<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHP Array Manipulation: Creating and Working with Arrays</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="icon" href="/favicon.png">
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <header>
        <h1>PHP Array Functions: Creating and Manipulating Arrays</h1>
        <p><a href="index.html">‚Üê Back to Syllabus</a></p>
    </header>
    
    <main>
        <section class="introduction">
            <h2>Understanding PHP Arrays</h2>
            <p>Welcome to our exploration of PHP array manipulation! Arrays are one of the most versatile and powerful data structures in PHP. Think of arrays as organized containers that can store multiple values under a single variable name, similar to how a filing cabinet organizes folders or how a toolbox stores different tools.</p>
            
            <p>In this lesson, we'll learn how to create, manipulate, and transform arrays using PHP's built-in functions. These skills are essential for any PHP developer, especially when working with WordPress, which heavily relies on arrays for storing and processing data.</p>
            
            <div class="array_visualization">
                <h3>Basic Array Structure</h3>
                <svg width="600" height="200" xmlns="http://www.w3.org/2000/svg">
                    <!-- Indexed Array -->
                    <rect x="50" y="30" width="500" height="60" fill="#f5f5f5" stroke="#333" stroke-width="2"/>
                    <text x="260" y="20" font-family="Arial" font-size="16" font-weight="bold">Indexed Array</text>
                    
                    <!-- Cells -->
                    <rect x="50" y="30" width="100" height="60" fill="#e6f7ff" stroke="#333" stroke-width="2"/>
                    <rect x="150" y="30" width="100" height="60" fill="#e6f7ff" stroke="#333" stroke-width="2"/>
                    <rect x="250" y="30" width="100" height="60" fill="#e6f7ff" stroke="#333" stroke-width="2"/>
                    <rect x="350" y="30" width="100" height="60" fill="#e6f7ff" stroke="#333" stroke-width="2"/>
                    <rect x="450" y="30" width="100" height="60" fill="#e6f7ff" stroke="#333" stroke-width="2"/>
                    
                    <!-- Indexes -->
                    <text x="95" y="110" font-family="Arial" font-size="14">Index 0</text>
                    <text x="195" y="110" font-family="Arial" font-size="14">Index 1</text>
                    <text x="295" y="110" font-family="Arial" font-size="14">Index 2</text>
                    <text x="395" y="110" font-family="Arial" font-size="14">Index 3</text>
                    <text x="495" y="110" font-family="Arial" font-size="14">Index 4</text>
                    
                    <!-- Values -->
                    <text x="90" y="65" font-family="Arial" font-size="14">"Apple"</text>
                    <text x="190" y="65" font-family="Arial" font-size="14">"Banana"</text>
                    <text x="290" y="65" font-family="Arial" font-size="14">"Cherry"</text>
                    <text x="390" y="65" font-family="Arial" font-size="14">"Dragon fruit"</text>
                    <text x="490" y="65" font-family="Arial" font-size="14">"Elderberry"</text>
                </svg>
                
                <svg width="600" height="200" xmlns="http://www.w3.org/2000/svg">
                    <!-- Associative Array -->
                    <rect x="50" y="30" width="500" height="60" fill="#f5f5f5" stroke="#333" stroke-width="2"/>
                    <text x="250" y="20" font-family="Arial" font-size="16" font-weight="bold">Associative Array</text>
                    
                    <!-- Cells -->
                    <rect x="50" y="30" width="100" height="60" fill="#ffefd5" stroke="#333" stroke-width="2"/>
                    <rect x="150" y="30" width="100" height="60" fill="#ffefd5" stroke="#333" stroke-width="2"/>
                    <rect x="250" y="30" width="100" height="60" fill="#ffefd5" stroke="#333" stroke-width="2"/>
                    <rect x="350" y="30" width="100" height="60" fill="#ffefd5" stroke="#333" stroke-width="2"/>
                    <rect x="450" y="30" width="100" height="60" fill="#ffefd5" stroke="#333" stroke-width="2"/>
                    
                    <!-- Keys -->
                    <text x="85" y="110" font-family="Arial" font-size="14">"name"</text>
                    <text x="185" y="110" font-family="Arial" font-size="14">"age"</text>
                    <text x="285" y="110" font-family="Arial" font-size="14">"city"</text>
                    <text x="385" y="110" font-family="Arial" font-size="14">"email"</text>
                    <text x="485" y="110" font-family="Arial" font-size="14">"active"</text>
                    
                    <!-- Values -->
                    <text x="80" y="65" font-family="Arial" font-size="14">"John Doe"</text>
                    <text x="192" y="65" font-family="Arial" font-size="14">28</text>
                    <text x="275" y="65" font-family="Arial" font-size="14">"New York"</text>
                    <text x="360" y="65" font-family="Arial" font-size="14">"john@example.com"</text>
                    <text x="492" y="65" font-family="Arial" font-size="14">true</text>
                </svg>
            </div>
        </section>

        <section class="array_creation">
            <h2>Creating Arrays in PHP</h2>
            
            <p>Before we dive into manipulation functions, let's review the basics of creating arrays in PHP:</p>
            
            <div class="code_example">
                <h3>Creating Indexed Arrays</h3>
                <pre><code>// Method 1: Using array() function
$fruits = array("Apple", "Banana", "Cherry", "Dragon fruit", "Elderberry");

// Method 2: Using short array syntax (PHP 5.4+) - Recommended
$fruits = ["Apple", "Banana", "Cherry", "Dragon fruit", "Elderberry"];

// Method 3: Adding elements individually
$fruits = [];
$fruits[] = "Apple";
$fruits[] = "Banana";
$fruits[] = "Cherry";

// Accessing elements
echo $fruits[0]; // Outputs: Apple
echo $fruits[2]; // Outputs: Cherry</code></pre>
            </div>
            
            <div class="code_example">
                <h3>Creating Associative Arrays</h3>
                <pre><code>// Method 1: Using array() function
$user = array(
    "name" => "John Doe",
    "age" => 28,
    "city" => "New York",
    "email" => "john@example.com",
    "active" => true
);

// Method 2: Using short array syntax (PHP 5.4+) - Recommended
$user = [
    "name" => "John Doe",
    "age" => 28,
    "city" => "New York",
    "email" => "john@example.com",
    "active" => true
];

// Method 3: Adding elements individually
$user = [];
$user["name"] = "John Doe";
$user["age"] = 28;
$user["city"] = "New York";

// Accessing elements
echo $user["name"]; // Outputs: John Doe
echo $user["city"]; // Outputs: New York</code></pre>
            </div>
            
            <div class="code_example">
                <h3>Creating Multidimensional Arrays</h3>
                <pre><code>// Multidimensional array example
$employees = [
    [
        "name" => "John Doe",
        "position" => "Developer",
        "skills" => ["PHP", "JavaScript", "MySQL"]
    ],
    [
        "name" => "Jane Smith",
        "position" => "Designer",
        "skills" => ["Photoshop", "Illustrator", "CSS"]
    ]
];

// Accessing elements
echo $employees[0]["name"]; // Outputs: John Doe
echo $employees[1]["skills"][0]; // Outputs: Photoshop</code></pre>
            </div>
        </section>

        <section class="array_manipulation">
            <h2>Essential Array Manipulation Functions</h2>
            
            <p>PHP provides a rich set of functions specifically designed for working with arrays. Let's explore the key functions you'll use most frequently:</p>
            
            <div class="function_category">
                <h3>Adding and Removing Elements</h3>
                
                <div class="function">
                    <h4>array_push() - Add Element(s) to the End</h4>
                    <p>The <code>array_push()</code> function adds one or more elements to the end of an array.</p>
                    
                    <div class="mermaid">
                    graph LR
                        subgraph "Before array_push()"
                            A1["Apple"] --> A2["Banana"] --> A3["Cherry"]
                        end
                        
                        subgraph "After array_push($fruits, 'Dragon fruit', 'Elderberry')"
                            B1["Apple"] --> B2["Banana"] --> B3["Cherry"] --> B4["Dragon fruit"] --> B5["Elderberry"]
                        end
                    </div>
                    
                    <div class="code_example">
                        <pre><code>$fruits = ["Apple", "Banana", "Cherry"];

// Add one element
array_push($fruits, "Dragon fruit");

// Add multiple elements
array_push($fruits, "Elderberry", "Fig");

print_r($fruits);
// Outputs:
// Array ( [0] => Apple [1] => Banana [2] => Cherry 
//         [3] => Dragon fruit [4] => Elderberry [5] => Fig )</code></pre>
                    </div>
                    
                    <div class="alternative">
                        <p><strong>Alternative approach:</strong> Use the array bracket notation for adding a single element. This is actually slightly faster than <code>array_push()</code> for single elements.</p>
                        <pre><code>$fruits[] = "Grape"; // Adds "Grape" to the end of the array</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_pop() - Remove the Last Element</h4>
                    <p>The <code>array_pop()</code> function removes the last element from an array and returns it.</p>
                    
                    <div class="mermaid">
                    graph LR
                        subgraph "Before array_pop()"
                            A1["Apple"] --> A2["Banana"] --> A3["Cherry"]
                        end
                        
                        subgraph "After array_pop($fruits)"
                            B1["Apple"] --> B2["Banana"]
                            B3["Returned: Cherry"]
                        end
                    </div>
                    
                    <div class="code_example">
                        <pre><code>$fruits = ["Apple", "Banana", "Cherry"];

$last_fruit = array_pop($fruits);

echo "Removed fruit: " . $last_fruit; // Outputs: Removed fruit: Cherry
print_r($fruits);
// Outputs: Array ( [0] => Apple [1] => Banana )</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_unshift() - Add Element(s) to the Beginning</h4>
                    <p>The <code>array_unshift()</code> function adds one or more elements to the beginning of an array.</p>
                    
                    <div class="mermaid">
                    graph LR
                        subgraph "Before array_unshift()"
                            A1["Banana"] --> A2["Cherry"]
                        end
                        
                        subgraph "After array_unshift($fruits, 'Apple')"
                            B1["Apple"] --> B2["Banana"] --> B3["Cherry"]
                        end
                    </div>
                    
                    <div class="code_example">
                        <pre><code>$fruits = ["Banana", "Cherry"];

// Add one element to the beginning
array_unshift($fruits, "Apple");

// Add multiple elements to the beginning
array_unshift($fruits, "Strawberry", "Raspberry");

print_r($fruits);
// Outputs:
// Array ( [0] => Strawberry [1] => Raspberry [2] => Apple 
//         [3] => Banana [4] => Cherry )</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_shift() - Remove the First Element</h4>
                    <p>The <code>array_shift()</code> function removes the first element from an array and returns it.</p>
                    
                    <div class="mermaid">
                    graph LR
                        subgraph "Before array_shift()"
                            A1["Apple"] --> A2["Banana"] --> A3["Cherry"]
                        end
                        
                        subgraph "After array_shift($fruits)"
                            B1["Banana"] --> B2["Cherry"]
                            B3["Returned: Apple"]
                        end
                    </div>
                    
                    <div class="code_example">
                        <pre><code>$fruits = ["Apple", "Banana", "Cherry"];

$first_fruit = array_shift($fruits);

echo "Removed fruit: " . $first_fruit; // Outputs: Removed fruit: Apple
print_r($fruits);
// Outputs: Array ( [0] => Banana [1] => Cherry )</code></pre>
                    </div>
                </div>
            </div>
            
            <div class="function_category">
                <h3>Array Information and Analysis</h3>
                
                <div class="function">
                    <h4>count() - Count Array Elements</h4>
                    <p>The <code>count()</code> function returns the number of elements in an array.</p>
                    <div class="code_example">
                        <pre><code>$fruits = ["Apple", "Banana", "Cherry", "Dragon fruit"];

echo "Number of fruits: " . count($fruits); // Outputs: Number of fruits: 4

// With multidimensional arrays
$nested_array = [1, 2, [3, 4, 5]];
echo "Count: " . count($nested_array); // Outputs: Count: 3
echo "Recursive count: " . count($nested_array, COUNT_RECURSIVE); // Outputs: Recursive count: 5</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>in_array() - Check if Value Exists</h4>
                    <p>The <code>in_array()</code> function checks if a value exists in an array. It returns <code>true</code> if the value is found, <code>false</code> otherwise.</p>
                    <div class="code_example">
                        <pre><code>$fruits = ["Apple", "Banana", "Cherry"];

if (in_array("Banana", $fruits)) {
    echo "Banana is in the fruit basket!";
} else {
    echo "No bananas today!";
}
// Outputs: Banana is in the fruit basket!

// Strict comparison (checking type as well)
$numbers = [1, 2, "3"];
var_dump(in_array(3, $numbers)); // Outputs: bool(true) - loose comparison
var_dump(in_array(3, $numbers, true)); // Outputs: bool(false) - strict comparison</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_key_exists() - Check if Key Exists</h4>
                    <p>The <code>array_key_exists()</code> function checks if a specified key exists in an array.</p>
                    <div class="code_example">
                        <pre><code>$user = [
    "name" => "John Doe",
    "age" => 28,
    "city" => "New York"
];

if (array_key_exists("age", $user)) {
    echo "The user's age is: " . $user["age"];
} else {
    echo "Age information is not available.";
}
// Outputs: The user's age is: 28</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_keys() - Get Array Keys</h4>
                    <p>The <code>array_keys()</code> function returns all the keys from an array.</p>
                    <div class="code_example">
                        <pre><code>$user = [
    "name" => "John Doe",
    "age" => 28,
    "city" => "New York"
];

$keys = array_keys($user);
print_r($keys);
// Outputs: Array ( [0] => name [1] => age [2] => city )

// Get keys for a specific value
$numbers = [10, 20, 30, 20, 40, 20];
$keys_for_20 = array_keys($numbers, 20);
print_r($keys_for_20);
// Outputs: Array ( [0] => 1 [1] => 3 [2] => 5 )</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_values() - Get Array Values</h4>
                    <p>The <code>array_values()</code> function returns all the values from an array.</p>
                    <div class="code_example">
                        <pre><code>$user = [
    "name" => "John Doe",
    "age" => 28,
    "city" => "New York"
];

$values = array_values($user);
print_r($values);
// Outputs: Array ( [0] => John Doe [1] => 28 [2] => New York )</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_search() - Search for Value</h4>
                    <p>The <code>array_search()</code> function searches for a value in an array and returns the key if found.</p>
                    <div class="code_example">
                        <pre><code>$fruits = ["Apple", "Banana", "Cherry", "Dragon fruit"];

$key = array_search("Cherry", $fruits);
echo "Cherry is at position: " . $key; // Outputs: Cherry is at position: 2

// If not found, returns false
$key = array_search("Mango", $fruits);
var_dump($key); // Outputs: bool(false)</code></pre>
                    </div>
                </div>
            </div>
            
            <div class="function_category">
                <h3>Array Transformation and Manipulation</h3>
                
                <div class="function">
                    <h4>array_merge() - Merge Arrays</h4>
                    <p>The <code>array_merge()</code> function merges one or more arrays into a single array.</p>
                    <div class="code_example">
                        <pre><code>$fruits1 = ["Apple", "Banana", "Cherry"];
$fruits2 = ["Dragon fruit", "Elderberry"];
$vegetables = ["Carrot", "Broccoli"];

$all_food = array_merge($fruits1, $fruits2, $vegetables);
print_r($all_food);
/* Outputs:
Array (
    [0] => Apple
    [1] => Banana
    [2] => Cherry
    [3] => Dragon fruit
    [4] => Elderberry
    [5] => Carrot
    [6] => Broccoli
)
*/

// With associative arrays, same keys will be overwritten
$settings1 = ["theme" => "light", "sidebar" => "left"];
$settings2 = ["theme" => "dark", "notifications" => true];

$merged_settings = array_merge($settings1, $settings2);
print_r($merged_settings);
/* Outputs:
Array (
    [theme] => dark
    [sidebar] => left
    [notifications] => 1
)
*/</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_combine() - Combine Keys and Values</h4>
                    <p>The <code>array_combine()</code> function creates a new array using one array for keys and another for values.</p>
                    <div class="code_example">
                        <pre><code>$keys = ["name", "age", "city"];
$values = ["John Doe", 28, "New York"];

$user = array_combine($keys, $values);
print_r($user);
/* Outputs:
Array (
    [name] => John Doe
    [age] => 28
    [city] => New York
)
*/</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_slice() - Extract Part of an Array</h4>
                    <p>The <code>array_slice()</code> function extracts a slice of an array.</p>
                    <div class="code_example">
                        <pre><code>$fruits = ["Apple", "Banana", "Cherry", "Dragon fruit", "Elderberry", "Fig"];

// Get 3 items starting at position 2
$slice1 = array_slice($fruits, 2, 3);
print_r($slice1);
// Outputs: Array ( [0] => Cherry [1] => Dragon fruit [2] => Elderberry )

// Get all items from position 3 to the end
$slice2 = array_slice($fruits, 3);
print_r($slice2);
// Outputs: Array ( [0] => Dragon fruit [1] => Elderberry [2] => Fig )

// Get the last 2 items using negative offset
$slice3 = array_slice($fruits, -2);
print_r($slice3);
// Outputs: Array ( [0] => Elderberry [1] => Fig )</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_splice() - Remove and Replace Elements</h4>
                    <p>The <code>array_splice()</code> function removes a portion of the array and replaces it with something else.</p>
                    <div class="code_example">
                        <pre><code>$fruits = ["Apple", "Banana", "Cherry", "Dragon fruit", "Elderberry"];

// Remove 2 items starting at position 1
array_splice($fruits, 1, 2);
print_r($fruits);
// Outputs: Array ( [0] => Apple [1] => Dragon fruit [2] => Elderberry )

$fruits = ["Apple", "Banana", "Cherry", "Dragon fruit", "Elderberry"];

// Replace 2 items starting at position 1 with new items
array_splice($fruits, 1, 2, ["Blueberry", "Blackberry"]);
print_r($fruits);
// Outputs: Array ( [0] => Apple [1] => Blueberry [2] => Blackberry 
//                  [3] => Dragon fruit [4] => Elderberry )

$fruits = ["Apple", "Banana", "Cherry", "Dragon fruit"];

// Insert items without removing any (length = 0)
array_splice($fruits, 2, 0, ["Blueberry", "Blackberry"]);
print_r($fruits);
// Outputs: Array ( [0] => Apple [1] => Banana [2] => Blueberry 
//                  [3] => Blackberry [4] => Cherry [5] => Dragon fruit )</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_reverse() - Reverse Array Order</h4>
                    <p>The <code>array_reverse()</code> function returns an array in reverse order.</p>
                    <div class="code_example">
                        <pre><code>$numbers = [1, 2, 3, 4, 5];

$reversed = array_reverse($numbers);
print_r($reversed);
// Outputs: Array ( [0] => 5 [1] => 4 [2] => 3 [3] => 2 [4] => 1 )

// Preserve keys
$user = [
    "name" => "John",
    "age" => 28,
    "city" => "New York"
];

$reversed_user = array_reverse($user, true);
print_r($reversed_user);
/* Outputs:
Array (
    [city] => New York
    [age] => 28
    [name] => John
)
*/</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_unique() - Remove Duplicate Values</h4>
                    <p>The <code>array_unique()</code> function removes duplicate values from an array.</p>
                    <div class="code_example">
                        <pre><code>$numbers = [1, 2, 3, 2, 4, 3, 5, 1];

$unique_numbers = array_unique($numbers);
print_r($unique_numbers);
// Outputs: Array ( [0] => 1 [1] => 2 [2] => 3 [4] => 4 [6] => 5 )
// Note that the original keys are preserved</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_filter() - Filter Elements</h4>
                    <p>The <code>array_filter()</code> function filters elements of an array using a callback function.</p>
                    <div class="code_example">
                        <pre><code>$numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

// Get only even numbers
$even_numbers = array_filter($numbers, function($value) {
    return $value % 2 === 0;
});

print_r($even_numbers);
// Outputs: Array ( [1] => 2 [3] => 4 [5] => 6 [7] => 8 [9] => 10 )
// Note that the original keys are preserved

// Remove empty values (default behavior when no callback is provided)
$values = ["apple", "", 0, null, false, "banana"];
$filtered = array_filter($values);

print_r($filtered);
// Outputs: Array ( [0] => apple [5] => banana )</code></pre>
                    </div>
                </div>
                
                <div class="function">
                    <h4>array_map() - Apply Function to All Elements</h4>
                    <p>The <code>array_map()</code> function applies a callback function to each element of an array.</p>
                    <div class="code_example">
                        <pre><code>$numbers = [1, 2, 3, 4, 5];

// Square each number
$squared = array_map(function($value) {
    return $value * $value;
}, $numbers);

print_r($squared);
// Outputs: Array ( [0] => 1 [1] => 4 [2] => 9 [3] => 16 [4] => 25 )

// Capitalize each word
$words = ["apple", "banana", "cherry"];
$capitalized = array_map('ucfirst', $words);

print_r($capitalized);
// Outputs: Array ( [0] => Apple [1] => Banana [2] => Cherry )</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <section class="challenge">
            <h2>Challenge: Create and Manipulate Arrays with PHP</h2>
            
            <p>Now let's apply what we've learned by solving a practical problem using George Polya's four-step problem-solving method.</p>
            
            <div class="problem">
                <h3>Problem Statement</h3>
                <p>You need to create a function that processes a list of user records and transforms it into a format suitable for display on a WordPress dashboard. The function should:</p>
                <ol>
                    <li>Accept an array of user records, each containing 'name', 'email', 'role', and 'last_login' fields</li>
                    <li>Remove any duplicate users (based on email)</li>
                    <li>Filter out inactive users (those who haven't logged in for more than 30 days)</li>
                    <li>Sort users by role importance (admin > editor > author > subscriber)</li>
                    <li>Format the data for display by adding a 'display_name' field that combines the name and role</li>
                    <li>Return the processed array</li>
                </ol>
            </div>
            
            <div class="solution">
                <h3>Solving the Challenge</h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p>Let's break down what we need to accomplish:</p>
                    <ul>
                        <li>Input: Array of user records with specific fields</li>
                        <li>Output: Processed array with filtered, sorted, and formatted user records</li>
                        <li>Processing steps: Remove duplicates, filter inactive users, sort by role, add display format</li>
                    </ul>
                    <p>Here's an example of what the input and output might look like:</p>
                    <pre><code>// Example input
$users = [
    [
        "name" => "John Doe",
        "email" => "john@example.com",
        "role" => "editor",
        "last_login" => "2023-05-10"
    ],
    [
        "name" => "Jane Smith",
        "email" => "jane@example.com",
        "role" => "admin",
        "last_login" => "2023-05-20"
    ],
    // More user records...
];

// Expected output
$processed_users = [
    [
        "name" => "Jane Smith",
        "email" => "jane@example.com",
        "role" => "admin",
        "last_login" => "2023-05-20",
        "display_name" => "Jane Smith (Admin)"
    ],
    [
        "name" => "John Doe",
        "email" => "john@example.com",
        "role" => "editor",
        "last_login" => "2023-05-10",
        "display_name" => "John Doe (Editor)"
    ],
    // More processed records...
];</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <p>Let's create a step-by-step approach to solve this problem:</p>
                    <ol>
                        <li>Create a function that accepts the user records array as input</li>
                        <li>Create a new array to store unique users (using email as the key to ensure uniqueness)</li>
                        <li>Calculate the cutoff date for inactive users (30 days ago)</li>
                        <li>Loop through each user record:
                            <ul>
                                <li>Skip if the email already exists in our new array</li>
                                <li>Skip if the last login is older than the cutoff date</li>
                                <li>Add a display_name field combining name and role</li>
                                <li>Store the user in our new array with email as key</li>
                            </ul>
                        </li>
                        <li>Define a role priority mapping for sorting</li>
                        <li>Sort the array by role priority</li>
                        <li>Reset array keys and return the final array</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Implement the Solution</h4>
                    <pre><code>/**
 * Process user records for dashboard display
 * 
 * @param array $users Array of user records
 * @return array Processed user records
 */
function process_users_for_dashboard($users) {
    // Step 1: Initialize variables
    $processed_users = [];
    $cutoff_date = date('Y-m-d', strtotime('-30 days'));
    
    // Step 2: Process each user
    foreach ($users as $user) {
        // Skip if missing required fields
        if (!isset($user['email']) || !isset($user['role']) || !isset($user['last_login'])) {
            continue;
        }
        
        $email = $user['email'];
        
        // Skip if duplicate email
        if (isset($processed_users[$email])) {
            continue;
        }
        
        // Skip if inactive (not logged in for 30+ days)
        if ($user['last_login'] < $cutoff_date) {
            continue;
        }
        
        // Add display_name field
        $user['display_name'] = $user['name'] . ' (' . ucfirst($user['role']) . ')';
        
        // Add to processed array using email as key for uniqueness
        $processed_users[$email] = $user;
    }
    
    // Step 3: Define role priorities for sorting
    $role_priority = [
        'admin' => 1,
        'editor' => 2,
        'author' => 3,
        'subscriber' => 4
    ];
    
    // Step 4: Sort by role priority
    uasort($processed_users, function($a, $b) use ($role_priority) {
        $priority_a = isset($role_priority[$a['role']]) ? $role_priority[$a['role']] : 999;
        $priority_b = isset($role_priority[$b['role']]) ? $role_priority[$b['role']] : 999;
        
        return $priority_a <=> $priority_b; // Using spaceship operator (PHP 7+)
    });
    
    // Step 5: Reset array keys and return
    return array_values($processed_users);
}

// Example usage:
$user_records = [
    [
        "name" => "John Doe",
        "email" => "john@example.com",
        "role" => "editor",
        "last_login" => "2023-05-10"
    ],
    [
        "name" => "Jane Smith",
        "email" => "jane@example.com",
        "role" => "admin",
        "last_login" => "2023-05-20"
    ],
    [
        "name" => "Bob Johnson",
        "email" => "bob@example.com",
        "role" => "subscriber",
        "last_login" => "2023-04-15" // Inactive (more than 30 days ago)
    ],
    [
        "name" => "Alice Brown",
        "email" => "alice@example.com",
        "role" => "author",
        "last_login" => "2023-05-18"
    ],
    [
        "name" => "John Duplicate",
        "email" => "john@example.com", // Duplicate email
        "role" => "author",
        "last_login" => "2023-05-22"
    ]
];

$dashboard_users = process_users_for_dashboard($user_records);
print_r($dashboard_users);</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Review and Improve</h4>
                    <p>Let's review our solution and consider improvements:</p>
                    <ul>
                        <li><strong>Correctness:</strong> The solution correctly implements all the requirements - removing duplicates, filtering inactive users, sorting by role, and adding display names.</li>
                        <li><strong>Efficiency:</strong> By using email as the key in our intermediate array, we efficiently remove duplicates without needing an extra loop.</li>
                        <li><strong>Readability:</strong> The code is well-structured with comments explaining each step.</li>
                    </ul>
                    
                    <p>Possible improvements:</p>
                    <ol>
                        <li>Add error handling for malformed input</li>
                        <li>Make the inactive cutoff period configurable</li>
                        <li>Add more sophisticated sorting (e.g., by role first, then by name)</li>
                    </ol>
                    
                    <p>Here's an improved version with these enhancements:</p>
                    
                    <pre><code>/**
 * Process user records for dashboard display with enhanced features
 * 
 * @param array $users Array of user records
 * @param int $inactive_days Days to consider a user inactive
 * @param array $custom_priorities Custom role priority mapping
 * @return array Processed user records
 */
function process_users_for_dashboard_enhanced($users, $inactive_days = 30, $custom_priorities = []) {
    // Validate input
    if (!is_array($users)) {
        return [];
    }
    
    // Initialize variables
    $processed_users = [];
    $cutoff_date = date('Y-m-d', strtotime("-$inactive_days days"));
    
    // Define default role priorities
    $default_priorities = [
        'admin' => 1,
        'editor' => 2,
        'author' => 3,
        'contributor' => 4,
        'subscriber' => 5
    ];
    
    // Merge with custom priorities if provided
    $role_priority = array_merge($default_priorities, $custom_priorities);
    
    // Process each user
    foreach ($users as $user) {
        // Validate user record
        if (!isset($user['email']) || !isset($user['name']) || 
            !isset($user['role']) || !isset($user['last_login'])) {
            continue; // Skip invalid records
        }
        
        $email = $user['email'];
        
        // Skip if duplicate email (keep the one with the most recent login)
        if (isset($processed_users[$email])) {
            // If this login is more recent, replace the existing record
            if ($user['last_login'] > $processed_users[$email]['last_login']) {
                // Keep processing this user
            } else {
                continue; // Skip this user
            }
        }
        
        // Skip if inactive
        if ($user['last_login'] < $cutoff_date) {
            continue;
        }
        
        // Format the last_login date for display
        $user['formatted_login'] = date('F j, Y', strtotime($user['last_login']));
        
        // Add display_name field
        $user['display_name'] = $user['name'] . ' (' . ucfirst($user['role']) . ')';
        
        // Add to processed array using email as key for uniqueness
        $processed_users[$email] = $user;
    }
    
    // First sort by role priority, then by name
    uasort($processed_users, function($a, $b) use ($role_priority) {
        // Get role priorities
        $priority_a = isset($role_priority[$a['role']]) ? $role_priority[$a['role']] : 999;
        $priority_b = isset($role_priority[$b['role']]) ? $role_priority[$b['role']] : 999;
        
        // If roles are different, sort by role priority
        if ($priority_a !== $priority_b) {
            return $priority_a <=> $priority_b;
        }
        
        // If roles are the same, sort by name
        return strcmp($a['name'], $b['name']);
    });
    
    // Reset array keys and return
    return array_values($processed_users);
}</code></pre>
                    
                    <p>This enhanced version offers more flexibility and better handles edge cases while maintaining the core functionality of the original solution.</p>
                </div>
            </div>
        </section>

        <section class="real_world">
            <h2>Real-World Applications in WordPress</h2>
            
            <p>Understanding array functions is crucial for WordPress development. Here are some common scenarios where you'll use these techniques:</p>
            
            <div class="application">
                <h3>Processing Custom Post Types</h3>
                <pre><code>/**
 * Get and process featured products for a homepage carousel
 */
function get_featured_products() {
    // Get raw product posts
    $args = array(
        'post_type' => 'product',
        'posts_per_page' => -1,
        'meta_query' => array(
            array(
                'key' => '_featured',
                'value' => 'yes',
                'compare' => '='
            )
        )
    );
    
    $products = get_posts($args);
    
    // Transform into a simpler format for the carousel
    $featured_products = array_map(function($product) {
        // Get product data
        $product_id = $product->ID;
        $thumbnail = get_the_post_thumbnail_url($product_id, 'medium');
        $price = get_post_meta($product_id, '_price', true);
        
        // Build the featured product array
        return array(
            'id' => $product_id,
            'title' => get_the_title($product),
            'image' => $thumbnail ? $thumbnail : '/images/placeholder.jpg',
            'price' => $price ? '$' . number_format($price, 2) : 'Price unavailable',
            'url' => get_permalink($product)
        );
    }, $products);
    
    // Sort by price (lowest first)
    usort($featured_products, function($a, $b) {
        $price_a = str_replace(['$', ','], '', $a['price']);
        $price_b = str_replace(['$', ','], '', $b['price']);
        
        // Handle non-numeric prices
        if (!is_numeric($price_a)) return 1;
        if (!is_numeric($price_b)) return -1;
        
        return $price_a <=> $price_b;
    });
    
    // Limit to 5 products
    return array_slice($featured_products, 0, 5);
}</code></pre>
            </div>
            
            <div class="application">
                <h3>Working with WordPress Settings</h3>
                <pre><code>/**
 * Merge default plugin settings with user settings
 */
function get_plugin_settings() {
    // Default settings
    $defaults = array(
        'enable_feature_a' => true,
        'enable_feature_b' => false,
        'max_items' => 10,
        'display_mode' => 'grid',
        'cache_time' => 3600
    );
    
    // Get user settings
    $user_settings = get_option('my_plugin_settings', array());
    
    // Merge defaults with user settings
    $settings = array_merge($defaults, $user_settings);
    
    return $settings;
}

/**
 * Validate and sanitize plugin settings
 */
function sanitize_plugin_settings($input) {
    $valid_settings = array();
    
    // Define allowed settings and their types
    $allowed_settings = array(
        'enable_feature_a' => 'boolean',
        'enable_feature_b' => 'boolean',
        'max_items' => 'integer',
        'display_mode' => 'string',
        'cache_time' => 'integer'
    );
    
    // Process each input
    foreach ($input as $key => $value) {
        // Skip if not an allowed setting
        if (!array_key_exists($key, $allowed_settings)) {
            continue;
        }
        
        // Sanitize based on expected type
        switch ($allowed_settings[$key]) {
            case 'boolean':
                $valid_settings[$key] = (bool) $value;
                break;
                
            case 'integer':
                $valid_settings[$key] = intval($value);
                break;
                
            case 'string':
                $valid_settings[$key] = sanitize_text_field($value);
                break;
        }
    }
    
    return $valid_settings;
}</code></pre>
            </div>
            
            <div class="application">
                <h3>Processing Form Data</h3>
                <pre><code>/**
 * Process a multi-checkbox form field
 */
function process_form_checkboxes() {
    // No checkboxes were checked
    if (!isset($_POST['interests'])) {
        return array();
    }
    
    // Get submitted interests
    $submitted_interests = $_POST['interests'];
    
    // Make sure it's an array
    if (!is_array($submitted_interests)) {
        $submitted_interests = array($submitted_interests);
    }
    
    // Define allowed values
    $allowed_interests = array('sports', 'music', 'movies', 'books', 'travel');
    
    // Filter out invalid values
    $valid_interests = array_filter($submitted_interests, function($interest) use ($allowed_interests) {
        return in_array($interest, $allowed_interests);
    });
    
    // Sanitize each value
    $sanitized_interests = array_map('sanitize_text_field', $valid_interests);
    
    return $sanitized_interests;
}</code></pre>
            </div>
        </section>

        <section class="homework">
            <h2>Homework Assignment: Array Function Practice</h2>
            
            <p>Create a PHP function that takes a list of products (as an array) and transforms it for a WordPress theme's featured products section. The function should accomplish the following:</p>
            
            <ol>
                <li>Accept an array of products, each containing 'id', 'name', 'category', 'price', and 'stock' fields</li>
                <li>Remove out-of-stock products (stock = 0)</li>
                <li>Group products by category</li>
                <li>Sort products within each category by price (lowest first)</li>
                <li>Format prices to display with a currency symbol and two decimal places</li>
                <li>Limit each category to show a maximum of 3 products</li>
                <li>Return the processed array</li>
            </ol>
            
            <p>Starter code:</p>
            
            <pre><code>/**
 * Process products for featured products section
 * 
 * @param array $products Array of product records
 * @return array Processed products grouped by category
 */
function process_featured_products($products) {
    // Your solution here
}

// Sample data to test your function
$products = [
    [
        'id' => 101,
        'name' => 'Wireless Headphones',
        'category' => 'Electronics',
        'price' => 59.99,
        'stock' => 15
    ],
    [
        'id' => 102,
        'name' => 'Bluetooth Speaker',
        'category' => 'Electronics',
        'price' => 89.99,
        'stock' => 0 // Out of stock
    ],
    [
        'id' => 103,
        'name' => 'Smartphone Case',
        'category' => 'Accessories',
        'price' => 19.99,
        'stock' => 32
    ],
    [
        'id' => 104,
        'name' => 'Laptop Sleeve',
        'category' => 'Accessories',
        'price' => 29.99,
        'stock' => 8
    ],
    [
        'id' => 105,
        'name' => 'Wireless Charger',
        'category' => 'Electronics',
        'price' => 34.99,
        'stock' => 12
    ],
    [
        'id' => 106,
        'name' => 'Smartwatch',
        'category' => 'Electronics',
        'price' => 199.99,
        'stock' => 5
    ],
    [
        'id' => 107,
        'name' => 'Phone Mount',
        'category' => 'Accessories',
        'price' => 14.99,
        'stock' => 21
    ],
    [
        'id' => 108,
        'name' => 'Tablet Stand',
        'category' => 'Accessories',
        'price' => 24.99,
        'stock' => 0 // Out of stock
    ]
];

$featured = process_featured_products($products);
print_r($featured);</code></pre>
            
            <p>Use the array functions we've covered in this lesson to create an elegant solution. Try to use at least 5 different array functions in your implementation.</p>
        </section>

        <section class="further_learning">
            <h2>Further Learning</h2>
            
            <ul>
                <li><a href="https://www.php.net/manual/en/book.array.php" target="_blank">PHP Manual: Array Functions</a> - Complete reference of all array functions</li>
                <li><a href="https://developer.wordpress.org/reference/" target="_blank">WordPress Developer Reference</a> - Official documentation for WordPress developers</li>
                <li><a href="https://www.smashingmagazine.com/2016/03/advanced-wordpress-development-techniques/" target="_blank">Advanced WordPress Development Techniques</a> - Article with real-world examples</li>
            </ul>
        </section>

        <section class="next_session">
            <h2>Coming Up Next</h2>
            <p>In our next session, we'll explore PHP array sorting techniques, learning how to organize and arrange array data for optimal presentation and processing.</p>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2025 PHP WordPress Development Course</p>
        <p><a href="module2.html">Back to Module 2</a> | <a href="index.html">Back to Syllabus</a></p>
    </footer>
</body>
</html>
