<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="ie=edge" http-equiv="X-UA-Compatible"/>
<!-- SEO Meta Tags -->
<title>PHP Functions: Anonymous Functions and Closures - PHP WordPress Course</title>
<meta content="Master anonymous functions and closures." name="description"/>
<meta content="PHP, WordPress, web development, anonymous, functions, and, closures" name="keywords"/>
<meta content="PHP WordPress Course" name="author"/>
<!-- Favicon -->
<link href="/favicon.png" rel="icon" type="image/png"/>
<link href="/favicon.png" rel="apple-touch-icon"/>
<!-- CSS -->
<link href="/assets/css/main.css" rel="stylesheet"/><link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/><link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>

<style>
/* Global diagram and SVG styles */
.mermaid-converted,
.svg-container,
.diagram {
    margin: 1.5rem auto !important;
    padding: 1rem !important;
    text-align: center !important;
    overflow: hidden !important;
    max-width: 100% !important;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #dee2e6;
}

.mermaid-converted svg,
.svg-container svg,
.diagram svg {
    max-width: 100% !important;
    height: auto !important;
    display: block !important;
    margin: 0 auto !important;
}

/* Fix for decision diamonds */
.decision-node polygon,
polygon.decision {
    fill: #fff3cd !important;
    stroke: #856404 !important;
    stroke-width: 2px !important;
}

/* Remove excessive bottom margins */
.mermaid-converted + *,
.svg-container + *,
.diagram + * {
    margin-top: 1.5rem !important;
}

/* Center content vertically in containers */
.mermaid-converted > *,
.svg-container > *,
.diagram > * {
    vertical-align: middle;
}
</style>


<style>
/* Mermaid Diagram Specific Styles */
.mermaid-converted,
.mermaid,
.mermaid-container,
.mermaid-diagram {
    margin: 1.5rem auto 0 !important;
    margin-bottom: 0 !important;
    padding: 1rem !important;
    text-align: center !important;
    overflow: visible !important;
    max-width: 100% !important;
    background: #f8f9fa;
    border-radius: 8px;
    border: 1px solid #dee2e6;
    box-sizing: border-box;
}

/* Ensure next element doesn't have excessive top margin */
.mermaid-converted + *,
.mermaid + *,
.mermaid-container + *,
.mermaid-diagram + * {
    margin-top: 1.5rem !important;
}

/* SVG within Mermaid containers */
.mermaid-converted svg,
.mermaid svg,
.mermaid-container svg,
.mermaid-diagram svg {
    max-width: 100% !important;
    height: auto !important;
    display: block !important;
    margin: 0 auto !important;
    overflow: visible !important;
}

/* Standardized decision diamonds */
polygon.decision,
.decision-node polygon,
polygon[class*="decision"] {
    fill: #fff3cd !important;
    stroke: #856404 !important;
    stroke-width: 2px !important;
}

/* Prevent text overlap */
text {
    pointer-events: none;
    z-index: 1000;
}

/* Fix for overlapping elements */
rect, circle, polygon, ellipse {
    pointer-events: all;
}

/* Remove any default margins that might cause issues */
.mermaid-converted > :last-child,
.mermaid > :last-child,
.mermaid-container > :last-child,
.mermaid-diagram > :last-child {
    margin-bottom: 0 !important;
}

/* Ensure proper spacing between consecutive diagrams */
.mermaid-converted + .mermaid-converted,
.mermaid + .mermaid,
.mermaid-container + .mermaid-container,
.mermaid-diagram + .mermaid-diagram {
    margin-top: 2rem !important;
}
</style>

</head>
<body>
<!-- Skip to main content -->
<a class="sr-only" href="#main-content">Skip to main content</a>
<div class="page-wrapper">
<!-- Header -->
<header class="site-header" role="banner">
<div class="header-container">
<div class="site-branding">
<a class="site-logo" href="/">
<h1 class="site-title">PHP WordPress Development</h1>
</a>
</div>
<nav aria-label="Main navigation" class="main-navigation" role="navigation">
<button aria-expanded="false" aria-label="Toggle navigation" class="mobile-menu-btn">
<span></span>
<span></span>
<span></span>
</button>
<div class="nav-menu">
<ul class="nav-list">
<li class="nav-item"><a class="nav-link" href="/">Home</a></li>
<li class="nav-item dropdown">
<button aria-haspopup="true" class="nav-link dropdown-toggle active">Modules</button>
<div class="dropdown-menu">
<a class="dropdown-item" href="/module1.html">Module 1: Web Fundamentals</a>
<a class="dropdown-item active" href="/module2.html">Module 2: PHP Fundamentals</a>
<a class="dropdown-item" href="/module3.html">Module 3: MySQL Database</a>
<a class="dropdown-item" href="/module4.html">Module 4: WordPress &amp; Docker</a>
<a class="dropdown-item" href="/module5.html">Module 5: Theme Development</a>
<a class="dropdown-item" href="/module6.html">Module 6: Plugin Development</a>
<a class="dropdown-item" href="/module7.html">Module 7: Advanced WordPress</a>
<a class="dropdown-item" href="/module8.html">Module 8: Deployment</a>
<a class="dropdown-item" href="/module9.html">Module 9: Final Project</a>
</div>
</li>
<li class="nav-item"><a class="nav-link" href="/resources.html">Resources</a></li>
<li class="nav-item"><a class="nav-link" href="/about.html">About</a></li>
</ul>
</div>
</nav>
<div class="search-container">
<div class="search-input-wrapper">
<svg class="search-icon" fill="currentColor" height="20" viewbox="0 0 20 20" width="20" style="max-width: 100%; height: auto; display: block; margin: 0 auto;" viewBox="0 0 20 20">
<path clip-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" fill-rule="evenodd"></path>
</svg>
<input aria-label="Search" class="search-input" placeholder="Search lessons..." type="search"/>
</div>
<div class="search-results"></div>
</div>
</div>
</header>
<!-- Progress Bar -->
<div class="progress-container">
<div class="progress-header">
<h2 class="progress-title">Course Progress</h2>
<span class="progress-text">Loading...</span>
</div>
<div class="progress-bar">
<div class="progress-bar-fill">
<span class="progress-bar-text"></span>
</div>
</div>
</div>
<!-- Breadcrumb -->
<nav aria-label="Breadcrumb" class="breadcrumb container">
<ol class="breadcrumb-list">
<li class="breadcrumb-item">
<a href="/">Home</a>
<span class="breadcrumb-separator">/</span>
</li>
<li class="breadcrumb-item">
<a href="/module2.html">Module 2</a>
<span class="breadcrumb-separator">/</span>
</li>
<li class="breadcrumb-item">
<span aria-current="page">Anonymous Functions and Closures</span>
</li>
</ol>
</nav>
<!-- Main Content -->
<main class="main-content" id="main-content" role="main">
<div class="container">
<div class="content-with-sidebar">
<!-- Sidebar -->
<aside class="sidebar">

<div class="sidebar-nav">
<h3 class="sidebar-title">Module 2: PHP Fundamentals</h3>
<div class="sidebar-section">
<h4 class="sidebar-section-title">Session 6</h4>
<ul class="sidebar-menu">
<li><a class="sidebar-link" href="/02module/php_function_declaration_and_calling.html">Function Declaration</a></li>
<li><a class="sidebar-link" href="/02module/php_function_parameters_and return_values.html">Parameters &amp; Returns</a></li>
<li><a class="sidebar-link" href="/02module/php_default_parameter_values.html">Default Parameters</a></li>
<li><a class="sidebar-link" href="/02module/php_variable_scope.html">Variable Scope</a></li>
<li class="active"><a class="sidebar-link active" href="/02module/php_anonymoous_functions_and_closures.html">Anonymous Functions</a></li>
<li><a class="sidebar-link" href="/02module/php_built_in_php_functions_overview.html">Built-in Functions</a></li>
<li><a class="sidebar-link" href="/02module/homework_php_create_library_custom_functions.html">Homework: Functions</a></li>
</ul>
</div>
<div class="sidebar-section">
<h4 class="sidebar-section-title">Quick Links</h4>
<ul class="sidebar-menu">
<li><a class="sidebar-link" href="/module2.html">Module Overview</a></li>
<li><a class="sidebar-link prev-session" href="/02module/php_indexed_array.html">← Prev: Session 5: Arrays</a></li>
<li><a class="sidebar-link next-session" href="/02module/php_html_forms_review.html">Next: Session 7: Forms →</a></li>
<li><a class="sidebar-link" href="/module1.html">← Previous Module</a></li>
<li><a class="sidebar-link" href="/module3.html">Next Module →</a></li>
<li><a class="sidebar-link" href="/resources.html">Resources</a></li>
</ul>
</div>
</div></aside>
<!-- Main Lesson Content -->
<article class="lesson-content">
<header class="lesson-header">
<h1>PHP Functions: Anonymous Functions and Closures</h1>
<div class="lesson-meta">
<div class="lesson-meta-item">
<svg fill="currentColor" height="20" width="20" style="max-width: 100%; height: auto; display: block; margin: 0 auto;" viewBox="0 0 20 20">
<path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<span>Duration: 45 minutes</span>
</div>
<div class="lesson-meta-item">
<svg fill="currentColor" height="20" width="20" style="max-width: 100%; height: auto; display: block; margin: 0 auto;" viewBox="0 0 20 20">
<path d="M12 14l9-5-9-5-9 5 9 5z"></path>
</svg>
<span>Module 2: Functions in PHP</span>
</div>
</div>
</header>
<!-- Learning Objectives -->
<div class="lesson-objectives">
<h2>Learning Objectives</h2>
<ul>
<li>Create and use PHP functions</li>
<li>Understand function parameters and returns</li>
<li>Master variable scope in functions</li>
<li>Build reusable code components</li>
</ul>
</div>
<!-- Lesson Body -->
<div class="lesson-body">
<section class="intro">
            <h2>Unlocking Flexible Function Power</h2>
            <p>Welcome to our exploration of anonymous functions and closures in PHP! These powerful features allow you to create functions on the fly, pass them as arguments, and encapsulate specific behaviors in elegant ways that can dramatically improve your WordPress development.</p>
            
            <p>Think of anonymous functions like temporary workers you can hire for specific tasks without going through the formal process of creating a permanent employee. They show up, do exactly what you need, and integrate seamlessly with your existing team.</p>

            <div class="definition-box">
                <h3>What Are Anonymous Functions and Closures?</h3>
                <p><strong>Anonymous Functions</strong> are functions without a name that can be created and used inline. They're also called lambda functions in some programming languages.</p>
                <p><strong>Closures</strong> are anonymous functions that can access variables from their parent scope. They "close over" variables from the surrounding context.</p>
            </div>
        </section>

        <section class="visual-concept">
            <h2>Understanding Anonymous Functions: A Visual Model</h2>
            
            <div class="svg-container" style="margin: 1.5rem auto; padding: 1rem; text-align: center; overflow: hidden; max-width: 100%;">
<svg width="650" height="400" xmlns="http://www.w3.org/2000/svg" style="max-width: 100%; height: auto; display: block; margin: 0 auto;" viewBox="0 0 650 400">
                    <!-- Anonymous Functions vs. Named Functions Diagram -->
                    <rect x="50" y="30" width="550" height="340" fill="#f5f5f5" stroke="#333" stroke-width="2"/>
                    <text x="325" y="60" text-anchor="middle" font-size="20" font-weight="bold">Named vs. Anonymous Functions</text>

                    <!-- Named Function -->
                    <rect x="70" y="90" width="240" height="260" fill="#e3f2fd" stroke="#0d47a1" stroke-width="2"/>
                    <text x="190" y="120" text-anchor="middle" font-weight="bold" fill="#0d47a1">Named Function</text>
<rect x="90" y="140" width="200" height="90" fill="#bbdefb" stroke="#0d47a1" stroke-width="1"/>
                    <text x="190" y="160" text-anchor="middle" font-size="14">function calculateTotal($a, $b) {</text>
                    <text x="190" y="185" text-anchor="middle" font-size="14">    return $a + $b;</text>
                    <text x="190" y="210" text-anchor="middle" font-size="14">}</text>
<rect x="90" y="240" width="200" height="90" fill="#bbdefb" stroke="#0d47a1" stroke-width="1"/>
                    <text x="190" y="270" text-anchor="middle" font-size="14">// Call by name</text>
                    <text x="190" y="295" text-anchor="middle" font-size="14">$result = calculateTotal(5, 10);</text>
                    <text x="190" y="320" text-anchor="middle" font-size="14">// $result = 15</text>
                    
                    <!-- Anonymous Function -->
                    <rect x="340" y="90" width="240" height="260" fill="#e8f5e9" stroke="#1b5e20" stroke-width="2"/>
                    <text x="460" y="120" text-anchor="middle" font-weight="bold" fill="#1b5e20">Anonymous Function</text>
<rect x="360" y="140" width="200" height="90" fill="#c8e6c9" stroke="#1b5e20" stroke-width="1"/>
                    <text x="460" y="160" text-anchor="middle" font-size="14">$calculateTotal = function($a, $b) {</text>
                    <text x="460" y="185" text-anchor="middle" font-size="14">    return $a + $b;</text>
                    <text x="460" y="210" text-anchor="middle" font-size="14">};</text>
<rect x="360" y="240" width="200" height="90" fill="#c8e6c9" stroke="#1b5e20" stroke-width="1"/>
                    <text x="460" y="270" text-anchor="middle" font-size="14">// Call through variable</text>
                    <text x="460" y="295" text-anchor="middle" font-size="14">$result = $calculateTotal(5, 10);</text>
                    <text x="460" y="320" text-anchor="middle" font-size="14">// $result = 15</text>
                </svg>
</div>
            
            <p>Think of a named function like a dedicated tool in your workshop - it has a specific name, place, and purpose. An anonymous function is more like a temporary tool you create for a specific job and then store in a variable or pass along to be used elsewhere.</p>
        </section>

        <section class="anonymous-basics">
            <h2>Creating and Using Anonymous Functions</h2>
            
            <p>Anonymous functions in PHP are created with the <code>function</code> keyword, but without a name. They're typically assigned to variables or passed directly as arguments.</p>
            
            <div class="code-example">
                <h3>Basic Anonymous Function Syntax</h3>
                <pre><code>$functionName = function($param1, $param2) {
    // Function body
    return $result;
};</code></pre>
            </div>

            <p>Note the semicolon at the end of the function definition - it's required because this is an expression assignment, not a function declaration.</p>

            <div class="example-box">
                <h3>Simple Anonymous Function Example</h3>
                <pre><code>// Create an anonymous function and assign it to a variable
$greeting = function($name) {
    return "Hello, $name!";
};

// Use the function
echo $greeting("WordPress Developer"); // Outputs: Hello, WordPress Developer!</code></pre>
            </div>

            <p>Once assigned to a variable, you can use an anonymous function just like any other function - call it with arguments, capture its return value, and so on.</p>
            
            <div class="example-box">
                <h3>Using Anonymous Functions as Arguments</h3>
                <pre><code>// A function that takes another function as an argument
function processList($items, $formatter) {
    $result = "";
    foreach ($items as $item) {
        $result .= $formatter($item) . "
";
    }
    return $result;
}

// Pass an anonymous function as an argument
$output = processList(
    ['Home', 'About', 'Contact'], 
    function($text) {
        return "• " . strtoupper($text);
    }
);

echo $output;
// Outputs:
// • HOME
// • ABOUT
// • CONTACT</code></pre>
            </div>

            <p>This ability to pass functions as arguments opens up powerful programming patterns that we'll explore throughout this lecture.</p>
        </section>

        <section class="closures-explained">
            <h2>Understanding Closures: Functions with Memory</h2>
            
            <p>A closure is a special type of anonymous function that "remembers" the environment in which it was created. This means it can access variables from the outer scope where it was defined.</p>

<div class="mermaid-converted" style="margin: 1.5rem auto 0; padding: 1rem; text-align: center; overflow: visible; max-width: 100%; min-height: auto;">
<div style="margin-bottom: 10px; font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 1px;">Diagram
</div>
    <svg viewBox="0 0 800 700" xmlns="http://www.w3.org/2000/svg" 
     style="max-width: 100%; height: auto; display: block; margin: 0 auto; background: white; border-radius: 8px;; max-width: 100%; height: auto; display: block; margin: 0 auto;">
    <!-- Embedded styles for this diagram only -->
    <defs>
        <style type="text/css">
            .node-rect { fill: #e1f5fe; stroke: #01579b; stroke-width: 2px; }
            .node-rect:hover { fill: #b3e5fc; }
            .node-text { fill: #01579b; font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; font-weight: 500; }
            .connection-line { stroke: #546e7a; stroke-width: 2px; fill: none; }
            .arrow-marker { fill: #546e7a; }
            .diagram-title { fill: #263238; font-size: 18px; font-weight: bold; }
            .subgraph-rect { fill: #fff3e0; stroke: #e65100; stroke-width: 1px; stroke-dasharray: 5,5; opacity: 0.3; }
        </style>
        
        <!-- Arrow marker -->
        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L0,6 L9,3 z" class="arrow-marker"/>
        </marker>
    </defs>
    
    <!-- Background -->
    <rect x="0" y="0" width="800" height="700" fill="#fafafa" rx="8"/>
    
    <line x1="190.0" y1="80" x2="225.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="330.0" y1="80" x2="400.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="330.0" y1="80" x2="575.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="190.0" y1="80" x2="400.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <text x="295.0" y="135.0" text-anchor="middle" 
          class="node-text" font-size="12">&gt; A1[&quot;$prefix = &#39;wp_&#39;&quot;] B </text>
    <rect x="130.0" y="55" width="120" height="50" 
          rx="5" class="node-rect"/>
    <text x="190.0" y="80" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Outer Scope</text>
    <rect x="270.0" y="55" width="120" height="50" 
          rx="5" class="node-rect"/>
    <text x="330.0" y="80" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Closure</text>
    <rect x="159.0" y="175" width="132" height="50" 
          rx="5" class="node-rect"/>
    <text x="225.0" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">$prefix = &#39;wp_</text>
    <rect x="254.0" y="175" width="292" height="50" 
          rx="5" class="node-rect"/>
    <text x="400.0" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">function($text) use($prefix) {...}</text>
    <rect x="433.0" y="175" width="284" height="50" 
          rx="5" class="node-rect"/>
    <text x="575.0" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Captures $prefix from outer scope</text>
    <rect x="410.0" y="55" width="120" height="50" 
          rx="25" class="node-rect"/>
    <text x="470.0" y="80" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">$text</text>
    <rect x="550.0" y="55" width="120" height="50" 
          rx="25" class="node-rect"/>
    <text x="610.0" y="80" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">$prefix</text>
</svg>
</div><div class="example-box">
                <h3>Basic Closure Example</h3>
                <pre><code>// Outer scope variable
$prefix = "WordPress_";

// Create a closure that uses the outer scope variable
$addPrefix = function($string) use ($prefix) {
    return $prefix . $string;
};

// Use the closure
echo $addPrefix("Plugin"); // Outputs: WordPress_Plugin</code></pre>
            </div>

            <p>The <code>use</code> keyword is essential here - it tells PHP which variables from the outer scope should be available inside the closure.</p>
            
            <div class="example-box">
                <h3>Multiple Variables in Closures</h3>
                <pre><code>$firstName = "John";
$lastName = "Doe";

$formatName = function($format) use ($firstName, $lastName) {
    switch ($format) {
        case 'full':
            return "$firstName $lastName";
        case 'last_first':
            return "$lastName, $firstName";
        case 'initials':
            return strtoupper(substr($firstName, 0, 1) . substr($lastName, 0, 1));
        default:
            return $firstName;
    }
};

echo $formatName('full');       // Outputs: John Doe
echo $formatName('last_first'); // Outputs: Doe, John
echo $formatName('initials');   // Outputs: JD</code></pre>
            </div>

            <p>You can capture multiple variables from the outer scope by listing them in the <code>use</code> statement.</p>
        </section>

        <section class="value-vs-reference">
            <h2>Capturing Variables by Value vs. Reference</h2>
            
            <p>By default, when a closure captures variables with <code>use</code>, it captures them by value (makes a copy). Sometimes, you want to capture by reference to see or make changes to the original variable.</p>
            
            <div class="svg-container" style="margin: 1.5rem auto; padding: 1rem; text-align: center; overflow: hidden; max-width: 100%;">
<svg width="650" height="350" xmlns="http://www.w3.org/2000/svg" style="max-width: 100%; height: auto; display: block; margin: 0 auto;" viewBox="0 0 650 350">
                    <!-- Value vs Reference Diagram -->
                    <rect x="50" y="30" width="550" height="290" fill="#f5f5f5" stroke="#333" stroke-width="2"/>
                    <text x="325" y="60" text-anchor="middle" font-size="20" font-weight="bold">Capture By Value vs. By Reference</text>

                    <!-- Capture By Value -->
                    <rect x="70" y="90" width="240" height="200" fill="#fff8e1" stroke="#ff6f00" stroke-width="2"/>
                    <text x="190" y="120" text-anchor="middle" font-weight="bold" fill="#ff6f00">Capture By Value</text>
<rect x="90" y="140" width="200" height="40" fill="#ffe0b2" stroke="#ff6f00" stroke-width="1"/>
                    <text x="190" y="165" text-anchor="middle" font-size="14">use ($counter)</text>
<path d="M190,180 L190,200" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
                    <text x="205" y="195" font-size="12">Creates a copy</text>
<rect x="140" y="210" width="100" height="60" fill="#ffe0b2" stroke="#ff6f00" stroke-width="1"/>
                    <text x="190" y="235" text-anchor="middle" font-size="14">Original</text>
                    <text x="190" y="255" text-anchor="middle" font-size="14">Unaffected</text>
                    
                    <!-- Capture By Reference -->
                    <rect x="340" y="90" width="240" height="200" fill="#e1f5fe" stroke="#0288d1" stroke-width="2"/>
                    <text x="460" y="120" text-anchor="middle" font-weight="bold" fill="#0288d1">Capture By Reference</text>
<rect x="360" y="140" width="200" height="40" fill="#b3e5fc" stroke="#0288d1" stroke-width="1"/>
                    <text x="460" y="165" text-anchor="middle" font-size="14">use (&$counter)</text>
<path d="M460,180 L460,200" stroke="#333" stroke-width="2" marker-end="url(#arrow)"/>
                    <text x="520" y="195" font-size="12">References original</text>
<rect x="410" y="210" width="100" height="60" fill="#b3e5fc" stroke="#0288d1" stroke-width="1"/>
                    <text x="460" y="235" text-anchor="middle" font-size="14">Changes affect</text>
                    <text x="460" y="255" text-anchor="middle" font-size="14">original variable</text>
                    
                    <!-- Arrow definition -->
                    <defs>
                        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                            <path d="M0,0 L0,6 L9,3 z" fill="#333" />
                        </marker>
                    </defs>
                </svg>
</div>
            
            <div class="example-box">
                <h3>Capture By Value (Default)</h3>
                <pre><code>$counter = 0;

$incrementByValue = function() use ($counter) {
    $counter++;
    return $counter;
};

echo $incrementByValue(); // Outputs: 1
echo $incrementByValue(); // Outputs: 1 (still 1, not 2)
echo $counter;           // Outputs: 0 (original unchanged)</code></pre>
            </div>

            <div class="example-box">
                <h3>Capture By Reference</h3>
                <pre><code>$counter = 0;

$incrementByReference = function() use (&$counter) {
    $counter++;
    return $counter;
};

echo $incrementByReference(); // Outputs: 1
echo $incrementByReference(); // Outputs: 2
echo $counter;               // Outputs: 2 (original was modified)</code></pre>
            </div>

            <p>The ampersand (&) before the variable name in the <code>use</code> statement is the key difference. It tells PHP to capture a reference to the original variable rather than making a copy.</p>
        </section>

        <section class="use-cases">
            <h2>Common Use Cases for Anonymous Functions</h2>

<div class="mermaid-converted" style="margin: 1.5rem auto 0; padding: 1rem; text-align: center; overflow: visible; max-width: 100%; min-height: auto;">
<div style="margin-bottom: 10px; font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 1px;">Diagram
</div>
    <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" 
     style="max-width: 100%; height: auto; display: block; margin: 0 auto; background: white; border-radius: 8px;; max-width: 100%; height: auto; display: block; margin: 0 auto;">
    <!-- Embedded styles for this diagram only -->
    <defs>
        <style type="text/css">
            .node-rect { fill: #e1f5fe; stroke: #01579b; stroke-width: 2px; }
            .node-rect:hover { fill: #b3e5fc; }
            .node-text { fill: #01579b; font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; font-weight: 500; }
            .connection-line { stroke: #546e7a; stroke-width: 2px; fill: none; }
            .arrow-marker { fill: #546e7a; }
            .diagram-title { fill: #263238; font-size: 18px; font-weight: bold; }
            .subgraph-rect { fill: #fff3e0; stroke: #e65100; stroke-width: 1px; stroke-dasharray: 5,5; opacity: 0.3; }
        </style>
        
        <!-- Arrow marker -->
        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L0,6 L9,3 z" class="arrow-marker"/>
        </marker>
    </defs>
    
    <!-- Background -->
    <rect x="0" y="0" width="800" height="600" fill="#fafafa" rx="8"/>
    
    <line x1="283.33333333333337" y1="80" x2="190.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="283.33333333333337" y1="80" x2="330.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="283.33333333333337" y1="80" x2="470.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="283.33333333333337" y1="80" x2="610.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="283.33333333333337" y1="80" x2="330.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <text x="306.6666666666667" y="135.0" text-anchor="middle" 
          class="node-text" font-size="12">&gt; C[Array Operations] A </text>
    <line x1="283.33333333333337" y1="80" x2="610.0" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <text x="446.6666666666667" y="135.0" text-anchor="middle" 
          class="node-text" font-size="12">&gt; E[Custom Sorters] A </text>
    <rect x="161.33333333333337" y="55" width="244" height="50" 
          rx="5" class="node-rect"/>
    <text x="283.33333333333337" y="80" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Anonymous FunctionsUse Cases</text>
    <rect x="456.66666666666674" y="55" width="120" height="50" 
          rx="5" class="node-rect"/>
    <text x="516.6666666666667" y="80" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Callbacks</text>
    <rect x="116.0" y="175" width="148" height="50" 
          rx="5" class="node-rect"/>
    <text x="190.0" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Array Operations</text>
    <rect x="264.0" y="175" width="132" height="50" 
          rx="5" class="node-rect"/>
    <text x="330.0" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Event Handlers</text>
    <rect x="404.0" y="175" width="132" height="50" 
          rx="5" class="node-rect"/>
    <text x="470.0" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Custom Sorters</text>
    <rect x="528.0" y="175" width="164" height="50" 
          rx="5" class="node-rect"/>
    <text x="610.0" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">One-Time Functions</text>
</svg>
</div><div class="use-case-examples">
                <h3>Array Operations with Anonymous Functions</h3>
                <pre><code>$posts = [
    ['title' => 'Getting Started with WordPress', 'comments' => 5, 'status' => 'publish'],
    ['title' => 'Advanced Theme Development', 'comments' => 12, 'status' => 'draft'],
    ['title' => 'Optimizing WordPress Performance', 'comments' => 8, 'status' => 'publish'],
    ['title' => 'WordPress Security Best Practices', 'comments' => 20, 'status' => 'publish']
];

// Filter published posts using array_filter
$publishedPosts = array_filter($posts, function($post) {
    return $post['status'] === 'publish';
});

// Sort posts by comment count using usort
usort($publishedPosts, function($a, $b) {
    return $b['comments'] - $a['comments']; // Sort in descending order
});

// Extract just the titles using array_map
$titles = array_map(function($post) {
    return $post['title'];
}, $publishedPosts);

// Display results
foreach ($titles as $title) {
    echo $title . "<br>";
}

// Outputs:
// WordPress Security Best Practices
// Optimizing WordPress Performance
// Getting Started with WordPress</code></pre>
            </div>

            <div class="use-case-examples">
                <h3>Custom Sorting with Anonymous Functions</h3>
                <pre><code>$users = [
    ['name' => 'John', 'role' => 'editor', 'last_active' => '2025-01-15'],
    ['name' => 'Sarah', 'role' => 'administrator', 'last_active' => '2025-04-20'],
    ['name' => 'Mike', 'role' => 'subscriber', 'last_active' => '2025-03-10'],
    ['name' => 'Lisa', 'role' => 'editor', 'last_active' => '2025-02-28']
];

// Custom sort function that prioritizes role and then last_active date
usort($users, function($a, $b) {
    // Define role priority (higher number = higher priority)
    $rolePriority = [
        'administrator' => 3,
        'editor' => 2,
        'author' => 1,
        'subscriber' => 0
    ];
    
    // Compare roles first
    $roleComparison = $rolePriority[$b['role']] - $rolePriority[$a['role']];
    
    // If roles are the same, compare by last active date
    if ($roleComparison === 0) {
        return strtotime($b['last_active']) - strtotime($a['last_active']);
    }
    
    return $roleComparison;
});

// Display sorted users
foreach ($users as $user) {
    echo "{$user['name']} ({$user['role']}) - Last active: {$user['last_active']}<br>";
}

// Outputs:
// Sarah (administrator) - Last active: 2025-04-20
// Lisa (editor) - Last active: 2025-02-28
// John (editor) - Last active: 2025-01-15
// Mike (subscriber) - Last active: 2025-03-10</code></pre>
            </div>
        </section>

        <section class="wordpress-hook-examples">
            <h2>Anonymous Functions with WordPress Hooks</h2>
            
            <p>WordPress's hook system (actions and filters) is one of the most powerful places to use anonymous functions. They allow you to hook into WordPress without creating named functions that might conflict with other code.</p>
            
            <div class="example-box">
                <h3>WordPress Action Hooks with Anonymous Functions</h3>
                <pre><code>// Add custom admin footer text using an anonymous function
add_action('admin_footer_text', function() {
    echo 'Thank you for creating with <a href="https://wordpress.org/">WordPress</a> | ';
    echo 'Theme by: Your Name';
});

// Add custom CSS to the head section of your site
add_action('wp_head', function() {
    ?>
    &lt;style&gt;
        .site-header {
            background-color: #2c3e50;
            color: white;
        }
        .entry-title {
            color: #3498db;
        }
    &lt;/style&gt;
    <?php
});

// Add script to footer but only on the front page
add_action('wp_footer', function() {
    if (is_front_page()) {
        ?>
        &lt;script&gt;
            document.addEventListener('DOMContentLoaded', function() {
                console.log('Front page loaded!');
            });
        &lt;/script&gt;
        <?php
    }
});</code></pre>
            </div>

            <div class="example-box">
                <h3>WordPress Filter Hooks with Anonymous Functions</h3>
                <pre><code>// Modify post content with an anonymous function
add_filter('the_content', function($content) {
    // Only modify single post content
    if (is_single() && !is_admin()) {
        // Add a "Thanks for reading" message at the end
        $content .= '&lt;div class="thank-you-message"&gt;';
        $content .= '&lt;p&gt;Thanks for reading! If you enjoyed this post, please share it.&lt;/p&gt;';
        $content .= '&lt;/div&gt;';
    }
    return $content;
});

// Add custom body classes with an anonymous function
add_filter('body_class', function($classes) {
    // Add a class based on user role
    if (is_user_logged_in()) {
        $user = wp_get_current_user();
        $role = $user->roles[0];
        $classes[] = 'user-role-' . $role;
    }
    
    // Add a class for posts with no thumbnail
    if (is_single() && !has_post_thumbnail()) {
        $classes[] = 'no-featured-image';
    }
    
    return $classes;
});</code></pre>
            </div>

            <div class="example-box">
                <h3>Using Closures with WordPress Hooks</h3>
                <pre><code>// Capture site configuration in a closure
$site_config = [
    'show_breadcrumbs' => true,
    'enable_animations' => true,
    'primary_color' => '#3498db'
];

// Use the configuration in a filter hook
add_filter('the_title', function($title) use ($site_config) {
    // Only modify archive page titles
    if (is_archive() && $site_config['show_breadcrumbs']) {
        $title = '&lt;span style="color:' . $site_config['primary_color'] . '"&gt;' . $title . '&lt;/span&gt;';
    }
    return $title;
});

// Counter for tracking post views with a closure
add_action('wp_footer', function() {
    static $posts_shown = 0;
    
    // Only increment on single post views
    if (is_single()) {
        $posts_shown++;
        echo '&lt;script&gt;console.log("Post view count: ' . $posts_shown . '");&lt;/script&gt;';
    }
});</code></pre>
            </div>
            
            <p>Notice how static variables can be used inside anonymous functions attached to hooks to maintain state across multiple calls.</p>
        </section>

        <section class="function-factories">
            <h2>Function Factories: Creating Functions with Functions</h2>
            
            <p>One powerful pattern with closures is creating "function factories" - functions that generate and return other functions with specific behaviors.</p>

<div class="mermaid-converted" style="margin: 1.5rem auto 0; padding: 1rem; text-align: center; overflow: visible; max-width: 100%; min-height: auto;">
<div style="margin-bottom: 10px; font-size: 12px; color: #6c757d; text-transform: uppercase; letter-spacing: 1px;">Diagram
</div>
    <svg viewBox="0 0 800 500" xmlns="http://www.w3.org/2000/svg" 
     style="max-width: 100%; height: auto; display: block; margin: 0 auto; background: white; border-radius: 8px;; max-width: 100%; height: auto; display: block; margin: 0 auto;">
    <!-- Embedded styles for this diagram only -->
    <defs>
        <style type="text/css">
            .node-rect { fill: #e1f5fe; stroke: #01579b; stroke-width: 2px; }
            .node-rect:hover { fill: #b3e5fc; }
            .node-text { fill: #01579b; font-family: 'Segoe UI', Arial, sans-serif; font-size: 14px; font-weight: 500; }
            .connection-line { stroke: #546e7a; stroke-width: 2px; fill: none; }
            .arrow-marker { fill: #546e7a; }
            .diagram-title { fill: #263238; font-size: 18px; font-weight: bold; }
            .subgraph-rect { fill: #fff3e0; stroke: #e65100; stroke-width: 1px; stroke-dasharray: 5,5; opacity: 0.3; }
        </style>
        
        <!-- Arrow marker -->
        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L0,6 L9,3 z" class="arrow-marker"/>
        </marker>
    </defs>
    
    <!-- Background -->
    <rect x="0" y="0" width="800" height="500" fill="#fafafa" rx="8"/>
    
    <line x1="516.6666666666667" y1="80" x2="283.33333333333337" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="283.33333333333337" y1="200" x2="516.6666666666667" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="516.6666666666667" y1="200" x2="400.0" y2="320" 
          class="connection-line" marker-end="url(#arrow)"/>
    <line x1="516.6666666666667" y1="80" x2="516.6666666666667" y2="200" 
          class="connection-line" marker-end="url(#arrow)"/>
    <text x="516.6666666666667" y="135.0" text-anchor="middle" 
          class="node-text" font-size="12">&gt; C[Function WithPredefined Behavior] C </text>
    <rect x="209.33333333333337" y="55" width="148" height="50" 
          rx="5" class="node-rect"/>
    <text x="283.33333333333337" y="80" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Function Factory</text>
    <rect x="145.33333333333337" y="175" width="276" height="50" 
          rx="5" class="node-rect"/>
    <text x="283.33333333333337" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Function WithPredefined Behavior</text>
    <rect x="410.66666666666674" y="175" width="212" height="50" 
          rx="5" class="node-rect"/>
    <text x="516.6666666666667" y="200" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Return Functionto Caller</text>
    <rect x="286.0" y="295" width="228" height="50" 
          rx="5" class="node-rect"/>
    <text x="400.0" y="320" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Caller UsesCustom Function</text>
    <polygon points="516.6666666666667,55.0 614.6666666666667,80.0 516.6666666666667,105.0 418.66666666666674,80.0" class="node-rect"/>
    <text x="516.6666666666667" y="80" text-anchor="middle" dominant-baseline="middle" 
          class="node-text">Create Custom Function</text>
</svg>
</div><div class="example-box">
                <h3>Basic Function Factory Example</h3>
                <pre><code>// A function that creates custom formatter functions
function createFormatter($format) {
    return function($content) use ($format) {
        switch ($format) {
            case 'uppercase':
                return strtoupper($content);
            case 'lowercase':
                return strtolower($content);
            case 'title':
                return ucwords(strtolower($content));
            case 'slug':
                return strtolower(str_replace(' ', '-', $content));
            default:
                return $content;
        }
    };
}

// Create specific formatter functions
$uppercaseFormatter = createFormatter('uppercase');
$titleFormatter = createFormatter('title');
$slugFormatter = createFormatter('slug');

// Use the formatters
$text = "welcome to wordpress development";
echo $uppercaseFormatter($text) . "<br>"; // WELCOME TO WORDPRESS DEVELOPMENT
echo $titleFormatter($text) . "<br>";     // Welcome To Wordpress Development
echo $slugFormatter($text) . "<br>";      // welcome-to-wordpress-development</code></pre>
            </div>

            <div class="example-box">
                <h3>WordPress Function Factory for Shortcodes</h3>
                <pre><code>// Factory that creates custom button shortcode handlers
function create_button_shortcode($style) {
    // Each closure captures its own style
    $shortcode_handler = function($atts, $content = null) use ($style) {
        $attributes = shortcode_atts([
            'url' => '#',
            'target' => '_self',
            'size' => 'medium',
            'align' => 'center'
        ], $atts);
        
        $class = "btn btn-{$style} btn-{$attributes['size']}";
        $alignment = $attributes['align'] !== 'none' ? "text-{$attributes['align']}" : '';
        
        return "&lt;div class=\"{$alignment}\"&gt;".
               "&lt;a href=\"{$attributes['url']}\" target=\"{$attributes['target']}\" class=\"{$class}\"&gt;".
               $content .
               "&lt;/a&gt;&lt;/div&gt;";
    };
    
    return $shortcode_handler;
}

// Register multiple button shortcodes with different styles
add_shortcode('primary_button', create_button_shortcode('primary'));
add_shortcode('success_button', create_button_shortcode('success'));
add_shortcode('warning_button', create_button_shortcode('warning'));
add_shortcode('danger_button', create_button_shortcode('danger'));

// Usage in WordPress content:
// [primary_button url="https://example.com" size="large"]Click Me[/primary_button]
// [success_button url="https://example.com/signup"]Sign Up[/success_button]</code></pre>
            </div>

            <p>Function factories reduce code duplication and create highly customized functions for specific purposes, all while maintaining a clean API.</p>
        </section>

        <section class="arrow-functions">
            <h2>Arrow Functions (PHP 7.4+)</h2>
            
            <p>In PHP 7.4 and above, there's a shorter syntax for simple anonymous functions called "arrow functions" or "short closures." They're perfect for brief, single-expression functions.</p>
            
            <div class="example-box">
                <h3>Arrow Function Syntax</h3>
                <pre><code>// Traditional anonymous function
$double = function($x) {
    return $x * 2;
};

// Equivalent arrow function
$double = fn($x) => $x * 2;

// Both work the same way
echo $double(5); // Outputs: 10</code></pre>
            </div>

            <p>Arrow functions are especially useful for array operations with callback functions, making your code more concise and readable.</p>
            
            <div class="example-box">
                <h3>Arrow Functions with Array Operations</h3>
                <pre><code>$posts = [
    ['id' => 1, 'title' => 'First Post', 'comments' => 5],
    ['id' => 2, 'title' => 'Second Post', 'comments' => 3],
    ['id' => 3, 'title' => 'Third Post', 'comments' => 8]
];

// Traditional anonymous functions
$titles = array_map(function($post) {
    return $post['title'];
}, $posts);

// With arrow functions
$titles = array_map(fn($post) => $post['title'], $posts);

// Filter posts with more than 5 comments
$popularPosts = array_filter($posts, fn($post) => $post['comments'] > 5);

// Calculate total comments with array_reduce
$totalComments = array_reduce($posts, fn($carry, $post) => $carry + $post['comments'], 0);

echo "Total comments: $totalComments"; // Outputs: Total comments: 16</code></pre>
            </div>

            <div class="note-box">
                <h3>Important Notes About Arrow Functions</h3>
                <ul>
                    <li>Arrow functions automatically capture variables from the parent scope without needing <code>use</code></li>
                    <li>They can only contain a single expression (no multi-line function bodies)</li>
                    <li>They implicitly return the value of the expression</li>
                    <li>All captures are by-value unless you explicitly use references in the parent scope</li>
                    <li>They're only available in PHP 7.4 and above</li>
                </ul>
            </div>
        </section>

        <section class="wordpress-practical">
            <h2>Practical WordPress Development Examples</h2>
            
            <div class="example-box">
                <h3>Custom Walker with Anonymous Function</h3>
                <pre><code>// Display a custom menu with specific styling using anonymous functions
function display_custom_menu($menu_location) {
    // Check if menu exists
    if (!has_nav_menu($menu_location)) {
        return;
    }
    
    // Custom walker using anonymous classes and functions
    $custom_walker = new class extends Walker_Nav_Menu {
        public function start_el(&$output, $item, $depth = 0, $args = null, $id = 0) {
            // Create a processor based on depth
            $processor = function($item, $depth) {
                $classes = empty($item->classes) ? [] : (array) $item->classes;
                
                // Add depth-specific classes
                $classes[] = 'menu-item-depth-' . $depth;
                
                // Add active class if needed
                if (in_array('current-menu-item', $classes)) {
                    $classes[] = 'active';
                }
                
                // Filter the classes
                $class_names = implode(' ', apply_filters('nav_menu_css_class', array_filter($classes), $item, $args, $depth));
                $class_names = $class_names ? ' class="' . esc-attr($class_names) . '"' : '';
                
                // Generate ID
                $id = apply_filters('nav_menu_item_id', 'menu-item-' . $item->ID, $item, $args, $depth);
                $id = $id ? ' id="' . esc_attr($id) . '"' : '';
                
                // Return the formatted list item start
                return "&lt;li{$id}{$class_names}&gt;";
            };
            
            // Add the item to output
            $output .= $processor($item, $depth);
            
            // Add the link
            $attributes = '';
            foreach (['title', 'target', 'rel', 'href', 'class'] as $attr) {
                if (!empty($item->$attr)) {
                    $attributes .= ' ' . $attr . '="' . esc_attr($item->$attr) . '"';
                }
            }
            
            $title = apply_filters('the_title', $item->title, $item->ID);
            $item_output = $args->before;
            $item_output .= "&lt;a{$attributes}&gt;";
            $item_output .= $args->link_before . $title . $args->link_after;
            $item_output .= '&lt;/a&gt;';
            $item_output .= $args->after;
            
            $output .= apply_filters('walker_nav_menu_start_el', $item_output, $item, $depth, $args);
        }
    };
    
    // Display the menu
    wp_nav_menu([
        'theme_location' => $menu_location,
        'container' => 'nav',
        'container_class' => 'custom-menu-container',
        'menu_class' => 'custom-menu',
        'walker' => $custom_walker
    ]);
}</code></pre>
            </div>

            <div class="example-box">
                <h3>WordPress Plugin with Callback Registry</h3>
                <pre><code>/**
 * Simple Callback Registry for a Hypothetical Plugin
 */
class MyPlugin_Callback_Registry {
    private $callbacks = [];
    
    /**
     * Register a callback for a specific event
     */
    public function register($event, $callback) {
        if (!isset($this->callbacks[$event])) {
            $this->callbacks[$event] = [];
        }
        
        $this->callbacks[$event][] = $callback;
        return $this;
    }
    
    /**
     * Execute all callbacks for an event
     */
    public function execute($event, $data = null) {
        if (!isset($this->callbacks[$event])) {
            return $data;
        }
        
        $result = $data;
        
        foreach ($this->callbacks[$event] as $callback) {
            $result = $callback($result);
        }
        
        return $result;
    }
}

// Usage example
$registry = new MyPlugin_Callback_Registry();

// Register formatters for different content types
$registry->register('format_title', function($title) {
    return strtoupper($title);
});

$registry->register('format_content', function($content) {
    return '&lt;div class="formatted-content"&gt;' . $content . '&lt;/div&gt;';
});

// Register multiple transformations for a single event type
$registry->register('transform_data', function($data) {
    // Add timestamp
    $data['timestamp'] = time();
    return $data;
});

$registry->register('transform_data', function($data) {
    // Add process ID
    $data['process_id'] = uniqid();
    return $data;
});

// Execute the callbacks
$title = $registry->execute('format_title', 'Welcome to WordPress');
$content = $registry->execute('format_content', 'This is some sample content.');
$data = $registry->execute('transform_data', ['source' => 'user_input']);

echo $title . '<br>';  // Outputs: WELCOME TO WORDPRESS
echo $content . '<br>'; // Outputs: <div class="formatted-content">This is some sample content.</div>
print_r($data);         // Outputs: Array with source, timestamp, and process_id keys</code></pre>
            </div>
        </section>

        <section class="anonymous-vs-named">
            <h2>When to Use Anonymous vs. Named Functions</h2>
            
            <div class="comparison-table">
                <h3>Anonymous Functions vs. Named Functions</h3>
                <table>
                    <tr>
                        <th>Use Anonymous Functions When</th>
                        <th>Use Named Functions When</th>
                    </tr>
                    <tr>
                        <td>The function is only used once</td>
                        <td>The function needs to be used in multiple places</td>
                    </tr>
                    <tr>
                        <td>The function is simple and short</td>
                        <td>The function is complex or long</td>
                    </tr>
                    <tr>
                        <td>You need to capture variables from the parent scope</td>
                        <td>The function should be completely independent</td>
                    </tr>
                    <tr>
                        <td>You're passing a callback to another function</td>
                        <td>You need to call the function recursively</td>
                    </tr>
                    <tr>
                        <td>You want to avoid polluting the global namespace</td>
                        <td>You want to make the function available globally</td>
                    </tr>
                    <tr>
                        <td>You're adding a hook or filter that's only used once</td>
                        <td>You're creating a callback that will be used by multiple hooks</td>
                    </tr>
                </table>
            </div>
            
            <div class="best-practices">
                <h3>Best Practices for Anonymous Functions</h3>
                <ul>
                    <li><strong>Keep them short and focused:</strong> If your anonymous function exceeds 10-15 lines, consider making it a named function instead</li>
                    <li><strong>Use meaningful variable names:</strong> Since anonymous functions lack descriptive names, use clear variable names when assigning them</li>
                    <li><strong>Comment complex logic:</strong> Add comments to explain what your anonymous function does, especially if it contains complex logic</li>
                    <li><strong>Be mindful of memory:</strong> Closures that capture many variables can increase memory usage</li>
                    <li><strong>Use arrow functions (PHP 7.4+):</strong> For simple operations, prefer the shorter arrow function syntax</li>
                    <li><strong>Consider readability:</strong> Sometimes a named function is more readable than an anonymous one, even if used only once</li>
                </ul>
            </div>
        </section>

        <section class="advanced-closures">
            <h2>Advanced Closure Techniques</h2>
            
            <div class="example-box">
                <h3>Self-Executing Anonymous Functions</h3>
                <pre><code>// Basic self-executing anonymous function
(function() {
    echo "This runs immediately!";
})();

// Useful for creating isolated scopes
(function() {
    // Variables defined here won't affect the global scope
    $localVar = "I'm local to this function";
    echo $localVar;
})();

// Passing parameters to self-executing functions
(function($name) {
    echo "Hello, $name!";
})("WordPress Developer");

// Practical WordPress example: One-time setup code
add_action('init', function() {
    // This runs once during WordPress initialization
    (function() {
        // Register a custom post type
        register_post_type('portfolio', [
            'labels' => [
                'name' => 'Portfolio Items',
                'singular_name' => 'Portfolio Item'
            ],
            'public' => true,
            'has_archive' => true,
            'supports' => ['title', 'editor', 'thumbnail']
        ]);
        
        // Register a taxonomy
        register_taxonomy('portfolio_category', 'portfolio', [
            'labels' => [
                'name' => 'Categories',
                'singular_name' => 'Category'
            ],
            'hierarchical' => true,
            'show_admin_column' => true
        ]);
    })();
});</code></pre>
            </div>

            <div class="example-box">
                <h3>Recursive Anonymous Functions with Static Variables</h3>
                <pre><code>// Create a recursive function to process nested menu items
$process_menu = function($items, $parent_id = 0) use (&$process_menu) {
    $output = '';
    
    foreach ($items as $item) {
        if ($item['parent_id'] == $parent_id) {
            $output .= '&lt;li&gt;';
            $output .= $item['title'];
            
            // Look for children
            $children = '';
            $children = $process_menu($items, $item['id']);
            
            if ($children) {
                $output .= '&lt;ul&gt;' . $children . '&lt;/ul&gt;';
            }
            
            $output .= '&lt;/li&gt;';
        }
    }
    
    return $output;
};

// Sample menu items
$menu_items = [
    ['id' => 1, 'title' => 'Home', 'parent_id' => 0],
    ['id' => 2, 'title' => 'About', 'parent_id' => 0],
    ['id' => 3, 'title' => 'Services', 'parent_id' => 0],
    ['id' => 4, 'title' => 'Web Design', 'parent_id' => 3],
    ['id' => 5, 'title' => 'WordPress Development', 'parent_id' => 3],
    ['id' => 6, 'title' => 'Team', 'parent_id' => 2],
    ['id' => 7, 'title' => 'History', 'parent_id' => 2]
];

// Generate menu HTML
$menu_html = '&lt;ul&gt;' . $process_menu($menu_items) . '&lt;/ul&gt;';
echo $menu_html;</code></pre>
            </div>
            
            <p>Note the <code>use (&$process_menu)</code> statement which allows the function to reference itself for recursion.</p>
        </section>

        <section class="debugging-closures">
            <h2>Debugging Anonymous Functions and Closures</h2>
            
            <p>Anonymous functions can sometimes be tricky to debug because they don't have names that appear in stack traces. Here are some strategies for effective debugging.</p>
            
            <div class="debugging-tips">
                <h3>Debugging Tips</h3>
                <ul>
                    <li><strong>Use descriptive variable names:</strong> Name the variables holding your anonymous functions descriptively</li>
                    <li><strong>Add internal logging:</strong> Include error logging or debug output inside your functions</li>
                    <li><strong>Test closures in isolation:</strong> Before using a closure in a complex context, test it separately</li>
                    <li><strong>Check captured variables:</strong> Verify that closures are capturing the variables you expect</li>
                    <li><strong>Wrap in try/catch blocks:</strong> Catch and log errors that occur inside anonymous functions</li>
                </ul>
            </div>
            
            <div class="example-box">
                <h3>Debugging Closure Example</h3>
                <pre><code>// A problematic closure
$process_data = function($data) use ($config) {
    try {
        // Add debug logging
        error_log('Processing data with config: ' . print_r($config, true));
        
        // Check if required variables are set
        if (!isset($config['processor']) || !isset($data['input'])) {
            error_log('Missing required variables in closure');
            return false;
        }
        
        // Process the data
        $result = $config['processor']($data['input']);
        
        // Verify result
        error_log('Result: ' . print_r($result, true));
        
        return $result;
    } catch (Exception $e) {
        // Catch and log errors
        error_log('Error in process_data closure: ' . $e->getMessage());
        return false;
    }
};

// When adding to WordPress hooks, wrap with identifiable try/catch
add_filter('the_content', function($content) use ($my_plugin_settings) {
    try {
        // Your processing code here
        return $processed_content;
    } catch (Exception $e) {
        error_log('Error in my_plugin content filter: ' . $e->getMessage());
        return $content; // Return original content on error
    }
});</code></pre>
            </div>
        </section>

        <section class="practice-exercises">
            <h2>Practice Exercises</h2>
            
            <div class="exercise">
                <h3>Exercise 1: Array Transformation</h3>
                <p>Create a function that takes an array of post objects and a formatter function as parameters. The function should apply the formatter to each post's title and return a new array with the formatted titles.</p>
                <p>Then create several different formatter anonymous functions (uppercase, lowercase, with prefix, etc.) and test them with your function.</p>
            </div>
            
            <div class="exercise">
                <h3>Exercise 2: WordPress Hook Callbacks</h3>
                <p>Write at least three different anonymous functions for WordPress hooks:</p>
                <ul>
                    <li>A filter for <code>the_title</code> that adds the post ID in parentheses but only on archive pages</li>
                    <li>An action for <code>wp_footer</code> that adds a "Back to Top" button only on long pages</li>
                    <li>A filter for <code>body_class</code> that adds classes based on the time of day (morning, afternoon, evening)</li>
                </ul>
            </div>
            
            <div class="exercise">
                <h3>Exercise 3: Function Factory</h3>
                <p>Create a function factory that generates different text formatter functions based on a configuration array. The factory should support at least:</p>
                <ul>
                    <li>Text case transformations (upper, lower, title case)</li>
                    <li>Text wrapping (with HTML tags or other delimiters)</li>
                    <li>Text truncation (limiting to a specified number of words)</li>
                </ul>
                <p>Then use your factory to create specialized formatters for different parts of a WordPress site (headings, excerpts, footers, etc.).</p>
            </div>
        </section>

        <section class="further-reading">
            <h2>Further Reading</h2>
            
            <ul>
                <li><a href="https://www.php.net/manual/en/functions.anonymous.php">PHP Manual: Anonymous Functions</a></li>
                <li><a href="https://www.php.net/manual/en/functions.arrow.php">PHP Manual: Arrow Functions</a></li>
                <li><a href="https://developer.wordpress.org/reference/functions/add_filter/">WordPress Function Reference: add_filter()</a></li>
                <li><a href="https://developer.wordpress.org/plugins/hooks/callbacks/">WordPress Developer Handbook: Callback Functions</a></li>
            </ul>
        </section>

        <section class="next-topics">
            <h2>Coming Up Next</h2>
            
            <p>In our next lecture, we'll explore built-in PHP functions - the extensive collection of pre-defined functions that PHP provides to help you with common tasks.</p>
            
            <div class="preview-topics">
                <ul>
                    <li>Overview of PHP's function libraries</li>
                    <li>String manipulation functions</li>
                    <li>Array and data handling functions</li>
                    <li>File system functions</li>
                    <li>Date and time functions</li>
                    <li>How to use the PHP documentation</li>
                </ul>
            </div>
        </section>
            
<div class="lesson-navigation">
<a class="lesson-nav-button prev" href="/module2.html">
<svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20" style="max-width: 100%; height: auto; display: block; margin: 0 auto;" viewBox="0 0 20 20">
<path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"></path>
</svg>
<span>
<small>Back to</small><br/>
                                    Module 2 Overview
                                </span>
</a>
<button class="complete-lesson-btn">
                                Mark as Complete
                            </button>
<a class="lesson-nav-button next" href="/module3.html">
<span>
<small>Next Module</small><br/>
                                    Module 3: MySQL Database
                                </span>
<svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20" style="max-width: 100%; height: auto; display: block; margin: 0 auto;" viewBox="0 0 20 20">
<path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"></path>
</svg>
</a>
</div>
</article>
</div>
</div>
</main>
<!-- Footer -->
<footer class="site-footer" role="contentinfo">
<div class="footer-container">
<div class="footer-content">
<div class="footer-section footer-about">
<h3>PHP WordPress Development</h3>
<p>Complete Web Development Course</p>
</div>
<div class="footer-section">
<h4>Quick Links</h4>
<ul class="footer-links">
<li><a href="/">Home</a></li>
<li><a href="/module2.html">Module 2</a></li>
<li><a href="/resources.html">Resources</a></li>
</ul>
</div>
<div class="footer-section">
<h4>Support</h4>
<ul class="footer-links">
<li><a href="/help.html">Help Center</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/contact.html">Contact</a></li>
</ul>
</div>
</div>
<div class="footer-bottom">
<div class="footer-bottom-content">
<p class="copyright">© 2025 PHP WordPress Development Course</p>
<nav class="footer-bottom-links">
<a href="/privacy.html">Privacy</a>
<span class="separator">|</span>
<a href="/terms.html">Terms</a>
</nav>
</div>
</div>
</div>
</footer>
</div>
<!-- Back to Top -->
<button aria-label="Back to top" class="back-to-top" id="back-to-top">
<svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24" style="max-width: 100%; height: auto; display: block; margin: 0 auto;" viewBox="0 0 2 24">
<path d="M12 19V5M12 5l-7 7M12 5l7 7"></path>
</svg>
</button>
<!-- JavaScript -->
<script src="/assets/js/navigation.js"></script>
<script src="/assets/js/site-config.js"></script>
<script src="/assets/js/sidebar-toggle.js"></script>
</body>
</html>