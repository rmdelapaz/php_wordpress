<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creating a Library of Custom Functions for Common Tasks</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="icon" href="/favicon.png">
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <header>
        <h1>Creating a Library of Custom Functions for Common Tasks</h1>
        <p><a href="index.html">← Back to Course Index</a></p>
    </header>
    
    <main>
        <section class="intro">
            <h2>Understanding the Challenge</h2>
            <p>Welcome to this practical session on creating your own function library! As web developers, we often find ourselves writing the same code over and over for common tasks like data validation, formatting, and manipulation. Building a personal function library is like creating your own toolbox that you can carry from project to project, saving time and ensuring consistency.</p>

            <div class="objectives">
                <h3>What We'll Accomplish</h3>
                <p>By the end of this session, you'll have:</p>
                <ul>
                    <li>Created a well-organized PHP function library for common web development tasks</li>
                    <li>Implemented functions for string manipulation, data validation, array processing, and more</li>
                    <li>Learned how to organize, document, and use custom functions effectively</li>
                    <li>Understood how to apply George Polya's problem-solving method to function development</li>
                </ul>
            </div>
        </section>

        <section class="problem-solving">
            <h2>George Polya's 4-Step Problem Solving Method</h2>
            
            <div class="mermaid-diagram">
                <div class="mermaid">
                    graph TD
                    A[1. Understand the Problem] --> B[2. Devise a Plan]
                    B --> C[3. Execute the Plan]
                    C --> D[4. Look Back / Reflect]
                    D -->|Improve| B
                    
                    style A fill:#f9f,stroke:#333,stroke-width:2px
                    style B fill:#bbf,stroke:#333,stroke-width:2px
                    style C fill:#bfb,stroke:#333,stroke-width:2px
                    style D fill:#fbb,stroke:#333,stroke-width:2px
                </div>
            </div>
            
            <p>We'll apply this proven four-step method to our function library development:</p>
            
            <div class="step">
                <h3>Step 1: Understand the Problem</h3>
                <p>Before writing any code, we need to clearly understand what our function library should do. What common tasks do we need to perform frequently? What types of functions would save us time? What are the inputs and outputs for each function?</p>
            </div>
            
            <div class="step">
                <h3>Step 2: Devise a Plan</h3>
                <p>After understanding the requirements, we'll plan our library structure and the individual functions. We'll create a simple whiteboard plan for each function before coding.</p>
            </div>
            
            <div class="step">
                <h3>Step 3: Execute the Plan</h3>
                <p>We'll write the code for each function, following our plan and adhering to best practices like proper documentation, error handling, and consistent naming conventions.</p>
            </div>
            
            <div class="step">
                <h3>Step 4: Look Back / Reflect</h3>
                <p>After implementing the functions, we'll test them, look for improvements, and refine as needed. We might discover better algorithms, edge cases we didn't consider, or opportunities to make our functions more flexible.</p>
            </div>
        </section>

        <section class="planning">
            <h2>Planning Our Function Library</h2>
            
            <p>Let's start by identifying categories of functions we'll need in our library:</p>
            
            <div class="svg-container">
                <svg width="700" height="400" xmlns="http://www.w3.org/2000/svg">
                    <!-- Function Library Categories -->
                    <rect x="50" y="30" width="600" height="340" fill="#f5f5f5" stroke="#333" stroke-width="2"/>
                    <text x="350" y="70" text-anchor="middle" font-size="22" font-weight="bold">PHP Function Library Categories</text>
                    
                    <!-- String Functions -->
                    <rect x="80" y="100" width="250" height="120" fill="#e3f2fd" stroke="#0d47a1" stroke-width="2" rx="10" ry="10"/>
                    <text x="205" y="125" text-anchor="middle" font-weight="bold" fill="#0d47a1">String Functions</text>
                    <text x="205" y="155" text-anchor="middle">- Text formatting</text>
                    <text x="205" y="180" text-anchor="middle">- String validation</text>
                    <text x="205" y="205" text-anchor="middle">- Text transformation</text>
                    
                    <!-- Validation Functions -->
                    <rect x="370" y="100" width="250" height="120" fill="#e8f5e9" stroke="#1b5e20" stroke-width="2" rx="10" ry="10"/>
                    <text x="495" y="125" text-anchor="middle" font-weight="bold" fill="#1b5e20">Validation Functions</text>
                    <text x="495" y="155" text-anchor="middle">- Form input validation</text>
                    <text x="495" y="180" text-anchor="middle">- Data type checking</text>
                    <text x="495" y="205" text-anchor="middle">- Security validation</text>
                    
                    <!-- Array Functions -->
                    <rect x="80" y="240" width="250" height="120" fill="#fff8e1" stroke="#ff6f00" stroke-width="2" rx="10" ry="10"/>
                    <text x="205" y="265" text-anchor="middle" font-weight="bold" fill="#ff6f00">Array Functions</text>
                    <text x="205" y="295" text-anchor="middle">- Array manipulation</text>
                    <text x="205" y="320" text-anchor="middle">- Data extraction</text>
                    <text x="205" y="345" text-anchor="middle">- Array formatting</text>
                    
                    <!-- Utility Functions -->
                    <rect x="370" y="240" width="250" height="120" fill="#f3e5f5" stroke="#6a1b9a" stroke-width="2" rx="10" ry="10"/>
                    <text x="495" y="265" text-anchor="middle" font-weight="bold" fill="#6a1b9a">Utility Functions</text>
                    <text x="495" y="295" text-anchor="middle">- Date formatting</text>
                    <text x="495" y="320" text-anchor="middle">- URL processing</text>
                    <text x="495" y="345" text-anchor="middle">- File handling</text>
                </svg>
            </div>
            
            <p>Now, let's plan the structure of our function library file:</p>
            
            <div class="code-example">
                <h3>File Structure: <code>functions_library.php</code></h3>
                <pre><code>/**
 * Custom PHP Function Library
 * 
 * A collection of useful functions for common web development tasks
 * 
 * @author Your Name
 * @version 1.0
 */

// ===== String Functions =====

/**
 * Function documentation goes here
 */
function string_function_1() {
    // Implementation
}

// More string functions...

// ===== Validation Functions =====

// Functions for data validation...

// ===== Array Functions =====

// Functions for array manipulation...

// ===== Utility Functions =====

// Utility functions like date formatting, URL processing...</code></pre>
            </div>
        </section>

        <section class="string-functions">
            <h2>Implementing String Functions</h2>
            
            <p>Let's start by building some useful string manipulation functions. First, we'll create a function for generating URL-friendly slugs from titles.</p>
            
            <div class="function-development">
                <h3>Function: <code>create_slug</code></h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p><strong>Purpose:</strong> Convert a title string into a URL-friendly slug</p>
                    <p><strong>Input:</strong> A string (title)</p>
                    <p><strong>Output:</strong> A lowercase string with spaces replaced by hyphens and special characters removed</p>
                    <p><strong>Example:</strong> "Hello World!" → "hello-world"</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <ol>
                        <li>Convert the string to lowercase</li>
                        <li>Remove any special characters and accents</li>
                        <li>Replace spaces with hyphens</li>
                        <li>Remove any consecutive hyphens</li>
                        <li>Trim hyphens from the beginning and end</li>
                        <li>Return the cleaned slug</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Execute the Plan</h4>
                    <pre><code>/**
 * Creates a URL-friendly slug from a string
 * 
 * @param string $string The string to convert to a slug
 * @return string The formatted slug
 */
function create_slug($string) {
    // Convert to lowercase
    $slug = strtolower($string);
    
    // Remove accents/diacritics
    $slug = iconv('UTF-8', 'ASCII//TRANSLIT', $slug);
    
    // Remove anything that isn't a letter, number, hyphen or space
    $slug = preg_replace('/[^a-z0-9\s-]/', '', $slug);
    
    // Replace spaces with hyphens
    $slug = preg_replace('/\s+/', '-', $slug);
    
    // Remove consecutive hyphens
    $slug = preg_replace('/-+/', '-', $slug);
    
    // Trim hyphens from beginning and end
    $slug = trim($slug, '-');
    
    return $slug;
}

// Test the function
echo create_slug("Hello World!"); // Output: hello-world
echo create_slug("PHP & WordPress Development"); // Output: php-wordpress-development</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Look Back / Reflect</h4>
                    <p>Our function handles basic slug creation well, but there might be some improvements we could make:</p>
                    <ul>
                        <li>Add an optional parameter to customize the separator (e.g., underscore instead of hyphen)</li>
                        <li>Add handling for languages with special characters</li>
                        <li>Consider maximum length for SEO purposes</li>
                    </ul>
                    
                    <p>Let's implement an improved version:</p>
                    
                    <pre><code>/**
 * Creates a URL-friendly slug from a string with additional options
 * 
 * @param string $string The string to convert to a slug
 * @param string $separator The character to use as word separator (default: '-')
 * @param int $max_length Maximum length of the resulting slug (default: 100)
 * @return string The formatted slug
 */
function create_slug($string, $separator = '-', $max_length = 100) {
    // Convert to lowercase
    $slug = strtolower($string);
    
    // Remove accents/diacritics
    $slug = iconv('UTF-8', 'ASCII//TRANSLIT', $slug);
    
    // Remove anything that isn't a letter, number or separator character
    $slug = preg_replace('/[^a-z0-9\s' . preg_quote($separator) . ']/', '', $slug);
    
    // Replace spaces with the separator
    $slug = preg_replace('/\s+/', $separator, $slug);
    
    // Remove consecutive separators
    $slug = preg_replace('/' . preg_quote($separator) . '+/', $separator, $slug);
    
    // Trim separators from beginning and end
    $slug = trim($slug, $separator);
    
    // Truncate to maximum length if needed
    if (strlen($slug) > $max_length) {
        // Cut at the maximum length
        $slug = substr($slug, 0, $max_length);
        
        // Find the last occurrence of the separator
        $last_separator = strrpos($slug, $separator);
        
        // If found, cut at the last separator to avoid cutting words in half
        if ($last_separator !== false) {
            $slug = substr($slug, 0, $last_separator);
        }
    }
    
    return $slug;
}

// Test the improved function
echo create_slug("Hello World!"); // Output: hello-world
echo create_slug("PHP & WordPress Development", '_'); // Output: php_wordpress_development
echo create_slug("This is a very long title that should be truncated for SEO purposes", '-', 30); // Output: this-is-a-very-long-title-that</code></pre>
                </div>
            </div>
            
            <div class="function-development">
                <h3>Function: <code>truncate_text</code></h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p><strong>Purpose:</strong> Truncate text to a specific length without cutting words in half</p>
                    <p><strong>Input:</strong> A string, maximum length, and optional ending</p>
                    <p><strong>Output:</strong> Truncated string with ending (e.g., "...")</p>
                    <p><strong>Example:</strong> "This is a long text" (max 10) → "This is a..."</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <ol>
                        <li>Check if the text is already shorter than the maximum length</li>
                        <li>If not, cut the text at the maximum length</li>
                        <li>Find the last space before the cut to avoid cutting words</li>
                        <li>Add the ending (e.g., "...")</li>
                        <li>Return the truncated text</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Execute the Plan</h4>
                    <pre><code>/**
 * Truncates text to a specified length without cutting words
 * 
 * @param string $text The text to truncate
 * @param int $max_length Maximum length of the resulting text
 * @param string $ending String to append to the truncated text (default: '...')
 * @return string The truncated text
 */
function truncate_text($text, $max_length, $ending = '...') {
    // Return original text if it's already shorter than max_length
    if (strlen($text) <= $max_length) {
        return $text;
    }
    
    // Calculate actual truncation length (considering the ending)
    $truncate_length = $max_length - strlen($ending);
    
    // Cut the text
    $truncated = substr($text, 0, $truncate_length);
    
    // Find the last space to avoid cutting words
    $last_space = strrpos($truncated, ' ');
    
    // If a space was found, cut at that position
    if ($last_space !== false) {
        $truncated = substr($truncated, 0, $last_space);
    }
    
    // Add the ending
    $truncated .= $ending;
    
    return $truncated;
}

// Test the function
$text = "This is a long sample text that needs to be truncated for display purposes.";
echo truncate_text($text, 30); // Output: This is a long sample text...
echo truncate_text($text, 20, ' [Read More]'); // Output: This is a long... [Read More]</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Look Back / Reflect</h4>
                    <p>The function works well for basic truncation needs. Some potential improvements:</p>
                    <ul>
                        <li>Add handling for HTML tags (to avoid cutting tags)</li>
                        <li>Consider word count instead of character count</li>
                        <li>Add support for preserving whole sentences</li>
                    </ul>
                    
                    <p>Let's add HTML awareness to our function:</p>
                    
                    <pre><code>/**
 * Truncates text to a specified length without cutting words or HTML tags
 * 
 * @param string $text The text to truncate (may contain HTML)
 * @param int $max_length Maximum length of the resulting text
 * @param string $ending String to append to the truncated text (default: '...')
 * @param boolean $html Set to true if text contains HTML (default: false)
 * @return string The truncated text
 */
function truncate_text($text, $max_length, $ending = '...', $html = false) {
    // Return original text if it's already shorter than max_length
    if (strlen($text) <= $max_length) {
        return $text;
    }
    
    // Handle HTML content
    if ($html) {
        // Strip HTML tags for length calculation but preserve original HTML
        $stripped_text = strip_tags($text);
        
        // If the stripped text is shorter than max_length, return original
        if (strlen($stripped_text) <= $max_length) {
            return $text;
        }
        
        // Extract text without HTML
        $visible_content = '';
        $html_content = '';
        $open_tags = [];
        $is_html = false;
        
        // Process each character to separate text from HTML
        for ($i = 0; $i < strlen($text) && strlen($visible_content) < $max_length - strlen($ending); $i++) {
            $char = $text[$i];
            
            if ($char == '<') {
                $is_html = true;
                $tag_start = $i;
            }
            
            if (!$is_html) {
                $visible_content .= $char;
            }
            
            if ($is_html) {
                $html_content .= $char;
            }
            
            if ($char == '>' && $is_html) {
                $is_html = false;
                
                // Extract tag name
                preg_match('/<\/?([a-z]+)[\s>]/i', substr($text, $tag_start, $i - $tag_start + 1), $matches);
                
                // Track open and close tags
                if (!empty($matches[1])) {
                    $tag = strtolower($matches[1]);
                    
                    // Check if it's a closing tag
                    if (substr($text, $tag_start + 1, 1) == '/') {
                        // Remove the last matching open tag
                        $pos = array_search($tag, $open_tags);
                        if ($pos !== false) {
                            unset($open_tags[$pos]);
                        }
                    } else {
                        // Check if it's a self-closing tag
                        if (substr($text, $i - 1, 1) != '/') {
                            $open_tags[] = $tag;
                        }
                    }
                }
            }
        }
        
        // Find last space in visible content
        $last_space = strrpos($visible_content, ' ');
        
        // If a space was found, cut at that position
        if ($last_space !== false) {
            $visible_content = substr($visible_content, 0, $last_space);
        }
        
        // Generate closing tags for any open tags
        $closing_tags = '';
        if (!empty($open_tags)) {
            $open_tags = array_reverse($open_tags);
            foreach ($open_tags as $tag) {
                $closing_tags .= "</{$tag}>";
            }
        }
        
        return $visible_content . $ending . $closing_tags;
    } else {
        // Non-HTML truncation (same as before)
        $truncate_length = $max_length - strlen($ending);
        $truncated = substr($text, 0, $truncate_length);
        
        $last_space = strrpos($truncated, ' ');
        if ($last_space !== false) {
            $truncated = substr($truncated, 0, $last_space);
        }
        
        return $truncated . $ending;
    }
}

// Test the function with HTML
$html_text = "This is a <strong>formatted text</strong> with <a href='#'>links</a> and other HTML elements.";
echo truncate_text($html_text, 30, '...', true);
// Output: This is a <strong>formatted...</strong></code></pre>
                </div>
            </div>
        </section>
        
        <section class="validation-functions">
            <h2>Implementing Validation Functions</h2>
            
            <p>Next, let's create some validation functions for common web form inputs.</p>
            
            <div class="function-development">
                <h3>Function: <code>validate_email</code></h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p><strong>Purpose:</strong> Validate email addresses with customizable options</p>
                    <p><strong>Input:</strong> An email address string and validation options</p>
                    <p><strong>Output:</strong> Boolean indicating if the email is valid</p>
                    <p><strong>Example:</strong> "user@example.com" → true, "invalid.email" → false</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <ol>
                        <li>Check if the email is not empty</li>
                        <li>Use PHP's built-in validation for basic format check</li>
                        <li>If required, check for specific domains (e.g., only accept business emails)</li>
                        <li>If required, check for disposable email domains</li>
                        <li>Return the validation result</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Execute the Plan</h4>
                    <pre><code>/**
 * Validates an email address with various options
 * 
 * @param string $email The email address to validate
 * @param array $options Validation options:
 *   - allowed_domains: Array of allowed domains (e.g., ['gmail.com', 'yahoo.com'])
 *   - disallow_disposable: Whether to disallow disposable email addresses (default: false)
 * @return bool True if the email is valid, false otherwise
 */
function validate_email($email, $options = []) {
    // Set default options
    $default_options = [
        'allowed_domains' => [],
        'disallow_disposable' => false
    ];
    
    // Merge with user options
    $options = array_merge($default_options, $options);
    
    // Basic validation
    if (empty($email) || !filter_var($email, FILTER_VALIDATE_EMAIL)) {
        return false;
    }
    
    // Extract domain
    $domain = substr(strrchr($email, "@"), 1);
    
    // Check allowed domains if specified
    if (!empty($options['allowed_domains'])) {
        if (!in_array($domain, $options['allowed_domains'])) {
            return false;
        }
    }
    
    // Check for disposable email domains if required
    if ($options['disallow_disposable']) {
        // List of common disposable email domains
        $disposable_domains = [
            'mailinator.com', 'guerrillamail.com', 'temp-mail.org', 
            'fakeinbox.com', 'tempmail.com', 'yopmail.com',
            'mailnesia.com', '10minutemail.com', 'trashmail.com'
            // Add more as needed
        ];
        
        if (in_array($domain, $disposable_domains)) {
            return false;
        }
    }
    
    // All checks passed
    return true;
}

// Test the function
$email1 = "user@example.com";
$email2 = "invalid.email";
$email3 = "user@gmail.com";
$email4 = "user@mailinator.com";

var_dump(validate_email($email1)); // bool(true)
var_dump(validate_email($email2)); // bool(false)

// Only allow specific domains
var_dump(validate_email($email3, [
    'allowed_domains' => ['gmail.com', 'yahoo.com']
])); // bool(true)

// Disallow disposable email addresses
var_dump(validate_email($email4, [
    'disallow_disposable' => true
])); // bool(false)</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Look Back / Reflect</h4>
                    <p>Our email validation function provides basic functionality, but there are several improvements we could make:</p>
                    <ul>
                        <li>Add more comprehensive disposable email domain list (could be loaded from a file)</li>
                        <li>Add options for maximum/minimum length checks</li>
                        <li>Add option to check if the domain's DNS records include MX entries (to verify if the domain can receive email)</li>
                        <li>Return specific error messages instead of just true/false</li>
                    </ul>
                </div>
            </div>
            
            <div class="function-development">
                <h3>Function: <code>validate_password</code></h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p><strong>Purpose:</strong> Validate passwords against customizable strength criteria</p>
                    <p><strong>Input:</strong> A password string and validation options</p>
                    <p><strong>Output:</strong> Validation result (boolean or details)</p>
                    <p><strong>Example:</strong> "Passw0rd!" with requirements for min length, uppercase, lowercase, numbers, and special chars</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <ol>
                        <li>Check minimum and maximum length requirements</li>
                        <li>Check for required character types (uppercase, lowercase, numbers, special)</li>
                        <li>If enabled, check against common password lists</li>
                        <li>Return validation result with details if requested</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Execute the Plan</h4>
                    <pre><code>/**
 * Validates a password against customizable strength criteria
 * 
 * @param string $password The password to validate
 * @param array $options Validation options:
 *   - min_length: Minimum password length (default: 8)
 *   - max_length: Maximum password length (default: 128)
 *   - require_uppercase: Require at least one uppercase letter (default: true)
 *   - require_lowercase: Require at least one lowercase letter (default: true)
 *   - require_number: Require at least one number (default: true)
 *   - require_special: Require at least one special character (default: true)
 *   - return_details: Return validation details instead of boolean (default: false)
 * @return bool|array Boolean result or array of validation details
 */
function validate_password($password, $options = []) {
    // Set default options
    $default_options = [
        'min_length' => 8,
        'max_length' => 128,
        'require_uppercase' => true,
        'require_lowercase' => true,
        'require_number' => true,
        'require_special' => true,
        'return_details' => false
    ];
    
    // Merge with user options
    $options = array_merge($default_options, $options);
    
    // Initialize validation results
    $results = [
        'valid' => true,
        'errors' => []
    ];
    
    // Check length
    if (strlen($password) < $options['min_length']) {
        $results['valid'] = false;
        $results['errors'][] = "Password must be at least {$options['min_length']} characters long";
    }
    
    if (strlen($password) > $options['max_length']) {
        $results['valid'] = false;
        $results['errors'][] = "Password cannot exceed {$options['max_length']} characters";
    }
    
    // Check for uppercase letters
    if ($options['require_uppercase'] && !preg_match('/[A-Z]/', $password)) {
        $results['valid'] = false;
        $results['errors'][] = "Password must contain at least one uppercase letter";
    }
    
    // Check for lowercase letters
    if ($options['require_lowercase'] && !preg_match('/[a-z]/', $password)) {
        $results['valid'] = false;
        $results['errors'][] = "Password must contain at least one lowercase letter";
    }
    
    // Check for numbers
    if ($options['require_number'] && !preg_match('/[0-9]/', $password)) {
        $results['valid'] = false;
        $results['errors'][] = "Password must contain at least one number";
    }
    
    // Check for special characters
    if ($options['require_special'] && !preg_match('/[^A-Za-z0-9]/', $password)) {
        $results['valid'] = false;
        $results['errors'][] = "Password must contain at least one special character";
    }
    
    // Return appropriate result format
    if ($options['return_details']) {
        return $results;
    } else {
        return $results['valid'];
    }
}

// Test the function
$password1 = "Passw0rd!";
$password2 = "weakpass";

var_dump(validate_password($password1)); // bool(true)
var_dump(validate_password($password2)); // bool(false)

// Get detailed validation results
$validation = validate_password($password2, ['return_details' => true]);
if (!$validation['valid']) {
    foreach ($validation['errors'] as $error) {
        echo $error . "<br>";
    }
}
// Output:
// Password must contain at least one uppercase letter
// Password must contain at least one number
// Password must contain at least one special character

// Custom requirements
var_dump(validate_password("Simple1", [
    'min_length' => 6,
    'require_special' => false
])); // bool(true)</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Look Back / Reflect</h4>
                    <p>The password validation function provides good customization options, but we could enhance it further:</p>
                    <ul>
                        <li>Add check for sequential characters (e.g., "123456", "abcdef")</li>
                        <li>Add check for repeated characters (e.g., "aaaaaa")</li>
                        <li>Add option to check against common password dictionaries</li>
                        <li>Add option to calculate and return password strength score</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <section class="array-functions">
            <h2>Implementing Array Functions</h2>
            
            <p>Now, let's create some useful functions for working with arrays, which are common in web development.</p>
            
            <div class="function-development">
                <h3>Function: <code>array_to_csv</code></h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p><strong>Purpose:</strong> Convert an array of data to CSV format</p>
                    <p><strong>Input:</strong> Array of data (associative or indexed) and CSV options</p>
                    <p><strong>Output:</strong> CSV string or file</p>
                    <p><strong>Example:</strong> Convert user data array to CSV for export</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <ol>
                        <li>Check if the input is an array</li>
                        <li>Determine the CSV headers (use keys from associative array or defaults)</li>
                        <li>Create a temporary file handle for CSV writing</li>
                        <li>Write headers and data rows</li>
                        <li>Return CSV string or save to file based on options</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Execute the Plan</h4>
                    <pre><code>/**
 * Converts an array to CSV format
 * 
 * @param array $data The array to convert to CSV
 * @param array $options CSV generation options:
 *   - headers: Array of column headers (default: keys from first row)
 *   - delimiter: CSV delimiter character (default: ',')
 *   - enclosure: CSV enclosure character (default: '"')
 *   - file_path: Path to save CSV file (default: null = return as string)
 * @return string|bool CSV string or true if saved to file
 */
function array_to_csv($data, $options = []) {
    // Check if data is an array
    if (!is_array($data) || empty($data)) {
        return false;
    }
    
    // Set default options
    $default_options = [
        'headers' => [],
        'delimiter' => ',',
        'enclosure' => '"',
        'file_path' => null
    ];
    
    // Merge with user options
    $options = array_merge($default_options, $options);
    
    // Get the first row to extract headers if not provided
    $first_row = reset($data);
    
    // If headers not specified, use keys from the first row
    if (empty($options['headers']) && is_array($first_row)) {
        // For associative arrays, use the keys as headers
        if (array_keys($first_row) !== range(0, count($first_row) - 1)) {
            $options['headers'] = array_keys($first_row);
        }
    }
    
    // Create a temporary file handle for CSV writing
    $output = fopen('php://temp', 'r+');
    
    // Write headers if available
    if (!empty($options['headers'])) {
        fputcsv($output, $options['headers'], $options['delimiter'], $options['enclosure']);
    }
    
    // Write data rows
    foreach ($data as $row) {
        // If row is an associative array and headers are provided,
        // ensure values are in the same order as headers
        if (!empty($options['headers']) && is_array($row) && 
            array_keys($row) !== range(0, count($row) - 1)) {
            
            $ordered_row = [];
            foreach ($options['headers'] as $header) {
                $ordered_row[] = isset($row[$header]) ? $row[$header] : '';
            }
            fputcsv($output, $ordered_row, $options['delimiter'], $options['enclosure']);
        } else {
            // For non-associative arrays or when headers aren't specified
            fputcsv($output, (array) $row, $options['delimiter'], $options['enclosure']);
        }
    }
    
    // Get the CSV content
    rewind($output);
    $csv = stream_get_contents($output);
    fclose($output);
    
    // Save to file if a path is provided
    if (!empty($options['file_path'])) {
        if (file_put_contents($options['file_path'], $csv) !== false) {
            return true;
        }
        return false;
    }
    
    // Return CSV as a string
    return $csv;
}

// Test the function with associative array
$users = [
    ['id' => 1, 'name' => 'John Doe', 'email' => 'john@example.com'],
    ['id' => 2, 'name' => 'Jane Smith', 'email' => 'jane@example.com'],
    ['id' => 3, 'name' => 'Bob Johnson', 'email' => 'bob@example.com']
];

// Get CSV as string
$csv = array_to_csv($users);
echo "<pre>" . htmlspecialchars($csv) . "</pre>";

// Save to file with custom options
array_to_csv($users, [
    'headers' => ['id', 'name', 'email', 'status'], // Add extra header
    'delimiter' => ';',
    'file_path' => 'users_export.csv'
]);</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Look Back / Reflect</h4>
                    <p>Our CSV conversion function works well, but we could improve it in several ways:</p>
                    <ul>
                        <li>Add option to include BOM (Byte Order Mark) for Excel compatibility</li>
                        <li>Add character encoding options</li>
                        <li>Add error handling for file operations</li>
                        <li>Add option to stream large datasets to avoid memory issues</li>
                    </ul>
                </div>
            </div>
            
            <div class="function-development">
                <h3>Function: <code>array_group_by</code></h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p><strong>Purpose:</strong> Group an array of items by a specific key or property</p>
                    <p><strong>Input:</strong> Array of items and the key to group by</p>
                    <p><strong>Output:</strong> Grouped array with key values as indexes</p>
                    <p><strong>Example:</strong> Group products by category</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <ol>
                        <li>Initialize an empty result array</li>
                        <li>Iterate through each item in the input array</li>
                        <li>Extract the grouping key value from the item</li>
                        <li>Add the item to the appropriate group in the result array</li>
                        <li>Return the grouped array</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Execute the Plan</h4>
                    <pre><code>/**
 * Groups an array of items by a specific key or property
 * 
 * @param array $array The array to group
 * @param string|callable $key The key to group by or a callback function
 * @return array The grouped array
 */
function array_group_by($array, $key) {
    if (!is_array($array)) {
        return false;
    }
    
    $result = [];
    
    foreach ($array as $item) {
        if (is_callable($key)) {
            // If $key is a callback, call it with the current item
            $group_key = call_user_func($key, $item);
        } elseif (is_object($item) && property_exists($item, $key)) {
            // If $item is an object and $key is a property
            $group_key = $item->$key;
        } elseif (is_array($item) && array_key_exists($key, $item)) {
            // If $item is an array and $key exists
            $group_key = $item[$key];
        } else {
            // Skip items without the specified key
            continue;
        }
        
        // Convert group key to string for array keys
        if (is_scalar($group_key)) {
            $group_key = (string) $group_key;
        } else {
            // Skip items with non-scalar keys
            continue;
        }
        
        // Create group if it doesn't exist
        if (!isset($result[$group_key])) {
            $result[$group_key] = [];
        }
        
        // Add item to its group
        $result[$group_key][] = $item;
    }
    
    return $result;
}

// Test with associative array
$products = [
    ['id' => 1, 'name' => 'Laptop', 'category' => 'Electronics'],
    ['id' => 2, 'name' => 'Desk Chair', 'category' => 'Furniture'],
    ['id' => 3, 'name' => 'Monitor', 'category' => 'Electronics'],
    ['id' => 4, 'name' => 'Bookshelf', 'category' => 'Furniture'],
    ['id' => 5, 'name' => 'Keyboard', 'category' => 'Electronics']
];

// Group by category
$grouped = array_group_by($products, 'category');
echo "<pre>";
print_r($grouped);
echo "</pre>";
// Output:
// Array (
//     [Electronics] => Array (
//         [0] => Array ( [id] => 1, [name] => Laptop, [category] => Electronics )
//         [1] => Array ( [id] => 3, [name] => Monitor, [category] => Electronics )
//         [2] => Array ( [id] => 5, [name] => Keyboard, [category] => Electronics )
//     )
//     [Furniture] => Array (
//         [0] => Array ( [id] => 2, [name] => Desk Chair, [category] => Furniture )
//         [1] => Array ( [id] => 4, [name] => Bookshelf, [category] => Furniture )
//     )
// )

// Group by custom callback function
$grouped_by_name_length = array_group_by($products, function($item) {
    // Group by name length
    return strlen($item['name']);
});
echo "<pre>";
print_r($grouped_by_name_length);
echo "</pre>;</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Look Back / Reflect</h4>
                    <p>Our grouping function provides good flexibility with key support and callback functions. Possible improvements include:</p>
                    <ul>
                        <li>Add support for multi-level grouping (group by category, then by price range)</li>
                        <li>Add option to preserve or discard keys from the original array</li>
                        <li>Add option to sort groups by key</li>
                        <li>Add support for grouping by multiple keys simultaneously</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <section class="utility-functions">
            <h2>Implementing Utility Functions</h2>
            
            <p>Finally, let's build some general utility functions that can be useful across different projects.</p>
            
            <div class="function-development">
                <h3>Function: <code>format_date</code></h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p><strong>Purpose:</strong> Format dates in various styles with locale support</p>
                    <p><strong>Input:</strong> Date string or timestamp, format options, locale</p>
                    <p><strong>Output:</strong> Formatted date string</p>
                    <p><strong>Example:</strong> Format "2025-05-15" as "May 15, 2025" or "15/05/2025"</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <ol>
                        <li>Parse the input date (string, timestamp, or DateTime object)</li>
                        <li>Create a DateTime object from the input</li>
                        <li>Apply the requested format or use a predefined format style</li>
                        <li>Apply locale formatting if requested</li>
                        <li>Return the formatted date string</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Execute the Plan</h4>
                    <pre><code>/**
 * Formats a date with various options and locale support
 * 
 * @param mixed $date Date string, timestamp, or DateTime object
 * @param string $format PHP date format or predefined format name
 * @param string $locale Locale for date formatting (default: current locale)
 * @return string Formatted date string
 */
function format_date($date, $format = 'default', $locale = null) {
    // Predefined formats
    $predefined_formats = [
        'default' => 'Y-m-d',
        'datetime' => 'Y-m-d H:i:s',
        'date' => 'Y-m-d',
        'time' => 'H:i:s',
        'short' => 'm/d/Y',
        'medium' => 'M j, Y',
        'long' => 'F j, Y',
        'full' => 'l, F j, Y',
        'month_year' => 'F Y',
        'day_month' => 'j M',
        'relative' => 'relative'
    ];
    
    // Convert to DateTime if not already
    if (!($date instanceof DateTime)) {
        try {
            if (is_numeric($date)) {
                // Timestamp
                $date_obj = new DateTime();
                $date_obj->setTimestamp($date);
            } else {
                // String date
                $date_obj = new DateTime($date);
            }
        } catch (Exception $e) {
            return false;
        }
    } else {
        $date_obj = clone $date;
    }
    
    // Use predefined format if available
    if (isset($predefined_formats[$format])) {
        $format = $predefined_formats[$format];
    }
    
    // Handle relative time format
    if ($format === 'relative') {
        return format_relative_time($date_obj);
    }
    
    // Apply locale if provided and IntlDateFormatter is available
    if ($locale && class_exists('IntlDateFormatter')) {
        // Map format to IntlDateFormatter constants
        $intl_formats = [
            'short' => [IntlDateFormatter::SHORT, IntlDateFormatter::NONE],
            'medium' => [IntlDateFormatter::MEDIUM, IntlDateFormatter::NONE],
            'long' => [IntlDateFormatter::LONG, IntlDateFormatter::NONE],
            'full' => [IntlDateFormatter::FULL, IntlDateFormatter::NONE],
            'datetime' => [IntlDateFormatter::SHORT, IntlDateFormatter::SHORT],
        ];
        
        if (isset($intl_formats[$format])) {
            $formatter = new IntlDateFormatter(
                $locale,
                $intl_formats[$format][0],
                $intl_formats[$format][1]
            );
            return $formatter->format($date_obj);
        }
    }
    
    // Standard PHP date formatting
    return $date_obj->format($format);
}

/**
 * Formats a date as a relative time string (e.g., "2 days ago")
 * 
 * @param DateTime $date The date to format
 * @return string Relative time string
 */
function format_relative_time($date) {
    $now = new DateTime();
    $diff = $date->diff($now);
    
    // Convert to total seconds
    $seconds = $diff->days * 86400 + $diff->h * 3600 + $diff->i * 60 + $diff->s;
    
    // Determine if date is in the past or future
    $is_past = !($date > $now);
    $format = $is_past ? '%s ago' : 'in %s';
    
    // Format the relative time
    if ($seconds < 60) {
        return $is_past ? 'just now' : 'in a moment';
    } elseif ($seconds < 3600) {
        $minutes = round($seconds / 60);
        $unit = $minutes === 1 ? 'minute' : 'minutes';
        return sprintf($format, "$minutes $unit");
    } elseif ($seconds < 86400) {
        $hours = round($seconds / 3600);
        $unit = $hours === 1 ? 'hour' : 'hours';
        return sprintf($format, "$hours $unit");
    } elseif ($seconds < 604800) {
        $days = round($seconds / 86400);
        $unit = $days === 1 ? 'day' : 'days';
        return sprintf($format, "$days $unit");
    } elseif ($seconds < 2592000) {
        $weeks = round($seconds / 604800);
        $unit = $weeks === 1 ? 'week' : 'weeks';
        return sprintf($format, "$weeks $unit");
    } elseif ($seconds < 31536000) {
        $months = round($seconds / 2592000);
        $unit = $months === 1 ? 'month' : 'months';
        return sprintf($format, "$months $unit");
    } else {
        $years = round($seconds / 31536000);
        $unit = $years === 1 ? 'year' : 'years';
        return sprintf($format, "$years $unit");
    }
}

// Test the function
$date = '2025-05-15 14:30:00';

echo format_date($date) . "<br>"; // 2025-05-15
echo format_date($date, 'medium') . "<br>"; // May 15, 2025
echo format_date($date, 'full') . "<br>"; // Thursday, May 15, 2025
echo format_date($date, 'Y-m-d H:i') . "<br>"; // 2025-05-15 14:30
echo format_date($date, 'relative') . "<br>"; // in X years (depends on current date)

// With locale (if IntlDateFormatter is available)
echo format_date($date, 'long', 'fr_FR') . "<br>"; // 15 mai 2025
echo format_date($date, 'long', 'de_DE') . "<br>"; // 15. Mai 2025</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Look Back / Reflect</h4>
                    <p>Our date formatting function provides good flexibility, but we could improve it by:</p>
                    <ul>
                        <li>Adding more predefined formats</li>
                        <li>Improving locale support for countries with different date formats</li>
                        <li>Adding timezone conversion capabilities</li>
                        <li>Providing more granular relative time (e.g., "yesterday", "tomorrow")</li>
                    </ul>
                </div>
            </div>
            
            <div class="function-development">
                <h3>Function: <code>format_file_size</code></h3>
                
                <div class="step">
                    <h4>Step 1: Understand the Problem</h4>
                    <p><strong>Purpose:</strong> Format file sizes in human-readable format</p>
                    <p><strong>Input:</strong> Size in bytes, precision, binary units option</p>
                    <p><strong>Output:</strong> Formatted size string (e.g., "1.5 MB")</p>
                    <p><strong>Example:</strong> Convert 1536000 bytes to "1.5 MB"</p>
                </div>
                
                <div class="step">
                    <h4>Step 2: Devise a Plan</h4>
                    <ol>
                        <li>Define the unit prefixes (KB, MB, GB, etc.)</li>
                        <li>Determine the appropriate unit based on size</li>
                        <li>Calculate the converted size with the desired precision</li>
                        <li>Return the formatted size with the unit</li>
                    </ol>
                </div>
                
                <div class="step">
                    <h4>Step 3: Execute the Plan</h4>
                    <pre><code>/**
 * Formats a file size in a human-readable format
 * 
 * @param int $bytes Size in bytes
 * @param int $precision Number of decimal places (default: 2)
 * @param bool $binary Use binary units (KiB, MiB) instead of decimal (KB, MB) (default: false)
 * @return string Formatted size string
 */
function format_file_size($bytes, $precision = 2, $binary = false) {
    // Ensure bytes is a number
    $bytes = max(0, (int) $bytes);
    
    // Define unit steps
    $base = $binary ? 1024 : 1000;
    
    // Define units
    if ($binary) {
        $units = ['B', 'KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB'];
    } else {
        $units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
    }
    
    // Determine the appropriate unit
    $power = $bytes > 0 ? floor(log($bytes, $base)) : 0;
    
    // Cap at the highest unit
    $power = min($power, count($units) - 1);
    
    // Calculate the formatted size
    $size = $bytes / pow($base, $power);
    
    // Format with the desired precision
    return round($size, $precision) . ' ' . $units[$power];
}

// Test the function
echo format_file_size(500) . "<br>"; // 500 B
echo format_file_size(1500) . "<br>"; // 1.5 KB
echo format_file_size(1500000) . "<br>"; // 1.5 MB
echo format_file_size(1500000000) . "<br>"; // 1.5 GB
echo format_file_size(1500000000000) . "<br>"; // 1.5 TB

// Binary units (base 1024)
echo format_file_size(1048576, 2, true) . "<br>"; // 1 MiB
echo format_file_size(1073741824, 2, true) . "<br>"; // 1 GiB

// Different precision
echo format_file_size(1500000, 0) . "<br>"; // 2 MB
echo format_file_size(1500000, 3) . "<br>"; // 1.500 MB</code></pre>
                </div>
                
                <div class="step">
                    <h4>Step 4: Look Back / Reflect</h4>
                    <p>Our file size formatting function is straightforward and effective. Possible improvements:</p>
                    <ul>
                        <li>Add option to use abbreviated units (K, M, G instead of KB, MB, GB)</li>
                        <li>Add localization support for decimal point and thousand separators</li>
                        <li>Add option to show or hide space between number and unit</li>
                        <li>Add option to display hybrid formats like "1.5GB (1,500,000,000 bytes)"</li>
                    </ul>
                </div>
            </div>
        </section>
        
        <section class="organizing-library">
            <h2>Organizing Your Function Library</h2>
            
            <p>Now that we have created several useful functions, let's organize them into a well-structured library file.</p>
            
            <div class="mermaid-diagram">
                <div class="mermaid">
                    graph TD
                    A[functions_library.php] --> B[String Functions]
                    A --> C[Validation Functions]
                    A --> D[Array Functions]
                    A --> E[Utility Functions]
                    
                    B --> B1[create_slug()]
                    B --> B2[truncate_text()]
                    
                    C --> C1[validate_email()]
                    C --> C2[validate_password()]
                    
                    D --> D1[array_to_csv()]
                    D --> D2[array_group_by()]
                    
                    E --> E1[format_date()]
                    E --> E2[format_file_size()]
                    
                    style A fill:#f9f,stroke:#333,stroke-width:2px
                </div>
            </div>
            
            <div class="code-example">
                <h3>Complete Function Library: <code>functions_library.php</code></h3>
                <p>Here's how you might organize your complete function library file:</p>
                
                <pre><code>/**
 * Custom PHP Function Library
 * 
 * A collection of useful functions for common web development tasks
 * 
 * @author Your Name
 * @version 1.0
 * @license MIT
 */

// ===== String Functions =====

/**
 * Creates a URL-friendly slug from a string with additional options
 * 
 * @param string $string The string to convert to a slug
 * @param string $separator The character to use as word separator (default: '-')
 * @param int $max_length Maximum length of the resulting slug (default: 100)
 * @return string The formatted slug
 */
function create_slug($string, $separator = '-', $max_length = 100) {
    // Function implementation...
}

/**
 * Truncates text to a specified length without cutting words or HTML tags
 * 
 * @param string $text The text to truncate (may contain HTML)
 * @param int $max_length Maximum length of the resulting text
 * @param string $ending String to append to the truncated text (default: '...')
 * @param boolean $html Set to true if text contains HTML (default: false)
 * @return string The truncated text
 */
function truncate_text($text, $max_length, $ending = '...', $html = false) {
    // Function implementation...
}

// ===== Validation Functions =====

/**
 * Validates an email address with various options
 * 
 * @param string $email The email address to validate
 * @param array $options Validation options
 * @return bool True if the email is valid, false otherwise
 */
function validate_email($email, $options = []) {
    // Function implementation...
}

/**
 * Validates a password against customizable strength criteria
 * 
 * @param string $password The password to validate
 * @param array $options Validation options
 * @return bool|array Boolean result or array of validation details
 */
function validate_password($password, $options = []) {
    // Function implementation...
}

// ===== Array Functions =====

/**
 * Converts an array to CSV format
 * 
 * @param array $data The array to convert to CSV
 * @param array $options CSV generation options
 * @return string|bool CSV string or true if saved to file
 */
function array_to_csv($data, $options = []) {
    // Function implementation...
}

/**
 * Groups an array of items by a specific key or property
 * 
 * @param array $array The array to group
 * @param string|callable $key The key to group by or a callback function
 * @return array The grouped array
 */
function array_group_by($array, $key) {
    // Function implementation...
}

// ===== Utility Functions =====

/**
 * Formats a date with various options and locale support
 * 
 * @param mixed $date Date string, timestamp, or DateTime object
 * @param string $format PHP date format or predefined format name
 * @param string $locale Locale for date formatting (default: current locale)
 * @return string Formatted date string
 */
function format_date($date, $format = 'default', $locale = null) {
    // Function implementation...
}

/**
 * Formats a relative time string (e.g., "2 days ago")
 * 
 * @param DateTime $date The date to format
 * @return string Relative time string
 */
function format_relative_time($date) {
    // Function implementation...
}

/**
 * Formats a file size in a human-readable format
 * 
 * @param int $bytes Size in bytes
 * @param int $precision Number of decimal places (default: 2)
 * @param bool $binary Use binary units (KiB, MiB) instead of decimal (KB, MB) (default: false)
 * @return string Formatted size string
 */
function format_file_size($bytes, $precision = 2, $binary = false) {
    // Function implementation...
}</code></pre>
            </div>
            
            <h3>Using Your Function Library</h3>
            
            <p>To use your function library in a PHP project, simply include it at the beginning of your scripts:</p>
            
            <pre><code>// Include the function library
require_once 'path/to/functions_library.php';

// Now you can use any of the functions
$slug = create_slug("Hello World!");
$formatted_date = format_date('2025-05-15', 'medium');
$readable_size = format_file_size(1500000);</code></pre>
            
            <div class="best-practices">
                <h3>Best Practices for Function Libraries</h3>
                <ul>
                    <li><strong>Document thoroughly:</strong> Include detailed docblocks for all functions</li>
                    <li><strong>Use consistent naming:</strong> Follow a consistent naming pattern (e.g., snake_case)</li>
                    <li><strong>Group related functions:</strong> Organize functions by category</li>
                    <li><strong>Provide sensible defaults:</strong> Make functions flexible with good default values</li>
                    <li><strong>Include error handling:</strong> Functions should gracefully handle invalid inputs</li>
                    <li><strong>Avoid name conflicts:</strong> Consider prefixing function names to avoid conflicts</li>
                    <li><strong>Test thoroughly:</strong> Create test cases for each function</li>
                    <li><strong>Version control:</strong> Use version control to track changes to your library</li>
                    <li><strong>Keep it modular:</strong> Break large functions into smaller, reusable components</li>

                    <li><strong>Optimize performance:</strong> Profile and optimize functions for speed and memory usage</li>
                    
                    <li><strong>Consider namespaces:</strong> For larger libraries, use PHP namespaces to avoid conflicts</li>
                    <li><strong>Version your library:</strong> Track changes with version numbers</li>
                    <li><strong>Create a README:</strong> Document how to use your library</li>
                    <li><strong>Make it modular:</strong> Consider splitting into multiple files for large libraries</li>
                </ul>
            </div>
        </section>

        <section class="advanced-organization">
            <h2>Advanced Organization: Using Namespaces</h2>
            
            <p>For larger function libraries, using PHP namespaces can help organize code and avoid naming conflicts. Here's how you might restructure your library using namespaces:</p>
            
            <div class="mermaid-diagram">
                <div class="mermaid">
                    graph TD
                    A[MyLibrary] --> B[MyLibrary\Text]
                    A --> C[MyLibrary\Validation]
                    A --> D[MyLibrary\Arrays]
                    A --> E[MyLibrary\Utils]
                    
                    B --> B1[createSlug()]
                    B --> B2[truncateText()]
                    
                    C --> C1[validateEmail()]
                    C --> C2[validatePassword()]
                    
                    D --> D1[toCsv()]
                    D --> D2[groupBy()]
                    
                    E --> E1[formatDate()]
                    E --> E2[formatFileSize()]
                    
                    style A fill:#f9f,stroke:#333,stroke-width:2px
                </div>
            </div>
            
            <div class="code-example">
                <h3>Namespace Structure</h3>
                <p>With namespaces, you would organize your files like this:</p>
                
                <pre><code>MyLibrary/
  ├── Text/
  │   └── Functions.php
  ├── Validation/
  │   └── Functions.php
  ├── Arrays/
  │   └── Functions.php
  ├── Utils/
  │   └── Functions.php
  └── autoload.php</code></pre>
                
                <h4>Example: <code>MyLibrary/Text/Functions.php</code></h4>
                <pre><code>&lt;?php
namespace MyLibrary\Text;

/**
  * Creates a URL-friendly slug from a string
  */
function createSlug($string, $separator = '-', $maxLength = 100) {
    // Implementation...
}

/**
  * Truncates text to a specified length
  */
function truncateText($text, $maxLength, $ending = '...', $html = false) {
    // Implementation...
}</code></pre>

                <h4>Example: <code>MyLibrary/autoload.php</code></h4>
                <pre><code>&lt;?php
// Simple autoloader for our library
spl_autoload_register(function ($class) {
    // Only handle our own namespaces
    if (strpos($class, 'MyLibrary\\') !== 0) {
        return;
    }
    
    // Convert namespace to path
    $file = __DIR__ . '/' . str_replace('\\', '/', str_replace('MyLibrary\\', '', $class)) . '.php';
    
    // Load the file if it exists
    if (file_exists($file)) {
        require_once $file;
    }
});

// Include all function files
require_once __DIR__ . '/Text/Functions.php';
require_once __DIR__ . '/Validation/Functions.php';
require_once __DIR__ . '/Arrays/Functions.php';
require_once __DIR__ . '/Utils/Functions.php';</code></pre>
            </div>
            
            <div class="example-usage">
                <h3>Using Namespaced Functions</h3>
                <pre><code>&lt;?php
// Include the library
require_once 'path/to/MyLibrary/autoload.php';

// Use the functions with their namespaces
$slug = \MyLibrary\Text\createSlug("Hello World!");
$validEmail = \MyLibrary\Validation\validateEmail("user@example.com");

// Or import the namespaces
use MyLibrary\Text as Text;
use MyLibrary\Utils as Utils;

$truncated = Text\truncateText("This is a long text...", 20);
$formatted = Utils\formatDate("2025-05-15", "long");</code></pre>
            </div>
        </section>

        <section class="oop-approach">
            <h2>Object-Oriented Approach: Class-Based Libraries</h2>
            
            <p>Another approach to organizing your function library is to use classes. This can provide additional benefits like encapsulation, inheritance, and better organization.</p>
            
            <div class="svg-container">
                <svg width="650" height="500" xmlns="http://www.w3.org/2000/svg">
                    <!-- Class Diagram -->
                    <rect x="50" y="30" width="550" height="440" fill="#f5f5f5" stroke="#333" stroke-width="2"/>
                    <text x="325" y="60" text-anchor="middle" font-size="22" font-weight="bold">Class-Based Library Structure</text>
                    
                    <!-- StringUtils Class -->
                    <rect x="100" y="90" width="450" height="120" fill="#e3f2fd" stroke="#0d47a1" stroke-width="2"/>
                    <rect x="100" y="90" width="450" height="30" fill="#bbdefb" stroke="#0d47a1" stroke-width="2"/>
                    <text x="325" y="110" text-anchor="middle" font-weight="bold" fill="#0d47a1">StringUtils</text>
                    <line x1="100" y1="120" x2="550" y2="120" stroke="#0d47a1" stroke-width="2"/>
                    
                    <text x="110" y="140" font-family="monospace">+ static createSlug($string, $separator = '-')</text>
                    <text x="110" y="160" font-family="monospace">+ static truncateText($text, $maxLength)</text>
                    <text x="110" y="180" font-family="monospace">+ static sanitize($string, $allowHtml = false)</text>
                    
                    <!-- ValidationUtils Class -->
                    <rect x="100" y="240" width="450" height="120" fill="#e8f5e9" stroke="#1b5e20" stroke-width="2"/>
                    <rect x="100" y="240" width="450" height="30" fill="#c8e6c9" stroke="#1b5e20" stroke-width="2"/>
                    <text x="325" y="260" text-anchor="middle" font-weight="bold" fill="#1b5e20">ValidationUtils</text>
                    <line x1="100" y1="270" x2="550" y2="270" stroke="#1b5e20" stroke-width="2"/>
                    
                    <text x="110" y="290" font-family="monospace">+ static validateEmail($email, $options = [])</text>
                    <text x="110" y="310" font-family="monospace">+ static validatePassword($password, $options = [])</text>
                    <text x="110" y="330" font-family="monospace">+ static isValidUrl($url)</text>
                    
                    <!-- FormatUtils Class -->
                    <rect x="100" y="390" width="450" height="120" fill="#fff8e1" stroke="#ff6f00" stroke-width="2"/>
                    <rect x="100" y="390" width="450" height="30" fill="#ffe0b2" stroke="#ff6f00" stroke-width="2"/>
                    <text x="325" y="410" text-anchor="middle" font-weight="bold" fill="#ff6f00">FormatUtils</text>
                    <line x1="100" y1="420" x2="550" y2="420" stroke="#ff6f00" stroke-width="2"/>
                    
                    <text x="110" y="440" font-family="monospace">+ static formatDate($date, $format = 'default')</text>
                    <text x="110" y="460" font-family="monospace">+ static formatFileSize($bytes, $precision = 2)</text>
                    <text x="110" y="480" font-family="monospace">+ static formatCurrency($amount, $currency = 'USD')</text>
                </svg>
            </div>
            
            <div class="code-example">
                <h3>Class-Based Implementation Example</h3>
                
                <h4>Example: <code>StringUtils.php</code></h4>
                <pre><code>&lt;?php
/**
  * String manipulation utility class
  */
class StringUtils {
    /**
      * Creates a URL-friendly slug from a string
      *
      * @param string $string The string to convert to a slug
      * @param string $separator The character to use as word separator (default: '-')
      * @param int $maxLength Maximum length of the resulting slug (default: 100)
      * @return string The formatted slug
      */
    public static function createSlug($string, $separator = '-', $maxLength = 100) {
        // Implementation...
    }
    
    /**
      * Truncates text to a specified length without cutting words
      *
      * @param string $text The text to truncate
      * @param int $maxLength Maximum length of the resulting text
      * @param string $ending String to append to the truncated text (default: '...')
      * @param boolean $html Set to true if text contains HTML (default: false)
      * @return string The truncated text
      */
    public static function truncateText($text, $maxLength, $ending = '...', $html = false) {
        // Implementation...
    }
    
    /**
      * Sanitizes a string for safe output
      *
      * @param string $string The string to sanitize
      * @param boolean $allowHtml Whether to allow safe HTML tags (default: false)
      * @return string The sanitized string
      */
    public static function sanitize($string, $allowHtml = false) {
        if ($allowHtml) {
            // Allow only safe HTML tags
            return strip_tags($string, '<p><br><a><strong><em><ul><ol><li><h1><h2><h3>');
        } else {
            // Remove all HTML
            return htmlspecialchars(strip_tags($string), ENT_QUOTES, 'UTF-8');
        }
    }
}</code></pre>

                <h4>Example: <code>ValidationUtils.php</code></h4>
                <pre><code>&lt;?php
/**
  * Validation utility class
  */
class ValidationUtils {
    /**
      * Validates an email address with various options
      *
      * @param string $email The email address to validate
      * @param array $options Validation options
      * @return bool True if the email is valid, false otherwise
      */
    public static function validateEmail($email, $options = []) {
        // Implementation...
    }
    
    /**
      * Validates a password against customizable strength criteria
      *
      * @param string $password The password to validate
      * @param array $options Validation options
      * @return bool|array Boolean result or array of validation details
      */
    public static function validatePassword($password, $options = []) {
        // Implementation...
    }
    
    /**
      * Checks if a URL is valid
      *
      * @param string $url The URL to validate
      * @return bool True if the URL is valid, false otherwise
      */
    public static function isValidUrl($url) {
        return filter_var($url, FILTER_VALIDATE_URL) !== false;
    }
}</code></pre>
            </div>
            
            <div class="example-usage">
                <h3>Using Class-Based Utilities</h3>
                <pre><code>&lt;?php
// Include the utility classes
require_once 'path/to/StringUtils.php';
require_once 'path/to/ValidationUtils.php';
require_once 'path/to/FormatUtils.php';

// Use the static methods
$slug = StringUtils::createSlug("Hello World!");
$isValid = ValidationUtils::validateEmail("user@example.com");
$formatted = FormatUtils::formatDate("2025-05-15", "medium");</code></pre>
            </div>
        </section>

        <section class="expanding-library">
            <h2>Expanding Your Function Library</h2>
            
            <p>As you continue to develop websites and applications, you'll identify more common tasks that can be automated with custom functions. Here are some ideas for additional functions you might add to your library:</p>
            
            <div class="mermaid-diagram">
                <div class="mermaid">
                    mindmap
                    root((Function Library<br>Expansion))
                        Security Functions
                            ::icon(fa fa-lock)
                            Token Generation
                            Data Encryption/Decryption
                            Input Sanitization
                            CSRF Protection
                        Image Processing
                            ::icon(fa fa-image)
                            Resizing
                            Watermarking
                            Format Conversion
                            Optimization
                        Database Utilities
                            ::icon(fa fa-database)
                            Query Builders
                            Pagination Helpers
                            Data Mappers
                            Cache Wrappers
                        API Interactions
                            ::icon(fa fa-globe)
                            Request Builders
                            Response Parsers
                            Authentication Helpers
                            Rate Limit Handling
                </div>
            </div>
            
            <div class="function-ideas">
                <h3>Security Functions</h3>
                <ul>
                    <li><code>generate_csrf_token()</code> - Generate and validate CSRF tokens for forms</li>
                    <li><code>encrypt_data()</code> / <code>decrypt_data()</code> - Simple data encryption/decryption</li>
                    <li><code>sanitize_input()</code> - Comprehensive input sanitization for different data types</li>
                    <li><code>generate_secure_password()</code> - Generate secure random passwords</li>
                </ul>
                
                <h3>Image Processing Functions</h3>
                <ul>
                    <li><code>resize_image()</code> - Resize images while maintaining aspect ratio</li>
                    <li><code>add_watermark()</code> - Add text or image watermarks to images</li>
                    <li><code>optimize_image()</code> - Compress images for web use</li>
                    <li><code>convert_image_format()</code> - Convert between image formats (JPG, PNG, WebP)</li>
                </ul>
                
                <h3>Database Utility Functions</h3>
                <ul>
                    <li><code>paginate_results()</code> - Handle pagination for database queries</li>
                    <li><code>build_where_clause()</code> - Build SQL WHERE clauses from array conditions</li>
                    <li><code>sanitize_sql()</code> - Sanitize SQL queries to prevent injection</li>
                    <li><code>cache_query_results()</code> - Cache and retrieve database query results</li>
                </ul>
                
                <h3>API Interaction Functions</h3>
                <ul>
                    <li><code>make_api_request()</code> - Wrapper for API requests with error handling</li>
                    <li><code>parse_api_response()</code> - Parse and sanitize API responses</li>
                    <li><code>handle_rate_limiting()</code> - Handle API rate limiting with backoff</li>
                    <li><code>create_oauth_signature()</code> - Generate OAuth signatures for API authentication</li>
                </ul>
            </div>
        </section>

        <section class="publishing-sharing">
            <h2>Publishing and Sharing Your Library</h2>
            
            <p>Once you've developed a useful function library, you might want to share it with others or use it across multiple projects. Here are some approaches:</p>
            
            <div class="approaches">
                <h3>Personal Repository</h3>
                <p>Keep your library in a private Git repository that you can clone for each project:</p>
                <pre><code># Create a Git repository for your library
git init
git add *.php
git commit -m "Initial library commit"

# Push to a personal Git repository (GitHub, GitLab, etc.)
git remote add origin git@github.com:yourusername/function-library.git
git push -u origin main</code></pre>
                
                <h3>Composer Package</h3>
                <p>For more advanced libraries, create a Composer package:</p>
                <pre><code>// composer.json
{
    "name": "yourusername/function-library",
    "description": "A library of useful PHP functions",
    "type": "library",
    "license": "MIT",
    "authors": [
        {
            "name": "Your Name",
            "email": "your.email@example.com"
        }
    ],
    "require": {
        "php": ">=7.4"
    },
    "autoload": {
        "psr-4": {
            "MyLibrary\\": "src/"
        },
        "files": [
            "src/functions.php"
        ]
    }
}

// Then users can install with:
// composer require yourusername/function-library</code></pre>
                
                <h3>WordPress Plugin</h3>
                <p>For WordPress-specific functions, create a simple utility plugin:</p>
                <pre><code>/**
  * Plugin Name: My Function Library
  * Description: A collection of useful functions for WordPress development
  * Version: 1.0.0
  * Author: Your Name
  * Author URI: https://yourwebsite.com
  * License: GPL v2 or later
  */

// Prevent direct access
if (!defined('ABSPATH')) {
    exit;
}

// Include function files
require_once plugin_dir_path(__FILE__) . 'includes/string-functions.php';
require_once plugin_dir_path(__FILE__) . 'includes/validation-functions.php';
require_once plugin_dir_path(__FILE__) . 'includes/array-functions.php';
require_once plugin_dir_path(__FILE__) . 'includes/utility-functions.php';</code></pre>
            </div>
        </section>

        <section class="final-project">
            <h2>Homework Project: Build Your Custom Function Library</h2>
            
            <p>Now it's your turn to build your own custom function library! Follow these steps:</p>
            
            <div class="steps">
                <ol>
                    <li>
                        <strong>Identify Common Tasks</strong>
                        <p>Think about functions that would be useful in your own projects. What tasks do you find yourself doing repeatedly?</p>
                    </li>
                    <li>
                        <strong>Plan Your Library Structure</strong>
                        <p>Decide how you want to organize your functions (simple function collection, namespaces, or classes).</p>
                    </li>
                    <li>
                        <strong>Implement Core Functions</strong>
                        <p>Create at least 8 useful functions across different categories (string manipulation, validation, arrays, utilities).</p>
                    </li>
                    <li>
                        <strong>Document Your Functions</strong>
                        <p>Add clear documentation for each function using PHPDoc comments.</p>
                    </li>
                    <li>
                        <strong>Test Your Functions</strong>
                        <p>Create a test script that demonstrates each function with different inputs.</p>
                    </li>
                    <li>
                        <strong>Create a README</strong>
                        <p>Write a simple README file explaining how to use your library.</p>
                    </li>
                </ol>
            </div>
            
            <div class="submission-guidelines">
                <h3>Submission Guidelines</h3>
                <ul>
                    <li>Submit your library as a ZIP file containing all PHP files and the README</li>
                    <li>Include a demo.php file that shows usage examples for each function</li>
                    <li>Be prepared to explain your design decisions in the next class session</li>
                </ul>
            </div>
            
            <div class="grading-criteria">
                <h3>Grading Criteria</h3>
                <ul>
                    <li><strong>Functionality (40%):</strong> Do the functions work correctly and handle edge cases?</li>
                    <li><strong>Code Quality (20%):</strong> Is the code well-written, consistent, and efficient?</li>
                    <li><strong>Documentation (20%):</strong> Are functions clearly documented with parameters and return values?</li>
                    <li><strong>Organization (10%):</strong> Is the library well-organized and easy to use?</li>
                    <li><strong>Creativity (10%):</strong> Did you include unique, helpful functions beyond the examples?</li>
                </ul>
            </div>
        </section>

        <section class="resources">
            <h2>Additional Resources</h2>
            
            <ul>
                <li><a href="https://www.php.net/manual/en/functions.user-defined.php" target="_blank">PHP Manual: User-defined Functions</a></li>
                <li><a href="https://www.php.net/manual/en/language.namespaces.php" target="_blank">PHP Manual: Namespaces</a></li>
                <li><a href="https://www.php.net/manual/en/language.oop5.php" target="_blank">PHP Manual: Classes and Objects</a></li>
                <li><a href="https://phptherightway.com/" target="_blank">PHP The Right Way</a> - Modern PHP best practices</li>
                <li><a href="https://getcomposer.org/doc/04-schema.md" target="_blank">Composer Package Schema</a> - For publishing your library</li>
                <li><a href="https://phpstan.org/" target="_blank">PHPStan</a> - Static analysis tool for improving code quality</li>
            </ul>
        </section>

        <section class="conclusion">
            <h2>Conclusion</h2>
            
            <p>Creating your own function library is a valuable exercise that will save you time in future projects and help you develop better coding practices. As you continue to build web applications, your library will grow and evolve, becoming an increasingly powerful tool in your developer toolkit.</p>
            
            <p>Remember to apply George Polya's problem-solving method when developing new functions:</p>
            
            <ol>
                <li><strong>Understand the Problem:</strong> Clearly define what the function should do</li>
                <li><strong>Devise a Plan:</strong> Outline the steps or algorithm before coding</li>
                <li><strong>Execute the Plan:</strong> Write the function with clean, well-documented code</li>
                <li><strong>Look Back:</strong> Test, refine, and improve your functions over time</li>
            </ol>
            
            <p>Happy coding!</p>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2025 PHP WordPress Development Course</p>
        <p><a href="index.html">Back to Course Index</a> | <a href="next_lecture.html">Next Lecture</a></p>
    </footer>
</body>
</html>
