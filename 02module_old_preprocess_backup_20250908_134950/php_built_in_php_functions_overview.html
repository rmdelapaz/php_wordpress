<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHP Functions: Built-in PHP Functions Overview</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="icon" href="/favicon.png">
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <header>
        <h1>PHP Functions: Built-in PHP Functions Overview</h1>
        <p><a href="index.html">← Back to Syllabus</a> | <a href="php_anonymous_functions.html">← Previous Lecture</a></p>
    </header>
    
    <main>
        <section class="intro">
            <h2>Unleashing PHP's Built-in Power</h2>
            <p>Welcome to our exploration of PHP's extensive built-in function library! One of PHP's greatest strengths is its rich collection of pre-built functions that handle everything from string manipulation to database connectivity, file operations, and more.</p>
            
            <p>Think of PHP's built-in functions as a vast toolbox that comes with the language. Rather than crafting every tool from scratch, PHP provides hundreds of specialized functions ready for you to use in your WordPress development journey.</p>

            <div class="definition-box">
                <h3>What Are Built-in Functions?</h3>
                <p>Built-in functions (also called native or internal functions) are functions that come pre-packaged with PHP. They're ready to use without requiring any additional libraries or extensions and form the foundation of PHP's functionality.</p>
            </div>
        </section>

        <section class="visual-concept">
            <h2>PHP's Function Categories: A Visual Overview</h2>
            
            <div class="mermaid-diagram">
                <div class="mermaid">
                    mindmap
                    root((PHP Built-in Functions))
                        String Functions
                            ::icon(fa fa-font)
                            String Manipulation
                            String Comparison
                            Regular Expressions
                        Array Functions
                            ::icon(fa fa-table)
                            Array Creation
                            Array Transformation
                            Array Sorting
                            Array Iteration
                        Math Functions
                            ::icon(fa fa-calculator)
                            Basic Math
                            Randomization
                            Number Formatting
                        File System Functions
                            ::icon(fa fa-file)
                            File Reading/Writing
                            Directory Operations
                            File Information
                        Date/Time Functions
                            ::icon(fa fa-calendar)
                            Date Creation
                            Date Formatting
                            Date Calculations
                        Database Functions
                            ::icon(fa fa-database)
                            MySQL
                            PostgreSQL
                            SQLite
                        Network Functions
                            ::icon(fa fa-globe)
                            HTTP
                            cURL
                            Sockets
                </div>
            </div>
            
            <p>PHP's built-in functions are organized into logical categories, making it easier to find the function you need for a specific task. As a WordPress developer, you'll frequently use functions from all these categories to build dynamic, data-driven websites.</p>
        </section>

        <section class="php-documentation">
            <h2>Using the PHP Documentation</h2>
            
            <p>Before we dive into specific function categories, let's discuss how to use PHP's official documentation, which is an invaluable resource for learning about built-in functions.</p>
            
            <div class="svg-container">
                <svg width="650" height="400" xmlns="http://www.w3.org/2000/svg">
                    <!-- PHP Documentation Structure Diagram -->
                    <rect x="50" y="30" width="550" height="340" fill="#f5f5f5" stroke="#333" stroke-width="2"/>
                    <text x="325" y="60" text-anchor="middle" font-size="20" font-weight="bold">PHP Function Documentation Structure</text>

                    <!-- Function Signature -->
                    <rect x="70" y="90" width="510" height="50" fill="#e3f2fd" stroke="#0d47a1" stroke-width="2"/>
                    <text x="325" y="120" text-anchor="middle" font-weight="bold" fill="#0d47a1">Function Signature and Version Information</text>
                    
                    <!-- Description -->
                    <rect x="70" y="150" width="510" height="50" fill="#e8f5e9" stroke="#1b5e20" stroke-width="2"/>
                    <text x="325" y="180" text-anchor="middle" font-weight="bold" fill="#1b5e20">Function Description and Purpose</text>
                    
                    <!-- Parameters -->
                    <rect x="70" y="210" width="510" height="50" fill="#fff8e1" stroke="#ff6f00" stroke-width="2"/>
                    <text x="325" y="240" text-anchor="middle" font-weight="bold" fill="#ff6f00">Parameter List and Types</text>
                    
                    <!-- Return Values -->
                    <rect x="70" y="270" width="510" height="50" fill="#f3e5f5" stroke="#6a1b9a" stroke-width="2"/>
                    <text x="325" y="300" text-anchor="middle" font-weight="bold" fill="#6a1b9a">Return Values and Types</text>
                    
                    <!-- Examples -->
                    <rect x="70" y="330" width="510" height="30" fill="#ffebee" stroke="#b71c1c" stroke-width="2"/>
                    <text x="325" y="350" text-anchor="middle" font-weight="bold" fill="#b71c1c">Usage Examples</text>
                </svg>
            </div>
            
            <div class="documentation-tips">
                <h3>Tips for Using PHP Documentation</h3>
                <ul>
                    <li><strong>Check the version requirements:</strong> Make sure the function is available in the PHP version you're using</li>
                    <li><strong>Read the parameter descriptions carefully:</strong> Pay attention to required vs. optional parameters</li>
                    <li><strong>Note the return value type:</strong> Understanding what a function returns helps prevent errors</li>
                    <li><strong>Study the examples:</strong> The documentation includes practical examples for most functions</li>
                    <li><strong>Look at related functions:</strong> The "See Also" section often points to similar or complementary functions</li>
                    <li><strong>Read user contributed notes:</strong> These often contain valuable tips and real-world usage scenarios</li>
                </ul>
            </div>
            
            <div class="example-box">
                <h3>Example Documentation Reading: <code>str_replace()</code></h3>
                <pre><code>/* 
Function Signature:
str_replace(mixed $search, mixed $replace, mixed $subject, int &$count = null): mixed

Description:
Replaces all occurrences of $search in $subject with $replace.

Parameters:
$search - The value being searched for (needle)
$replace - The replacement value
$subject - The string or array being searched and replaced on
$count - If provided, this will be set to the number of replacements performed

Return Value:
Returns a string or array with all occurrences of $search in $subject replaced with $replace
*/

// Example Usage
$text = "The quick brown fox jumps over the lazy dog.";
$search = ["quick", "brown", "fox"];
$replace = ["slow", "black", "cat"];

$result = str_replace($search, $replace, $text);
echo $result; // Outputs: The slow black cat jumps over the lazy dog.</code></pre>
            </div>
        </section>

        <section class="string-functions">
            <h2>String Functions: Text Manipulation</h2>
            
            <p>String functions are among the most commonly used in PHP, especially in WordPress development where you're constantly working with text content.</p>
            
            <div class="example-box">
                <h3>Essential String Manipulation Functions</h3>
                <pre><code>// String length
$title = "Welcome to WordPress Development";
echo strlen($title); // Outputs: 32

// Changing case
echo strtoupper($title); // Outputs: WELCOME TO WORDPRESS DEVELOPMENT
echo strtolower($title); // Outputs: welcome to wordpress development
echo ucfirst("hello world"); // Outputs: Hello world
echo ucwords("hello world"); // Outputs: Hello World

// Substring extraction
echo substr($title, 0, 7); // Outputs: Welcome
echo substr($title, 11);   // Outputs: WordPress Development

// String replacement
$content = "This post needs [shortcode]";
echo str_replace("[shortcode]", "&lt;div class='feature'&gt;&lt;/div&gt;", $content);
// Outputs: This post needs <div class='feature'></div>

// Position finding
echo strpos($title, "WordPress"); // Outputs: 11 (position where "WordPress" starts)
if (strpos($title, "PHP") === false) {
    echo "The string 'PHP' was not found.";
}

// String trimming
$input = "  User Input with Spaces  ";
echo trim($input); // Outputs: "User Input with Spaces"
echo ltrim($input); // Outputs: "User Input with Spaces  "
echo rtrim($input); // Outputs: "  User Input with Spaces"</code></pre>
            </div>

            <div class="wordpress-example">
                <h3>WordPress Content Formatting Example</h3>
                <pre><code>/**
 * Format post content for display
 * 
 * @param string $content The raw post content
 * @return string The formatted content
 */
function format_post_content($content) {
    // Convert line breaks to paragraphs (like wpautop())
    $content = nl2br($content);
    
    // Make URLs clickable
    $content = preg_replace('/(https?:\/\/\S+)/', '&lt;a href="$1"&gt;$1&lt;/a&gt;', $content);
    
    // Convert markdown-style bold text
    $content = preg_replace('/\*\*(.*?)\*\*/', '&lt;strong&gt;$1&lt;/strong&gt;', $content);
    
    // Convert markdown-style italic text
    $content = preg_replace('/\*(.*?)\*/', '&lt;em&gt;$1&lt;/em&gt;', $content);
    
    // Clean up excessive whitespace
    $content = preg_replace('/\s+/', ' ', $content);
    $content = trim($content);
    
    return $content;
}

// Example usage
$post_content = "Welcome to **WordPress**!\n\nThis is an *amazing* platform.\n\nCheck out https://wordpress.org for more info.";
echo format_post_content($post_content);</code></pre>
            </div>
            
            <div class="explainer-box">
                <h3>Regular Expressions with <code>preg_</code> Functions</h3>
                <p>While basic string functions handle many tasks, regular expressions offer more powerful pattern matching and replacement capabilities through the <code>preg_</code> family of functions.</p>
                <pre><code>// Validate an email address
$email = "user@example.com";
if (preg_match('/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/', $email)) {
    echo "Valid email format";
}

// Extract all image tags from HTML content
$html = "&lt;p&gt;Text with &lt;img src='image1.jpg'&gt; and &lt;img src='image2.png' alt='Photo'&gt;&lt;/p&gt;";
preg_match_all('/&lt;img.+?src=[\'"](.*?)[\'"].*?&gt;/i', $html, $matches);
print_r($matches[1]); // Array of image sources: ['image1.jpg', 'image2.png']

// Replace all WordPress shortcodes with their HTML equivalents
$content = "Here's a gallery: [gallery ids='1,2,3'] and a button: [button link='https://example.com']Click me[/button]";
$content = preg_replace_callback('/\[([a-z0-9_-]+)(?:\s+([^\]]+))?\](.*?)\[\/\1\]/', function($matches) {
    // $matches[1] contains the shortcode name
    // $matches[2] contains the attributes (if any)
    // $matches[3] contains the content (if any)
    
    if ($matches[1] == 'button') {
        // Parse attributes
        preg_match('/link=[\'"](.*?)[\'"]/', $matches[2], $link);
        return '&lt;a href="' . $link[1] . '" class="button"&gt;' . $matches[3] . '&lt;/a&gt;';
    }
    
    return $matches[0]; // Return unchanged if not processed
}, $content);</code></pre>
            </div>
        </section>

        <section class="array-functions">
            <h2>Array Functions: Data Collection Handling</h2>
            
            <p>Arrays are fundamental data structures in PHP, and the language provides a rich set of functions for working with them. These functions are especially useful in WordPress when dealing with posts, users, options, and other collections of data.</p>
            
            <div class="mermaid-diagram">
                <div class="mermaid">
                    graph TD
                    A[Array Functions] --> B[Creation & Inspection]
                    A --> C[Modification]
                    A --> D[Iteration]
                    A --> E[Filtering & Mapping]
                    A --> F[Sorting]
                    
                    B --> B1[array()]
                    B --> B2[count()]
                    B --> B3[empty()]
                    B --> B4[isset()]
                    
                    C --> C1[array_push()]
                    C --> C2[array_pop()]
                    C --> C3[array_merge()]
                    C --> C4[array_slice()]
                    
                    D --> D1[foreach]
                    D --> D2[array_walk()]
                    D --> D3[array_map()]
                    
                    E --> E1[array_filter()]
                    E --> E2[array_map()]
                    E --> E3[array_reduce()]
                    
                    F --> F1[sort()]
                    F --> F2[usort()]
                    F --> F3[ksort()]
                    
                    style A fill:#f9f,stroke:#333,stroke-width:2px
                </div>
            </div>
            
            <div class="example-box">
                <h3>Essential Array Functions</h3>
                <pre><code>// Creating arrays
$simple_array = array('apple', 'banana', 'cherry');
$modern_syntax = ['apple', 'banana', 'cherry']; // PHP 5.4+ short syntax
$associative_array = [
    'title' => 'My WordPress Site',
    'theme' => 'Twenty Twenty-Five',
    'plugins' => 15
];

// Accessing and checking arrays
echo count($simple_array); // Outputs: 3
var_dump(empty($simple_array)); // Outputs: bool(false)
var_dump(isset($associative_array['author'])); // Outputs: bool(false)

// Adding and removing elements
array_push($simple_array, 'dragonfruit'); // Add to the end
$last_fruit = array_pop($simple_array); // Remove from the end
array_unshift($simple_array, 'apricot'); // Add to the beginning
$first_fruit = array_shift($simple_array); // Remove from the beginning

// Merging arrays
$fruits = ['apple', 'banana', 'cherry'];
$vegetables = ['carrot', 'broccoli'];
$produce = array_merge($fruits, $vegetables);
// $produce now contains: ['apple', 'banana', 'cherry', 'carrot', 'broccoli']

// Slicing arrays
$slice = array_slice($produce, 1, 3); // Extract elements 1, 2, and 3
// $slice now contains: ['banana', 'cherry', 'carrot']

// Checking if value exists
if (in_array('banana', $fruits)) {
    echo "Yes, we have bananas!";
}

// Getting array keys and values
$keys = array_keys($associative_array); // ['title', 'theme', 'plugins']
$values = array_values($associative_array); // ['My WordPress Site', 'Twenty Twenty-Five', 15]</code></pre>
            </div>

            <div class="example-box">
                <h3>Advanced Array Manipulation</h3>
                <pre><code>// Array filtering
$numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
$even_numbers = array_filter($numbers, function($n) {
    return $n % 2 === 0;
});
// $even_numbers now contains: [2, 4, 6, 8, 10]

// Array mapping
$squared_numbers = array_map(function($n) {
    return $n * $n;
}, $numbers);
// $squared_numbers now contains: [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]

// Array reduction
$sum = array_reduce($numbers, function($carry, $item) {
    return $carry + $item;
}, 0);
echo $sum; // Outputs: 55 (sum of all numbers)

// Array sorting
sort($numbers); // Sort numerically
$words = ['zebra', 'apple', 'orange', 'Banana'];
sort($words); // Sort alphabetically (case-sensitive)
// $words now contains: ['Banana', 'apple', 'orange', 'zebra']

// Case-insensitive sorting
$words = ['zebra', 'apple', 'orange', 'Banana'];
usort($words, 'strcasecmp');
// $words now contains: ['apple', 'Banana', 'orange', 'zebra']

// Custom sorting with user-defined function
$people = [
    ['name' => 'John', 'age' => 35],
    ['name' => 'Jane', 'age' => 28],
    ['name' => 'Bob', 'age' => 42]
];

usort($people, function($a, $b) {
    return $a['age'] - $b['age']; // Sort by age ascending
});

// Associative array sorting
$scores = ['John' => 85, 'Jane' => 92, 'Bob' => 78];
asort($scores); // Sort by value (ascending)
// $scores now contains: ['Bob' => 78, 'John' => 85, 'Jane' => 92]

ksort($scores); // Sort by key (alphabetically)
// $scores now contains: ['Bob' => 78, 'Jane' => 92, 'John' => 85]</code></pre>
            </div>

            <div class="wordpress-example">
                <h3>WordPress Array Function Example</h3>
                <pre><code>/**
 * Organize posts by category
 * 
 * @param array $posts Array of WP_Post objects
 * @return array Posts organized by category
 */
function organize_posts_by_category($posts) {
    $organized = [];
    
    // Handle empty input
    if (empty($posts)) {
        return $organized;
    }
    
    // Group posts by category
    foreach ($posts as $post) {
        $categories = get_the_category($post->ID);
        
        if (empty($categories)) {
            // Add to "Uncategorized" if no categories found
            if (!isset($organized['Uncategorized'])) {
                $organized['Uncategorized'] = [];
            }
            $organized['Uncategorized'][] = $post;
        } else {
            // Add to each category the post belongs to
            foreach ($categories as $category) {
                $cat_name = $category->name;
                if (!isset($organized[$cat_name])) {
                    $organized[$cat_name] = [];
                }
                $organized[$cat_name][] = $post;
            }
        }
    }
    
    // Sort category names alphabetically
    ksort($organized);
    
    // Sort posts within each category by date
    foreach ($organized as $category => $category_posts) {
        usort($category_posts, function($a, $b) {
            return strtotime($b->post_date) - strtotime($a->post_date);
        });
        $organized[$category] = $category_posts;
    }
    
    return $organized;
}

// Usage example
$recent_posts = get_posts([
    'numberposts' => 20,
    'post_status' => 'publish'
]);
$posts_by_category = organize_posts_by_category($recent_posts);</code></pre>
            </div>
        </section>

        <section class="file-system-functions">
            <h2>File System Functions: Reading, Writing, and Managing Files</h2>
            
            <p>PHP provides powerful functions for interacting with the file system, allowing you to read and write files, manage directories, and check file properties. These are particularly useful for theme and plugin development in WordPress.</p>
            
            <div class="example-box">
                <h3>Reading and Writing Files</h3>
                <pre><code>// Reading an entire file into a string
$content = file_get_contents('config.json');
echo $content;

// Reading a file line by line
$lines = file('log.txt', FILE_IGNORE_NEW_LINES | FILE_SKIP_EMPTY_LINES);
foreach ($lines as $line_num => $line) {
    echo "Line #{$line_num}: " . htmlspecialchars($line) . "<br>";
}

// Writing to a file (overwrites existing content)
file_put_contents('output.txt', 'Hello, WordPress!');

// Appending to a file
file_put_contents('log.txt', "New log entry: " . date('Y-m-d H:i:s') . "\n", FILE_APPEND);

// Using fopen for more control
$file = fopen('data.csv', 'r');
if ($file) {
    while (($data = fgetcsv($file, 1000, ',')) !== false) {
        // Process the CSV data
        print_r($data);
    }
    fclose($file);
}

// Writing with fopen
$file = fopen('newfile.txt', 'w');
if ($file) {
    fwrite($file, "Line 1\n");
    fwrite($file, "Line 2\n");
    fclose($file);
}</code></pre>
            </div>

            <div class="example-box">
                <h3>File and Directory Management</h3>
                <pre><code>// Check if a file exists
if (file_exists('wp-config.php')) {
    echo "WordPress configuration file found!";
}

// Get file information
$filesize = filesize('image.jpg'); // File size in bytes
$modification_time = filemtime('style.css'); // Last modified time
echo "Last modified: " . date('F d Y H:i:s', $modification_time);

// File permissions
$permissions = fileperms('wp-config.php');
echo substr(sprintf('%o', $permissions), -4); // e.g., 0644

// Directory operations
$files = scandir('wp-content/uploads/');
print_r($files); // Array of files and directories

// Create a directory
if (!file_exists('wp-content/cache')) {
    mkdir('wp-content/cache', 0755, true); // true enables recursive creation
}

// Delete a file
if (file_exists('temp.txt')) {
    unlink('temp.txt');
}

// Delete a directory (must be empty)
if (is_dir('old-backups')) {
    rmdir('old-backups');
}</code></pre>
            </div>

            <div class="wordpress-example">
                <h3>WordPress Log File Manager Example</h3>
                <pre><code>/**
 * Simple log manager for WordPress plugin/theme debugging
 */
class Simple_Log_Manager {
    private $log_dir;
    private $log_file;
    private $max_size = 1048576; // 1MB
    
    /**
     * Constructor
     */
    public function __construct() {
        // Create log directory in the uploads folder
        $upload_dir = wp_upload_dir();
        $this->log_dir = $upload_dir['basedir'] . '/logs';
        
        // Create directory if it doesn't exist
        if (!file_exists($this->log_dir)) {
            wp_mkdir_p($this->log_dir);
            
            // Create .htaccess to prevent direct access
            file_put_contents($this->log_dir . '/.htaccess', 'Deny from all');
        }
        
        // Set log file path
        $this->log_file = $this->log_dir . '/debug.log';
    }
    
    /**
     * Write a message to the log file
     */
    public function log($message, $level = 'info') {
        // Rotate log if it's too big
        $this->rotate_log_if_needed();
        
        // Format the log entry
        $time = date('Y-m-d H:i:s');
        $entry = "[$time] [$level] $message" . PHP_EOL;
        
        // Append to log file
        file_put_contents($this->log_file, $entry, FILE_APPEND);
    }
    
    /**
     * Rotate log file if it gets too large
     */
    private function rotate_log_if_needed() {
        if (file_exists($this->log_file) && filesize($this->log_file) > $this->max_size) {
            $backup_file = $this->log_dir . '/debug.' . date('Y-m-d-H-i-s') . '.log';
            rename($this->log_file, $backup_file);
        }
    }
    
    /**
     * Get all log files
     */
    public function get_log_files() {
        $files = scandir($this->log_dir);
        $log_files = [];
        
        foreach ($files as $file) {
            if (pathinfo($file, PATHINFO_EXTENSION) === 'log') {
                $log_files[] = [
                    'name' => $file,
                    'path' => $this->log_dir . '/' . $file,
                    'size' => filesize($this->log_dir . '/' . $file),
                    'modified' => filemtime($this->log_dir . '/' . $file)
                ];
            }
        }
        
        return $log_files;
    }
    
    /**
     * Delete a log file
     */
    public function delete_log($file) {
        $file_path = $this->log_dir . '/' . basename($file);
        
        if (file_exists($file_path) && is_file($file_path)) {
            return unlink($file_path);
        }
        
        return false;
    }
}

// Usage
$logger = new Simple_Log_Manager();
$logger->log('Plugin initialized successfully');
$logger->log('User login failed: incorrect password', 'error');

// Get list of log files
$log_files = $logger->get_log_files();</code></pre>
            </div>
            
            <div class="security-note">
                <h3>⚠️ Security Note: File System Operations</h3>
                <p>When working with file operations in WordPress, always:</p>
                <ul>
                    <li>Validate and sanitize any user-provided filenames or paths</li>
                    <li>Use WordPress functions like <code>wp_upload_dir()</code> to get safe paths</li>
                    <li>Check permissions before reading from or writing to files</li>
                    <li>Be cautious with functions like <code>file_get_contents()</code> when the URL might be user-provided</li>
                    <li>Consider using WordPress filesystem API for more secure file operations</li>
                </ul>
            </div>
        </section>

        <section class="date-time-functions">
            <h2>Date and Time Functions: Managing Temporal Data</h2>
            
            <p>PHP offers comprehensive functions for working with dates and times, essential for scheduling posts, managing events, calculating durations, and formatting dates in WordPress.</p>
            
            <div class="example-box">
                <h3>Basic Date and Time Functions</h3>
                <pre><code>// Get current time as Unix timestamp (seconds since Jan 1, 1970)
$now = time();
echo $now; // e.g., 1714542302

// Format a date
echo date('Y-m-d H:i:s', $now); // e.g., 2025-05-01 14:25:02
echo date('F j, Y g:i a'); // e.g., May 1, 2025 2:25 pm

// Common date formatting characters:
// Y - Four-digit year (2025)
// y - Two-digit year (25)
// m - Month with leading zeros (05)
// n - Month without leading zeros (5)
// F - Full month name (May)
// M - Three-letter month name (May)
// d - Day of month with leading zeros (01)
// j - Day of month without leading zeros (1)
// l - Full day of week name (Thursday)
// D - Three-letter day name (Thu)
// H - 24-hour format with leading zeros (14)
// h - 12-hour format with leading zeros (02)
// i - Minutes with leading zeros (25)
// s - Seconds with leading zeros (02)
// a - am/pm (pm)
// A - AM/PM (PM)

// Create a timestamp from a date string
$timestamp = strtotime('2025-06-15 10:30:00');
$timestamp = strtotime('+1 week'); // 1 week from now
$timestamp = strtotime('next Monday');
$timestamp = strtotime('last day of February 2025');

// Calculate time differences
$future = strtotime('+2 months');
$difference = $future - time();
echo "Seconds until event: $difference";
echo "Days until event: " . floor($difference / (60 * 60 * 24));</code></pre>
            </div>

            <div class="example-box">
                <h3>DateTime Object (PHP 5.2+)</h3>
                <pre><code>// Create a DateTime object
$date = new DateTime('2025-05-15 14:30:00');
$now = new DateTime(); // Current date and time

// Format a DateTime
echo $date->format('Y-m-d H:i:s'); // 2025-05-15 14:30:00

// Add or subtract time intervals
$date->add(new DateInterval('P2D')); // Add 2 days
$date->sub(new DateInterval('PT5H')); // Subtract 5 hours

// DateInterval format: P (period) followed by:
// nY - Years
// nM - Months
// nD - Days
// T (time) followed by:
// nH - Hours
// nM - Minutes
// nS - Seconds

// Example: P2Y6M5DT4H3M2S = 2 years, 6 months, 5 days, 4 hours, 3 minutes, 2 seconds

// Calculate difference between dates
$diff = $now->diff($date);
echo "Difference: " . $diff->format('%y years, %m months, %d days');

// Time zones
$london = new DateTime('now', new DateTimeZone('Europe/London'));
$newYork = new DateTime('now', new DateTimeZone('America/New_York'));
$tokyo = new DateTime('now', new DateTimeZone('Asia/Tokyo'));

echo "London: " . $london->format('H:i') . "<br>";
echo "New York: " . $newYork->format('H:i') . "<br>";
echo "Tokyo: " . $tokyo->format('H:i') . "<br>";</code></pre>
            </div>

            <div class="wordpress-example">
                <h3>WordPress Date and Time Example</h3>
                <pre><code>/**
 * Calculate and display event countdown
 * 
 * @param string $event_date Event date in Y-m-d H:i:s format
 * @param string $format Output format (full, days, hours)
 * @return string Formatted countdown
 */
function get_event_countdown($event_date, $format = 'full') {
    // Get timezone from WordPress settings
    $timezone_string = get_option('timezone_string');
    
    if (empty($timezone_string)) {
        // If no timezone string, use GMT offset
        $gmt_offset = get_option('gmt_offset');
        $timezone_string = $gmt_offset >= 0 ? "+$gmt_offset" : "$gmt_offset";
    }
    
    try {
        // Create DateTime objects
        $timezone = new DateTimeZone($timezone_string);
        $event = new DateTime($event_date, $timezone);
        $now = new DateTime('now', $timezone);
        
        // Get the difference
        $diff = $now->diff($event);
        
        // If event is in the past
        if ($now > $event) {
            return 'This event has already occurred.';
        }
        
        // Format based on requested output
        switch ($format) {
            case 'days':
                $total_days = $diff->days;
                return "$total_days " . _n('day', 'days', $total_days) . " remaining";
                
            case 'hours':
                $total_hours = ($diff->days * 24) + $diff->h;
                return "$total_hours " . _n('hour', 'hours', $total_hours) . " remaining";
                
            case 'countdown':
                return sprintf(
                    '%s days, %s hours, %s minutes, %s seconds',
                    $diff->d,
                    $diff->h,
                    $diff->i,
                    $diff->s
                );
                
            case 'full':
            default:
                if ($diff->y > 0) {
                    return sprintf(
                        '%s years, %s months, %s days remaining',
                        $diff->y,
                        $diff->m,
                        $diff->d
                    );
                } elseif ($diff->m > 0) {
                    return sprintf(
                        '%s months, %s days, %s hours remaining',
                        $diff->m,
                        $diff->d,
                        $diff->h
                    );
                } elseif ($diff->d > 0) {
                    return sprintf(
                        '%s days, %s hours, %s minutes remaining',
                        $diff->d,
                        $diff->h,
                        $diff->i
                    );
                } else {
                    return sprintf(
                        '%s hours, %s minutes, %s seconds remaining',
                        $diff->h,
                        $diff->i,
                        $diff->s
                    );
                }
        }
    } catch (Exception $e) {
        return 'Error calculating countdown.';
    }
}

// Usage examples
echo get_event_countdown('2025-12-31 23:59:59'); // Full format
echo get_event_countdown('2025-06-15 10:00:00', 'days'); // Days only
echo get_event_countdown('2025-05-01 09:30:00', 'countdown'); // Countdown format</code></pre>
            </div>
        </section>

        <section class="utility-functions">
            <h2>Utility Functions: Everyday Helpers</h2>
            
            <p>PHP provides a variety of utility functions that help with common tasks in web development, from URL handling to data validation.</p>
            
            <div class="example-box">
                <h3>URL and HTTP Functions</h3>
                <pre><code>// URL encoding/decoding
$original = "search term with spaces & special chars";
$encoded = urlencode($original);
echo $encoded; // search+term+with+spaces+%26+special+chars
$decoded = urldecode($encoded);
echo $decoded; // search term with spaces & special chars

// Parse a URL into components
$url = "https://user:pass@example.com:8080/path?query=value#fragment";
$parts = parse_url($url);
/*
Array (
    [scheme] => https
    [host] => example.com
    [user] => user
    [pass] => pass
    [port] => 8080
    [path] => /path
    [query] => query=value
    [fragment] => fragment
)
*/

// Parse query string
$query_string = "name=John&age=30&city=New+York";
parse_str($query_string, $params);
/*
$params = [
    'name' => 'John',
    'age' => '30',
    'city' => 'New York'
]
*/

// Build a query string
$data = [
    'action' => 'update',
    'id' => 42,
    'status' => 'published'
];
$query = http_build_query($data);
echo $query; // action=update&id=42&status=published</code></pre>
            </div>

            <div class="example-box">
                <h3>Data Validation and Sanitization</h3>
                <pre><code>// Check if a variable is of a specific type
var_dump(is_numeric('42')); // bool(true)
var_dump(is_string(42)); // bool(false)
var_dump(is_array([1, 2, 3])); // bool(true)
var_dump(is_null(null)); // bool(true)
var_dump(is_object(new stdClass())); // bool(true)

// Validate an email address
$email = "user@example.com";
if (filter_var($email, FILTER_VALIDATE_EMAIL)) {
    echo "Valid email format";
}

// Validate an IP address
$ip = "192.168.1.1";
if (filter_var($ip, FILTER_VALIDATE_IP)) {
    echo "Valid IP address";
}

// Sanitize input
$number = filter_var("42abc", FILTER_SANITIZE_NUMBER_INT); // "42"
$url = filter_var("https://example.com", FILTER_SANITIZE_URL);

// Type conversion
$int_val = intval("42"); // 42 (integer)
$float_val = floatval("3.14"); // 3.14 (float)
$str_val = strval(42); // "42" (string)

// Check if a value is empty
if (empty($var)) {
    echo "Variable is empty, null, false, 0, or not set";
}

// Serialize and unserialize data
$data = ['name' => 'John', 'age' => 30];
$serialized = serialize($data);
echo $serialized; // a:2:{s:4:"name";s:4:"John";s:3:"age";i:30;}
$unserialized = unserialize($serialized);
print_r($unserialized); // Original array</code></pre>
            </div>

            <div class="wordpress-example">
                <h3>WordPress Form Data Processor Example</h3>
                <pre><code>/**
 * Process and validate contact form submission
 * 
 * @return array Response with status and messages
 */
function process_contact_form() {
    $response = [
        'success' => false,
        'errors' => [],
        'data' => []
    ];
    
    // Check for nonce (security token)
    if (!isset($_POST['contact_nonce']) || !wp_verify_nonce($_POST['contact_nonce'], 'contact_form')) {
        $response['errors'][] = 'Security verification failed. Please try again.';
        return $response;
    }
    
    // Get and sanitize form data
    $name = isset($_POST['name']) ? sanitize_text_field($_POST['name']) : '';
    $email = isset($_POST['email']) ? sanitize_email($_POST['email']) : '';
    $subject = isset($_POST['subject']) ? sanitize_text_field($_POST['subject']) : '';
    $message = isset($_POST['message']) ? sanitize_textarea_field($_POST['message']) : '';
    
    // Validate required fields
    if (empty($name)) {
        $response['errors'][] = 'Name is required.';
    }
    
    if (empty($email)) {
        $response['errors'][] = 'Email is required.';
    } elseif (!is_email($email)) {
        $response['errors'][] = 'Please enter a valid email address.';
    }
    
    if (empty($subject)) {
        $response['errors'][] = 'Subject is required.';
    }
    
    if (empty($message)) {
        $response['errors'][] = 'Message is required.';
    }
    
    // If there are errors, return early
    if (!empty($response['errors'])) {
        return $response;
    }
    
    // Store the form submission (example)
    $submission_data = [
        'name' => $name,
        'email' => $email,
        'subject' => $subject,
        'message' => $message,
        'ip' => $_SERVER['REMOTE_ADDR'],
        'date' => current_time('mysql'),
        'user_agent' => $_SERVER['HTTP_USER_AGENT']
    ];
    
    // Insert into database using WordPress functions
    global $wpdb;
    $table_name = $wpdb->prefix . 'contact_submissions';
    
    $insert_result = $wpdb->insert(
        $table_name,
        $submission_data,
        ['%s', '%s', '%s', '%s', '%s', '%s', '%s'] // All strings
    );
    
    if ($insert_result === false) {
        $response['errors'][] = 'Failed to save your message. Please try again later.';
        return $response;
    }
    
    // Send email notification
    $to = get_option('admin_email');
    $headers = ['Content-Type: text/html; charset=UTF-8'];
    
    $email_message = "
        <p><strong>Name:</strong> {$name}</p>
        <p><strong>Email:</strong> {$email}</p>
        <p><strong>Subject:</strong> {$subject}</p>
        <p><strong>Message:</strong></p>
        <p>" . nl2br($message) . "</p>
    ";
    
    $mail_sent = wp_mail($to, "New Contact Form Submission: {$subject}", $email_message, $headers);
    
    // Success!
    $response['success'] = true;
    $response['data'] = [
        'submission_id' => $wpdb->insert_id,
        'email_sent' => $mail_sent
    ];
    
    return $response;
}</code></pre>
            </div>
        </section>

        <section class="math-functions">
            <h2>Math and Number Functions: Calculations Made Simple</h2>
            
            <p>PHP provides many mathematical functions for performing calculations, generating random numbers, and formatting numeric output.</p>
            
            <div class="example-box">
                <h3>Basic Math Functions</h3>
                <pre><code>// Basic operations
echo abs(-42); // 42 (absolute value)
echo round(3.7); // 4
echo floor(3.7); // 3
echo ceil(3.2); // 4

// Rounding with precision
echo round(3.14159, 2); // 3.14
echo round(1234.5678, -2); // 1200 (round to hundreds)

// Min and max
echo min(5, 8, 2, 10); // 2
echo max(5, 8, 2, 10); // 10

// Power and square root
echo pow(2, 3); // 8 (2^3)
echo sqrt(16); // 4

// Random numbers
echo rand(); // Random number
echo rand(1, 100); // Random number between 1 and 100

// More secure random numbers (PHP 7+)
echo random_int(1, 100); // Cryptographically secure random number

// Mathematical constants
echo M_PI; // 3.14159...
echo M_E; // 2.71828... (Euler's number)</code></pre>
            </div>

            <div class="example-box">
                <h3>Number Formatting</h3>
                <pre><code>// Format a number with thousands separator
echo number_format(1234567); // 1,234,567
echo number_format(1234567.89, 2); // 1,234,567.89
echo number_format(1234567.89, 2, ',', ' '); // 1 234 567,89

// Format as money
function format_money($amount, $currency = '$') {
    return $currency . number_format($amount, 2);
}
echo format_money(42.5); // $42.50
echo format_money(1234.56, '€'); // €1,234.56

// Format percentages
function format_percentage($value, $precision = 1) {
    return number_format($value * 100, $precision) . '%';
}
echo format_percentage(0.12345); // 12.3%</code></pre>
            </div>

            <div class="wordpress-example">
                <h3>WordPress Product Pricing Calculator Example</h3>
                <pre><code>/**
 * Calculate product pricing with tax and discounts
 * 
 * @param float $base_price Base product price
 * @param array $options Options with pricing adjustments
 * @param float $tax_rate Tax rate (e.g., 0.06 for 6%)
 * @param float $discount Discount amount or percentage
 * @param bool $discount_is_percentage Whether discount is a percentage
 * @return array Detailed price breakdown
 */
function calculate_product_price($base_price, $options = [], $tax_rate = 0, $discount = 0, $discount_is_percentage = true) {
    // Initialize result array
    $result = [
        'base_price' => $base_price,
        'options_total' => 0,
        'subtotal' => 0,
        'discount_amount' => 0,
        'pre_tax_total' => 0,
        'tax_amount' => 0,
        'total' => 0,
        'formatted' => []
    ];
    
    // Calculate options total
    foreach ($options as $option) {
        $option_price = isset($option['price']) ? floatval($option['price']) : 0;
        $result['options_total'] += $option_price;
    }
    
    // Calculate subtotal (base price + options)
    $result['subtotal'] = $result['base_price'] + $result['options_total'];
    
    // Calculate discount
    if ($discount > 0) {
        if ($discount_is_percentage) {
            // Ensure percentage is between 0 and 100
            $discount = min(100, max(0, $discount));
            $result['discount_amount'] = $result['subtotal'] * ($discount / 100);
        } else {
            // Fixed discount cannot be more than the subtotal
            $result['discount_amount'] = min($result['subtotal'], $discount);
        }
    }
    
    // Calculate pre-tax total
    $result['pre_tax_total'] = $result['subtotal'] - $result['discount_amount'];
    
    // Calculate tax if applicable
    if ($tax_rate > 0) {
        $result['tax_amount'] = $result['pre_tax_total'] * $tax_rate;
    }
    
    // Calculate final total
    $result['total'] = $result['pre_tax_total'] + $result['tax_amount'];
    
    // Format all currency values
    $result['formatted'] = [
        'base_price' => number_format($result['base_price'], 2),
        'options_total' => number_format($result['options_total'], 2),
        'subtotal' => number_format($result['subtotal'], 2),
        'discount_amount' => number_format($result['discount_amount'], 2),
        'pre_tax_total' => number_format($result['pre_tax_total'], 2),
        'tax_amount' => number_format($result['tax_amount'], 2),
        'total' => number_format($result['total'], 2)
    ];
    
    return $result;
}

// Example usage
$price_data = calculate_product_price(
    29.99, // Base price
    [
        ['name' => 'Extra Memory', 'price' => 10.00],
        ['name' => 'Extended Warranty', 'price' => 15.00]
    ],
    0.06, // 6% tax rate
    10,   // 10% discount
    true  // Discount is a percentage
);

// Output price breakdown
echo "Base price: $" . $price_data['formatted']['base_price'] . "<br>";
echo "Options: $" . $price_data['formatted']['options_total'] . "<br>";
echo "Subtotal: $" . $price_data['formatted']['subtotal'] . "<br>";
echo "Discount: -$" . $price_data['formatted']['discount_amount'] . "<br>";
echo "Pre-tax total: $" . $price_data['formatted']['pre_tax_total'] . "<br>";
echo "Tax: $" . $price_data['formatted']['tax_amount'] . "<br>";
echo "Total: $" . $price_data['formatted']['total'] . "<br>";</code></pre>
            </div>
        </section>

        <section class="finding-functions">
            <h2>Finding the Right Function</h2>
            
            <p>With over 1,000 built-in functions in PHP, finding the right one for your task can be challenging. Here are some strategies to help you discover useful functions:</p>
            
            <div class="mermaid-diagram">
                <div class="mermaid">
                    graph TD
                    A[How to Find PHP Functions] --> B[Official PHP Documentation]
                    A --> C[Function by Category]
                    A --> D[Function Search]
                    A --> E[Predictable Naming]
                    
                    B --> B1[php.net/manual/en/funcref.php]
                    
                    C --> C1[String - str_*]
                    C --> C2[Array - array_*]
                    C --> C3[File - file_*]
                    
                    D --> D1[php.net/function_name]
                    D --> D2[Search engines]
                    
                    E --> E1[Consistent prefixes]
                    E --> E2[Common verbs: get, set, is, has]
                    
                    style A fill:#f9f,stroke:#333,stroke-width:2px
                </div>
            </div>
            
            <div class="tips-box">
                <h3>Function Finding Tips</h3>
                <ul>
                    <li><strong>Use the Function Reference:</strong> Browse the PHP manual's function reference, organized by category</li>
                    <li><strong>Learn Common Prefixes:</strong> Functions are often grouped by prefixes like <code>str_</code> (strings), <code>array_</code> (arrays), etc.</li>
                    <li><strong>Search for What You Need:</strong> Search phrases like "PHP convert string to lowercase" to find relevant functions</li>
                    <li><strong>Check Related Functions:</strong> When you find a useful function, look at the "See Also" section for related functions</li>
                    <li><strong>Read User Comments:</strong> The PHP manual's user-contributed notes often contain valuable examples and alternatives</li>
                    <li><strong>Explore WordPress-Specific Functions:</strong> The WordPress Developer Handbook lists many WordPress-specific functions</li>
                </ul>
            </div>
            
            <div class="example-box">
                <h3>Common Function Naming Patterns</h3>
                <pre><code>// String functions
str_replace()     // Replace text in a string
strlen()          // Get string length
strtolower()      // Convert string to lowercase

// Array functions
array_push()      // Add items to an array
array_merge()     // Combine arrays
array_filter()    // Filter array elements

// File functions
file_exists()     // Check if file exists
file_get_contents() // Read file into a string
file_put_contents() // Write string to a file

// Math functions
round()           // Round a number
rand()            // Generate a random number
max()             // Find the highest value

// Type checking
is_array()        // Check if variable is an array
is_string()       // Check if variable is a string
is_numeric()      // Check if variable is a number</code></pre>
            </div>
        </section>

        <section class="best-practices">
            <h2>Best Practices for Using Built-in Functions</h2>
            
            <div class="best-practices-list">
                <h3>Do's and Don'ts</h3>
                <table>
                    <tr>
                        <th>Do ✅</th>
                        <th>Don't ❌</th>
                    </tr>
                    <tr>
                        <td>Check function return values for errors</td>
                        <td>Assume functions always succeed</td>
                    </tr>
                    <tr>
                        <td>Understand what functions return when they fail</td>
                        <td>Use functions without checking the documentation first</td>
                    </tr>
                    <tr>
                        <td>Use type-specific functions when possible</td>
                        <td>Reinvent built-in functionality with custom code</td>
                    </tr>
                    <tr>
                        <td>Sanitize and validate all inputs</td>
                        <td>Pass raw user input directly to functions</td>
                    </tr>
                    <tr>
                        <td>Use WordPress wrappers when available</td>
                        <td>Ignore WordPress's built-in function alternatives</td>
                    </tr>
                </table>
            </div>
            
            <div class="example-box">
                <h3>Error Handling with Built-in Functions</h3>
                <pre><code>// Bad: No error checking
$content = file_get_contents('config.json');
$config = json_decode($content);
// What if the file doesn't exist or isn't valid JSON?

// Good: Check for errors at each step
if (file_exists('config.json')) {
    $content = file_get_contents('config.json');
    if ($content !== false) {
        $config = json_decode($content);
        if (json_last_error() === JSON_ERROR_NONE) {
            // Now we can safely use $config
        } else {
            echo "JSON error: " . json_last_error_msg();
        }
    } else {
        echo "Could not read file contents";
    }
} else {
    echo "Config file does not exist";
}</code></pre>
            </div>
            
            <div class="example-box">
                <h3>Using WordPress Wrapper Functions</h3>
                <pre><code>// Instead of direct PHP file functions:
// file_get_contents(), file_put_contents(), etc.

// Use WordPress file system API:
global $wp_filesystem;
if (empty($wp_filesystem)) {
    require_once ABSPATH . '/wp-admin/includes/file.php';
    WP_Filesystem();
}

// Reading a file
$content = $wp_filesystem->get_contents('my-file.txt');

// Writing to a file
$wp_filesystem->put_contents('my-file.txt', 'New content', FS_CHMOD_FILE);

// Instead of direct PHP mail():
// mail($to, $subject, $message, $headers);

// Use WordPress mail function:
wp_mail($to, $subject, $message, $headers, $attachments);

// Instead of PHP's date/time functions:
// date(), time(), strtotime()

// Use WordPress time functions:
$date = current_time('mysql'); // Current time in WordPress timezone
$timestamp = current_time('timestamp'); // Current timestamp in WordPress timezone</code></pre>
            </div>
        </section>

        <section class="practice-exercises">
            <h2>Practice Exercises</h2>
            
            <div class="exercise">
                <h3>Exercise 1: String Manipulation</h3>
                <p>Create a function that takes a blog post title and returns a slug version (lowercase, hyphens instead of spaces, no special characters) using PHP's built-in string functions. Test it with various titles, including ones with special characters and different cases.</p>
            </div>
            
            <div class="exercise">
                <h3>Exercise 2: Array Processing</h3>
                <p>Write a function that takes an array of WordPress post objects and returns an organized array with the following:</p>
                <ul>
                    <li>Posts grouped by year and month of publication</li>
                    <li>Each group sorted by comment count (highest to lowest)</li>
                    <li>Only the title, date, and comment count for each post</li>
                </ul>
                <p>Use PHP's array functions to accomplish this task efficiently.</p>
            </div>
            
            <div class="exercise">
                <h3>Exercise 3: Date Calculator</h3>
                <p>Create a "publishing schedule" function that:</p>
                <ul>
                    <li>Takes a start date and the number of posts to schedule</li>
                    <li>Generates dates for each post, publishing on Mondays, Wednesdays, and Fridays only</li>
                    <li>Returns an array of formatted dates for each post</li>
                </ul>
                <p>Use PHP's date and time functions to handle the calendar calculations.</p>
            </div>
        </section>

        <section class="further-reading">
            <h2>Further Reading</h2>
            
            <ul>
                <li><a href="https://www.php.net/manual/en/funcref.php">PHP Function Reference</a></li>
                <li><a href="https://developer.wordpress.org/reference/">WordPress Function Reference</a></li>
                <li><a href="https://php.net/manual/en/reserved.variables.php">PHP Predefined Variables</a></li>
                <li><a href="https://www.php.net/manual/en/refs.calendar.php">PHP Date and Time Functions</a></li>
                <li><a href="https://www.php.net/manual/en/book.strings.php">PHP String Functions</a></li>
            </ul>
        </section>

        <section class="module-completion">
            <h2>Module Completion</h2>
            
            <p>Congratulations! You've completed our series on PHP Functions. Let's review what we've covered:</p>
            
            <div class="module-summary">
                <ul>
                    <li>Function declaration and calling</li>
                    <li>Function parameters and return values</li>
                    <li>Default parameter values</li>
                    <li>Variable scope</li>
                    <li>Anonymous functions and closures</li>
                    <li>Built-in PHP functions</li>
                </ul>
            </div>
            
            <p>With this foundation in PHP functions, you're well-equipped to move on to our next module on Database Development with MySQL, where you'll learn how to interact with databases using PHP.</p>
            
            <div class="next-module-preview">
                <h3>Coming Up Next: Database Development with MySQL</h3>
                <ul>
                    <li>Database design principles</li>
                    <li>SQL fundamentals</li>
                    <li>Connecting to MySQL with PHP</li>
                    <li>CRUD operations (Create, Read, Update, Delete)</li>
                    <li>Preparing and executing SQL queries</li>
                    <li>Working with the WordPress database</li>
                </ul>
            </div>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2025 PHP WordPress Development Course</p>

    </footer>
</body>
</html>
