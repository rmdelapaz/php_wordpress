<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 2: DOM Manipulation with jQuery</title>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="icon" href="/favicon.png">
    <script type="module">
      import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
      mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <header>
        <h1>DOM Manipulation with jQuery</h1>
        <p><a href="index.html">‚Üê Back to Syllabus</a></p>
    </header>
    
    <main>
        <section class="lecture_intro">
            <h2>Session Overview</h2>
            <p>Welcome to our deep dive into DOM manipulation with jQuery! Today's session focuses on how jQuery simplifies interacting with the Document Object Model (DOM). By the end of this session, you'll understand how to efficiently select, traverse, modify, and create HTML elements using jQuery ‚Äî skills that are essential for WordPress theme and plugin development.</p>
            
            <div class="overview_diagram">
                <div class="mermaid">
                flowchart TB
                    A[DOM Manipulation with jQuery]
                    A --> B[Selection]
                    A --> C[Traversal]
                    A --> D[Modification]
                    A --> E[Creation]
                    A --> F[Insertion]
                    A --> G[Deletion]
                    B --> B1[Basic Selectors]
                    B --> B2[Filter Methods]
                    B --> B3[Form Selectors]
                    C --> C1[Parents & Ancestors]
                    C --> C2[Children & Descendants]
                    C --> C3[Siblings]
                    C --> C4[Filtering]
                    D --> D1[Content Manipulation]
                    D --> D2[Attribute Manipulation]
                    D --> D3[Class Manipulation]
                    D --> D4[CSS Manipulation]
                    E --> E1[Creating Elements]
                    E --> E2[Cloning Elements]
                    F --> F1[Inside Existing Elements]
                    F --> F2[Outside Existing Elements]
                    G --> G1[Removing Elements]
                    G --> G2[Emptying Elements]
                </div>
            </div>
        </section>

        <section class="understanding_dom">
            <h2>Understanding the DOM</h2>
            <p>Before we dive into jQuery's DOM manipulation methods, let's refresh our understanding of what the DOM actually is.</p>
            
            <h3>What is the DOM?</h3>
            <p>The Document Object Model (DOM) is a programming interface that represents HTML documents as tree structures. Each element in an HTML document (paragraphs, divs, spans, etc.) becomes a node in this tree. The DOM provides a way for scripts to access and modify the structure, content, and style of a document.</p>
            
            <div class="analogy">
                <h3>The Family Tree Analogy</h3>
                <p>Think of the DOM as a family tree. The document is the oldest ancestor, with children (html, head, body) who themselves have children (divs, paragraphs), and so on. Each family member (node) has characteristics (attributes) and can have relationships with other family members (parent-child, siblings). jQuery provides easy ways to navigate this family tree and modify its members.</p>
                
                <svg viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- DOM Tree Visualization -->
                    <rect x="250" y="20" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="300" y="40" text-anchor="middle" font-size="14">document</text>
                    
                    <line x1="300" y1="50" x2="300" y2="70" stroke="#333" />
                    
                    <rect x="250" y="70" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="300" y="90" text-anchor="middle" font-size="14">html</text>
                    
                    <line x1="300" y1="100" x2="200" y2="120" stroke="#333" />
                    <line x1="300" y1="100" x2="400" y2="120" stroke="#333" />
                    
                    <rect x="150" y="120" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="200" y="140" text-anchor="middle" font-size="14">head</text>
                    
                    <rect x="350" y="120" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="400" y="140" text-anchor="middle" font-size="14">body</text>
                    
                    <line x1="200" y1="150" x2="200" y2="170" stroke="#333" />
                    <line x1="400" y1="150" x2="300" y2="170" stroke="#333" />
                    <line x1="400" y1="150" x2="500" y2="170" stroke="#333" />
                    
                    <rect x="150" y="170" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="200" y="190" text-anchor="middle" font-size="14">title</text>
                    
                    <rect x="250" y="170" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="300" y="190" text-anchor="middle" font-size="14">div</text>
                    
                    <rect x="450" y="170" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="500" y="190" text-anchor="middle" font-size="14">script</text>
                    
                    <line x1="300" y1="200" x2="250" y2="220" stroke="#333" />
                    <line x1="300" y1="200" x2="350" y2="220" stroke="#333" />
                    
                    <rect x="200" y="220" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="250" y="240" text-anchor="middle" font-size="14">p</text>
                    
                    <rect x="300" y="220" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="350" y="240" text-anchor="middle" font-size="14">a</text>
                    
                    <line x1="250" y1="250" x2="250" y2="270" stroke="#333" />
                    
                    <rect x="200" y="270" width="100" height="30" rx="5" fill="#f5f5f5" stroke="#333" />
                    <text x="250" y="290" text-anchor="middle" font-size="14">text</text>
                </svg>
            </div>
            
            <h3>Why Use jQuery for DOM Manipulation?</h3>
            <p>While modern JavaScript has improved its DOM manipulation capabilities, jQuery still offers significant advantages, especially in WordPress development:</p>
            <ul>
                <li><strong>Concise syntax:</strong> jQuery methods are shorter and more readable than vanilla JavaScript equivalents</li>
                <li><strong>Cross-browser compatibility:</strong> jQuery handles browser differences that might still exist</li>
                <li><strong>Method chaining:</strong> Perform multiple operations on the same selection with a fluent interface</li>
                <li><strong>WordPress integration:</strong> WordPress core uses jQuery extensively, making it a natural fit</li>
                <li><strong>Plugin ecosystem:</strong> Take advantage of thousands of jQuery plugins that extend functionality</li>
            </ul>
        </section>

        <section class="element_selection">
            <h2>Selecting Elements with jQuery</h2>
            <p>The foundation of DOM manipulation with jQuery is element selection. jQuery makes it easy to find exactly the elements you want to work with.</p>
            
            <h3>Basic Selectors</h3>
            <p>jQuery uses CSS-style selectors to find elements in the DOM:</p>
            
            <div class="code_example">
                <pre><code>// Select by ID
$("#header") // Finds the element with id="header"

// Select by class
$(".nav-item") // Finds all elements with class="nav-item"

// Select by tag name
$("p") // Finds all paragraph elements

// Combined selectors
$("ul.menu li") // Finds all list items inside ul with class="menu"

// Multiple selectors (comma-separated)
$("h1, h2, h3") // Finds all h1, h2, and h3 elements

// Attribute selectors
$("a[target='_blank']") // Finds links that open in new tabs
$("input[type='checkbox']") // Finds checkbox inputs
$("img[alt]") // Finds images with alt attributes

// Pseudo-class selectors
$("tr:odd") // Finds odd-numbered table rows
$("li:first-child") // Finds list items that are first children
$("div:visible") // Finds visible divs</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World WordPress Example: Customizing Admin Elements</h3>
                <p>Here's how you might use jQuery selectors to customize the WordPress admin interface:</p>
                
                <pre><code>jQuery(document).ready(function($) {
    // Hide specific metaboxes on the post edit screen
    $("#postexcerpt, #slugdiv").hide();
    
    // Add a class to all required form fields
    $(".form-required").addClass("highlighted-field");
    
    // Find all external links in the dashboard
    $(".wp-admin a[href^='http']:not([href*='"+window.location.hostname+"'])").addClass("external-link");
    
    // Style the first item in each admin menu
    $(".wp-admin-bar-root-default > li:first-child").css("background-color", "#f0f0f0");
});</code></pre>
            </div>
            
            <h3>Form-Specific Selectors</h3>
            <p>jQuery provides special selectors for working with forms:</p>
            
            <div class="code_example">
                <pre><code>// Form element selectors
$(":input") // All form elements (input, select, textarea, button)
$(":text") // Text inputs
$(":password") // Password inputs
$(":radio") // Radio buttons
$(":checkbox") // Checkboxes
$(":submit") // Submit buttons
$(":button") // Button elements
$(":file") // File inputs

// Form state selectors
$(":enabled") // Enabled form elements
$(":disabled") // Disabled form elements
$(":checked") // Checked radio buttons and checkboxes
$(":selected") // Selected options in select elements</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World Example: Form Validation in WordPress</h3>
                <p>Here's how you might use these form selectors in a WordPress form validation scenario:</p>
                
                <pre><code>jQuery(document).ready(function($) {
    // When the form is submitted
    $("#user-profile-form").on("submit", function(e) {
        // Reset previous errors
        $(".error-message").remove();
        
        // Check if required fields are empty
        $(this).find("input.required:text").each(function() {
            if ($(this).val() === "") {
                e.preventDefault(); // Stop form submission
                $(this).after("&lt;span class='error-message'&gt;This field is required&lt;/span&gt;");
            }
        });
        
        // Check if at least one checkbox is checked
        if ($(this).find("input:checkbox:checked").length === 0) {
            e.preventDefault();
            $("#checkbox-group").after("&lt;span class='error-message'&gt;Please select at least one option&lt;/span&gt;");
        }
        
        // Validate email format
        let $email = $(this).find("input[type='email']");
        let emailPattern = /^[^@]+@[^@]+\.[a-z]{2,}$/i;
        
        if ($email.length && !emailPattern.test($email.val())) {
            e.preventDefault();
            $email.after("&lt;span class='error-message'&gt;Please enter a valid email address&lt;/span&gt;");
        }
    });
});</code></pre>
            </div>
        </section>

        <section class="traversing_dom">
            <h2>Traversing the DOM</h2>
            <p>Once you've selected elements, jQuery provides powerful methods to navigate through the DOM tree to find related elements.</p>
            
            <h3>Parent and Ancestor Methods</h3>
            <div class="code_example">
                <pre><code>// Get the direct parent
let $parent = $("#child-element").parent();

// Get all ancestors
let $ancestors = $("#child-element").parents();

// Get specific ancestors
let $specificAncestors = $("#child-element").parents("div.container");

// Get ancestors until a specific element
let $limitedAncestors = $("#child-element").parentsUntil(".stop-here");

// Get closest ancestor matching a selector
let $closest = $("#child-element").closest(".wrapper");</code></pre>
            </div>
            
            <h3>Child and Descendant Methods</h3>
            <div class="code_example">
                <pre><code>// Get all children
let $children = $("#parent-element").children();

// Get specific children
let $specificChildren = $("#parent-element").children(".highlighted");

// Get all descendants matching a selector
let $descendants = $("#parent-element").find("a");

// Get contents (including text nodes)
let $contents = $("#parent-element").contents();</code></pre>
            </div>
            
            <h3>Sibling Methods</h3>
            <div class="code_example">
                <pre><code>// Get all siblings
let $siblings = $("#middle-element").siblings();

// Get specific siblings
let $specificSiblings = $("#middle-element").siblings(".important");

// Get next sibling
let $next = $("#first-element").next();

// Get all next siblings
let $allNext = $("#first-element").nextAll();

// Get next siblings until a match
let $nextUntil = $("#first-element").nextUntil(".stop-here");

// Get previous sibling
let $prev = $("#last-element").prev();

// Get all previous siblings
let $allPrev = $("#last-element").prevAll();

// Get previous siblings until a match
let $prevUntil = $("#last-element").prevUntil(".stop-here");</code></pre>
            </div>
            
            <h3>Filtering Methods</h3>
            <div class="code_example">
                <pre><code>// Filter a selection based on a selector
let $filtered = $("li").filter(".active");

// Filter using a function
let $evenItems = $("li").filter(function(index) {
    return index % 2 === 0;
});

// Get first item in a selection
let $first = $("li").first();

// Get last item in a selection
let $last = $("li").last();

// Get item at a specific index
let $third = $("li").eq(2); // Zero-based index (3rd item)

// Get items greater than an index
let $afterThird = $("li").gt(2);

// Get items less than an index
let $beforeFourth = $("li").lt(3);

// Not selector (elements that don't match)
let $notHidden = $("div").not(".hidden");</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World Example: WordPress Menu Enhancement</h3>
                <p>Here's how you might use traversal methods to enhance a WordPress navigation menu:</p>
                
                <pre><code>jQuery(document).ready(function($) {
    // Add a dropdown icon to menu items with children
    $(".menu-item-has-children").each(function() {
        $(this).children("a").first().append("&lt;span class='dropdown-icon'&gt;‚ñº&lt;/span&gt;");
    });
    
    // When a parent menu item is clicked
    $(".menu-item-has-children > a").on("click", function(e) {
        e.preventDefault();
        
        // Toggle the submenu
        $(this).siblings(".sub-menu").slideToggle();
        
        // Toggle the dropdown icon
        $(this).find(".dropdown-icon").toggleClass("open");
        
        // Close other open submenus
        $(this).closest("li").siblings().find(".sub-menu").slideUp();
        $(this).closest("li").siblings().find(".dropdown-icon").removeClass("open");
    });
    
    // Add active class to current menu item and its ancestors
    $(".current-menu-item")
        .addClass("highlighted")
        .parents(".menu-item").addClass("ancestor-active");
});</code></pre>
            </div>
            
            <div class="analogy">
                <h3>The GPS Navigation Analogy</h3>
                <p>Think of DOM traversal like using a GPS navigation system. You start at a specific location (your selected element) and can then navigate in different directions: up to parents/ancestors, down to children/descendants, or sideways to siblings. Each traversal method is like inputting a different direction on your GPS, taking you to related elements in the DOM tree.</p>
                
                <svg viewBox="0 0 600 300" xmlns="http://www.w3.org/2000/svg">
                    <!-- GPS Navigation Analogy -->
                    <rect x="250" y="120" width="100" height="60" rx="5" fill="#ffcc00" stroke="#333" stroke-width="2"/>
                    <text x="300" y="155" text-anchor="middle" font-size="14" font-weight="bold">Current Element</text>
                    
                    <!-- Parent/Ancestor Direction -->
                    <path d="M300,120 L300,80 L280,90 M300,80 L320,90" fill="none" stroke="#007bff" stroke-width="2"/>
                    <text x="300" y="60" text-anchor="middle" font-size="12" fill="#007bff">.parent()</text>
                    <text x="300" y="45" text-anchor="middle" font-size="12" fill="#007bff">.parents()</text>
                    
                    <!-- Children/Descendants Direction -->
                    <path d="M300,180 L300,220 L280,210 M300,220 L320,210" fill="none" stroke="#28a745" stroke-width="2"/>
                    <text x="300" y="240" text-anchor="middle" font-size="12" fill="#28a745">.children()</text>
                    <text x="300" y="255" text-anchor="middle" font-size="12" fill="#28a745">.find()</text>
                    
                    <!-- Previous Siblings Direction -->
                    <path d="M250,150 L210,150 L220,130 M210,150 L220,170" fill="none" stroke="#dc3545" stroke-width="2"/>
                    <text x="180" y="140" text-anchor="middle" font-size="12" fill="#dc3545">.prev()</text>
                    <text x="180" y="155" text-anchor="middle" font-size="12" fill="#dc3545">.prevAll()</text>
                    
                    <!-- Next Siblings Direction -->
                    <path d="M350,150 L390,150 L380,130 M390,150 L380,170" fill="none" stroke="#6f42c1" stroke-width="2"/>
                    <text x="420" y="140" text-anchor="middle" font-size="12" fill="#6f42c1">.next()</text>
                    <text x="420" y="155" text-anchor="middle" font-size="12" fill="#6f42c1">.nextAll()</text>
                </svg>
            </div>
        </section>

        <section class="modifying_dom">
            <h2>Modifying Elements</h2>
            <p>jQuery provides a rich set of methods for modifying existing elements in the DOM.</p>
            
            <h3>Getting and Setting Content</h3>
            <div class="code_example">
                <pre><code>// Get text content (without HTML)
let headerText = $("#header").text();

// Set text content
$("#header").text("New Header Text");

// Get HTML content (including tags)
let contentHTML = $("#content").html();

// Set HTML content
$("#content").html("&lt;strong&gt;New content&lt;/strong&gt; with &lt;em&gt;emphasis&lt;/em&gt;");

// Get value of form elements
let username = $("input[name='username']").val();

// Set value of form elements
$("input[name='username']").val("JohnDoe");</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World Example: WordPress Post Editor Enhancement</h3>
                <p>Here's how you might use content manipulation in a WordPress admin customization:</p>
                
                <pre><code>jQuery(document).ready(function($) {
    // Add a character counter below the title field
    $("#title").after("&lt;div id='title-counter'&gt;Characters: 0&lt;/div&gt;");
    
    // Update the counter when typing
    $("#title").on("input", function() {
        let count = $(this).val().length;
        $("#title-counter").text("Characters: " + count);
        
        // Add warning class if too long
        if (count > 60) {
            $("#title-counter").addClass("warning");
        } else {
            $("#title-counter").removeClass("warning");
        }
    });
    
    // Add template content to empty editor
    if ($("#content").text() === "") {
        if ($("#post_type").val() === "product") {
            // For product post type
            $("#content").html("&lt;h2&gt;Product Description&lt;/h2&gt;\n&lt;p&gt;Enter product details here...&lt;/p&gt;\n\n&lt;h2&gt;Features&lt;/h2&gt;\n&lt;ul&gt;\n  &lt;li&gt;Feature 1&lt;/li&gt;\n  &lt;li&gt;Feature 2&lt;/li&gt;\n&lt;/ul&gt;");
        } else {
            // For regular posts
            $("#content").html("&lt;p&gt;Enter your content here...&lt;/p&gt;");
        }
    }
});</code></pre>
            </div>
            
            <h3>Working with Attributes</h3>
            <div class="code_example">
                <pre><code>// Get an attribute
let linkURL = $("a.main-link").attr("href");

// Set an attribute
$("a.main-link").attr("href", "https://example.com");

// Set multiple attributes
$("img.profile").attr({
    src: "profile.jpg",
    alt: "Profile picture",
    width: 100,
    height: 100
});

// Remove an attribute
$("a.temp-link").removeAttr("href");

// Check if has attribute
if ($("img").is("[alt]")) {
    console.log("Image has alt attribute");
}

// Setting boolean attributes
$("input[type='checkbox']").prop("checked", true); // Check a checkbox
$("select option").prop("selected", false); // Deselect all options
$("button").prop("disabled", true); // Disable a button

// Toggle boolean attributes
$("input").prop("readonly", function(i, currentValue) {
    return !currentValue;
});</code></pre>
            </div>
            
            <h3>Managing CSS Classes</h3>
            <div class="code_example">
                <pre><code>// Add a class
$("nav li").addClass("active");

// Add multiple classes
$("div.content").addClass("highlighted bordered");

// Add classes conditionally
$("tr").addClass(function(index) {
    return index % 2 === 0 ? "even" : "odd";
});

// Remove a class
$("nav li.old-item").removeClass("old-item");

// Remove multiple classes
$("div").removeClass("temporary highlighted");

// Toggle a class (add if not present, remove if present)
$(".accordion-item").toggleClass("expanded");

// Toggle multiple classes
$("p").toggleClass("highlighted bordered");

// Toggle class based on condition
$("li").toggleClass("active", $(this).index() < 3);

// Check if element has a class
if ($("#signup-btn").hasClass("disabled")) {
    // Do something
}</code></pre>
            </div>
            
            <h3>Manipulating CSS Styles</h3>
            <div class="code_example">
                <pre><code>// Get a CSS property
let bgColor = $("#header").css("background-color");

// Set a CSS property
$("#header").css("background-color", "#f0f0f0");

// Set multiple CSS properties
$(".highlight").css({
    backgroundColor: "#ffff00",
    fontWeight: "bold",
    padding: "5px",
    borderRadius: "3px"
});

// Set property with calculation
$("div").css("width", function(index, currentWidth) {
    // Convert currentWidth from "100px" to 100
    return parseInt(currentWidth) + 50 + "px";
});

// Get computed dimensions
let width = $("#element").width(); // Content width
let innerWidth = $("#element").innerWidth(); // Content + padding
let outerWidth = $("#element").outerWidth(); // Content + padding + border
let outerWidthWithMargin = $("#element").outerWidth(true); // Content + padding + border + margin

// Set dimensions
$("#element").width(500);
$("#element").height(300);</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World Example: WordPress Theme Customizer Preview</h3>
                <p>Here's how you might use class and style manipulation for a live theme preview:</p>
                
                <pre><code>// In the WordPress Customizer
jQuery(document).ready(function($) {
    // When the primary color setting changes
    wp.customize('theme_primary_color', function(value) {
        value.bind(function(newColor) {
            // Update colors for various elements
            $(".site-header, .main-navigation").css("background-color", newColor);
            $(".button, .highlight").css("background-color", newColor);
            
            // Update text color based on background brightness
            let brightness = getBrightness(newColor);
            let textColor = brightness > 160 ? "#333333" : "#ffffff";
            
            $(".site-header, .main-navigation").css("color", textColor);
            $(".button, .highlight").css("color", textColor);
        });
    });
    
    // When layout setting changes
    wp.customize('theme_layout', function(value) {
        value.bind(function(newLayout) {
            // Remove all layout classes
            $("body").removeClass("layout-wide layout-boxed layout-narrow");
            
            // Add the new layout class
            $("body").addClass("layout-" + newLayout);
        });
    });
    
    // Helper function to calculate brightness
    function getBrightness(hexColor) {
        // Convert hex to RGB
        hexColor = hexColor.replace('#', '');
        let r = parseInt(hexColor.substr(0, 2), 16);
        let g = parseInt(hexColor.substr(2, 2), 16);
        let b = parseInt(hexColor.substr(4, 2), 16);
        
        // Calculate brightness (YIQ formula)
        return (r * 299 + g * 587 + b * 114) / 1000;
    }
});</code></pre>
            </div>
        </section>

        <section class="creating_elements">
            <h2>Creating and Inserting Elements</h2>
            <p>jQuery makes it easy to create new HTML elements and insert them into the DOM.</p>
            
            <h3>Creating Elements</h3>
            <div class="code_example">
                <pre><code>// Create a simple element
let $newDiv = $("&lt;div&gt;&lt;/div&gt;");

// Create an element with content
let $newParagraph = $("&lt;p&gt;This is a new paragraph.&lt;/p&gt;");

// Create an element with attributes
let $newLink = $("&lt;a href='https://example.com' class='external-link'&gt;Visit Example&lt;/a&gt;");

// Alternative syntax with attributes object
let $newImage = $("&lt;img&gt;", {
    src: "image.jpg",
    alt: "Description",
    class: "featured-image",
    width: 300,
    height: 200
});

// Create a complex structure
let $newCard = $("&lt;div class='card'&gt;&lt;/div&gt;")
    .append("&lt;img src='product.jpg' alt='Product'&gt;")
    .append("&lt;h3&gt;Product Title&lt;/h3&gt;")
    .append("&lt;p&gt;Product description goes here.&lt;/p&gt;")
    .append("&lt;button&gt;Add to Cart&lt;/button&gt;");</code></pre>
            </div>
            
            <h3>Inserting Elements Inside</h3>
            <div class="code_example">
                <pre><code>// Append to the end of an element
$("#container").append($newParagraph);
// Or with HTML string directly
$("#container").append("&lt;p&gt;New paragraph&lt;/p&gt;");

// Append multiple elements
$("#container").append($newParagraph, $newDiv, $newLink);

// Prepend to the beginning of an element
$("#container").prepend($newParagraph);
// Or with HTML string directly
$("#container").prepend("&lt;h2&gt;Section Title&lt;/h2&gt;");

// Append the same content to multiple elements
$("div.card").append("&lt;span class='badge'&gt;New!&lt;/span&gt;");

// Prepend the same content to multiple elements
$("ul.list").prepend("&lt;li class='list-header'&gt;Items:&lt;/li&gt;");

// Alternative syntax that reverses target and content
$newParagraph.appendTo("#container");
$newHeading.prependTo("#container");</code></pre>
            </div>
            
            <h3>Inserting Elements Outside</h3>
            <div class="code_example">
                <pre><code>// Insert after an element (as a sibling)
$("#target").after($newDiv);
// Or with HTML string directly
$("#target").after("&lt;div class='separator'&gt;&lt;/div&gt;");

// Insert before an element (as a sibling)
$("#target").before($newHeading);
// Or with HTML string directly
$("#target").before("&lt;h2&gt;Section Title&lt;/h2&gt;");

// Insert after multiple elements
$("p.note").after("&lt;hr&gt;");

// Insert before multiple elements
$("h3").before("&lt;a class='anchor' id='section-{{index}}'&gt;&lt;/a&gt;");

// Alternative syntax that reverses target and content
$newDiv.insertAfter("#target");
$newHeading.insertBefore("#target");</code></pre>
            </div>
            
            <h3>Wrapping Elements</h3>
            <div class="code_example">
                <pre><code>// Wrap each element in a container
$("p").wrap("&lt;div class='paragraph-wrapper'&gt;&lt;/div&gt;");

// Wrap all elements together in a single container
$("p").wrapAll("&lt;div class='paragraphs-container'&gt;&lt;/div&gt;");

// Wrap only the contents of each element
$("div.post").wrapInner("&lt;article&gt;&lt;/article&gt;");

// Unwrap (remove parent)
$("p").unwrap();</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World Example: WordPress Comment Form Enhancement</h3>
                <p>Here's how you might use element creation and insertion to enhance a WordPress comment form:</p>
                
                <pre><code>jQuery(document).ready(function($) {
    // Add emoji picker to comment form
    $("#comment").after("&lt;div class='emoji-picker'&gt;&lt;button type='button' class='toggle-emoji-picker'&gt;üòÄ Add Emoji&lt;/button&gt;&lt;div class='emoji-container' style='display:none;'&gt;&lt;/div&gt;&lt;/div&gt;");
    
    // Populate emoji container
    const emojis = ["üòÄ", "üòÇ", "üòç", "ü§î", "üòé", "üëç", "‚ù§Ô∏è", "üéâ", "üî•", "‚ú®"];
    let emojiHTML = "";
    
    emojis.forEach(function(emoji) {
        emojiHTML += "&lt;span class='emoji-item'&gt;" + emoji + "&lt;/span&gt;";
    });
    
    $(".emoji-container").html(emojiHTML);
    
    // Toggle emoji picker
    $(".toggle-emoji-picker").on("click", function() {
        $(".emoji-container").slideToggle(200);
    });
    
    // Insert emoji when clicked
    $(".emoji-item").on("click", function() {
        let emoji = $(this).text();
        let $commentField = $("#comment");
        let currentText = $commentField.val();
        
        // Insert emoji at cursor position or append to end
        let cursorPos = $commentField[0].selectionStart;
        
        if (typeof cursorPos !== 'undefined') {
            let textBefore = currentText.substring(0, cursorPos);
            let textAfter = currentText.substring(cursorPos, currentText.length);
            
            $commentField.val(textBefore + emoji + textAfter);
            
            // Reset cursor position after the inserted emoji
            let newPos = cursorPos + emoji.length;
            $commentField[0].setSelectionRange(newPos, newPos);
        } else {
            // Fallback: just append to the end
            $commentField.val(currentText + emoji);
        }
        
        // Focus the comment field
        $commentField.focus();
    });
    
    // Add character counter below comment form
    $("#comment").after("&lt;div class='comment-char-count'&gt;0 characters&lt;/div&gt;");
    
    // Update character count when typing
    $("#comment").on("input", function() {
        let count = $(this).val().length;
        $(".comment-char-count").text(count + " characters");
    });
});</code></pre>
            </div>
            
            <div class="analogy">
                <h3>The LEGO Building Analogy</h3>
                <p>Think of DOM creation and insertion like building with LEGO bricks. First, you create individual pieces (new elements), then you decide how to connect them: stack them inside each other (append/prepend), place them side by side (before/after), or even wrap them in a container piece (wrap). Just like with LEGOs, you can build complex structures piece by piece, or create pre-assembled sections and then place them into your main construction.</p>
                
                <div class="mermaid">
                graph TD
                    A[Create Element] --> B["$('<div class=\"card\"></div>')"]
                    B --> C1[Append - Inside at end]
                    B --> C2[Prepend - Inside at beginning]
                    B --> C3[After - Outside after]
                    B --> C4[Before - Outside before]
                    B --> C5[Wrap - Surround with]
                    
                    C1 --> D1["$('#container').append(newElement)"]
                    C2 --> D2["$('#container').prepend(newElement)"]
                    C3 --> D3["$('#ref').after(newElement)"]
                    C4 --> D4["$('#ref').before(newElement)"]
                    C5 --> D5["$('#element').wrap(newElement)"]
                </div>
            </div>
        </section>

        <section class="removing_elements">
            <h2>Removing Elements</h2>
            <p>jQuery provides several methods for removing elements from the DOM.</p>
            
            <h3>Basic Removal Methods</h3>
            <div class="code_example">
                <pre><code>// Remove elements and their data/events
$(".temp-message").remove();

// Remove elements that match a selector
$("div").remove(".obsolete, .temporary");

// Remove elements but keep their data/events for later use
let $detached = $(".sidebar-widget").detach();

// Later, you can reattach the elements
$("#new-sidebar").append($detached);

// Remove all children of an element
$("#comments-list").empty();

// Replace elements with new content
$("#old-content").replaceWith("&lt;div id='new-content'&gt;Updated content&lt;/div&gt;");

// Replace elements with elements from another selection
$("p.temp").replaceWith($("div.final"));

// Replace all matched elements with the first element
$("div.duplicate").replaceAll("div.original");</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World Example: WordPress Admin Cleanup</h3>
                <p>Here's how you might use removal methods to customize the WordPress admin interface:</p>
                
                <pre><code>jQuery(document).ready(function($) {
    // Remove unnecessary metaboxes for specific user roles
    if (currentUser.role !== 'administrator') {
        $("#dashboard_right_now, #dashboard_activity").remove();
    }
    
    // Empty and repopulate a dashboard widget
    $("#dashboard_quick_press").empty().append("&lt;p&gt;Quick actions have been customized for your role.&lt;/p&gt;");
    
    // Dynamically filter and hide table rows based on content
    $("#the-list tr").each(function() {
        if ($(this).find("td.column-author").text().includes("Guest Author")) {
            $(this).addClass("guest-post").hide();
        }
    });
    
    // Add a toggle button
    $("#posts-filter .tablenav.top").append(
        "&lt;button type='button' id='toggle-guest-posts' class='button'&gt;Show/Hide Guest Posts&lt;/button&gt;"
    );
    
    // Toggle visibility when button is clicked
    $("#toggle-guest-posts").on("click", function() {
        $(".guest-post").toggle();
    });
    
    // Replace the welcome panel with a custom message
    if ($("#welcome-panel").length) {
        let $customWelcome = $("&lt;div id='custom-welcome-panel' class='welcome-panel'&gt;&lt;/div&gt;")
            .append("&lt;h2&gt;Welcome to " + siteName + "!&lt;/h2&gt;")
            .append("&lt;p&gt;Here are your pending tasks for today:&lt;/p&gt;")
            .append("&lt;ul id='daily-tasks'&gt;&lt;/ul&gt;");
        
        // Fetch tasks via AJAX and populate the list
        $.get(ajaxurl, {
            action: 'get_daily_tasks'
        }, function(response) {
            if (response.success && response.data.tasks) {
                $.each(response.data.tasks, function(i, task) {
                    $("#daily-tasks").append("&lt;li&gt;" + task.title + "&lt;/li&gt;");
                });
            }
        });
        
        $("#welcome-panel").replaceWith($customWelcome);
    }
});</code></pre>
            </div>
        </section>

        <section class="cloning_elements">
            <h2>Cloning Elements</h2>
            <p>jQuery's clone method allows you to make copies of existing elements.</p>
            
            <h3>Basic Cloning</h3>
            <div class="code_example">
                <pre><code>// Clone an element
let $cloned = $("#original-element").clone();

// Insert the clone somewhere
$("#target-container").append($cloned);

// Clone with data and events (true parameter)
let $clonedWithEvents = $("#original-element").clone(true);

// Clone with data but without events
let $clonedWithData = $("#original-element").clone(true, false);

// Clone, modify, and insert
$("#template-row").clone()
    .attr("id", "new-row-" + rowCount)
    .find(".item-name").text("New Item").end()
    .find(".item-price").text("$0.00").end()
    .appendTo("#items-table tbody");</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World Example: WordPress Dynamic Form Fields</h3>
                <p>Here's how you might use cloning to create repeatable form fields in a WordPress plugin:</p>
                
                <pre><code>jQuery(document).ready(function($) {
    // Set up a counter for unique IDs
    let fieldCounter = $(".repeatable-field-group").length;
    
    // Add button to create a new field group
    $("#repeatable-fields").after("&lt;button type='button' id='add-field-group' class='button button-secondary'&gt;Add Another Item&lt;/button&gt;");
    
    // When the add button is clicked
    $("#add-field-group").on("click", function() {
        // Clone the template
        let $template = $(".repeatable-field-group:first").clone(true);
        
        // Update IDs and names
        fieldCounter++;
        
        $template.attr("id", "field-group-" + fieldCounter);
        
        // Update input fields
        $template.find("input, select, textarea").each(function() {
            let $input = $(this);
            let name = $input.attr("name");
            
            // Update the array index in the name attribute
            name = name.replace(/\[(\d+)\]/, "[" + fieldCounter + "]");
            $input.attr("name", name);
            
            // Clear the value
            $input.val("");
            
            // Update id attribute if present
            let id = $input.attr("id");
            if (id) {
                $input.attr("id", id.replace(/-(\d+)$/, "-" + fieldCounter));
            }
        });
        
        // Update labels
        $template.find("label").each(function() {
            let $label = $(this);
            let forAttr = $label.attr("for");
            
            if (forAttr) {
                $label.attr("for", forAttr.replace(/-(\d+)$/, "-" + fieldCounter));
            }
        });
        
        // Add delete button if it doesn't exist
        if ($template.find(".remove-field-group").length === 0) {
            $template.append("&lt;button type='button' class='button remove-field-group'&gt;Remove&lt;/button&gt;");
        }
        
        // Add the cloned and modified template to the form
        $("#repeatable-fields").append($template);
    });
    
    // Handle removal of field groups (using event delegation)
    $("#repeatable-fields").on("click", ".remove-field-group", function() {
        // Don't remove if it's the last one
        if ($(".repeatable-field-group").length > 1) {
            $(this).closest(".repeatable-field-group").slideUp(300, function() {
                $(this).remove();
            });
        } else {
            // Just clear the values if it's the last one
            let $group = $(this).closest(".repeatable-field-group");
            $group.find("input, select, textarea").val("");
            
            alert("You need to keep at least one item.");
        }
    });
});</code></pre>
            </div>
        </section>

        <section class="performance_tips">
            <h2>Performance Optimization</h2>
            <p>When manipulating the DOM, performance considerations become important, especially for complex WordPress sites.</p>
            
            <h3>Best Practices for DOM Manipulation</h3>
            <ul>
                <li><strong>Cache jQuery objects:</strong> Store frequently used selections in variables</li>
                <li><strong>Minimize DOM traversals:</strong> Find elements efficiently with specific selectors</li>
                <li><strong>Use document fragments:</strong> Build complex structures before inserting into the DOM</li>
                <li><strong>Limit reflows and repaints:</strong> Batch DOM operations when possible</li>
                <li><strong>Use CSS classes for styling:</strong> Modify classes instead of individual style properties</li>
                <li><strong>Detach elements for bulk changes:</strong> Remove from DOM, modify, then reinsert</li>
                <li><strong>Use event delegation:</strong> Attach events to parent elements instead of multiple children</li>
            </ul>
            
            <div class="code_example">
                <h4>Bad Performance:</h4>
                <pre><code>// Multiple DOM queries for the same element
$("#header").css("background-color", "#f0f0f0");
$("#header").addClass("sticky");
$("#header").find("h1").text("New Title");

// Adding multiple elements one by one
for (let i = 0; i < 100; i++) {
    $("#list").append("&lt;li&gt;Item " + i + "&lt;/li&gt;");
}

// Inefficient style changes causing reflows
$(".box").css("width", "200px");
$(".box").css("height", "150px");
$(".box").css("background-color", "#f0f0f0");
$(".box").css("border-radius", "5px");</code></pre>
                
                <h4>Good Performance:</h4>
                <pre><code>// Cache jQuery objects
let $header = $("#header");
$header.css("background-color", "#f0f0f0")
       .addClass("sticky")
       .find("h1").text("New Title");

// Build HTML string before appending
let items = [];
for (let i = 0; i < 100; i++) {
    items.push("&lt;li&gt;Item " + i + "&lt;/li&gt;");
}
$("#list").append(items.join(""));

// Or use document fragment for complex structures
let fragment = document.createDocumentFragment();
for (let i = 0; i < 100; i++) {
    let li = document.createElement("li");
    li.textContent = "Item " + i;
    fragment.appendChild(li);
}
$("#list")[0].appendChild(fragment);

// Batch style changes
$(".box").css({
    width: "200px",
    height: "150px",
    backgroundColor: "#f0f0f0",
    borderRadius: "5px"
});

// Or better, add a class with all styles
$(".box").addClass("featured-box");</code></pre>
            </div>
            
            <div class="real_world">
                <h3>Real-World Example: WordPress Image Gallery Optimization</h3>
                <p>Here's how you might optimize the creation of a large image gallery:</p>
                
                <pre><code>jQuery(document).ready(function($) {
    // Fetch gallery images via AJAX
    $.getJSON(ajaxurl, {
        action: 'get_gallery_images',
        gallery_id: currentGalleryId
    }, function(response) {
        if (response.success && response.data.images) {
            renderGallery(response.data.images);
        }
    });
    
    function renderGallery(images) {
        let $gallery = $("#image-gallery");
        
        // Detach the gallery while we work on it
        $gallery.detach();
        
        // Clear any existing content
        $gallery.empty();
        
        // Build all items at once
        let galleryHTML = "";
        
        $.each(images, function(i, image) {
            galleryHTML += 
                "&lt;div class='gallery-item' data-id='" + image.id + "'&gt;" +
                    "&lt;img src='" + image.thumb + "' alt='" + image.title + "'&gt;" +
                    "&lt;div class='item-overlay'&gt;" +
                        "&lt;h4&gt;" + image.title + "&lt;/h4&gt;" +
                        "&lt;div class='item-actions'&gt;" +
                            "&lt;button class='view-full'&gt;View&lt;/button&gt;" +
                            "&lt;button class='edit-image'&gt;Edit&lt;/button&gt;" +
                        "&lt;/div&gt;" +
                    "&lt;/div&gt;" +
                "&lt;/div&gt;";
        });
        
        // Add all items at once
        $gallery.html(galleryHTML);
        
        // Reattach to the DOM
        $("#gallery-container").append($gallery);
        
        // Initialize masonry layout after images load
        $gallery.imagesLoaded(function() {
            $gallery.masonry({
                itemSelector: '.gallery-item',
                columnWidth: '.gallery-item',
                percentPosition: true
            });
        });
        
        // Use event delegation for all gallery interactions
        $gallery.on("click", ".view-full", function() {
            let imageId = $(this).closest(".gallery-item").data("id");
            openLightbox(imageId);
        });
        
        $gallery.on("click", ".edit-image", function() {
            let imageId = $(this).closest(".gallery-item").data("id");
            openImageEditor(imageId);
        });
    }
});</code></pre>
            </div>
        </section>

        <section class="practical_examples">
            <h2>Practical WordPress Examples</h2>
            
            <h3>Example 1: Dynamic Admin Meta Box</h3>
            <p>Let's create a dynamic meta box for the WordPress post editor that uses jQuery DOM manipulation:</p>
            
            <div class="code_example">
                <pre><code>// PHP part (functions.php or plugin file)
function add_dynamic_related_posts_meta_box() {
    add_meta_box(
        'dynamic_related_posts',
        'Related Posts',
        'render_related_posts_meta_box',
        'post',
        'side',
        'default'
    );
}
add_action('add_meta_boxes', 'add_dynamic_related_posts_meta_box');

function render_related_posts_meta_box($post) {
    // Add nonce for security
    wp_nonce_field('related_posts_nonce', 'related_posts_nonce');
    
    // Get saved related posts
    $related_posts = get_post_meta($post->ID, '_related_posts', true);
    
    // Output the meta box HTML
    ?>
    &lt;div id="related-posts-container"&gt;
        &lt;p&gt;
            &lt;label for="related-posts-search"&gt;Search posts:&lt;/label&gt;
            &lt;input type="text" id="related-posts-search" class="widefat" placeholder="Type to search..."&gt;
        &lt;/p&gt;
        
        &lt;div id="search-results" class="hidden"&gt;
            &lt;ul&gt;&lt;/ul&gt;
        &lt;/div&gt;
        
        &lt;div id="selected-related-posts"&gt;
            &lt;h4&gt;Selected Related Posts:&lt;/h4&gt;
            &lt;ul id="related-posts-list"&gt;
                &lt;?php
                if (!empty($related_posts)) {
                    foreach ($related_posts as $id) {
                        $related_post = get_post($id);
                        if ($related_post) {
                            echo '&lt;li data-id="' . esc_attr($id) . '"&gt;';
                            echo esc_html($related_post->post_title);
                            echo '&lt;a href="#" class="remove-related"&gt;√ó&lt;/a&gt;';
                            echo '&lt;input type="hidden" name="related_posts[]" value="' . esc_attr($id) . '"&gt;';
                            echo '&lt;/li&gt;';
                        }
                    }
                }
                ?&gt;
            &lt;/ul&gt;
            &lt;p class="howto"&gt;Drag to reorder.&lt;/p&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;?php
    
    // Enqueue the script
    wp_enqueue_script('jquery-ui-sortable');
    wp_enqueue_script(
        'related-posts-meta-box',
        get_template_directory_uri() . '/js/related-posts.js',
        array('jquery', 'jquery-ui-sortable'),
        '1.0',
        true
    );
    
    wp_localize_script('related-posts-meta-box', 'relatedPostsData', array(
        'ajaxurl' => admin_url('admin-ajax.php'),
        'nonce' => wp_create_nonce('search_posts_nonce'),
        'currentPostId' => $post->ID
    ));
}

// Save the meta box data
function save_related_posts_meta($post_id) {
    // Check nonce
    if (!isset($_POST['related_posts_nonce']) || !wp_verify_nonce($_POST['related_posts_nonce'], 'related_posts_nonce')) {
        return;
    }
    
    // Check autosave
    if (defined('DOING_AUTOSAVE') && DOING_AUTOSAVE) {
        return;
    }
    
    // Check permissions
    if ('post' === $_POST['post_type'] && !current_user_can('edit_post', $post_id)) {
        return;
    }
    
    // Save related posts
    if (isset($_POST['related_posts'])) {
        update_post_meta($post_id, '_related_posts', array_map('intval', $_POST['related_posts']));
    } else {
        delete_post_meta($post_id, '_related_posts');
    }
}
add_action('save_post', 'save_related_posts_meta');

// AJAX handler for post search
function search_posts_ajax() {
    check_ajax_referer('search_posts_nonce', 'nonce');
    
    $search_term = sanitize_text_field($_POST['search_term']);
    $current_post_id = intval($_POST['current_post_id']);
    
    $args = array(
        'post_type' => 'post',
        'post_status' => 'publish',
        'posts_per_page' => 10,
        's' => $search_term,
        'post__not_in' => array($current_post_id),
    );
    
    $query = new WP_Query($args);
    $results = array();
    
    if ($query->have_posts()) {
        while ($query->have_posts()) {
            $query->the_post();
            $results[] = array(
                'id' => get_the_ID(),
                'title' => get_the_title(),
            );
        }
    }
    
    wp_reset_postdata();
    wp_send_json_success($results);
}
add_action('wp_ajax_search_posts', 'search_posts_ajax');</code></pre>
                
                <h4>JavaScript (related-posts.js):</h4>
                <pre><code>jQuery(document).ready(function($) {
    // Make the related posts list sortable
    $("#related-posts-list").sortable({
        placeholder: "sortable-placeholder",
        update: function(event, ui) {
            // Re-index the hidden inputs if needed
        }
    });
    
    // Search functionality
    let searchTimeout;
    $("#related-posts-search").on("input", function() {
        let searchTerm = $(this).val().trim();
        
        // Clear previous timeout
        clearTimeout(searchTimeout);
        
        // Hide results if search term is too short
        if (searchTerm.length < 3) {
            $("#search-results").addClass("hidden");
            return;
        }
        
        // Set a small timeout to prevent too many AJAX requests while typing
        searchTimeout = setTimeout(function() {
            // Show loading indicator
            $("#search-results").removeClass("hidden").html("&lt;p&gt;Searching...&lt;/p&gt;");
            
            // Send AJAX request
            $.ajax({
                url: relatedPostsData.ajaxurl,
                type: "POST",
                data: {
                    action: "search_posts",
                    nonce: relatedPostsData.nonce,
                    search_term: searchTerm,
                    current_post_id: relatedPostsData.currentPostId
                },
                success: function(response) {
                    if (response.success && response.data.length > 0) {
                        // Build results list
                        let resultsHTML = "&lt;ul&gt;";
                        
                        response.data.forEach(function(post) {
                            // Check if this post is already in the related posts list
                            let isSelected = $("#related-posts-list li[data-id='" + post.id + "']").length > 0;
                            let disabledClass = isSelected ? " class='disabled'" : "";
                            
                            resultsHTML += "&lt;li data-id='" + post.id + "'" + disabledClass + "&gt;";
                            resultsHTML += post.title;
                            
                            if (!isSelected) {
                                resultsHTML += "&lt;a href='#' class='add-related'&gt;+&lt;/a&gt;";
                            } else {
                                resultsHTML += " (already added)";
                            }
                            
                            resultsHTML += "&lt;/li&gt;";
                        });
                        
                        resultsHTML += "&lt;/ul&gt;";
                        $("#search-results").html(resultsHTML);
                    } else {
                        // No results
                        $("#search-results").html("&lt;p&gt;No posts found.&lt;/p&gt;");
                    }
                },
                error: function() {
                    // Error handling
                    $("#search-results").html("&lt;p&gt;Error searching posts.&lt;/p&gt;");
                }
            });
        }, 500);
    });
    
    // Add related post
    $("#search-results").on("click", ".add-related", function(e) {
        e.preventDefault();
        
        let $listItem = $(this).parent();
        let postId = $listItem.data("id");
        let postTitle = $listItem.text().replace("+", "").trim();
        
        // Create the new related post item
        let $newItem = $("&lt;li&gt;").attr("data-id", postId);
        $newItem.text(postTitle);
        $newItem.append("&lt;a href='#' class='remove-related'&gt;√ó&lt;/a&gt;");
        $newItem.append("&lt;input type='hidden' name='related_posts[]' value='" + postId + "'&gt;");
        
        // Add to the related posts list
        $("#related-posts-list").append($newItem);
        
        // Disable in search results
        $listItem.addClass("disabled").find(".add-related").remove().end().append(" (already added)");
        
        // Clear search
        $("#related-posts-search").val("");
        $("#search-results").addClass("hidden");
    });
    
    // Remove related post
    $("#related-posts-list").on("click", ".remove-related", function(e) {
        e.preventDefault();
        
        let $listItem = $(this).parent();
        let postId = $listItem.data("id");
        
        // Remove the item with animation
        $listItem.fadeOut(300, function() {
            $(this).remove();
            
            // Update search results if they're visible
            $("#search-results li[data-id='" + postId + "']").removeClass("disabled")
                .find("span").remove().end()
                .append("&lt;a href='#' class='add-related'&gt;+&lt;/a&gt;");
        });
    });
    
    // Hide search results when clicking outside
    $(document).on("click", function(e) {
        if (!$(e.target).closest("#related-posts-container").length) {
            $("#search-results").addClass("hidden");
        }
    });
});</code></pre>
            </div>
            
            <h3>Example 2: Dynamic Theme Customizer Controls</h3>
            <p>Here's an example of using jQuery DOM manipulation for a custom Theme Customizer experience:</p>
            
            <div class="code_example">
                <pre><code>// JavaScript for the WordPress Theme Customizer
jQuery(document).ready(function($) {
    // Listen for changes to the header layout option
    wp.customize('theme_header_layout', function(value) {
        value.bind(function(newLayout) {
            // Update the preview by manipulating the DOM
            let $headerContent = $(".site-header-content");
            
            // Remove existing layout classes
            $headerContent.removeClass("layout-centered layout-split layout-traditional");
            
            // Add the new layout class
            $headerContent.addClass("layout-" + newLayout);
            
            // Rearrange elements based on the selected layout
            switch(newLayout) {
                case 'centered':
                    // Move logo to the top center
                    $(".site-branding").prependTo($headerContent).addClass("centered");
                    
                    // Move navigation below
                    $(".main-navigation").appendTo($headerContent);
                    
                    // Move search and cart icons to the bottom
                    $(".header-icons").appendTo($headerContent);
                    break;
                    
                case 'split':
                    // Center the logo
                    $(".site-branding").appendTo($headerContent.find(".header-middle")).addClass("centered");
                    
                    // Split the navigation into two parts
                    let $nav = $(".main-navigation");
                    let $menuItems = $nav.find(".menu > li");
                    let middlePoint = Math.ceil($menuItems.length / 2);
                    
                    // Create left and right navigation containers if they don't exist
                    if ($(".header-left .left-navigation").length === 0) {
                        $(".header-left").append("&lt;nav class='left-navigation'&gt;&lt;ul class='left-menu'&gt;&lt;/ul&gt;&lt;/nav&gt;");
                    }
                    
                    if ($(".header-right .right-navigation").length === 0) {
                        $(".header-right").append("&lt;nav class='right-navigation'&gt;&lt;ul class='right-menu'&gt;&lt;/ul&gt;&lt;/nav&gt;");
                    }
                    
                    // Clear existing items
                    $(".left-menu, .right-menu").empty();
                    
                    // Distribute menu items
                    $menuItems.each(function(index) {
                        if (index < middlePoint) {
                            $(this).clone(true).appendTo(".left-menu");
                        } else {
                            $(this).clone(true).appendTo(".right-menu");
                        }
                    });
                    
                    // Hide the original navigation
                    $nav.hide();
                    
                    // Move search and cart to the right
                    $(".header-icons").appendTo($(".header-right"));
                    break;
                    
                case 'traditional':
                    // Logo on the left
                    $(".site-branding").prependTo($headerContent.find(".header-left")).removeClass("centered");
                    
                    // Show the original navigation and move it to the right
                    $(".main-navigation").show().appendTo($(".header-right"));
                    
                    // Move search and cart next to navigation
                    $(".header-icons").insertAfter($(".main-navigation"));
                    break;
            }
        });
    });
    
    // Listen for changes to the color scheme
    wp.customize('theme_color_scheme', function(value) {
        value.bind(function(newColorScheme) {
            // Remove existing scheme classes
            $("body").removeClass(function(index, className) {
                return (className.match(/(^|\s)color-scheme-\S+/g) || []).join(' ');
            });
            
            // Add new scheme class
            $("body").addClass("color-scheme-" + newColorScheme);
            
            // Update dynamic elements - example for navigation
            if (newColorScheme === "dark") {
                // If a light logo version exists, switch to it
                let $logo = $(".site-logo img");
                let darkLogoSrc = $logo.attr("src");
                let lightLogoSrc = $logo.data("light-logo");
                
                if (lightLogoSrc) {
                    $logo.attr("src", lightLogoSrc).data("dark-logo", darkLogoSrc);
                }
                
                // Add dark mode icon
                if ($(".dark-mode-indicator").length === 0) {
                    $(".header-icons").prepend("&lt;span class='dark-mode-indicator'&gt;üåô&lt;/span&gt;");
                }
            } else {
                // Switch back to dark logo if needed
                let $logo = $(".site-logo img");
                let lightLogoSrc = $logo.attr("src");
                let darkLogoSrc = $logo.data("dark-logo");
                
                if (darkLogoSrc) {
                    $logo.attr("src", darkLogoSrc).data("light-logo", lightLogoSrc);
                }
                
                // Remove dark mode icon
                $(".dark-mode-indicator").remove();
            }
        });
    });
    
    // Listen for changes to the typography
    wp.customize('theme_heading_font', function(value) {
        value.bind(function(newFont) {
            // If the font hasn't been loaded yet, load it
            if (newFont !== "default" && $("#font-" + newFont).length === 0) {
                $("head").append("&lt;link id='font-" + newFont + "' href='https://fonts.googleapis.com/css?family=" + newFont + ":400,700&display=swap' rel='stylesheet'&gt;");
            }
            
            // Update CSS Custom Property
            document.documentElement.style.setProperty('--heading-font', "'" + newFont + "', sans-serif");
            
            // Or, apply directly to elements
            $("h1, h2, h3, h4, h5, h6").css("font-family", "'" + newFont + "', sans-serif");
        });
    });
});</code></pre>
            </div>
            
            <h3>Example 3: Interactive Widget with Ajax</h3>
            <p>Let's create a WordPress widget that uses jQuery DOM manipulation to provide a live search feature:</p>
            
            <div class="code_example">
                <pre><code>// PHP Widget Class (in your theme's functions.php or plugin file)
class Live_Search_Widget extends WP_Widget {
    public function __construct() {
        parent::__construct(
            'live_search_widget',
            'Live Search Widget',
            ['description' => 'A widget that shows live search results as users type']
        );
    }
    
    public function widget($args, $instance) {
        echo $args['before_widget'];
        
        if (!empty($instance['title'])) {
            echo $args['before_title'] . apply_filters('widget_title', $instance['title']) . $args['after_title'];
        }
        
        // Widget content
        ?>
        &lt;div class="live-search-widget"&gt;
            &lt;div class="search-form-container"&gt;
                &lt;input type="text" class="live-search-input" placeholder="<?php echo esc_attr($instance['placeholder']); ?>"&gt;
                &lt;button type="button" class="clear-search" style="display: none;"&gt;√ó&lt;/button&gt;
            &lt;/div&gt;
            
            &lt;div class="live-search-results"&gt;
                &lt;div class="results-message"&gt;Type to search...&lt;/div&gt;
                &lt;ul class="results-list"&gt;&lt;/ul&gt;
            &lt;/div&gt;
            
            &lt;div class="search-footer"&gt;
                &lt;a href="<?php echo esc_url(home_url('/')); ?>?s=" class="view-all-results" style="display: none;"&gt;View all results&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        <?php
        
        // Enqueue the script
        wp_enqueue_script(
            'live-search-widget',
            get_template_directory_uri() . '/js/live-search.js',
            ['jquery'],
            '1.0',
            true
        );
        
        wp_localize_script('live-search-widget', 'liveSearchData', [
            'ajaxurl' => admin_url('admin-ajax.php'),
            'nonce' => wp_create_nonce('live_search_nonce'),
            'searching_text' => esc_html($instance['searching_text'] ?: 'Searching...'),
            'no_results_text' => esc_html($instance['no_results_text'] ?: 'No results found'),
            'min_chars' => absint($instance['min_chars'] ?: 3)
        ]);
        
        echo $args['after_widget'];
    }
    
    public function form($instance) {
        $title = !empty($instance['title']) ? $instance['title'] : 'Search';
        $placeholder = !empty($instance['placeholder']) ? $instance['placeholder'] : 'Search...';
        $searching_text = !empty($instance['searching_text']) ? $instance['searching_text'] : 'Searching...';
        $no_results_text = !empty($instance['no_results_text']) ? $instance['no_results_text'] : 'No results found';
        $min_chars = !empty($instance['min_chars']) ? absint($instance['min_chars']) : 3;
        
        ?>
        &lt;p&gt;
            &lt;label for="<?php echo esc_attr($this->get_field_id('title')); ?>"&gt;Title:&lt;/label&gt;
            &lt;input class="widefat" id="<?php echo esc_attr($this->get_field_id('title')); ?>" name="<?php echo esc_attr($this->get_field_name('title')); ?>" type="text" value="<?php echo esc_attr($title); ?>"&gt;
        &lt;/p&gt;
        
        &lt;p&gt;
            &lt;label for="<?php echo esc_attr($this->get_field_id('placeholder')); ?>"&gt;Placeholder Text:&lt;/label&gt;
            &lt;input class="widefat" id="<?php echo esc_attr($this->get_field_id('placeholder')); ?>" name="<?php echo esc_attr($this->get_field_name('placeholder')); ?>" type="text" value="<?php echo esc_attr($placeholder); ?>"&gt;
        &lt;/p&gt;
        
        &lt;p&gt;
            &lt;label for="<?php echo esc_attr($this->get_field_id('searching_text')); ?>"&gt;Searching Message:&lt;/label&gt;
            &lt;input class="widefat" id="<?php echo esc_attr($this->get_field_id('searching_text')); ?>" name="<?php echo esc_attr($this->get_field_name('searching_text')); ?>" type="text" value="<?php echo esc_attr($searching_text); ?>"&gt;
        &lt;/p&gt;
        
        &lt;p&gt;
            &lt;label for="<?php echo esc_attr($this->get_field_id('no_results_text')); ?>"&gt;No Results Message:&lt;/label&gt;
            &lt;input class="widefat" id="<?php echo esc_attr($this->get_field_id('no_results_text')); ?>" name="<?php echo esc_attr($this->get_field_name('no_results_text')); ?>" type="text" value="<?php echo esc_attr($no_results_text); ?>"&gt;
        &lt;/p&gt;
        
        &lt;p&gt;
            &lt;label for="<?php echo esc_attr($this->get_field_id('min_chars')); ?>"&gt;Minimum Characters:&lt;/label&gt;
            &lt;input class="tiny-text" id="<?php echo esc_attr($this->get_field_id('min_chars')); ?>" name="<?php echo esc_attr($this->get_field_name('min_chars')); ?>" type="number" min="1" max="10" value="<?php echo esc_attr($min_chars); ?>"&gt;
        &lt;/p&gt;
        <?php
    }
    
    public function update($new_instance, $old_instance) {
        $instance = [];
        $instance['title'] = (!empty($new_instance['title'])) ? sanitize_text_field($new_instance['title']) : '';
        $instance['placeholder'] = (!empty($new_instance['placeholder'])) ? sanitize_text_field($new_instance['placeholder']) : '';
        $instance['searching_text'] = (!empty($new_instance['searching_text'])) ? sanitize_text_field($new_instance['searching_text']) : '';
        $instance['no_results_text'] = (!empty($new_instance['no_results_text'])) ? sanitize_text_field($new_instance['no_results_text']) : '';
        $instance['min_chars'] = (!empty($new_instance['min_chars'])) ? absint($new_instance['min_chars']) : 3;
        
        return $instance;
    }
}

// Register the widget
function register_live_search_widget() {
    register_widget('Live_Search_Widget');
}
add_action('widgets_init', 'register_live_search_widget');

// AJAX handler for the live search
function live_search_ajax() {
    check_ajax_referer('live_search_nonce', 'nonce');
    
    $search_term = sanitize_text_field($_POST['search_term']);
    
    if (strlen($search_term) < 3) {
        wp_send_json_error('Search term too short');
        return;
    }
    
    $args = [
        'post_type' => ['post', 'page', 'product'], // Add your post types
        'post_status' => 'publish',
        'posts_per_page' => 5,
        's' => $search_term,
    ];
    
    $query = new WP_Query($args);
    $results = [];
    
    if ($query->have_posts()) {
        while ($query->have_posts()) {
            $query->the_post();
            
            // Get featured image if available
            $thumbnail = '';
            if (has_post_thumbnail()) {
                $thumbnail = get_the_post_thumbnail_url(get_the_ID(), 'thumbnail');
            }
            
            // Get post type label
            $post_type_obj = get_post_type_object(get_post_type());
            $post_type_label = $post_type_obj->labels->singular_name;
            
            $results[] = [
                'id' => get_the_ID(),
                'title' => get_the_title(),
                'excerpt' => wp_trim_words(get_the_excerpt(), 10),
                'permalink' => get_permalink(),
                'thumbnail' => $thumbnail,
                'post_type' => $post_type_label,
                'date' => get_the_date()
            ];
        }
        
        wp_reset_postdata();
        wp_send_json_success($results);
    } else {
        wp_send_json_error('No results found');
    }
}
add_action('wp_ajax_live_search', 'live_search_ajax');
add_action('wp_ajax_nopriv_live_search', 'live_search_ajax');</code></pre>
                
                <h4>JavaScript (live-search.js):</h4>
                <pre><code>jQuery(document).ready(function($) {
    let searchTimeout;
    
    // Cache DOM elements for better performance
    let $searchInput = $(".live-search-input");
    let $clearButton = $(".clear-search");
    let $resultsContainer = $(".live-search-results");
    let $resultsMessage = $(".results-message");
    let $resultsList = $(".results-list");
    let $viewAllLink = $(".view-all-results");
    
    // When user types in the search input
    $searchInput.on("input", function() {
        let searchTerm = $(this).val().trim();
        
        // Clear previous timeout
        clearTimeout(searchTimeout);
        
        // Show/hide clear button
        if (searchTerm.length > 0) {
            $clearButton.show();
        } else {
            $clearButton.hide();
            $resultsMessage.text("Type to search...");
            $resultsList.empty();
            $viewAllLink.hide();
            return;
        }
        
        // Check if search term is long enough
        if (searchTerm.length < liveSearchData.min_chars) {
            $resultsMessage.text("Please enter at least " + liveSearchData.min_chars + " characters...");
            $resultsList.empty();
            $viewAllLink.hide();
            return;
        }
        
        // Set a timeout to prevent too many AJAX requests while typing
        searchTimeout = setTimeout(function() {
            performSearch(searchTerm);
        }, 500);
    });
    
    // Clear search button
    $clearButton.on("click", function() {
        $searchInput.val("").focus();
        $clearButton.hide();
        $resultsMessage.text("Type to search...");
        $resultsList.empty();
        $viewAllLink.hide();
    });
    
    // Handle clicks on search results
    $resultsList.on("click", "li", function() {
        window.location.href = $(this).find("a").attr("href");
    });
    
    // Update the view all results link
    function updateViewAllLink(searchTerm) {
        $viewAllLink.attr("href", $viewAllLink.attr("href") + encodeURIComponent(searchTerm));
        $viewAllLink.show();
    }
    
    // Perform the AJAX search
    function performSearch(searchTerm) {
        // Show searching message
        $resultsMessage.text(liveSearchData.searching_text);
        $resultsList.empty();
        
        // Send AJAX request
        $.ajax({
            url: liveSearchData.ajaxurl,
            type: "POST",
            data: {
                action: "live_search",
                nonce: liveSearchData.nonce,
                search_term: searchTerm
            },
            success: function(response) {
                if (response.success && response.data.length > 0) {
                    // Hide the message and clear the list
                    $resultsMessage.hide();
                    $resultsList.empty();
                    
                    // Add each result to the list
                    $.each(response.data, function(index, result) {
                        let $resultItem = $("&lt;li class='result-item'&gt;").appendTo($resultsList);
                        
                        let $resultLink = $("&lt;a&gt;")
                            .attr("href", result.permalink)
                            .appendTo($resultItem);
                        
                        // If thumbnail exists, add it
                        if (result.thumbnail) {
                            $("&lt;div class='result-thumbnail'&gt;")
                                .append($("&lt;img&gt;").attr({
                                    src: result.thumbnail,
                                    alt: result.title
                                }))
                                .appendTo($resultLink);
                        }
                        
                        let $resultContent = $("&lt;div class='result-content'&gt;").appendTo($resultLink);
                        
                        $("&lt;h4 class='result-title'&gt;").text(result.title).appendTo($resultContent);
                        
                        if (result.excerpt) {
                            $("&lt;div class='result-excerpt'&gt;").text(result.excerpt).appendTo($resultContent);
                        }
                        
                        let $resultMeta = $("&lt;div class='result-meta'&gt;").appendTo($resultContent);
                        
                        $("&lt;span class='result-type'&gt;").text(result.post_type).appendTo($resultMeta);
                        $("&lt;span class='result-date'&gt;").text(result.date).appendTo($resultMeta);
                    });
                    
                    // Update the "View all results" link
                    updateViewAllLink(searchTerm);
                } else {
                    // No results found
                    $resultsMessage.text(liveSearchData.no_results_text).show();
                    $resultsList.empty();
                    $viewAllLink.hide();
                }
            },
            error: function() {
                // Error handling
                $resultsMessage.text("Error performing search. Please try again.").show();
                $resultsList.empty();
                $viewAllLink.hide();
            }
        });
    }
});</code></pre>
            </div>
        </section>

        <section class="homework">
            <h2>Homework Assignment</h2>
            
            <p>To practice your jQuery DOM manipulation skills, complete the following tasks:</p>
            
            <ol>
                <li>
                    <strong>Task 1: WordPress Comment System Enhancement</strong>
                    <p>Create a script that enhances the WordPress comment system. Your script should:</p>
                    <ul>
                        <li>Add "Reply" links to each comment that auto-scroll to the comment form and pre-fill it with "@username"</li>
                        <li>Add a "Quote" feature that copies the comment text into the comment form with proper formatting</li>
                        <li>Implement an "Edit" timer for your own comments (5 minutes to edit after posting)</li>
                        <li>Create a simple preview feature that shows how your comment will look as you type</li>
                    </ul>
                </li>
                <li>
                    <strong>Task 2: Dynamic Content Loader</strong>
                    <p>Create a script that dynamically loads more posts when a user clicks "Load More" or scrolls to the bottom of the page. Your implementation should:</p>
                    <ul>
                        <li>Create and inject a "Load More" button at the end of post listings</li>
                        <li>Use AJAX to fetch additional posts without page refreshes</li>
                        <li>Show a loading indicator while fetching</li>
                        <li>Gracefully handle the "no more posts" scenario</li>
                    </ul>
                </li>
                <li>
                    <strong>Task 3: Interactive Form Builder</strong>
                    <p>Create a form builder interface that uses jQuery to:</p>
                    <ul>
                        <li>Allow users to add different types of form fields (text, email, checkbox, radio, select)</li>
                        <li>Provide options to configure each field (label, placeholder, required status)</li>
                        <li>Allow drag and drop reordering of fields</li>
                        <li>Generate the corresponding HTML/PHP code for a WordPress form</li>
                    </ul>
                </li>
            </ol>
            
            <p>Submit your completed code with comments explaining your DOM manipulation techniques before the next session.</p>
        </section>

        <section class="additional_resources">
            <h2>Additional Resources</h2>
            
            <h3>Documentation and Tutorials</h3>
            <ul>
                <li><a href="https://api.jquery.com/category/manipulation/" target="_blank">jQuery Manipulation Documentation</a></li>
                <li><a href="https://learn.jquery.com/using-jquery-core/manipulating-elements/" target="_blank">jQuery Learning Center: Manipulating Elements</a></li>
                <li><a href="https://developer.wordpress.org/plugins/javascript/jquery/" target="_blank">WordPress Documentation: Using jQuery</a></li>
                <li><a href="https://css-tricks.com/examples/DynamicPage/" target="_blank">CSS-Tricks: Building Dynamic Pages with jQuery</a></li>
            </ul>
            
            <h3>Tools and Plugins</h3>
            <ul>
                <li><strong>Chrome DevTools:</strong> Use the Elements panel to inspect and modify the DOM</li>
                <li><strong>jQuery Cheat Sheet:</strong> Quick reference for common DOM manipulation methods</li>
                <li><strong>jsFiddle:</strong> Online playground for testing jQuery code</li>
                <li><strong>What's Running:</strong> Browser extension to detect jQuery versions on websites</li>
            </ul>
        </section>
    </main>
    
    <footer>
        <p>&copy; 2025 PHP WordPress Development Course</p>
        <p><a href="index.html">Back to Syllabus</a></p>
    </footer>
</body>
</html>
