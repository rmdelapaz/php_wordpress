<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
    <!-- SEO Meta Tags -->
    <title>Using CMB2 for Metaboxes - PHP WordPress Course</title>
    <meta name="description" content="Learn to use CMB2 (Custom Metaboxes 2) library for creating advanced metaboxes in WordPress. Master CMB2 field types, configurations, and best practices.">
    <meta name="keywords" content="WordPress, CMB2, metaboxes, custom fields, PHP, WordPress development">
    <meta name="author" content="PHP WordPress Course">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Using CMB2 for Metaboxes">
    <meta property="og:description" content="Create powerful metaboxes with the CMB2 library">
    <meta property="og:type" content="article">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="/assets/css/prism.css" rel="stylesheet">
</head>
<body>
    <!-- Skip to main content -->
    <a href="#main-content" class="sr-only">Skip to main content</a>
    
    <div class="page-wrapper">
        <!-- Header -->
        <header class="site-header" role="banner">
            <div class="header-container">
                <div class="site-branding">
                    <a href="/" class="site-logo">
                        <h1 class="site-title">PHP WordPress Development</h1>
                    </a>
                </div>
                
                <nav class="main-navigation" role="navigation" aria-label="Main navigation">
                    <button class="mobile-menu-btn" aria-label="Toggle navigation" aria-expanded="false">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    
                    <div class="nav-menu">
                        <ul class="nav-list">
                            <li class="nav-item"><a href="/" class="nav-link">Home</a></li>
                            <li class="nav-item dropdown">
                                <button class="nav-link dropdown-toggle active" aria-haspopup="true">Modules</button>
                                <div class="dropdown-menu">
                                    <a href="/module1.html" class="dropdown-item">Module 1: Web Fundamentals</a>
                                    <a href="/module2.html" class="dropdown-item">Module 2: PHP Fundamentals</a>
                                    <a href="/module3.html" class="dropdown-item">Module 3: MySQL Database</a>
                                    <a href="/module4.html" class="dropdown-item">Module 4: WordPress & Docker</a>
                                    <a href="/module5.html" class="dropdown-item">Module 5: Theme Development</a>
                                    <a href="/module6.html" class="dropdown-item">Module 6: Plugin Development</a>
                                    <a href="/module7.html" class="dropdown-item active">Module 7: Advanced WordPress</a>
                                    <a href="/module8.html" class="dropdown-item">Module 8: Deployment</a>
                                    <a href="/module9.html" class="dropdown-item">Module 9: Final Project</a>
                                </div>
                            </li>
                            <li class="nav-item"><a href="/resources.html" class="nav-link">Resources</a></li>
                            <li class="nav-item"><a href="/about.html" class="nav-link">About</a></li>
                        </ul>
                    </div>
                </nav>
                
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                        </svg>
                        <input type="search" class="search-input" placeholder="Search lessons..." aria-label="Search">
                    </div>
                    <div class="search-results"></div>
                </div>
            </div>
        </header>
        
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-header">
                <h2 class="progress-title">Course Progress</h2>
                <span class="progress-text">Loading...</span>
            </div>
            <div class="progress-bar">
                <div class="progress-bar-fill">
                    <span class="progress-bar-text"></span>
                </div>
            </div>
        </div>
        
        <!-- Breadcrumb -->
        <nav class="breadcrumb container" aria-label="Breadcrumb">
            <ol class="breadcrumb-list">
                <li class="breadcrumb-item">
                    <a href="/">Home</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <a href="/module7.html">Module 7</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <span aria-current="page">CMB2 for Metaboxes</span>
                </li>
            </ol>
        </nav>
        
        <!-- Main Content -->
        <main id="main-content" class="main-content" role="main">
            <div class="container">
                <!-- Lesson Header -->
                <div class="lesson-header">
                    <h1 class="lesson-title">Using CMB2 for Metaboxes</h1>
                    <p class="lesson-subtitle">Create powerful, developer-friendly metaboxes with CMB2</p>
                </div>
                
                <!-- Learning Objectives -->
                <div class="lesson-objectives">
                    <h2>Learning Objectives</h2>
                    <p>By the end of this lesson, you will be able to:</p>
                    <ul>
                        <li>Install and configure CMB2 in your WordPress project</li>
                        <li>Create metaboxes using CMB2's API</li>
                        <li>Use all CMB2 field types effectively</li>
                        <li>Implement repeatable and group fields</li>
                        <li>Create options pages with CMB2</li>
                        <li>Extend CMB2 with custom field types</li>
                    </ul>
                </div>
                
                <!-- Lesson Body -->
                <div class="lesson-body">
                    <!-- Introduction to CMB2 -->
                    <section>
                        <h2>What is CMB2?</h2>
                        
                        <p>CMB2 (Custom Metaboxes 2) is a developer's toolkit for building metaboxes, custom fields, and forms for WordPress. It provides a powerful, extensible framework that simplifies the process of adding custom data to your WordPress sites.</p>
                        
                        <div class="info-box">
                            <h3>Why Use CMB2?</h3>
                            <ul>
                                <li><strong>Developer-friendly:</strong> Clean, intuitive API</li>
                                <li><strong>Extensive field types:</strong> 30+ built-in field types</li>
                                <li><strong>Repeatable fields:</strong> Built-in support for repeating data</li>
                                <li><strong>Field groups:</strong> Organize related fields together</li>
                                <li><strong>Options pages:</strong> Easy creation of settings pages</li>
                                <li><strong>Extensible:</strong> Add custom field types</li>
                                <li><strong>Well-documented:</strong> Comprehensive documentation</li>
                                <li><strong>Active community:</strong> Regular updates and support</li>
                            </ul>
                        </div>
                    </section>
                    
                    <!-- Installation -->
                    <section>
                        <h2>Installing CMB2</h2>
                        
                        <h3>Method 1: As a Plugin</h3>
                        <pre><code class="language-bash">
# Install via WordPress admin
# Go to Plugins > Add New
# Search for "CMB2"
# Install and activate

# Or via WP-CLI
wp plugin install cmb2 --activate
                        </code></pre>
                        
                        <h3>Method 2: Include in Theme</h3>
                        <pre><code class="language-php">
// Download CMB2 and place in theme directory
// In functions.php or custom file:

// Check if CMB2 is already loaded (as plugin)
if (!class_exists('CMB2')) {
    // Include CMB2
    require_once get_template_directory() . '/lib/cmb2/init.php';
}
                        </code></pre>
                        
                        <h3>Method 3: Using Composer</h3>
                        <pre><code class="language-json">
// composer.json
{
    "require": {
        "cmb2/cmb2": "^2.10"
    }
}
                        </code></pre>
                        
                        <pre><code class="language-php">
// Load via Composer autoload
require_once 'vendor/autoload.php';
                        </code></pre>
                    </section>
                    
                    <!-- Basic Metabox -->
                    <section>
                        <h2>Creating Your First CMB2 Metabox</h2>
                        
                        <h3>Basic Metabox Registration</h3>
                        <pre><code class="language-php">
// Hook into cmb2_admin_init action
add_action('cmb2_admin_init', 'register_demo_metabox');

function register_demo_metabox() {
    
    // Create new metabox
    $cmb = new_cmb2_box([
        'id'            => 'demo_metabox',
        'title'         => 'Demo Metabox',
        'object_types'  => ['page'], // Post type
        'context'       => 'normal',
        'priority'      => 'high',
        'show_names'    => true, // Show field names on the left
    ]);
    
    // Add fields to the metabox
    $cmb->add_field([
        'name'       => 'Test Text',
        'desc'       => 'This is a test text field',
        'id'         => 'wiki_test_text',
        'type'       => 'text',
        'show_on_cb' => 'cmb2_hide_if_no_cats', // Optional callback
    ]);
    
    $cmb->add_field([
        'name' => 'Test Text Area',
        'desc' => 'This is a test text area',
        'id'   => 'wiki_test_textarea',
        'type' => 'textarea',
    ]);
    
    $cmb->add_field([
        'name'    => 'Test Select',
        'desc'    => 'Select an option',
        'id'      => 'wiki_test_select',
        'type'    => 'select',
        'options' => [
            'standard' => 'Option One',
            'custom'   => 'Option Two',
            'none'     => 'Option Three',
        ],
        'default' => 'standard',
    ]);
}

// Optional display callback
function cmb2_hide_if_no_cats($field) {
    // Don't show this field if not in the cats category
    if (!has_category('cats', $field->object_id)) {
        return false;
    }
    return true;
}
                        </code></pre>
                    </section>
                    
                    <!-- Field Types -->
                    <section>
                        <h2>CMB2 Field Types</h2>
                        
                        <h3>Text-Based Fields</h3>
                        <pre><code class="language-php">
// Text field
$cmb->add_field([
    'name' => 'Text Field',
    'id'   => 'text_field',
    'type' => 'text',
    'attributes' => [
        'placeholder' => 'Enter text here',
        'data-custom' => 'custom-value',
    ],
]);

// Text small
$cmb->add_field([
    'name' => 'Small Text',
    'id'   => 'text_small',
    'type' => 'text_small',
]);

// Text medium
$cmb->add_field([
    'name' => 'Medium Text',
    'id'   => 'text_medium',
    'type' => 'text_medium',
]);

// Text email
$cmb->add_field([
    'name' => 'Email',
    'id'   => 'email',
    'type' => 'text_email',
]);

// Text URL
$cmb->add_field([
    'name' => 'Website URL',
    'id'   => 'website_url',
    'type' => 'text_url',
    'protocols' => ['http', 'https'], // Limit protocols
]);

// Text money
$cmb->add_field([
    'name' => 'Price',
    'id'   => 'price',
    'type' => 'text_money',
    'before_field' => '$', // Custom currency symbol
]);

// Textarea
$cmb->add_field([
    'name' => 'Description',
    'id'   => 'description',
    'type' => 'textarea',
    'attributes' => [
        'rows' => 5,
        'cols' => 50,
    ],
]);

// Textarea small
$cmb->add_field([
    'name' => 'Short Description',
    'id'   => 'short_description',
    'type' => 'textarea_small',
]);

// Textarea code
$cmb->add_field([
    'name' => 'Custom CSS',
    'id'   => 'custom_css',
    'type' => 'textarea_code',
    'attributes' => [
        'data-codeeditor' => json_encode([
            'codemirror' => [
                'mode' => 'css',
            ],
        ]),
    ],
]);
                        </code></pre>
                        
                        <h3>Date and Time Fields</h3>
                        <pre><code class="language-php">
// Date picker
$cmb->add_field([
    'name' => 'Event Date',
    'id'   => 'event_date',
    'type' => 'text_date',
    'date_format' => 'Y-m-d',
]);

// Date and time picker
$cmb->add_field([
    'name' => 'Event Date/Time',
    'id'   => 'event_datetime',
    'type' => 'text_datetime_timestamp',
    'attributes' => [
        'data-timepicker' => json_encode([
            'timeFormat' => 'HH:mm',
            'stepMinute' => 15,
        ]),
    ],
]);

// Time picker
$cmb->add_field([
    'name' => 'Event Time',
    'id'   => 'event_time',
    'type' => 'text_time',
    'time_format' => 'H:i', // 24-hour format
]);

// Date/Time picker with timezone
$cmb->add_field([
    'name' => 'Event with Timezone',
    'id'   => 'event_timezone',
    'type' => 'text_datetime_timestamp_timezone',
]);
                        </code></pre>
                        
                        <h3>Choice Fields</h3>
                        <pre><code class="language-php">
// Select
$cmb->add_field([
    'name'    => 'Select Field',
    'id'      => 'select_field',
    'type'    => 'select',
    'options' => [
        'option1' => 'Option 1',
        'option2' => 'Option 2',
        'option3' => 'Option 3',
    ],
    'default' => 'option1',
]);

// Radio
$cmb->add_field([
    'name'    => 'Radio Field',
    'id'      => 'radio_field',
    'type'    => 'radio',
    'options' => [
        'yes' => 'Yes',
        'no'  => 'No',
        'maybe' => 'Maybe',
    ],
    'default' => 'yes',
]);

// Radio inline
$cmb->add_field([
    'name'    => 'Radio Inline',
    'id'      => 'radio_inline',
    'type'    => 'radio_inline',
    'options' => [
        'small'  => 'Small',
        'medium' => 'Medium',
        'large'  => 'Large',
    ],
]);

// Checkbox
$cmb->add_field([
    'name' => 'Checkbox',
    'desc' => 'Check to enable',
    'id'   => 'checkbox',
    'type' => 'checkbox',
]);

// Multi-checkbox
$cmb->add_field([
    'name'    => 'Multi Checkbox',
    'id'      => 'multi_checkbox',
    'type'    => 'multicheck',
    'options' => [
        'check1' => 'Option 1',
        'check2' => 'Option 2',
        'check3' => 'Option 3',
    ],
]);

// Multi-checkbox inline
$cmb->add_field([
    'name'    => 'Multi Checkbox Inline',
    'id'      => 'multi_checkbox_inline',
    'type'    => 'multicheck_inline',
    'options' => [
        'opt1' => 'Option 1',
        'opt2' => 'Option 2',
        'opt3' => 'Option 3',
    ],
    'select_all_button' => false,
]);
                        </code></pre>
                        
                        <h3>Media Fields</h3>
                        <pre><code class="language-php">
// File upload
$cmb->add_field([
    'name' => 'Upload File',
    'id'   => 'file_upload',
    'type' => 'file',
    'options' => [
        'url' => false, // Hide the text input for the url
    ],
    'text' => [
        'add_upload_file_text' => 'Add File',
    ],
    'query_args' => [
        'type' => [
            'application/pdf',
        ],
    ],
    'preview_size' => 'large',
]);

// Multiple files
$cmb->add_field([
    'name' => 'Multiple Files',
    'id'   => 'file_list',
    'type' => 'file_list',
    'preview_size' => 'thumbnail',
    'query_args' => [
        'type' => 'image',
    ],
    'text' => [
        'add_upload_files_text' => 'Add Images',
        'remove_image_text' => 'Remove Image',
    ],
]);

// oEmbed
$cmb->add_field([
    'name' => 'YouTube Video',
    'id'   => 'youtube_embed',
    'type' => 'oembed',
]);
                        </code></pre>
                        
                        <h3>Color Picker</h3>
                        <pre><code class="language-php">
// Color picker
$cmb->add_field([
    'name' => 'Color Picker',
    'id'   => 'color_picker',
    'type' => 'colorpicker',
    'default' => '#ffffff',
    'attributes' => [
        'data-colorpicker' => json_encode([
            'palettes' => ['#f00', '#0f0', '#00f', '#000', '#fff'],
        ]),
    ],
]);

// RGBA color picker
$cmb->add_field([
    'name' => 'RGBA Color',
    'id'   => 'rgba_color',
    'type' => 'colorpicker',
    'default' => 'rgba(255,255,255,0.5)',
    'options' => [
        'alpha' => true,
    ],
]);
                        </code></pre>
                        
                        <h3>WYSIWYG Editor</h3>
                        <pre><code class="language-php">
// WYSIWYG editor
$cmb->add_field([
    'name'    => 'Content Editor',
    'id'      => 'wysiwyg_editor',
    'type'    => 'wysiwyg',
    'options' => [
        'wpautop' => true,
        'media_buttons' => true,
        'textarea_rows' => 10,
        'tabindex' => '',
        'editor_css' => '',
        'editor_class' => '',
        'teeny' => false,
        'dfw' => false,
        'tinymce' => true,
        'quicktags' => true,
    ],
]);
                        </code></pre>
                    </section>
                    
                    <!-- Advanced Fields -->
                    <section>
                        <h2>Advanced Field Types</h2>
                        
                        <h3>Repeatable Fields</h3>
                        <pre><code class="language-php">
// Repeatable text field
$cmb->add_field([
    'name' => 'Repeatable Text',
    'id'   => 'repeatable_text',
    'type' => 'text',
    'repeatable' => true,
    'text' => [
        'add_row_text' => 'Add Another Entry',
    ],
]);

// Repeatable group
$group_field_id = $cmb->add_field([
    'id'          => 'team_members',
    'type'        => 'group',
    'description' => 'Team member information',
    'repeatable'  => true,
    'options'     => [
        'group_title'   => 'Team Member {#}',
        'add_button'    => 'Add Another Member',
        'remove_button' => 'Remove Member',
        'sortable'      => true,
        'closed'        => true, // Start closed
    ],
]);

// Fields within the group
$cmb->add_group_field($group_field_id, [
    'name' => 'Name',
    'id'   => 'name',
    'type' => 'text',
]);

$cmb->add_group_field($group_field_id, [
    'name' => 'Title',
    'id'   => 'title',
    'type' => 'text',
]);

$cmb->add_group_field($group_field_id, [
    'name' => 'Bio',
    'id'   => 'bio',
    'type' => 'textarea_small',
]);

$cmb->add_group_field($group_field_id, [
    'name' => 'Photo',
    'id'   => 'photo',
    'type' => 'file',
]);

$cmb->add_group_field($group_field_id, [
    'name'    => 'Department',
    'id'      => 'department',
    'type'    => 'select',
    'options' => [
        'sales'      => 'Sales',
        'marketing'  => 'Marketing',
        'development' => 'Development',
        'support'    => 'Support',
    ],
]);
                        </code></pre>
                        
                        <h3>Taxonomy Fields</h3>
                        <pre><code class="language-php">
// Taxonomy select
$cmb->add_field([
    'name'     => 'Category',
    'id'       => 'category_select',
    'type'     => 'taxonomy_select',
    'taxonomy' => 'category',
    'remove_default' => true,
]);

// Taxonomy radio
$cmb->add_field([
    'name'     => 'Category Radio',
    'id'       => 'category_radio',
    'type'     => 'taxonomy_radio',
    'taxonomy' => 'category',
    'inline'   => true,
]);

// Taxonomy radio hierarchical
$cmb->add_field([
    'name'     => 'Category Hierarchical',
    'id'       => 'category_hierarchical',
    'type'     => 'taxonomy_radio_hierarchical',
    'taxonomy' => 'category',
]);

// Taxonomy multicheck
$cmb->add_field([
    'name'     => 'Tags',
    'id'       => 'tags_multicheck',
    'type'     => 'taxonomy_multicheck',
    'taxonomy' => 'post_tag',
]);

// Taxonomy multicheck hierarchical
$cmb->add_field([
    'name'     => 'Categories Multi',
    'id'       => 'categories_multi',
    'type'     => 'taxonomy_multicheck_hierarchical',
    'taxonomy' => 'category',
]);
                        </code></pre>
                    </section>
                    
                    <!-- Options Pages -->
                    <section>
                        <h2>Creating Options Pages</h2>
                        
                        <h3>Basic Options Page</h3>
                        <pre><code class="language-php">
add_action('cmb2_admin_init', 'register_theme_options_metabox');

function register_theme_options_metabox() {
    
    // Register main options page
    $main_options = new_cmb2_box([
        'id'           => 'theme_options_page',
        'title'        => 'Theme Options',
        'object_types' => ['options-page'],
        'option_key'   => 'theme_options', // The option key and admin menu page slug
        'icon_url'     => 'dashicons-admin-generic',
        'menu_title'   => 'Theme Options',
        'position'     => 2,
        'capability'   => 'manage_options',
        'save_button'  => 'Save Settings',
    ]);
    
    // Add fields
    $main_options->add_field([
        'name' => 'Site Logo',
        'id'   => 'site_logo',
        'type' => 'file',
        'query_args' => [
            'type' => 'image',
        ],
    ]);
    
    $main_options->add_field([
        'name' => 'Footer Text',
        'id'   => 'footer_text',
        'type' => 'textarea_small',
    ]);
    
    $main_options->add_field([
        'name'    => 'Color Scheme',
        'id'      => 'color_scheme',
        'type'    => 'select',
        'options' => [
            'light' => 'Light',
            'dark'  => 'Dark',
            'auto'  => 'Auto',
        ],
        'default' => 'light',
    ]);
}

// Get option value
$logo = cmb2_get_option('theme_options', 'site_logo');
$footer_text = cmb2_get_option('theme_options', 'footer_text');
                        </code></pre>
                        
                        <h3>Options Page with Tabs</h3>
                        <pre><code class="language-php">
add_action('cmb2_admin_init', 'register_tabbed_options_page');

function register_tabbed_options_page() {
    
    // Main options page
    $args = [
        'id'           => 'theme_options',
        'title'        => 'Theme Options',
        'object_types' => ['options-page'],
        'option_key'   => 'theme_options',
        'tab_group'    => 'theme_options',
        'tab_title'    => 'General',
    ];
    
    $main_options = new_cmb2_box($args);
    
    // General tab fields
    $main_options->add_field([
        'name' => 'Site Title',
        'id'   => 'site_title',
        'type' => 'text',
    ]);
    
    // Header tab
    $args['id'] = 'theme_options_header';
    $args['title'] = 'Header Settings';
    $args['tab_title'] = 'Header';
    
    $header_options = new_cmb2_box($args);
    
    $header_options->add_field([
        'name' => 'Header Logo',
        'id'   => 'header_logo',
        'type' => 'file',
    ]);
    
    $header_options->add_field([
        'name' => 'Sticky Header',
        'id'   => 'sticky_header',
        'type' => 'checkbox',
    ]);
    
    // Footer tab
    $args['id'] = 'theme_options_footer';
    $args['title'] = 'Footer Settings';
    $args['tab_title'] = 'Footer';
    
    $footer_options = new_cmb2_box($args);
    
    $footer_options->add_field([
        'name' => 'Footer Columns',
        'id'   => 'footer_columns',
        'type' => 'select',
        'options' => [
            '1' => '1 Column',
            '2' => '2 Columns',
            '3' => '3 Columns',
            '4' => '4 Columns',
        ],
        'default' => '3',
    ]);
    
    $footer_options->add_field([
        'name' => 'Copyright Text',
        'id'   => 'copyright_text',
        'type' => 'textarea_small',
    ]);
}
                        </code></pre>
                    </section>
                    
                    <!-- Custom Field Types -->
                    <section>
                        <h2>Creating Custom Field Types</h2>
                        
                        <h3>Custom Field Type Example</h3>
                        <pre><code class="language-php">
// Register custom field type
add_action('cmb2_render_address', 'render_address_field_type', 10, 5);
add_filter('cmb2_sanitize_address', 'sanitize_address_field_type', 10, 2);

function render_address_field_type($field, $value, $object_id, $object_type, $field_type) {
    
    // Parse value
    $value = wp_parse_args($value, [
        'street' => '',
        'city' => '',
        'state' => '',
        'zip' => '',
    ]);
    
    ?>
    &lt;div class="cmb-row cmb-address-field"&gt;
        &lt;div class="cmb-td"&gt;
            &lt;label for="&lt;?php echo $field_type->_id('_street'); ?&gt;"&gt;Street&lt;/label&gt;
            &lt;?php echo $field_type->input([
                'name'  => $field_type->_name('[street]'),
                'id'    => $field_type->_id('_street'),
                'value' => $value['street'],
                'desc'  => '',
            ]); ?&gt;
        &lt;/div&gt;
        
        &lt;div class="cmb-td"&gt;
            &lt;label for="&lt;?php echo $field_type->_id('_city'); ?&gt;"&gt;City&lt;/label&gt;
            &lt;?php echo $field_type->input([
                'name'  => $field_type->_name('[city]'),
                'id'    => $field_type->_id('_city'),
                'value' => $value['city'],
                'desc'  => '',
            ]); ?&gt;
        &lt;/div&gt;
        
        &lt;div class="cmb-td"&gt;
            &lt;label for="&lt;?php echo $field_type->_id('_state'); ?&gt;"&gt;State&lt;/label&gt;
            &lt;?php echo $field_type->input([
                'name'  => $field_type->_name('[state]'),
                'id'    => $field_type->_id('_state'),
                'value' => $value['state'],
                'desc'  => '',
                'class' => 'cmb2-text-small',
            ]); ?&gt;
        &lt;/div&gt;
        
        &lt;div class="cmb-td"&gt;
            &lt;label for="&lt;?php echo $field_type->_id('_zip'); ?&gt;"&gt;ZIP&lt;/label&gt;
            &lt;?php echo $field_type->input([
                'name'  => $field_type->_name('[zip]'),
                'id'    => $field_type->_id('_zip'),
                'value' => $value['zip'],
                'desc'  => '',
                'class' => 'cmb2-text-small',
            ]); ?&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;p class="cmb2-metabox-description"&gt;&lt;?php echo $field->args('desc'); ?&gt;&lt;/p&gt;
    
    &lt;style&gt;
        .cmb-address-field {
            display: flex;
            gap: 15px;
        }
        .cmb-address-field .cmb-td {
            flex: 1;
        }
        .cmb-address-field label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
    &lt;/style&gt;
    &lt;?php
}

function sanitize_address_field_type($override_value, $value) {
    if (!is_array($value)) {
        return $override_value;
    }
    
    return array_map('sanitize_text_field', $value);
}

// Use the custom field type
$cmb->add_field([
    'name' => 'Business Address',
    'id'   => 'business_address',
    'type' => 'address',
    'desc' => 'Enter the complete address',
]);
                        </code></pre>
                        
                        <h3>Advanced Custom Field</h3>
                        <pre><code class="language-php">
// Star rating field type
add_action('cmb2_render_star_rating', 'render_star_rating_field', 10, 5);
add_filter('cmb2_sanitize_star_rating', 'sanitize_star_rating', 10, 2);

function render_star_rating_field($field, $value, $object_id, $object_type, $field_type) {
    $value = absint($value);
    ?>
    &lt;div class="star-rating-field" data-field-id="&lt;?php echo $field_type->_id(); ?&gt;"&gt;
        &lt;input type="hidden" 
               name="&lt;?php echo $field_type->_name(); ?&gt;" 
               id="&lt;?php echo $field_type->_id(); ?&gt;" 
               value="&lt;?php echo $value; ?&gt;" /&gt;
        
        &lt;div class="stars"&gt;
            &lt;?php for ($i = 1; $i <= 5; $i++): ?&gt;
                &lt;span class="star &lt;?php echo $i <= $value ? 'filled' : ''; ?&gt;" 
                      data-rating="&lt;?php echo $i; ?&gt;"&gt;
                    ★
                &lt;/span&gt;
            &lt;?php endfor; ?&gt;
        &lt;/div&gt;
        
        &lt;span class="rating-text"&gt;
            &lt;?php echo $value ? $value . ' out of 5' : 'Not rated'; ?&gt;
        &lt;/span&gt;
    &lt;/div&gt;
    
    &lt;style&gt;
        .star-rating-field .stars {
            display: inline-block;
            font-size: 24px;
        }
        .star-rating-field .star {
            color: #ddd;
            cursor: pointer;
            transition: color 0.2s;
        }
        .star-rating-field .star.filled {
            color: #ffd700;
        }
        .star-rating-field .star:hover {
            color: #ffd700;
        }
        .rating-text {
            margin-left: 10px;
            color: #666;
        }
    &lt;/style&gt;
    
    &lt;script&gt;
    jQuery(document).ready(function($) {
        $('.star-rating-field').each(function() {
            var $field = $(this);
            var $input = $field.find('input');
            var $text = $field.find('.rating-text');
            
            $field.find('.star').on('click', function() {
                var rating = $(this).data('rating');
                $input.val(rating);
                
                $field.find('.star').removeClass('filled');
                $field.find('.star').each(function(index) {
                    if (index < rating) {
                        $(this).addClass('filled');
                    }
                });
                
                $text.text(rating + ' out of 5');
            });
            
            $field.find('.star').hover(
                function() {
                    var hoverRating = $(this).data('rating');
                    $field.find('.star').each(function(index) {
                        if (index < hoverRating) {
                            $(this).addClass('filled');
                        } else {
                            $(this).removeClass('filled');
                        }
                    });
                },
                function() {
                    var currentRating = $input.val();
                    $field.find('.star').each(function(index) {
                        if (index < currentRating) {
                            $(this).addClass('filled');
                        } else {
                            $(this).removeClass('filled');
                        }
                    });
                }
            );
        });
    });
    &lt;/script&gt;
    &lt;?php
}

function sanitize_star_rating($override_value, $value) {
    return absint($value);
}

// Use star rating field
$cmb->add_field([
    'name' => 'Product Rating',
    'id'   => 'product_rating',
    'type' => 'star_rating',
    'desc' => 'Rate this product',
]);
                        </code></pre>
                    </section>
                    
                    <!-- Conditional Display -->
                    <section>
                        <h2>Conditional Display</h2>
                        
                        <h3>Show/Hide Callbacks</h3>
                        <pre><code class="language-php">
// Show field only on specific pages
$cmb->add_field([
    'name' => 'Homepage Hero',
    'id'   => 'homepage_hero',
    'type' => 'file',
    'show_on_cb' => 'show_on_homepage',
]);

function show_on_homepage($field) {
    // Only show on homepage
    if (isset($field->object_id)) {
        return $field->object_id == get_option('page_on_front');
    }
    return false;
}

// Show based on user role
$cmb->add_field([
    'name' => 'Admin Notes',
    'id'   => 'admin_notes',
    'type' => 'textarea',
    'show_on_cb' => 'show_for_admins',
]);

function show_for_admins() {
    return current_user_can('manage_options');
}

// Show based on post meta value
$cmb->add_field([
    'name' => 'Special Content',
    'id'   => 'special_content',
    'type' => 'wysiwyg',
    'show_on_cb' => 'show_if_special',
]);

function show_if_special($field) {
    $is_special = get_post_meta($field->object_id, '_is_special', true);
    return $is_special === 'yes';
}
                        </code></pre>
                    </section>
                    
                    <!-- Getting and Using Values -->
                    <section>
                        <h2>Getting and Using CMB2 Values</h2>
                        
                        <h3>Getting Values in Templates</h3>
                        <pre><code class="language-php">
// Get post meta
$text_value = get_post_meta(get_the_ID(), 'wiki_test_text', true);

// Get repeatable group
$team_members = get_post_meta(get_the_ID(), 'team_members', true);

if ($team_members) {
    foreach ($team_members as $member) {
        echo '&lt;div class="team-member"&gt;';
        echo '&lt;h3&gt;' . esc_html($member['name']) . '&lt;/h3&gt;';
        echo '&lt;p&gt;' . esc_html($member['title']) . '&lt;/p&gt;';
        echo '&lt;p&gt;' . esc_html($member['bio']) . '&lt;/p&gt;';
        
        if ($member['photo']) {
            echo wp_get_attachment_image($member['photo'], 'thumbnail');
        }
        
        echo '&lt;/div&gt;';
    }
}

// Get options page values
$site_logo = cmb2_get_option('theme_options', 'site_logo');
$footer_text = cmb2_get_option('theme_options', 'footer_text');

// Helper function for getting meta
function get_cmb_value($key) {
    return get_post_meta(get_the_ID(), $key, true);
}

// Use in template
$price = get_cmb_value('price');
if ($price) {
    echo '&lt;div class="price"&gt;$' . esc_html($price) . '&lt;/div&gt;';
}
                        </code></pre>
                    </section>
                    
                    <!-- Best Practices -->
                    <section>
                        <h2>CMB2 Best Practices</h2>
                        
                        <h3>Organizing CMB2 Code</h3>
                        <pre><code class="language-php">
// Create a CMB2 functions file
// includes/cmb2-functions.php

class Theme_CMB2 {
    
    private static $prefix = '_theme_';
    
    public static function init() {
        add_action('cmb2_admin_init', [__CLASS__, 'register_metaboxes']);
    }
    
    public static function register_metaboxes() {
        self::page_metabox();
        self::post_metabox();
        self::theme_options();
    }
    
    private static function page_metabox() {
        $cmb = new_cmb2_box([
            'id'           => self::$prefix . 'page_metabox',
            'title'        => 'Page Settings',
            'object_types' => ['page'],
        ]);
        
        $cmb->add_field([
            'name' => 'Subtitle',
            'id'   => self::$prefix . 'subtitle',
            'type' => 'text',
        ]);
        
        $cmb->add_field([
            'name' => 'Hide Title',
            'id'   => self::$prefix . 'hide_title',
            'type' => 'checkbox',
        ]);
    }
    
    private static function post_metabox() {
        $cmb = new_cmb2_box([
            'id'           => self::$prefix . 'post_metabox',
            'title'        => 'Post Settings',
            'object_types' => ['post'],
        ]);
        
        $cmb->add_field([
            'name' => 'Featured',
            'id'   => self::$prefix . 'featured',
            'type' => 'checkbox',
        ]);
    }
    
    private static function theme_options() {
        $cmb = new_cmb2_box([
            'id'           => self::$prefix . 'theme_options',
            'title'        => 'Theme Options',
            'object_types' => ['options-page'],
            'option_key'   => 'theme_options',
        ]);
        
        $cmb->add_field([
            'name' => 'Logo',
            'id'   => 'logo',
            'type' => 'file',
        ]);
    }
    
    // Helper function to get values
    public static function get_value($key, $post_id = null) {
        if (!$post_id) {
            $post_id = get_the_ID();
        }
        
        return get_post_meta($post_id, self::$prefix . $key, true);
    }
    
    // Helper function for options
    public static function get_option($key) {
        return cmb2_get_option('theme_options', $key);
    }
}

// Initialize
Theme_CMB2::init();

// Usage in templates
$subtitle = Theme_CMB2::get_value('subtitle');
$logo = Theme_CMB2::get_option('logo');
                        </code></pre>
                    </section>
                    
                    <!-- Summary -->
                    <section>
                        <h2>Summary</h2>
                        
                        <div class="summary-box">
                            <h3>Key Takeaways</h3>
                            <ul>
                                <li>CMB2 simplifies metabox creation with a clean API</li>
                                <li>Extensive field types cover most use cases</li>
                                <li>Repeatable groups enable complex data structures</li>
                                <li>Options pages are easy to create and manage</li>
                                <li>Custom field types extend functionality</li>
                                <li>Conditional display enhances user experience</li>
                                <li>Proper organization improves maintainability</li>
                            </ul>
                        </div>
                        
                        <div class="best-practices">
                            <h3>CMB2 Best Practices</h3>
                            <ul>
                                <li>Use consistent prefixes for field IDs</li>
                                <li>Organize metaboxes in separate files or classes</li>
                                <li>Create helper functions for getting values</li>
                                <li>Use field descriptions to guide users</li>
                                <li>Implement proper sanitization for custom fields</li>
                                <li>Test metaboxes with different user roles</li>
                                <li>Consider performance with large repeatable groups</li>
                            </ul>
                        </div>
                    </section>
                    
                    <!-- Additional Resources -->
                    <section class="resources">
                        <h2>Additional Resources</h2>
                        <ul>
                            <li><a href="https://github.com/CMB2/CMB2" target="_blank">CMB2 GitHub Repository</a></li>
                            <li><a href="https://cmb2.io/" target="_blank">CMB2 Documentation</a></li>
                            <li><a href="https://github.com/CMB2/CMB2/wiki/Field-Types" target="_blank">CMB2 Field Types Reference</a></li>
                            <li><a href="https://github.com/CMB2/CMB2-Snippet-Library" target="_blank">CMB2 Code Snippets</a></li>
                            <li><a href="https://github.com/jtsternberg/CMB2-Code-Snippets" target="_blank">Advanced CMB2 Examples</a></li>
                        </ul>
                    </section>
                </div>
                
                <!-- Lesson Navigation -->
                <div class="lesson-navigation">
                    <a href="/07module/custom_metaboxes.html" class="lesson-nav-button prev">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"/>
                        </svg>
                        <span>
                            <small>Previous</small><br>
                            Custom Metaboxes
                        </span>
                    </a>
                    
                    <button class="complete-lesson-btn">
                        Mark as Complete
                    </button>
                    
                    <a href="/module7.html" class="lesson-nav-button next">
                        <span>
                            <small>Next</small><br>
                            Module 7 Overview
                        </span>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="site-footer" role="contentinfo">
            <div class="footer-container">
                <div class="footer-content">
                    <div class="footer-section footer-about">
                        <h3>PHP WordPress Development</h3>
                        <p>Complete Web Development Course - From HTML to WordPress</p>
                    </div>
                    
                    <div class="footer-section">
                        <h4>Quick Links</h4>
                        <ul class="footer-links">
                            <li><a href="/">Home</a></li>
                            <li><a href="/module7.html">Module 7</a></li>
                            <li><a href="/resources.html">Resources</a></li>
                            <li><a href="/about.html">About</a></li>
                        </ul>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <p>&copy; 2025 PHP WordPress Development Course. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- JavaScript -->
    <script src="/assets/js/prism.js"></script>
    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/lesson.js"></script>
</body>
</html>