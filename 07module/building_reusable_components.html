<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
    <!-- SEO Meta Tags -->
    <title>Building Reusable Components - PHP WordPress Course</title>
    <meta name="description" content="Learn how to build reusable components in WordPress. Create modular, maintainable code with component-based architecture.">
    <meta name="keywords" content="WordPress, reusable components, modular development, component architecture, WordPress development">
    <meta name="author" content="PHP WordPress Course">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Building Reusable Components">
    <meta property="og:description" content="Master component-based development in WordPress applications">
    <meta property="og:type" content="article">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="/assets/css/prism.css" rel="stylesheet">
</head>
<body>
    <!-- Skip to main content -->
    <a href="#main-content" class="sr-only">Skip to main content</a>
    
    <div class="page-wrapper">
        <!-- Header -->
        <header class="site-header" role="banner">
            <div class="header-container">
                <div class="site-branding">
                    <a href="/" class="site-logo">
                        <h1 class="site-title">PHP WordPress Development</h1>
                    </a>
                </div>
                
                <nav class="main-navigation" role="navigation" aria-label="Main navigation">
                    <button class="mobile-menu-btn" aria-label="Toggle navigation" aria-expanded="false">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    
                    <div class="nav-menu">
                        <ul class="nav-list">
                            <li class="nav-item"><a href="/" class="nav-link">Home</a></li>
                            <li class="nav-item dropdown">
                                <button class="nav-link dropdown-toggle active" aria-haspopup="true">Modules</button>
                                <div class="dropdown-menu">
                                    <a href="/module1.html" class="dropdown-item">Module 1: Web Fundamentals</a>
                                    <a href="/module2.html" class="dropdown-item">Module 2: PHP Fundamentals</a>
                                    <a href="/module3.html" class="dropdown-item">Module 3: MySQL Database</a>
                                    <a href="/module4.html" class="dropdown-item">Module 4: WordPress & Docker</a>
                                    <a href="/module5.html" class="dropdown-item">Module 5: Theme Development</a>
                                    <a href="/module6.html" class="dropdown-item">Module 6: Plugin Development</a>
                                    <a href="/module7.html" class="dropdown-item active">Module 7: Advanced WordPress</a>
                                    <a href="/module8.html" class="dropdown-item">Module 8: Deployment</a>
                                    <a href="/module9.html" class="dropdown-item">Module 9: Final Project</a>
                                </div>
                            </li>
                            <li class="nav-item"><a href="/resources.html" class="nav-link">Resources</a></li>
                            <li class="nav-item"><a href="/about.html" class="nav-link">About</a></li>
                        </ul>
                    </div>
                </nav>
                
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                        </svg>
                        <input type="search" class="search-input" placeholder="Search lessons..." aria-label="Search">
                    </div>
                    <div class="search-results"></div>
                </div>
            </div>
        </header>
        
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-header">
                <h2 class="progress-title">Course Progress</h2>
                <span class="progress-text">Loading...</span>
            </div>
            <div class="progress-bar">
                <div class="progress-bar-fill">
                    <span class="progress-bar-text"></span>
                </div>
            </div>
        </div>
        
        <!-- Breadcrumb -->
        <nav class="breadcrumb container" aria-label="Breadcrumb">
            <ol class="breadcrumb-list">
                <li class="breadcrumb-item">
                    <a href="/">Home</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <a href="/module7.html">Module 7</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <span aria-current="page">Building Reusable Components</span>
                </li>
            </ol>
        </nav>
        
        <!-- Main Content -->
        <main id="main-content" class="main-content" role="main">
            <div class="container">
                <!-- Lesson Header -->
                <div class="lesson-header">
                    <h1 class="lesson-title">Building Reusable Components</h1>
                    <p class="lesson-subtitle">Create modular, maintainable WordPress components</p>
                </div>
                
                <!-- Learning Objectives -->
                <div class="lesson-objectives">
                    <h2>Learning Objectives</h2>
                    <p>By the end of this lesson, you will be able to:</p>
                    <ul>
                        <li>Design component-based architecture</li>
                        <li>Build reusable UI components</li>
                        <li>Create form components with validation</li>
                        <li>Implement data table components</li>
                        <li>Build notification and modal systems</li>
                        <li>Package components for distribution</li>
                    </ul>
                </div>
                
                <!-- Lesson Body -->
                <div class="lesson-body">
                    <!-- Component Architecture -->
                    <section>
                        <h2>Component Architecture in WordPress</h2>
                        
                        <p>Components are self-contained, reusable pieces of functionality that can be composed to build complex applications.</p>
                        
                        <div class="info-box">
                            <h3>Component Principles</h3>
                            <ul>
                                <li><strong>Single Responsibility:</strong> Each component has one clear purpose</li>
                                <li><strong>Encapsulation:</strong> Components manage their own state and behavior</li>
                                <li><strong>Reusability:</strong> Can be used in multiple contexts</li>
                                <li><strong>Composability:</strong> Components can be combined</li>
                                <li><strong>Testability:</strong> Components can be tested in isolation</li>
                            </ul>
                        </div>
                        
                        <h3>Component Structure</h3>
                        <pre><code class="language-text">
components/
├── Button/
│   ├── Button.php           # PHP class
│   ├── button.js           # JavaScript
│   ├── button.scss         # Styles
│   ├── button.twig         # Template
│   └── README.md           # Documentation
├── Card/
├── Modal/
├── DataTable/
├── Form/
└── Notification/
                        </code></pre>
                    </section>
                    
                    <!-- Base Component Class -->
                    <section>
                        <h2>Base Component Class</h2>
                        
                        <pre><code class="language-php">
// src/Components/Component.php
namespace App\Components;

abstract class Component {
    protected $attributes = [];
    protected $data = [];
    protected static $instances = 0;
    protected $id;
    
    public function __construct($data = [], $attributes = []) {
        $this->data = $data;
        $this->attributes = $attributes;
        $this->id = $this->generateId();
        $this->init();
    }
    
    protected function init() {
        // Override in child classes
    }
    
    protected function generateId() {
        static::$instances++;
        return strtolower(class_basename($this)) . '-' . static::$instances;
    }
    
    public function render() {
        $this->enqueueAssets();
        return $this->template();
    }
    
    public function __toString() {
        return $this->render();
    }
    
    protected function enqueueAssets() {
        // Enqueue component-specific assets
        $componentName = strtolower(class_basename($this));
        
        wp_enqueue_style(
            "component-{$componentName}",
            $this->getAssetUrl("css/{$componentName}.css"),
            [],
            $this->getVersion()
        );
        
        wp_enqueue_script(
            "component-{$componentName}",
            $this->getAssetUrl("js/{$componentName}.js"),
            ['jquery'],
            $this->getVersion(),
            true
        );
        
        // Pass data to JavaScript
        wp_localize_script(
            "component-{$componentName}",
            "{$componentName}Data",
            $this->getJsData()
        );
    }
    
    protected function getJsData() {
        return [
            'id' => $this->id,
            'ajaxUrl' => admin_url('admin-ajax.php'),
            'nonce' => wp_create_nonce($this->id)
        ];
    }
    
    protected function getAssetUrl($path) {
        return plugins_url("assets/{$path}", dirname(__FILE__, 2));
    }
    
    protected function getVersion() {
        return defined('WP_DEBUG') && WP_DEBUG ? time() : '1.0.0';
    }
    
    protected function template() {
        $template = $this->getTemplate();
        
        if (file_exists($template)) {
            ob_start();
            extract($this->getTemplateData());
            include $template;
            return ob_get_clean();
        }
        
        return '';
    }
    
    protected function getTemplate() {
        $componentName = strtolower(class_basename($this));
        return dirname(__FILE__) . "/templates/{$componentName}.php";
    }
    
    protected function getTemplateData() {
        return array_merge($this->data, [
            'id' => $this->id,
            'attributes' => $this->buildAttributes()
        ]);
    }
    
    protected function buildAttributes() {
        $attrs = array_merge($this->attributes, [
            'id' => $this->id,
            'class' => $this->getClasses()
        ]);
        
        $html = '';
        foreach ($attrs as $key => $value) {
            if ($value !== null && $value !== false) {
                $html .= sprintf(' %s="%s"', esc_attr($key), esc_attr($value));
            }
        }
        
        return $html;
    }
    
    protected function getClasses() {
        $classes = ['component', strtolower(class_basename($this))];
        
        if (isset($this->attributes['class'])) {
            $classes[] = $this->attributes['class'];
        }
        
        return implode(' ', $classes);
    }
    
    public function setAttribute($key, $value) {
        $this->attributes[$key] = $value;
        return $this;
    }
    
    public function setData($key, $value = null) {
        if (is_array($key)) {
            $this->data = array_merge($this->data, $key);
        } else {
            $this->data[$key] = $value;
        }
        return $this;
    }
}
                        </code></pre>
                    </section>
                    
                    <!-- Button Component -->
                    <section>
                        <h2>Button Component</h2>
                        
                        <h3>PHP Implementation</h3>
                        <pre><code class="language-php">
// src/Components/Button/Button.php
namespace App\Components;

class Button extends Component {
    protected $type = 'button';
    protected $variant = 'primary';
    protected $size = 'medium';
    protected $icon = null;
    protected $loading = false;
    protected $disabled = false;
    
    public function __construct($text, $options = []) {
        $this->data['text'] = $text;
        
        foreach (['type', 'variant', 'size', 'icon', 'loading', 'disabled'] as $option) {
            if (isset($options[$option])) {
                $this->$option = $options[$option];
            }
        }
        
        parent::__construct($this->data, $options['attributes'] ?? []);
    }
    
    public static function primary($text, $attributes = []) {
        return new static($text, array_merge($attributes, ['variant' => 'primary']));
    }
    
    public static function secondary($text, $attributes = []) {
        return new static($text, array_merge($attributes, ['variant' => 'secondary']));
    }
    
    public static function danger($text, $attributes = []) {
        return new static($text, array_merge($attributes, ['variant' => 'danger']));
    }
    
    public static function submit($text, $attributes = []) {
        return new static($text, array_merge($attributes, ['type' => 'submit']));
    }
    
    protected function getClasses() {
        $classes = parent::getClasses();
        $classes .= " btn btn-{$this->variant} btn-{$this->size}";
        
        if ($this->loading) {
            $classes .= ' btn-loading';
        }
        
        if ($this->disabled) {
            $classes .= ' btn-disabled';
        }
        
        if ($this->icon) {
            $classes .= ' btn-has-icon';
        }
        
        return $classes;
    }
    
    protected function getTemplateData() {
        return array_merge(parent::getTemplateData(), [
            'type' => $this->type,
            'icon' => $this->icon,
            'loading' => $this->loading,
            'disabled' => $this->disabled || $this->loading
        ]);
    }
}

// templates/button.php
&lt;button type="&lt;?php echo esc_attr($type); ?&gt;" 
        &lt;?php echo $attributes; ?&gt;
        &lt;?php echo $disabled ? 'disabled' : ''; ?&gt;&gt;
    &lt;?php if ($loading): ?&gt;
        &lt;span class="spinner"&gt;&lt;/span&gt;
    &lt;?php endif; ?&gt;
    
    &lt;?php if ($icon): ?&gt;
        &lt;span class="btn-icon"&gt;
            &lt;?php echo $icon; // Icon should be sanitized SVG or icon class ?&gt;
        &lt;/span&gt;
    &lt;?php endif; ?&gt;
    
    &lt;span class="btn-text"&gt;&lt;?php echo esc_html($text); ?&gt;&lt;/span&gt;
&lt;/button&gt;
                        </code></pre>
                        
                        <h3>JavaScript Enhancement</h3>
                        <pre><code class="language-javascript">
// assets/js/button.js
(function($) {
    'use strict';
    
    class Button {
        constructor(element) {
            this.$element = $(element);
            this.init();
        }
        
        init() {
            this.bindEvents();
            this.setupLoadingState();
        }
        
        bindEvents() {
            this.$element.on('click', this.handleClick.bind(this));
        }
        
        handleClick(e) {
            if (this.$element.hasClass('btn-loading') || this.$element.prop('disabled')) {
                e.preventDefault();
                return false;
            }
            
            if (this.$element.data('confirm')) {
                if (!confirm(this.$element.data('confirm'))) {
                    e.preventDefault();
                    return false;
                }
            }
            
            if (this.$element.data('ajax')) {
                e.preventDefault();
                this.handleAjax();
            }
        }
        
        handleAjax() {
            this.setLoading(true);
            
            $.ajax({
                url: this.$element.data('ajax-url') || buttonData.ajaxUrl,
                method: this.$element.data('ajax-method') || 'POST',
                data: {
                    action: this.$element.data('ajax-action'),
                    nonce: buttonData.nonce,
                    ...this.$element.data('ajax-data')
                },
                success: (response) => {
                    this.handleSuccess(response);
                },
                error: (xhr, status, error) => {
                    this.handleError(error);
                },
                complete: () => {
                    this.setLoading(false);
                }
            });
        }
        
        setLoading(loading) {
            if (loading) {
                this.$element.addClass('btn-loading').prop('disabled', true);
                this.originalText = this.$element.find('.btn-text').text();
                this.$element.find('.btn-text').text(this.$element.data('loading-text') || 'Loading...');
            } else {
                this.$element.removeClass('btn-loading').prop('disabled', false);
                if (this.originalText) {
                    this.$element.find('.btn-text').text(this.originalText);
                }
            }
        }
        
        handleSuccess(response) {
            if (response.redirect) {
                window.location.href = response.redirect;
            } else if (response.message) {
                this.showMessage(response.message, 'success');
            }
            
            this.$element.trigger('button:success', response);
        }
        
        handleError(error) {
            this.showMessage(error || 'An error occurred', 'error');
            this.$element.trigger('button:error', error);
        }
        
        showMessage(message, type) {
            // Integrate with notification component
            if (window.NotificationComponent) {
                window.NotificationComponent.show(message, type);
            } else {
                alert(message);
            }
        }
        
        setupLoadingState() {
            if (this.$element.closest('form').length) {
                this.$element.closest('form').on('submit', () => {
                    if (this.$element.attr('type') === 'submit') {
                        this.setLoading(true);
                    }
                });
            }
        }
    }
    
    // Initialize all buttons
    $(document).ready(function() {
        $('.btn').each(function() {
            new Button(this);
        });
    });
    
    // Export for external use
    window.ButtonComponent = Button;
    
})(jQuery);
                        </code></pre>
                    </section>
                    
                    <!-- Card Component -->
                    <section>
                        <h2>Card Component</h2>
                        
                        <pre><code class="language-php">
// src/Components/Card/Card.php
namespace App\Components;

class Card extends Component {
    protected $title;
    protected $subtitle;
    protected $content;
    protected $image;
    protected $actions = [];
    protected $footer;
    protected $variant = 'default';
    
    public function __construct($options = []) {
        foreach (['title', 'subtitle', 'content', 'image', 'footer', 'variant'] as $option) {
            if (isset($options[$option])) {
                $this->$option = $options[$option];
            }
        }
        
        parent::__construct([], $options['attributes'] ?? []);
    }
    
    public function addAction($action) {
        if ($action instanceof Button) {
            $this->actions[] = $action;
        } elseif (is_array($action)) {
            $this->actions[] = new Button($action['text'], $action);
        }
        return $this;
    }
    
    public function setContent($content) {
        if (is_callable($content)) {
            $this->content = $content();
        } else {
            $this->content = $content;
        }
        return $this;
    }
    
    protected function getTemplateData() {
        return array_merge(parent::getTemplateData(), [
            'title' => $this->title,
            'subtitle' => $this->subtitle,
            'content' => $this->content,
            'image' => $this->image,
            'actions' => $this->actions,
            'footer' => $this->footer,
            'variant' => $this->variant
        ]);
    }
    
    protected function getClasses() {
        return parent::getClasses() . " card-{$this->variant}";
    }
}

// templates/card.php
&lt;div &lt;?php echo $attributes; ?&gt;&gt;
    &lt;?php if ($image): ?&gt;
        &lt;div class="card-image"&gt;
            &lt;?php if (is_array($image)): ?&gt;
                &lt;img src="&lt;?php echo esc_url($image['url']); ?&gt;" 
                     alt="&lt;?php echo esc_attr($image['alt'] ?? ''); ?&gt;"&gt;
            &lt;?php else: ?&gt;
                &lt;img src="&lt;?php echo esc_url($image); ?&gt;" alt=""&gt;
            &lt;?php endif; ?&gt;
        &lt;/div&gt;
    &lt;?php endif; ?&gt;
    
    &lt;div class="card-body"&gt;
        &lt;?php if ($title): ?&gt;
            &lt;h3 class="card-title"&gt;&lt;?php echo esc_html($title); ?&gt;&lt;/h3&gt;
        &lt;?php endif; ?&gt;
        
        &lt;?php if ($subtitle): ?&gt;
            &lt;p class="card-subtitle"&gt;&lt;?php echo esc_html($subtitle); ?&gt;&lt;/p&gt;
        &lt;?php endif; ?&gt;
        
        &lt;?php if ($content): ?&gt;
            &lt;div class="card-content"&gt;
                &lt;?php echo wp_kses_post($content); ?&gt;
            &lt;/div&gt;
        &lt;?php endif; ?&gt;
        
        &lt;?php if (!empty($actions)): ?&gt;
            &lt;div class="card-actions"&gt;
                &lt;?php foreach ($actions as $action): ?&gt;
                    &lt;?php echo $action->render(); ?&gt;
                &lt;?php endforeach; ?&gt;
            &lt;/div&gt;
        &lt;?php endif; ?&gt;
    &lt;/div&gt;
    
    &lt;?php if ($footer): ?&gt;
        &lt;div class="card-footer"&gt;
            &lt;?php echo wp_kses_post($footer); ?&gt;
        &lt;/div&gt;
    &lt;?php endif; ?&gt;
&lt;/div&gt;
                        </code></pre>
                    </section>
                    
                    <!-- Data Table Component -->
                    <section>
                        <h2>Data Table Component</h2>
                        
                        <pre><code class="language-php">
// src/Components/DataTable/DataTable.php
namespace App\Components;

class DataTable extends Component {
    protected $columns = [];
    protected $data = [];
    protected $searchable = true;
    protected $sortable = true;
    protected $paginated = true;
    protected $perPage = 10;
    protected $actions = [];
    protected $bulkActions = [];
    protected $ajax = false;
    
    public function __construct($options = []) {
        foreach ($options as $key => $value) {
            if (property_exists($this, $key)) {
                $this->$key = $value;
            }
        }
        
        parent::__construct();
        
        if ($this->ajax) {
            $this->registerAjaxHandlers();
        }
    }
    
    public function addColumn($key, $label, $options = []) {
        $this->columns[$key] = array_merge([
            'key' => $key,
            'label' => $label,
            'sortable' => true,
            'searchable' => true,
            'type' => 'text',
            'width' => null,
            'formatter' => null,
            'className' => ''
        ], $options);
        
        return $this;
    }
    
    public function setData($data) {
        $this->data = $data;
        return $this;
    }
    
    public function addAction($key, $label, $callback, $options = []) {
        $this->actions[$key] = array_merge([
            'label' => $label,
            'callback' => $callback,
            'icon' => null,
            'confirm' => false,
            'className' => 'button-link'
        ], $options);
        
        return $this;
    }
    
    public function addBulkAction($key, $label, $callback) {
        $this->bulkActions[$key] = [
            'label' => $label,
            'callback' => $callback
        ];
        
        return $this;
    }
    
    protected function getTemplateData() {
        return array_merge(parent::getTemplateData(), [
            'columns' => $this->columns,
            'rows' => $this->prepareRows(),
            'searchable' => $this->searchable,
            'sortable' => $this->sortable,
            'paginated' => $this->paginated,
            'actions' => $this->actions,
            'bulkActions' => $this->bulkActions,
            'pagination' => $this->getPagination()
        ]);
    }
    
    protected function prepareRows() {
        $rows = [];
        
        foreach ($this->data as $item) {
            $row = [];
            
            foreach ($this->columns as $key => $column) {
                $value = $this->getCellValue($item, $key, $column);
                $row[$key] = $this->formatCellValue($value, $column);
            }
            
            if (!empty($this->actions)) {
                $row['_actions'] = $this->renderRowActions($item);
            }
            
            $row['_raw'] = $item;
            $rows[] = $row;
        }
        
        return $rows;
    }
    
    protected function getCellValue($item, $key, $column) {
        if (is_object($item)) {
            return $item->$key ?? '';
        } elseif (is_array($item)) {
            return $item[$key] ?? '';
        }
        return '';
    }
    
    protected function formatCellValue($value, $column) {
        if ($column['formatter']) {
            if (is_callable($column['formatter'])) {
                return call_user_func($column['formatter'], $value);
            }
        }
        
        switch ($column['type']) {
            case 'date':
                return date_i18n(get_option('date_format'), strtotime($value));
                
            case 'datetime':
                return date_i18n(get_option('date_format') . ' ' . get_option('time_format'), strtotime($value));
                
            case 'currency':
                return wc_price($value);
                
            case 'boolean':
                return $value ? '✓' : '✗';
                
            case 'status':
                return sprintf('<span class="status status-%s">%s</span>', 
                    sanitize_html_class($value), 
                    esc_html($value)
                );
                
            default:
                return esc_html($value);
        }
    }
    
    protected function renderRowActions($item) {
        $html = '';
        
        foreach ($this->actions as $key => $action) {
            $url = '#';
            
            if (is_callable($action['callback'])) {
                $url = call_user_func($action['callback'], $item);
            }
            
            $html .= sprintf(
                '<a href="%s" class="%s" %s>%s%s</a> ',
                esc_url($url),
                esc_attr($action['className']),
                $action['confirm'] ? 'data-confirm="' . esc_attr($action['confirm']) . '"' : '',
                $action['icon'] ? '<span class="dashicons ' . esc_attr($action['icon']) . '"></span> ' : '',
                esc_html($action['label'])
            );
        }
        
        return $html;
    }
    
    protected function getPagination() {
        if (!$this->paginated) {
            return null;
        }
        
        $totalItems = count($this->data);
        $totalPages = ceil($totalItems / $this->perPage);
        $currentPage = isset($_GET['paged']) ? max(1, intval($_GET['paged'])) : 1;
        
        return paginate_links([
            'base' => add_query_arg('paged', '%#%'),
            'format' => '',
            'prev_text' => __('&laquo;'),
            'next_text' => __('&raquo;'),
            'total' => $totalPages,
            'current' => $currentPage
        ]);
    }
    
    protected function registerAjaxHandlers() {
        add_action('wp_ajax_datatable_' . $this->id, [$this, 'handleAjax']);
        add_action('wp_ajax_nopriv_datatable_' . $this->id, [$this, 'handleAjax']);
    }
    
    public function handleAjax() {
        check_ajax_referer($this->id);
        
        $action = $_POST['table_action'] ?? 'fetch';
        
        switch ($action) {
            case 'fetch':
                $this->handleFetch();
                break;
                
            case 'sort':
                $this->handleSort();
                break;
                
            case 'search':
                $this->handleSearch();
                break;
                
            case 'bulk':
                $this->handleBulkAction();
                break;
        }
        
        wp_die();
    }
}

// templates/datatable.php
&lt;div &lt;?php echo $attributes; ?&gt; data-ajax="&lt;?php echo $ajax ? 'true' : 'false'; ?&gt;"&gt;
    &lt;?php if ($searchable): ?&gt;
        &lt;div class="datatable-search"&gt;
            &lt;input type="text" 
                   class="datatable-search-input" 
                   placeholder="Search..."&gt;
        &lt;/div&gt;
    &lt;?php endif; ?&gt;
    
    &lt;?php if (!empty($bulkActions)): ?&gt;
        &lt;div class="datatable-bulk-actions"&gt;
            &lt;select class="bulk-action-selector"&gt;
                &lt;option value=""&gt;Bulk Actions&lt;/option&gt;
                &lt;?php foreach ($bulkActions as $key => $action): ?&gt;
                    &lt;option value="&lt;?php echo esc_attr($key); ?&gt;"&gt;
                        &lt;?php echo esc_html($action['label']); ?&gt;
                    &lt;/option&gt;
                &lt;?php endforeach; ?&gt;
            &lt;/select&gt;
            &lt;button class="button bulk-action-apply"&gt;Apply&lt;/button&gt;
        &lt;/div&gt;
    &lt;?php endif; ?&gt;
    
    &lt;table class="datatable-table wp-list-table widefat fixed striped"&gt;
        &lt;thead&gt;
            &lt;tr&gt;
                &lt;?php if (!empty($bulkActions)): ?&gt;
                    &lt;th class="check-column"&gt;
                        &lt;input type="checkbox" class="select-all"&gt;
                    &lt;/th&gt;
                &lt;?php endif; ?&gt;
                
                &lt;?php foreach ($columns as $column): ?&gt;
                    &lt;th class="&lt;?php echo esc_attr($column['className']); ?&gt; 
                               &lt;?php echo $column['sortable'] ? 'sortable' : ''; ?&gt;"
                        data-key="&lt;?php echo esc_attr($column['key']); ?&gt;"
                        &lt;?php echo $column['width'] ? 'style="width: ' . esc_attr($column['width']) . '"' : ''; ?&gt;&gt;
                        &lt;?php echo esc_html($column['label']); ?&gt;
                        &lt;?php if ($column['sortable']): ?&gt;
                            &lt;span class="sorting"&gt;&lt;/span&gt;
                        &lt;?php endif; ?&gt;
                    &lt;/th&gt;
                &lt;?php endforeach; ?&gt;
                
                &lt;?php if (!empty($actions)): ?&gt;
                    &lt;th&gt;Actions&lt;/th&gt;
                &lt;?php endif; ?&gt;
            &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
            &lt;?php foreach ($rows as $row): ?&gt;
                &lt;tr&gt;
                    &lt;?php if (!empty($bulkActions)): ?&gt;
                        &lt;td class="check-column"&gt;
                            &lt;input type="checkbox" 
                                   class="row-selector" 
                                   value="&lt;?php echo esc_attr($row['_raw']->id ?? ''); ?&gt;"&gt;
                        &lt;/td&gt;
                    &lt;?php endif; ?&gt;
                    
                    &lt;?php foreach ($columns as $key => $column): ?&gt;
                        &lt;td class="&lt;?php echo esc_attr($column['className']); ?&gt;"&gt;
                            &lt;?php echo $row[$key]; // Already escaped in formatCellValue ?&gt;
                        &lt;/td&gt;
                    &lt;?php endforeach; ?&gt;
                    
                    &lt;?php if (!empty($actions)): ?&gt;
                        &lt;td class="row-actions"&gt;
                            &lt;?php echo $row['_actions']; // Already escaped in renderRowActions ?&gt;
                        &lt;/td&gt;
                    &lt;?php endif; ?&gt;
                &lt;/tr&gt;
            &lt;?php endforeach; ?&gt;
        &lt;/tbody&gt;
    &lt;/table&gt;
    
    &lt;?php if ($paginated && $pagination): ?&gt;
        &lt;div class="datatable-pagination"&gt;
            &lt;?php echo $pagination; ?&gt;
        &lt;/div&gt;
    &lt;?php endif; ?&gt;
&lt;/div&gt;
                        </code></pre>
                    </section>
                    
                    <!-- Form Component -->
                    <section>
                        <h2>Form Component</h2>
                        
                        <pre><code class="language-php">
// src/Components/Form/Form.php
namespace App\Components;

class Form extends Component {
    protected $method = 'POST';
    protected $action = '';
    protected $fields = [];
    protected $values = [];
    protected $errors = [];
    protected $ajax = false;
    protected $validation = [];
    
    public function __construct($action = '', $options = []) {
        $this->action = $action;
        
        foreach (['method', 'ajax', 'values', 'errors'] as $option) {
            if (isset($options[$option])) {
                $this->$option = $options[$option];
            }
        }
        
        parent::__construct([], $options['attributes'] ?? []);
    }
    
    public function addField($name, $type = 'text', $options = []) {
        $field = array_merge([
            'name' => $name,
            'type' => $type,
            'label' => ucfirst(str_replace('_', ' ', $name)),
            'value' => $this->values[$name] ?? '',
            'required' => false,
            'placeholder' => '',
            'help' => '',
            'options' => [],
            'attributes' => []
        ], $options);
        
        $this->fields[$name] = $field;
        
        if (isset($options['validation'])) {
            $this->validation[$name] = $options['validation'];
        }
        
        return $this;
    }
    
    public function addTextField($name, $label, $options = []) {
        return $this->addField($name, 'text', array_merge(['label' => $label], $options));
    }
    
    public function addEmailField($name, $label, $options = []) {
        return $this->addField($name, 'email', array_merge([
            'label' => $label,
            'validation' => 'email'
        ], $options));
    }
    
    public function addSelectField($name, $label, $choices, $options = []) {
        return $this->addField($name, 'select', array_merge([
            'label' => $label,
            'options' => $choices
        ], $options));
    }
    
    public function addCheckboxField($name, $label, $options = []) {
        return $this->addField($name, 'checkbox', array_merge(['label' => $label], $options));
    }
    
    public function addRadioField($name, $label, $choices, $options = []) {
        return $this->addField($name, 'radio', array_merge([
            'label' => $label,
            'options' => $choices
        ], $options));
    }
    
    public function addTextareaField($name, $label, $options = []) {
        return $this->addField($name, 'textarea', array_merge(['label' => $label], $options));
    }
    
    public function addHiddenField($name, $value) {
        return $this->addField($name, 'hidden', ['value' => $value]);
    }
    
    public function validate($data = null) {
        if ($data === null) {
            $data = $_POST;
        }
        
        $this->errors = [];
        
        foreach ($this->validation as $field => $rules) {
            $value = $data[$field] ?? '';
            
            if (is_string($rules)) {
                $rules = explode('|', $rules);
            }
            
            foreach ($rules as $rule) {
                $error = $this->validateRule($field, $value, $rule);
                if ($error) {
                    $this->errors[$field] = $error;
                    break;
                }
            }
        }
        
        return empty($this->errors);
    }
    
    protected function validateRule($field, $value, $rule) {
        if (strpos($rule, ':') !== false) {
            list($ruleName, $parameter) = explode(':', $rule);
        } else {
            $ruleName = $rule;
            $parameter = null;
        }
        
        switch ($ruleName) {
            case 'required':
                if (empty($value)) {
                    return "{$field} is required";
                }
                break;
                
            case 'email':
                if (!is_email($value)) {
                    return "{$field} must be a valid email";
                }
                break;
                
            case 'min':
                if (strlen($value) < $parameter) {
                    return "{$field} must be at least {$parameter} characters";
                }
                break;
                
            case 'max':
                if (strlen($value) > $parameter) {
                    return "{$field} must not exceed {$parameter} characters";
                }
                break;
                
            case 'numeric':
                if (!is_numeric($value)) {
                    return "{$field} must be numeric";
                }
                break;
        }
        
        return null;
    }
    
    protected function renderField($field) {
        $html = '<div class="form-field form-field-' . esc_attr($field['type']) . '">';
        
        if ($field['type'] !== 'hidden' && !empty($field['label'])) {
            $html .= '<label for="' . esc_attr($field['name']) . '">';
            $html .= esc_html($field['label']);
            if ($field['required']) {
                $html .= ' <span class="required">*</span>';
            }
            $html .= '</label>';
        }
        
        switch ($field['type']) {
            case 'text':
            case 'email':
            case 'password':
            case 'number':
                $html .= '<input type="' . esc_attr($field['type']) . '" ';
                $html .= 'name="' . esc_attr($field['name']) . '" ';
                $html .= 'id="' . esc_attr($field['name']) . '" ';
                $html .= 'value="' . esc_attr($field['value']) . '" ';
                $html .= $field['required'] ? 'required ' : '';
                $html .= 'placeholder="' . esc_attr($field['placeholder']) . '" ';
                $html .= $this->buildFieldAttributes($field['attributes']);
                $html .= '>';
                break;
                
            case 'textarea':
                $html .= '<textarea ';
                $html .= 'name="' . esc_attr($field['name']) . '" ';
                $html .= 'id="' . esc_attr($field['name']) . '" ';
                $html .= $field['required'] ? 'required ' : '';
                $html .= 'placeholder="' . esc_attr($field['placeholder']) . '" ';
                $html .= $this->buildFieldAttributes($field['attributes']);
                $html .= '>' . esc_textarea($field['value']) . '</textarea>';
                break;
                
            case 'select':
                $html .= '<select ';
                $html .= 'name="' . esc_attr($field['name']) . '" ';
                $html .= 'id="' . esc_attr($field['name']) . '" ';
                $html .= $field['required'] ? 'required ' : '';
                $html .= $this->buildFieldAttributes($field['attributes']);
                $html .= '>';
                
                foreach ($field['options'] as $value => $label) {
                    $html .= '<option value="' . esc_attr($value) . '" ';
                    $html .= selected($field['value'], $value, false) . '>';
                    $html .= esc_html($label) . '</option>';
                }
                
                $html .= '</select>';
                break;
                
            case 'checkbox':
                $html .= '<label class="checkbox-label">';
                $html .= '<input type="checkbox" ';
                $html .= 'name="' . esc_attr($field['name']) . '" ';
                $html .= 'value="1" ';
                $html .= checked($field['value'], 1, false) . '>';
                $html .= esc_html($field['label']);
                $html .= '</label>';
                break;
                
            case 'hidden':
                $html = '<input type="hidden" ';
                $html .= 'name="' . esc_attr($field['name']) . '" ';
                $html .= 'value="' . esc_attr($field['value']) . '">';
                break;
        }
        
        if (!empty($field['help'])) {
            $html .= '<p class="field-help">' . esc_html($field['help']) . '</p>';
        }
        
        if (isset($this->errors[$field['name']])) {
            $html .= '<p class="field-error">' . esc_html($this->errors[$field['name']]) . '</p>';
        }
        
        if ($field['type'] !== 'hidden') {
            $html .= '</div>';
        }
        
        return $html;
    }
    
    protected function buildFieldAttributes($attributes) {
        $html = '';
        foreach ($attributes as $key => $value) {
            $html .= esc_attr($key) . '="' . esc_attr($value) . '" ';
        }
        return $html;
    }
}
                        </code></pre>
                    </section>
                    
                    <!-- Modal Component -->
                    <section>
                        <h2>Modal Component</h2>
                        
                        <pre><code class="language-php">
// src/Components/Modal/Modal.php
namespace App\Components;

class Modal extends Component {
    protected $title;
    protected $content;
    protected $footer;
    protected $size = 'medium';
    protected $closable = true;
    protected $backdrop = true;
    protected $keyboard = true;
    
    public function __construct($id, $options = []) {
        $this->id = $id;
        
        foreach (['title', 'content', 'footer', 'size', 'closable', 'backdrop', 'keyboard'] as $option) {
            if (isset($options[$option])) {
                $this->$option = $options[$option];
            }
        }
        
        parent::__construct();
    }
    
    public static function confirm($message, $onConfirm, $onCancel = null) {
        $modal = new static('confirm-modal', [
            'title' => 'Confirm',
            'content' => $message,
            'size' => 'small'
        ]);
        
        $modal->footer = '
            <button class="button button-secondary modal-cancel">Cancel</button>
            <button class="button button-primary modal-confirm">Confirm</button>
        ';
        
        return $modal;
    }
}
                        </code></pre>
                    </section>
                    
                    <!-- Component Registry -->
                    <section>
                        <h2>Component Registry</h2>
                        
                        <pre><code class="language-php">
// src/Components/ComponentRegistry.php
namespace App\Components;

class ComponentRegistry {
    private static $instance;
    private $components = [];
    private $aliases = [];
    
    public static function getInstance() {
        if (!self::$instance) {
            self::$instance = new self();
        }
        return self::$instance;
    }
    
    public function register($name, $class) {
        $this->components[$name] = $class;
        return $this;
    }
    
    public function alias($alias, $name) {
        $this->aliases[$alias] = $name;
        return $this;
    }
    
    public function make($name, ...$args) {
        $name = $this->aliases[$name] ?? $name;
        
        if (!isset($this->components[$name])) {
            throw new \Exception("Component {$name} not found");
        }
        
        $class = $this->components[$name];
        return new $class(...$args);
    }
    
    public function __call($method, $args) {
        return $this->make($method, ...$args);
    }
}

// Register components
$registry = ComponentRegistry::getInstance();
$registry->register('button', Button::class);
$registry->register('card', Card::class);
$registry->register('modal', Modal::class);
$registry->register('form', Form::class);
$registry->register('dataTable', DataTable::class);

// Helper function
function component($name, ...$args) {
    return ComponentRegistry::getInstance()->make($name, ...$args);
}

// Usage
echo component('button', 'Click Me', ['variant' => 'primary']);
echo component('card', ['title' => 'My Card', 'content' => 'Content here']);
                        </code></pre>
                    </section>
                    
                    <!-- Summary -->
                    <section>
                        <h2>Summary</h2>
                        
                        <div class="summary-box">
                            <h3>Key Takeaways</h3>
                            <ul>
                                <li>Components promote code reusability and maintainability</li>
                                <li>Base component class provides common functionality</li>
                                <li>Each component encapsulates its own logic, styles, and templates</li>
                                <li>Components can be composed to build complex interfaces</li>
                                <li>Component registry provides centralized management</li>
                                <li>JavaScript enhancements add interactivity</li>
                            </ul>
                        </div>
                        
                        <div class="best-practices">
                            <h3>Component Best Practices</h3>
                            <ul>
                                <li>Keep components focused on a single responsibility</li>
                                <li>Make components configurable through options</li>
                                <li>Provide sensible defaults</li>
                                <li>Document component APIs clearly</li>
                                <li>Use consistent naming conventions</li>
                                <li>Test components in isolation</li>
                                <li>Version components properly</li>
                            </ul>
                        </div>
                    </section>
                    
                    <!-- Additional Resources -->
                    <section class="resources">
                        <h2>Additional Resources</h2>
                        <ul>
                            <li><a href="https://atomicdesign.bradfrost.com/" target="_blank">Atomic Design Methodology</a></li>
                            <li><a href="https://storybook.js.org/" target="_blank">Storybook for Component Development</a></li>
                            <li><a href="https://patternlab.io/" target="_blank">Pattern Lab</a></li>
                            <li><a href="https://github.com/WordPress/gutenberg/tree/trunk/packages/components" target="_blank">WordPress Gutenberg Components</a></li>
                        </ul>
                    </section>
                </div>
                
                <!-- Lesson Navigation -->
                <div class="lesson-navigation">
                    <a href="/07module/separating_business_logic.html" class="lesson-nav-button prev">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"/>
                        </svg>
                        <span>
                            <small>Previous</small><br>
                            Separating Business Logic
                        </span>
                    </a>
                    
                    <button class="complete-lesson-btn">
                        Mark as Complete
                    </button>
                    
                    <a href="/07module/homework_application_architecture.html" class="lesson-nav-button next">
                        <span>
                            <small>Next</small><br>
                            Homework: Application Architecture
                        </span>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="site-footer" role="contentinfo">
            <div class="footer-container">
                <div class="footer-content">
                    <div class="footer-section footer-about">
                        <h3>PHP WordPress Development</h3>
                        <p>Complete Web Development Course - From HTML to WordPress</p>
                    </div>
                    
                    <div class="footer-section">
                        <h4>Quick Links</h4>
                        <ul class="footer-links">
                            <li><a href="/">Home</a></li>
                            <li><a href="/module7.html">Module 7</a></li>
                            <li><a href="/resources.html">Resources</a></li>
                            <li><a href="/about.html">About</a></li>
                        </ul>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <p>&copy; 2025 PHP WordPress Development Course. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- JavaScript -->
    <script src="/assets/js/prism.js"></script>
    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/lesson.js"></script>
</body>
</html>