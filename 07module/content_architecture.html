<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
    <!-- SEO Meta Tags -->
    <title>Content Architecture Planning - PHP WordPress Course</title>
    <meta name="description" content="Learn how to plan and implement effective content architecture in WordPress. Master information architecture, content modeling, and data relationships.">
    <meta name="keywords" content="WordPress, content architecture, information architecture, content modeling, WordPress development">
    <meta name="author" content="PHP WordPress Course">
    
    <!-- Open Graph Tags -->
    <meta property="og:title" content="Content Architecture Planning">
    <meta property="og:description" content="Design and implement effective content architecture in WordPress">
    <meta property="og:type" content="article">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Prism.js for syntax highlighting -->
    <link href="/assets/css/prism.css" rel="stylesheet">
</head>
<body>
    <!-- Skip to main content -->
    <a href="#main-content" class="sr-only">Skip to main content</a>
    
    <div class="page-wrapper">
        <!-- Header -->
        <header class="site-header" role="banner">
            <div class="header-container">
                <div class="site-branding">
                    <a href="/" class="site-logo">
                        <h1 class="site-title">PHP WordPress Development</h1>
                    </a>
                </div>
                
                <nav class="main-navigation" role="navigation" aria-label="Main navigation">
                    <button class="mobile-menu-btn" aria-label="Toggle navigation" aria-expanded="false">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    
                    <div class="nav-menu">
                        <ul class="nav-list">
                            <li class="nav-item"><a href="/" class="nav-link">Home</a></li>
                            <li class="nav-item dropdown">
                                <button class="nav-link dropdown-toggle active" aria-haspopup="true">Modules</button>
                                <div class="dropdown-menu">
                                    <a href="/module1.html" class="dropdown-item">Module 1: Web Fundamentals</a>
                                    <a href="/module2.html" class="dropdown-item">Module 2: PHP Fundamentals</a>
                                    <a href="/module3.html" class="dropdown-item">Module 3: MySQL Database</a>
                                    <a href="/module4.html" class="dropdown-item">Module 4: WordPress & Docker</a>
                                    <a href="/module5.html" class="dropdown-item">Module 5: Theme Development</a>
                                    <a href="/module6.html" class="dropdown-item">Module 6: Plugin Development</a>
                                    <a href="/module7.html" class="dropdown-item active">Module 7: Advanced WordPress</a>
                                    <a href="/module8.html" class="dropdown-item">Module 8: Deployment</a>
                                    <a href="/module9.html" class="dropdown-item">Module 9: Final Project</a>
                                </div>
                            </li>
                            <li class="nav-item"><a href="/resources.html" class="nav-link">Resources</a></li>
                            <li class="nav-item"><a href="/about.html" class="nav-link">About</a></li>
                        </ul>
                    </div>
                </nav>
                
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                        </svg>
                        <input type="search" class="search-input" placeholder="Search lessons..." aria-label="Search">
                    </div>
                    <div class="search-results"></div>
                </div>
            </div>
        </header>
        
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-header">
                <h2 class="progress-title">Course Progress</h2>
                <span class="progress-text">Loading...</span>
            </div>
            <div class="progress-bar">
                <div class="progress-bar-fill">
                    <span class="progress-bar-text"></span>
                </div>
            </div>
        </div>
        
        <!-- Breadcrumb -->
        <nav class="breadcrumb container" aria-label="Breadcrumb">
            <ol class="breadcrumb-list">
                <li class="breadcrumb-item">
                    <a href="/">Home</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <a href="/module7.html">Module 7</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <span aria-current="page">Content Architecture</span>
                </li>
            </ol>
        </nav>
        
        <!-- Main Content -->
        <main id="main-content" class="main-content" role="main">
            <div class="container">
                <!-- Lesson Header -->
                <div class="lesson-header">
                    <h1 class="lesson-title">Content Architecture Planning</h1>
                    <p class="lesson-subtitle">Design scalable and maintainable content structures for WordPress</p>
                </div>
                
                <!-- Learning Objectives -->
                <div class="lesson-objectives">
                    <h2>Learning Objectives</h2>
                    <p>By the end of this lesson, you will be able to:</p>
                    <ul>
                        <li>Plan effective content architectures</li>
                        <li>Design content models and relationships</li>
                        <li>Implement scalable taxonomy structures</li>
                        <li>Create content templates and patterns</li>
                        <li>Build flexible content management systems</li>
                        <li>Document content architecture decisions</li>
                    </ul>
                </div>
                
                <!-- Lesson Body -->
                <div class="lesson-body">
                    <!-- Content Modeling -->
                    <section>
                        <h2>Content Modeling Fundamentals</h2>
                        
                        <h3>Defining Content Types and Relationships</h3>
                        <pre><code class="language-php">
/**
 * Content Architecture Blueprint
 * Define your content model structure
 */
class Content_Architecture {
    
    /**
     * Content type definitions
     */
    private static $content_types = [
        'product' => [
            'singular' => 'Product',
            'plural' => 'Products',
            'supports' => ['title', 'editor', 'thumbnail', 'excerpt', 'revisions'],
            'taxonomies' => ['product_category', 'product_brand', 'product_features'],
            'meta_fields' => [
                'price' => ['type' => 'number', 'required' => true],
                'sku' => ['type' => 'string', 'unique' => true],
                'stock' => ['type' => 'number', 'default' => 0],
                'dimensions' => ['type' => 'object'],
                'weight' => ['type' => 'number'],
                'gallery' => ['type' => 'array'],
            ],
            'relationships' => [
                'accessories' => ['type' => 'product', 'many' => true],
                'reviews' => ['type' => 'review', 'many' => true],
                'manufacturer' => ['type' => 'company', 'many' => false],
            ]
        ],
        
        'review' => [
            'singular' => 'Review',
            'plural' => 'Reviews',
            'supports' => ['title', 'editor', 'author'],
            'taxonomies' => [],
            'meta_fields' => [
                'rating' => ['type' => 'number', 'min' => 1, 'max' => 5],
                'product_id' => ['type' => 'number', 'required' => true],
                'verified_purchase' => ['type' => 'boolean', 'default' => false],
                'pros' => ['type' => 'array'],
                'cons' => ['type' => 'array'],
            ],
            'relationships' => [
                'product' => ['type' => 'product', 'many' => false],
                'author' => ['type' => 'user', 'many' => false],
            ]
        ],
        
        'company' => [
            'singular' => 'Company',
            'plural' => 'Companies',
            'supports' => ['title', 'editor', 'thumbnail'],
            'taxonomies' => ['industry', 'location'],
            'meta_fields' => [
                'website' => ['type' => 'url'],
                'email' => ['type' => 'email'],
                'phone' => ['type' => 'string'],
                'address' => ['type' => 'object'],
                'founded' => ['type' => 'date'],
                'employees' => ['type' => 'number'],
            ],
            'relationships' => [
                'products' => ['type' => 'product', 'many' => true],
                'subsidiaries' => ['type' => 'company', 'many' => true],
                'parent_company' => ['type' => 'company', 'many' => false],
            ]
        ],
        
        'event' => [
            'singular' => 'Event',
            'plural' => 'Events',
            'supports' => ['title', 'editor', 'thumbnail', 'excerpt'],
            'taxonomies' => ['event_type', 'event_location'],
            'meta_fields' => [
                'start_date' => ['type' => 'datetime', 'required' => true],
                'end_date' => ['type' => 'datetime', 'required' => true],
                'venue' => ['type' => 'string'],
                'capacity' => ['type' => 'number'],
                'price' => ['type' => 'number'],
                'registration_url' => ['type' => 'url'],
                'speakers' => ['type' => 'array'],
            ],
            'relationships' => [
                'organizer' => ['type' => 'company', 'many' => false],
                'sponsors' => ['type' => 'company', 'many' => true],
                'sessions' => ['type' => 'session', 'many' => true],
            ]
        ]
    ];
    
    /**
     * Initialize content architecture
     */
    public static function init() {
        add_action('init', [__CLASS__, 'register_content_types']);
        add_action('init', [__CLASS__, 'register_taxonomies']);
        add_action('init', [__CLASS__, 'register_meta_fields']);
        add_action('init', [__CLASS__, 'setup_relationships']);
    }
    
    /**
     * Register all content types
     */
    public static function register_content_types() {
        foreach (self::$content_types as $post_type => $config) {
            register_post_type($post_type, [
                'labels' => self::generate_labels($config['singular'], $config['plural']),
                'public' => true,
                'supports' => $config['supports'],
                'has_archive' => true,
                'rewrite' => ['slug' => sanitize_title($config['plural'])],
                'show_in_rest' => true,
                'menu_icon' => self::get_menu_icon($post_type),
            ]);
        }
    }
    
    /**
     * Generate consistent labels
     */
    private static function generate_labels($singular, $plural) {
        return [
            'name' => $plural,
            'singular_name' => $singular,
            'add_new' => "Add New",
            'add_new_item' => "Add New $singular",
            'edit_item' => "Edit $singular",
            'new_item' => "New $singular",
            'view_item' => "View $singular",
            'view_items' => "View $plural",
            'search_items' => "Search $plural",
            'not_found' => "No $plural found",
            'not_found_in_trash' => "No $plural found in Trash",
            'all_items' => "All $plural",
            'archives' => "$singular Archives",
            'attributes' => "$singular Attributes",
            'insert_into_item' => "Insert into $singular",
            'uploaded_to_this_item' => "Uploaded to this $singular",
        ];
    }
    
    /**
     * Get appropriate menu icon
     */
    private static function get_menu_icon($post_type) {
        $icons = [
            'product' => 'dashicons-products',
            'review' => 'dashicons-star-filled',
            'company' => 'dashicons-building',
            'event' => 'dashicons-calendar-alt',
        ];
        
        return $icons[$post_type] ?? 'dashicons-admin-post';
    }
}
                        </code></pre>
                    </section>
                    
                    <!-- Taxonomy Architecture -->
                    <section>
                        <h2>Taxonomy Architecture Design</h2>
                        
                        <h3>Building Scalable Taxonomy Structures</h3>
                        <pre><code class="language-php">
/**
 * Taxonomy architecture implementation
 */
class Taxonomy_Architecture {
    
    /**
     * Taxonomy definitions with hierarchy
     */
    private static $taxonomies = [
        'product_category' => [
            'post_types' => ['product'],
            'hierarchical' => true,
            'labels' => [
                'name' => 'Product Categories',
                'singular_name' => 'Product Category',
            ],
            'structure' => [
                'Electronics' => [
                    'Computers' => ['Laptops', 'Desktops', 'Tablets'],
                    'Mobile' => ['Smartphones', 'Accessories', 'Wearables'],
                    'Audio' => ['Headphones', 'Speakers', 'Home Audio'],
                ],
                'Clothing' => [
                    'Men' => ['Shirts', 'Pants', 'Shoes'],
                    'Women' => ['Dresses', 'Tops', 'Shoes'],
                    'Kids' => ['Boys', 'Girls', 'Babies'],
                ],
            ]
        ],
        
        'product_brand' => [
            'post_types' => ['product'],
            'hierarchical' => false,
            'labels' => [
                'name' => 'Brands',
                'singular_name' => 'Brand',
            ],
            'terms' => ['Apple', 'Samsung', 'Sony', 'Nike', 'Adidas'],
        ],
        
        'product_features' => [
            'post_types' => ['product'],
            'hierarchical' => false,
            'labels' => [
                'name' => 'Features',
                'singular_name' => 'Feature',
            ],
            'groups' => [
                'Technical' => ['Wireless', 'Bluetooth', 'USB-C', 'Waterproof'],
                'Material' => ['Cotton', 'Leather', 'Synthetic', 'Organic'],
                'Style' => ['Modern', 'Classic', 'Vintage', 'Minimalist'],
            ]
        ],
        
        'location' => [
            'post_types' => ['company', 'event', 'store'],
            'hierarchical' => true,
            'labels' => [
                'name' => 'Locations',
                'singular_name' => 'Location',
            ],
            'structure' => [
                'United States' => [
                    'California' => ['Los Angeles', 'San Francisco', 'San Diego'],
                    'New York' => ['New York City', 'Buffalo', 'Albany'],
                    'Texas' => ['Houston', 'Dallas', 'Austin'],
                ],
                'Europe' => [
                    'United Kingdom' => ['London', 'Manchester', 'Birmingham'],
                    'Germany' => ['Berlin', 'Munich', 'Hamburg'],
                    'France' => ['Paris', 'Lyon', 'Marseille'],
                ],
            ]
        ]
    ];
    
    /**
     * Register and populate taxonomies
     */
    public static function setup_taxonomies() {
        foreach (self::$taxonomies as $taxonomy => $config) {
            // Register taxonomy
            register_taxonomy($taxonomy, $config['post_types'], [
                'labels' => $config['labels'],
                'hierarchical' => $config['hierarchical'],
                'show_ui' => true,
                'show_admin_column' => true,
                'query_var' => true,
                'rewrite' => ['slug' => sanitize_title($config['labels']['name'])],
                'show_in_rest' => true,
            ]);
            
            // Populate with initial terms if needed
            if (isset($config['structure'])) {
                self::create_hierarchical_terms($taxonomy, $config['structure']);
            } elseif (isset($config['terms'])) {
                self::create_flat_terms($taxonomy, $config['terms']);
            } elseif (isset($config['groups'])) {
                self::create_grouped_terms($taxonomy, $config['groups']);
            }
        }
    }
    
    /**
     * Create hierarchical term structure
     */
    private static function create_hierarchical_terms($taxonomy, $structure, $parent = 0) {
        foreach ($structure as $term => $children) {
            $term_exists = term_exists($term, $taxonomy);
            
            if (!$term_exists) {
                $result = wp_insert_term($term, $taxonomy, [
                    'parent' => $parent,
                    'slug' => sanitize_title($term),
                ]);
                
                if (!is_wp_error($result)) {
                    $parent_id = $result['term_id'];
                    
                    // Add term meta
                    update_term_meta($parent_id, 'term_order', 0);
                    update_term_meta($parent_id, 'featured', 'no');
                    
                    // Create children
                    if (is_array($children)) {
                        if (isset($children[0])) {
                            // Array of child terms
                            foreach ($children as $child) {
                                wp_insert_term($child, $taxonomy, [
                                    'parent' => $parent_id,
                                    'slug' => sanitize_title($child),
                                ]);
                            }
                        } else {
                            // Nested structure
                            self::create_hierarchical_terms($taxonomy, $children, $parent_id);
                        }
                    }
                }
            }
        }
    }
    
    /**
     * Create flat terms
     */
    private static function create_flat_terms($taxonomy, $terms) {
        foreach ($terms as $term) {
            if (!term_exists($term, $taxonomy)) {
                wp_insert_term($term, $taxonomy, [
                    'slug' => sanitize_title($term),
                ]);
            }
        }
    }
    
    /**
     * Create grouped terms with meta
     */
    private static function create_grouped_terms($taxonomy, $groups) {
        foreach ($groups as $group => $terms) {
            foreach ($terms as $term) {
                if (!term_exists($term, $taxonomy)) {
                    $result = wp_insert_term($term, $taxonomy, [
                        'slug' => sanitize_title($term),
                    ]);
                    
                    if (!is_wp_error($result)) {
                        update_term_meta($result['term_id'], 'group', $group);
                    }
                }
            }
        }
    }
}
                        </code></pre>
                    </section>
                    
                    <!-- Content Relationships -->
                    <section>
                        <h2>Content Relationship Management</h2>
                        
                        <h3>Implementing Complex Relationships</h3>
                        <pre><code class="language-php">
/**
 * Content relationship handler
 */
class Content_Relationships {
    
    /**
     * Define relationship types
     */
    const RELATIONSHIP_TYPES = [
        'one_to_one' => 'One to One',
        'one_to_many' => 'One to Many',
        'many_to_many' => 'Many to Many',
        'hierarchical' => 'Parent-Child',
        'bidirectional' => 'Bidirectional',
    ];
    
    /**
     * Setup relationship tables
     */
    public static function setup_relationship_tables() {
        global $wpdb;
        
        $table_name = $wpdb->prefix . 'content_relationships';
        $charset_collate = $wpdb->get_charset_collate();
        
        $sql = "CREATE TABLE IF NOT EXISTS $table_name (
            id bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT,
            source_id bigint(20) UNSIGNED NOT NULL,
            source_type varchar(50) NOT NULL,
            target_id bigint(20) UNSIGNED NOT NULL,
            target_type varchar(50) NOT NULL,
            relationship_type varchar(50) NOT NULL,
            relationship_meta longtext,
            order_index int(11) DEFAULT 0,
            created_at datetime DEFAULT CURRENT_TIMESTAMP,
            updated_at datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
            PRIMARY KEY (id),
            KEY source_idx (source_id, source_type),
            KEY target_idx (target_id, target_type),
            KEY relationship_idx (relationship_type),
            UNIQUE KEY unique_relationship (source_id, source_type, target_id, target_type, relationship_type)
        ) $charset_collate;";
        
        require_once(ABSPATH . 'wp-admin/includes/upgrade.php');
        dbDelta($sql);
    }
    
    /**
     * Create a relationship
     */
    public static function create_relationship($source_id, $source_type, $target_id, $target_type, $relationship_type, $meta = []) {
        global $wpdb;
        
        $table_name = $wpdb->prefix . 'content_relationships';
        
        // Check if relationship already exists
        $exists = $wpdb->get_var($wpdb->prepare(
            "SELECT id FROM $table_name 
            WHERE source_id = %d AND source_type = %s 
            AND target_id = %d AND target_type = %s 
            AND relationship_type = %s",
            $source_id, $source_type, $target_id, $target_type, $relationship_type
        ));
        
        if ($exists) {
            // Update existing relationship
            return $wpdb->update(
                $table_name,
                [
                    'relationship_meta' => maybe_serialize($meta),
                    'updated_at' => current_time('mysql')
                ],
                ['id' => $exists],
                ['%s', '%s'],
                ['%d']
            );
        } else {
            // Create new relationship
            return $wpdb->insert(
                $table_name,
                [
                    'source_id' => $source_id,
                    'source_type' => $source_type,
                    'target_id' => $target_id,
                    'target_type' => $target_type,
                    'relationship_type' => $relationship_type,
                    'relationship_meta' => maybe_serialize($meta),
                    'created_at' => current_time('mysql'),
                    'updated_at' => current_time('mysql')
                ],
                ['%d', '%s', '%d', '%s', '%s', '%s', '%s', '%s']
            );
        }
    }
    
    /**
     * Get related content
     */
    public static function get_related($source_id, $source_type, $relationship_type = null, $target_type = null) {
        global $wpdb;
        
        $table_name = $wpdb->prefix . 'content_relationships';
        
        $query = "SELECT * FROM $table_name WHERE source_id = %d AND source_type = %s";
        $params = [$source_id, $source_type];
        
        if ($relationship_type) {
            $query .= " AND relationship_type = %s";
            $params[] = $relationship_type;
        }
        
        if ($target_type) {
            $query .= " AND target_type = %s";
            $params[] = $target_type;
        }
        
        $query .= " ORDER BY order_index ASC, created_at DESC";
        
        $relationships = $wpdb->get_results($wpdb->prepare($query, $params));
        
        // Hydrate with actual content
        foreach ($relationships as &$rel) {
            $rel->relationship_meta = maybe_unserialize($rel->relationship_meta);
            
            if ($rel->target_type === 'post' || in_array($rel->target_type, get_post_types())) {
                $rel->target = get_post($rel->target_id);
            } elseif ($rel->target_type === 'user') {
                $rel->target = get_user_by('id', $rel->target_id);
            } elseif ($rel->target_type === 'term') {
                $rel->target = get_term($rel->target_id);
            }
        }
        
        return $relationships;
    }
    
    /**
     * Get bidirectional relationships
     */
    public static function get_bidirectional($id, $type, $relationship_type) {
        global $wpdb;
        
        $table_name = $wpdb->prefix . 'content_relationships';
        
        $sql = $wpdb->prepare(
            "SELECT * FROM $table_name 
            WHERE (source_id = %d AND source_type = %s) 
            OR (target_id = %d AND target_type = %s) 
            AND relationship_type = %s",
            $id, $type, $id, $type, $relationship_type
        );
        
        return $wpdb->get_results($sql);
    }
}

// Initialize relationship tables
register_activation_hook(__FILE__, ['Content_Relationships', 'setup_relationship_tables']);
                        </code></pre>
                    </section>
                    
                    <!-- Content Templates -->
                    <section>
                        <h2>Content Templates and Patterns</h2>
                        
                        <h3>Reusable Content Structures</h3>
                        <pre><code class="language-php">
/**
 * Content template system
 */
class Content_Templates {
    
    /**
     * Template definitions
     */
    private static $templates = [
        'product_standard' => [
            'name' => 'Standard Product',
            'post_type' => 'product',
            'structure' => [
                'title' => '[Product Name]',
                'content' => '<!-- wp:heading {"level":2} -->
<h2>Product Description</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>[Product description goes here]</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2>Features</h2>
<!-- /wp:heading -->

<!-- wp:list -->
<ul>
<li>Feature 1</li>
<li>Feature 2</li>
<li>Feature 3</li>
</ul>
<!-- /wp:list -->

<!-- wp:heading {"level":2} -->
<h2>Specifications</h2>
<!-- /wp:heading -->

<!-- wp:table -->
<figure class="wp-block-table">
<table>
<tbody>
<tr><td>Dimension</td><td>[Value]</td></tr>
<tr><td>Weight</td><td>[Value]</td></tr>
<tr><td>Material</td><td>[Value]</td></tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->',
                'meta' => [
                    '_price' => 0,
                    '_sku' => '',
                    '_stock' => 0,
                    '_featured' => 'no',
                ],
                'taxonomies' => [
                    'product_category' => [],
                    'product_features' => [],
                ]
            ]
        ],
        
        'event_conference' => [
            'name' => 'Conference Event',
            'post_type' => 'event',
            'structure' => [
                'title' => '[Conference Name] [Year]',
                'content' => '<!-- wp:heading {"level":2} -->
<h2>About the Conference</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>[Conference description]</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":2} -->
<h2>Keynote Speakers</h2>
<!-- /wp:heading -->

<!-- wp:columns -->
<div class="wp-block-columns">
<!-- wp:column -->
<div class="wp-block-column">
<!-- wp:image -->
<figure class="wp-block-image"><img src="" alt="Speaker"/></figure>
<!-- /wp:image -->
<!-- wp:heading {"level":3} -->
<h3>Speaker Name</h3>
<!-- /wp:heading -->
<!-- wp:paragraph -->
<p>Speaker bio</p>
<!-- /wp:paragraph -->
</div>
<!-- /wp:column -->
</div>
<!-- /wp:columns -->

<!-- wp:heading {"level":2} -->
<h2>Schedule</h2>
<!-- /wp:heading -->

<!-- wp:table -->
<figure class="wp-block-table">
<table>
<thead>
<tr><th>Time</th><th>Session</th><th>Speaker</th></tr>
</thead>
<tbody>
<tr><td>9:00 AM</td><td>Registration</td><td>-</td></tr>
<tr><td>10:00 AM</td><td>Opening Keynote</td><td>[Speaker]</td></tr>
</tbody>
</table>
</figure>
<!-- /wp:table -->',
                'meta' => [
                    '_event_start_date' => '',
                    '_event_end_date' => '',
                    '_venue' => '',
                    '_capacity' => 0,
                    '_registration_url' => '',
                ],
                'taxonomies' => [
                    'event_type' => ['conference'],
                    'event_location' => [],
                ]
            ]
        ]
    ];
    
    /**
     * Create content from template
     */
    public static function create_from_template($template_key, $data = []) {
        if (!isset(self::$templates[$template_key])) {
            return new WP_Error('invalid_template', 'Template not found');
        }
        
        $template = self::$templates[$template_key];
        $structure = $template['structure'];
        
        // Merge with provided data
        $post_data = [
            'post_type' => $template['post_type'],
            'post_status' => 'draft',
            'post_title' => $data['title'] ?? $structure['title'],
            'post_content' => $data['content'] ?? $structure['content'],
        ];
        
        // Create post
        $post_id = wp_insert_post($post_data);
        
        if (is_wp_error($post_id)) {
            return $post_id;
        }
        
        // Set meta fields
        if (isset($structure['meta'])) {
            foreach ($structure['meta'] as $key => $default_value) {
                $value = $data['meta'][$key] ?? $default_value;
                update_post_meta($post_id, $key, $value);
            }
        }
        
        // Set taxonomies
        if (isset($structure['taxonomies'])) {
            foreach ($structure['taxonomies'] as $taxonomy => $default_terms) {
                $terms = $data['taxonomies'][$taxonomy] ?? $default_terms;
                wp_set_object_terms($post_id, $terms, $taxonomy);
            }
        }
        
        return $post_id;
    }
    
    /**
     * Register block patterns
     */
    public static function register_block_patterns() {
        register_block_pattern_category(
            'content-architecture',
            ['label' => __('Content Architecture', 'textdomain')]
        );
        
        register_block_pattern(
            'content-architecture/product-gallery',
            [
                'title' => __('Product Gallery', 'textdomain'),
                'description' => __('A gallery layout for displaying products', 'textdomain'),
                'categories' => ['content-architecture'],
                'content' => '<!-- wp:group {"align":"wide"} -->
<div class="wp-block-group alignwide">
<!-- wp:heading -->
<h2>Featured Products</h2>
<!-- /wp:heading -->

<!-- wp:query {"queryId":1,"query":{"perPage":6,"pages":0,"offset":0,"postType":"product","order":"desc","orderBy":"date","author":"","search":"","exclude":[],"sticky":"","inherit":false,"taxQuery":{"product_category":[]}}} -->
<div class="wp-block-query">
<!-- wp:post-template {"layout":{"type":"grid","columnCount":3}} -->
<!-- wp:post-featured-image {"isLink":true} /-->
<!-- wp:post-title {"isLink":true} /-->
<!-- wp:post-excerpt /-->
<!-- wp:group {"layout":{"type":"flex","justifyContent":"space-between"}} -->
<div class="wp-block-group">
<!-- wp:post-terms {"term":"product_category"} /-->
<!-- wp:paragraph -->
<p>Price: $XX.XX</p>
<!-- /wp:paragraph -->
</div>
<!-- /wp:group -->
<!-- /wp:post-template -->

<!-- wp:query-pagination -->
<!-- wp:query-pagination-previous /-->
<!-- wp:query-pagination-numbers /-->
<!-- wp:query-pagination-next /-->
<!-- /wp:query-pagination -->
</div>
<!-- /wp:query -->
</div>
<!-- /wp:group -->',
            ]
        );
    }
}

// Register block patterns
add_action('init', ['Content_Templates', 'register_block_patterns']);
                        </code></pre>
                    </section>
                    
                    <!-- Content Migration -->
                    <section>
                        <h2>Content Migration Strategy</h2>
                        
                        <h3>Migrating to New Architecture</h3>
                        <pre><code class="language-php">
/**
 * Content migration handler
 */
class Content_Migration {
    
    /**
     * Migrate content to new architecture
     */
    public static function migrate_content($old_type, $new_type, $mapping = []) {
        global $wpdb;
        
        // Get all posts of old type
        $posts = get_posts([
            'post_type' => $old_type,
            'posts_per_page' => -1,
            'post_status' => 'any',
        ]);
        
        $migration_log = [];
        
        foreach ($posts as $post) {
            // Create new post
            $new_post_data = [
                'post_title' => $post->post_title,
                'post_content' => $post->post_content,
                'post_excerpt' => $post->post_excerpt,
                'post_status' => $post->post_status,
                'post_author' => $post->post_author,
                'post_date' => $post->post_date,
                'post_type' => $new_type,
            ];
            
            $new_post_id = wp_insert_post($new_post_data);
            
            if (!is_wp_error($new_post_id)) {
                // Migrate meta fields
                self::migrate_meta($post->ID, $new_post_id, $mapping['meta'] ?? []);
                
                // Migrate taxonomies
                self::migrate_taxonomies($post->ID, $new_post_id, $mapping['taxonomies'] ?? []);
                
                // Migrate relationships
                self::migrate_relationships($post->ID, $new_post_id, $old_type, $new_type);
                
                // Log migration
                $migration_log[] = [
                    'old_id' => $post->ID,
                    'new_id' => $new_post_id,
                    'title' => $post->post_title,
                    'status' => 'success',
                ];
                
                // Store mapping for reference
                update_post_meta($new_post_id, '_migrated_from', $post->ID);
                update_post_meta($post->ID, '_migrated_to', $new_post_id);
            } else {
                $migration_log[] = [
                    'old_id' => $post->ID,
                    'title' => $post->post_title,
                    'status' => 'error',
                    'error' => $new_post_id->get_error_message(),
                ];
            }
        }
        
        // Save migration log
        update_option('content_migration_log_' . time(), $migration_log);
        
        return $migration_log;
    }
    
    /**
     * Migrate meta fields
     */
    private static function migrate_meta($old_id, $new_id, $mapping) {
        $old_meta = get_post_meta($old_id);
        
        foreach ($old_meta as $key => $values) {
            // Skip WordPress internal meta
            if (substr($key, 0, 1) === '_' && !isset($mapping[$key])) {
                continue;
            }
            
            $new_key = $mapping[$key] ?? $key;
            
            foreach ($values as $value) {
                add_post_meta($new_id, $new_key, maybe_unserialize($value));
            }
        }
    }
    
    /**
     * Migrate taxonomies
     */
    private static function migrate_taxonomies($old_id, $new_id, $mapping) {
        $taxonomies = get_object_taxonomies(get_post_type($old_id));
        
        foreach ($taxonomies as $taxonomy) {
            $terms = wp_get_object_terms($old_id, $taxonomy, ['fields' => 'ids']);
            
            if (!empty($terms)) {
                $new_taxonomy = $mapping[$taxonomy] ?? $taxonomy;
                
                // Check if new taxonomy exists
                if (taxonomy_exists($new_taxonomy)) {
                    wp_set_object_terms($new_id, $terms, $new_taxonomy);
                }
            }
        }
    }
    
    /**
     * Migrate relationships
     */
    private static function migrate_relationships($old_id, $new_id, $old_type, $new_type) {
        global $wpdb;
        
        $table_name = $wpdb->prefix . 'content_relationships';
        
        // Update source relationships
        $wpdb->update(
            $table_name,
            [
                'source_id' => $new_id,
                'source_type' => $new_type,
            ],
            [
                'source_id' => $old_id,
                'source_type' => $old_type,
            ],
            ['%d', '%s'],
            ['%d', '%s']
        );
        
        // Update target relationships
        $wpdb->update(
            $table_name,
            [
                'target_id' => $new_id,
                'target_type' => $new_type,
            ],
            [
                'target_id' => $old_id,
                'target_type' => $old_type,
            ],
            ['%d', '%s'],
            ['%d', '%s']
        );
    }
}
                        </code></pre>
                    </section>
                    
                    <!-- Documentation -->
                    <section>
                        <h2>Architecture Documentation</h2>
                        
                        <h3>Generating Documentation</h3>
                        <pre><code class="language-php">
/**
 * Architecture documentation generator
 */
class Architecture_Documentation {
    
    /**
     * Generate complete architecture documentation
     */
    public static function generate_documentation() {
        $doc = [];
        
        // Document post types
        $doc['post_types'] = self::document_post_types();
        
        // Document taxonomies
        $doc['taxonomies'] = self::document_taxonomies();
        
        // Document relationships
        $doc['relationships'] = self::document_relationships();
        
        // Document meta fields
        $doc['meta_fields'] = self::document_meta_fields();
        
        // Generate visual diagram
        $doc['diagram'] = self::generate_diagram();
        
        // Save documentation
        self::save_documentation($doc);
        
        return $doc;
    }
    
    /**
     * Document all post types
     */
    private static function document_post_types() {
        $post_types = get_post_types(['public' => true], 'objects');
        $documentation = [];
        
        foreach ($post_types as $post_type) {
            $documentation[$post_type->name] = [
                'label' => $post_type->label,
                'description' => $post_type->description,
                'public' => $post_type->public,
                'hierarchical' => $post_type->hierarchical,
                'supports' => get_all_post_type_supports($post_type->name),
                'taxonomies' => get_object_taxonomies($post_type->name),
                'has_archive' => $post_type->has_archive,
                'rewrite' => $post_type->rewrite,
                'capabilities' => $post_type->cap,
                'menu_icon' => $post_type->menu_icon,
                'rest_base' => $post_type->rest_base,
            ];
        }
        
        return $documentation;
    }
    
    /**
     * Document all taxonomies
     */
    private static function document_taxonomies() {
        $taxonomies = get_taxonomies(['public' => true], 'objects');
        $documentation = [];
        
        foreach ($taxonomies as $taxonomy) {
            $documentation[$taxonomy->name] = [
                'label' => $taxonomy->label,
                'description' => $taxonomy->description,
                'hierarchical' => $taxonomy->hierarchical,
                'post_types' => $taxonomy->object_type,
                'public' => $taxonomy->public,
                'rewrite' => $taxonomy->rewrite,
                'rest_base' => $taxonomy->rest_base,
                'term_count' => wp_count_terms($taxonomy->name),
                'terms_hierarchy' => self::get_terms_hierarchy($taxonomy->name),
            ];
        }
        
        return $documentation;
    }
    
    /**
     * Get terms hierarchy
     */
    private static function get_terms_hierarchy($taxonomy) {
        $terms = get_terms([
            'taxonomy' => $taxonomy,
            'hide_empty' => false,
            'parent' => 0,
        ]);
        
        $hierarchy = [];
        
        foreach ($terms as $term) {
            $hierarchy[] = self::build_term_tree($term, $taxonomy);
        }
        
        return $hierarchy;
    }
    
    /**
     * Build term tree recursively
     */
    private static function build_term_tree($term, $taxonomy) {
        $tree = [
            'id' => $term->term_id,
            'name' => $term->name,
            'slug' => $term->slug,
            'count' => $term->count,
        ];
        
        $children = get_terms([
            'taxonomy' => $taxonomy,
            'hide_empty' => false,
            'parent' => $term->term_id,
        ]);
        
        if (!empty($children)) {
            $tree['children'] = [];
            foreach ($children as $child) {
                $tree['children'][] = self::build_term_tree($child, $taxonomy);
            }
        }
        
        return $tree;
    }
    
    /**
     * Generate visual diagram (Mermaid format)
     */
    private static function generate_diagram() {
        $diagram = "graph TD\n";
        
        // Add post types
        $post_types = get_post_types(['public' => true]);
        foreach ($post_types as $post_type) {
            $diagram .= "    {$post_type}[{$post_type}]\n";
            
            // Add taxonomies
            $taxonomies = get_object_taxonomies($post_type);
            foreach ($taxonomies as $taxonomy) {
                $diagram .= "    {$post_type} --> {$taxonomy}\n";
            }
        }
        
        return $diagram;
    }
    
    /**
     * Save documentation
     */
    private static function save_documentation($doc) {
        // Save as JSON
        $json_file = WP_CONTENT_DIR . '/architecture-documentation.json';
        file_put_contents($json_file, json_encode($doc, JSON_PRETTY_PRINT));
        
        // Save as Markdown
        $markdown = self::generate_markdown($doc);
        $md_file = WP_CONTENT_DIR . '/architecture-documentation.md';
        file_put_contents($md_file, $markdown);
        
        // Store in database
        update_option('content_architecture_doc', $doc);
        update_option('content_architecture_doc_generated', current_time('mysql'));
    }
    
    /**
     * Generate Markdown documentation
     */
    private static function generate_markdown($doc) {
        $md = "# Content Architecture Documentation\n\n";
        $md .= "Generated: " . current_time('mysql') . "\n\n";
        
        $md .= "## Post Types\n\n";
        foreach ($doc['post_types'] as $name => $info) {
            $md .= "### {$info['label']} (`{$name}`)\n\n";
            $md .= "- **Description:** {$info['description']}\n";
            $md .= "- **Hierarchical:** " . ($info['hierarchical'] ? 'Yes' : 'No') . "\n";
            $md .= "- **Supports:** " . implode(', ', array_keys($info['supports'])) . "\n";
            $md .= "- **Taxonomies:** " . implode(', ', $info['taxonomies']) . "\n\n";
        }
        
        $md .= "## Taxonomies\n\n";
        foreach ($doc['taxonomies'] as $name => $info) {
            $md .= "### {$info['label']} (`{$name}`)\n\n";
            $md .= "- **Type:** " . ($info['hierarchical'] ? 'Hierarchical' : 'Flat') . "\n";
            $md .= "- **Post Types:** " . implode(', ', $info['post_types']) . "\n";
            $md .= "- **Term Count:** {$info['term_count']}\n\n";
        }
        
        $md .= "## Architecture Diagram\n\n";
        $md .= "```mermaid\n";
        $md .= $doc['diagram'];
        $md .= "```\n";
        
        return $md;
    }
}

// Generate documentation
add_action('admin_init', function() {
    if (isset($_GET['generate_architecture_doc'])) {
        Architecture_Documentation::generate_documentation();
        wp_redirect(admin_url('admin.php?page=architecture-doc&generated=1'));
        exit;
    }
});
                        </code></pre>
                    </section>
                    
                    <!-- Summary -->
                    <section>
                        <h2>Summary</h2>
                        
                        <div class="summary-box">
                            <h3>Key Takeaways</h3>
                            <ul>
                                <li>Content architecture planning is crucial for scalability</li>
                                <li>Define clear content types and relationships</li>
                                <li>Design hierarchical taxonomy structures thoughtfully</li>
                                <li>Implement flexible relationship management</li>
                                <li>Create reusable templates and patterns</li>
                                <li>Document architecture decisions thoroughly</li>
                            </ul>
                        </div>
                        
                        <div class="best-practices">
                            <h3>Architecture Best Practices</h3>
                            <ul>
                                <li>Plan before implementation</li>
                                <li>Keep content types focused and specific</li>
                                <li>Use taxonomies for faceted classification</li>
                                <li>Implement proper data validation</li>
                                <li>Consider future scalability needs</li>
                                <li>Document all architectural decisions</li>
                                <li>Version control your architecture code</li>
                            </ul>
                        </div>
                    </section>
                    
                    <!-- Additional Resources -->
                    <section class="resources">
                        <h2>Additional Resources</h2>
                        <ul>
                            <li><a href="https://www.usability.gov/how-to-and-tools/methods/information-architecture.html" target="_blank">Information Architecture Basics</a></li>
                            <li><a href="https://developer.wordpress.org/plugins/post-types/" target="_blank">WordPress Post Types Documentation</a></li>
                            <li><a href="https://developer.wordpress.org/plugins/taxonomies/" target="_blank">WordPress Taxonomies Documentation</a></li>
                            <li><a href="https://www.smashingmagazine.com/2020/04/structured-content-design-headless-cms/" target="_blank">Structured Content Design</a></li>
                        </ul>
                    </section>
                </div>
                
                <!-- Lesson Navigation -->
                <div class="lesson-navigation">
                    <a href="/07module/querying_complex_relationships.html" class="lesson-nav-button prev">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"/>
                        </svg>
                        <span>
                            <small>Previous</small><br>
                            Complex Queries
                        </span>
                    </a>
                    
                    <button class="complete-lesson-btn">
                        Mark as Complete
                    </button>
                    
                    <a href="/07module/homework_complex_architecture.html" class="lesson-nav-button next">
                        <span>
                            <small>Next</small><br>
                            Homework Project
                        </span>
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                        </svg>
                    </a>
                </div>
            </div>
        </main>
        
        <!-- Footer -->
        <footer class="site-footer" role="contentinfo">
            <div class="footer-container">
                <div class="footer-content">
                    <div class="footer-section footer-about">
                        <h3>PHP WordPress Development</h3>
                        <p>Complete Web Development Course - From HTML to WordPress</p>
                    </div>
                    
                    <div class="footer-section">
                        <h4>Quick Links</h4>
                        <ul class="footer-links">
                            <li><a href="/">Home</a></li>
                            <li><a href="/module7.html">Module 7</a></li>
                            <li><a href="/resources.html">Resources</a></li>
                            <li><a href="/about.html">About</a></li>
                        </ul>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <p>&copy; 2025 PHP WordPress Development Course. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- JavaScript -->
    <script src="/assets/js/prism.js"></script>
    <script src="/assets/js/main.js"></script>
    <script src="/assets/js/lesson.js"></script>
</body>
</html>