<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <!-- SEO Meta Tags -->
  <title>WordPress Database Structure - PHP WordPress Course</title>
  <meta content="Deep dive into WordPress database architecture, table relationships, and optimization strategies for WordPress development" name="description"/>
  <meta content="PHP, WordPress, MySQL, database, wp_posts, wp_users, database structure, optimization" name="keywords"/>
  <meta content="PHP WordPress Course" name="author"/>
  <link href="/assets/css/main.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
  <!-- Favicon -->
  <link href="/favicon.png" rel="icon" type="image/png"/>
  <link href="/favicon.png" rel="apple-touch-icon"/>
  <!-- CSS -->
 </head>
 <body>
  <!-- Skip to main content -->
  <a class="sr-only" href="#main-content">Skip to main content</a>
  <div class="page-wrapper">
   <!-- Header -->
   <header class="site-header" role="banner">
    <div class="header-container">
     <div class="site-branding">
      <a class="site-logo" href="/">
       <h1 class="site-title">PHP WordPress Development</h1>
      </a>
     </div>
     <nav aria-label="Main navigation" class="main-navigation" role="navigation">
      <button aria-expanded="false" aria-label="Toggle navigation" class="mobile-menu-btn">
       <span>
       </span>
       <span>
       </span>
       <span>
       </span>
      </button>
      <div class="nav-menu">
       <ul class="nav-list">
        <li class="nav-item">
         <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item dropdown">
         <button aria-haspopup="true" class="nav-link dropdown-toggle active">Modules</button>
         <div class="dropdown-menu">
          <a class="dropdown-item" href="/module1.html">Module 1: Web Fundamentals</a>
          <a class="dropdown-item" href="/module2.html">Module 2: PHP Fundamentals</a>
          <a class="dropdown-item" href="/module3.html">Module 3: MySQL Database</a>
          <a class="dropdown-item active" href="/module4.html">Module 4: WordPress &amp; Docker</a>
          <a class="dropdown-item" href="/module5.html">Module 5: Theme Development</a>
          <a class="dropdown-item" href="/module6.html">Module 6: Plugin Development</a>
          <a class="dropdown-item" href="/module7.html">Module 7: Advanced WordPress</a>
          <a class="dropdown-item" href="/module8.html">Module 8: Deployment</a>
          <a class="dropdown-item" href="/module9.html">Module 9: Final Project</a>
         </div>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/resources.html">Resources</a>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/about.html">About</a>
        </li>
       </ul>
      </div>
     </nav>
     <div class="search-container">
      <div class="search-input-wrapper">
       <svg class="search-icon" fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
        <path clip-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" fill-rule="evenodd">
        </path>
       </svg>
       <input aria-label="Search" class="search-input" placeholder="Search lessons..." type="search"/>
      </div>
      <div class="search-results">
      </div>
     </div>
    </div>
   </header>
   <!-- Progress Bar -->
   <div class="progress-container">
    <div class="progress-header">
     <h2 class="progress-title">Course Progress</h2>
     <span class="progress-text">Loading...</span>
    </div>
    <div class="progress-bar">
     <div class="progress-bar-fill">
      <span class="progress-bar-text">
      </span>
     </div>
    </div>
   </div>
   <!-- Breadcrumb -->
   <nav aria-label="Breadcrumb" class="breadcrumb container">
    <ol class="breadcrumb-list">
     <li class="breadcrumb-item">
      <a href="/">Home</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <a href="/module4.html">Module 4</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <span aria-current="page">WordPress Database Structure</span>
     </li>
    </ol>
   </nav>
   <!-- Main Content -->
   <main class="main-content" id="main-content" role="main">
    <div class="container">
     <div class="content-with-sidebar">
      <!-- Sidebar -->
      <aside class="sidebar">
       <div class="sidebar-nav">
        <h3 class="sidebar-title">Module 4: WordPress &amp; Docker</h3>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 1: Introduction to WordPress</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/04module/history_evolution.html">History and evolution of WordPress</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wordpress_org_vs_com.html">WordPress.org vs WordPress.com</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/core_features.html">WordPress core features and capabilities</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wordpress_ecosystem.html">The WordPress ecosystem (themes, plugins, community)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/use_cases.html">WordPress use cases and examples</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/local_development.html">Setting up local development environments for WordPress</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/homework_wordpress_install.html">Homework: Install WordPress locally and explore the admin interface</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 2: WordPress Core Architecture</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/04module/file_structure_overview.html">WordPress file structure</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wp_config.html">Understanding wp-config.php</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wordpress_database_structure_lesson.html">WordPress database structure</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wordpress_loop.html">The WordPress Loop</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wordpress_template_hierarchy.html">Template hierarchy</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wordpress_hooks_system.html">WordPress hooks system (actions and filters)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/homework_file_structure_template_hierarchy.html">Homework: Create a diagram of WordPress file structure and template hierarchy</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 3: WordPress Admin Dashboard</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/04module/wordpress_dashboard_overview.html">Dashboard overview and navigation</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/posts_vs_pages.html">Posts vs. Pages</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wordpress_categories_tags.html">Categories and Tags</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/media_library.html">Media library</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/comments_moderation.html">Comments management</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/users_roles.html">User roles and permissions</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/homework_create_sample_content.html">Homework: Create sample content including posts, pages, and media</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 4: Working with WordPress Themes</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/04module/understanding_wordpress_themes.html">Understanding WordPress themes</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/default_themes_overview.html">Default themes overview</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/installing_activating_themes.html">Installing and activating themes</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/theme_customizer.html">Theme customization through the Customizer</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/theme_settings_options.html">Theme settings and options</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/child_themes.html">Child themes: concept and implementation</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/responsive_mobile_themes.html">Responsive themes and mobile optimization</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/homework_install_theme_create_child.html">Homework: Install a theme and create a child theme</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 5: Docker for WordPress Development</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/04module/docker_fundamentals_review.html">Docker fundamentals review</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/wordpress_docker_setup.html">Setting up WordPress with Docker</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/docker_development_workflow.html">Docker-based development workflow</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/docker_commands_wordpress.html">Docker commands for WordPress developers</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/debugging_wordpress_docker.html">Debugging WordPress in Docker</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/homework_migrate_to_docker.html">Homework: Migrate your WordPress installation to Docker</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 6: Working with WordPress Plugins</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/04module/understanding_wordpress_plugins.html">Understanding WordPress plugins</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/essential_plugins_overview.html">Essential plugins overview</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/installing_activating_plugins.html">Installing and activating plugins</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/plugin_settings_configuration.html">Plugin settings and configuration</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/plugin_quality_security.html">Evaluating plugin quality and security</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/plugin_compatibility.html">Plugin compatibility issues</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/plugins_for_website_types.html">Must-have plugins for different website types</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/homework_essential_plugins.html">Homework: Install and configure essential plugins for your site</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 7: Content Creation in WordPress</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/04module/wordpress_editor_overview.html">WordPress editor overview (Classic vs. Gutenberg)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/04module/mastering_gutenberg_blocks.html">Working with blocks in Gutenberg</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 8: Menus, Widgets, and Site Structure</h4>
         <ul class="sidebar-menu">
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 9: WordPress Forms and User Interactions</h4>
         <ul class="sidebar-menu">
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 10: WordPress Security, Performance, and Mini-Project</h4>
         <ul class="sidebar-menu">
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Quick Links</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/module4.html">Module Overview</a>
          </li>
          <li>
           <a class="sidebar-link prev-session" href="/module3.html">← Prev: Module 3</a>
          </li>
          <li>
           <a class="sidebar-link next-session" href="/module5.html">Next: Module 5 →</a>
          </li>
          <li>
           <a class="sidebar-link" href="/resources.html">Resources</a>
          </li>
         </ul>
        </div>
       </div>
      </aside>
      <!-- Main Lesson Content -->
      <article class="lesson-content">
       <header class="lesson-header">
        <h1>WordPress Database Structure</h1>
        <div class="lesson-meta">
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
           </path>
          </svg>
          <span>Duration: 45 minutes</span>
         </div>
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 14l9-5-9-5-9 5 9 5z">
           </path>
          </svg>
          <span>Module 4: Session 2</span>
         </div>
        </div>
       </header>
       <!-- Learning Objectives -->
       <div class="lesson-objectives">
        <h2>Learning Objectives</h2>
        <ul>
         <li>Understand the complete WordPress database schema and table relationships</li>
         <li>Master working with core WordPress tables (posts, users, meta tables)</li>
         <li>Learn how to query and manipulate WordPress data using $wpdb</li>
         <li>Implement database optimization strategies for better performance</li>
        </ul>
       </div>
       <!-- Lesson Body -->
       <div class="lesson-body">
        <section>
         <h2>Introduction to WordPress Database Architecture</h2>
         <p class="lead">WordPress uses MySQL/MariaDB as its database management system. Understanding the database structure is crucial for advanced WordPress development, troubleshooting, and optimization. Think of it as understanding the filing system in a massive library - knowing where everything is stored and how it's organized.</p>
         <div class="alert alert-info">
          <div class="alert-icon">💡</div>
          <div class="alert-content">
           <div class="alert-title">Key Concept</div>
           <div class="alert-message">WordPress uses a prefix for all its tables (default: wp_) to allow multiple WordPress installations in the same database. This prefix can be customized during installation for security purposes.</div>
          </div>
         </div>
        </section>
        <section>
         <h2>Core WordPress Tables Overview</h2>
         <p>WordPress creates 12 core tables during installation. Each table serves a specific purpose and relates to others through foreign key relationships.</p>
         <!-- Database Structure Diagram -->
         <div class="mermaid">erDiagram
                                        wp_posts ||--o{ wp_postmeta : has
                                        wp_posts ||--o{ wp_comments : has
                                        wp_users ||--o{ wp_posts : creates
                                        wp_users ||--o{ wp_usermeta : has
                                        wp_users ||--o{ wp_comments : makes
                                        wp_comments ||--o{ wp_commentmeta : has
                                        wp_terms ||--o{ wp_term_taxonomy : categorized
                                        wp_term_taxonomy ||--o{ wp_term_relationships : relates
                                        wp_posts ||--o{ wp_term_relationships : tagged
                                        
                                        wp_posts {
                                            bigint ID PK
                                            bigint post_author FK
                                            datetime post_date
                                            text post_content
                                            text post_title
                                            varchar post_status
                                            varchar post_type
                                        }
                                        
                                        wp_users {
                                            bigint ID PK
                                            varchar user_login
                                            varchar user_pass
                                            varchar user_email
                                            datetime user_registered
                                        }
                                        
                                        wp_postmeta {
                                            bigint meta_id PK
                                            bigint post_id FK
                                            varchar meta_key
                                            longtext meta_value
                                        }</div>
         <h3>The 12 Core WordPress Tables</h3>
         <table class="data-table">
          <thead>
           <tr>
            <th>Table Name</th>
            <th>Purpose</th>
            <th>Key Fields</th>
           </tr>
          </thead>
          <tbody>
           <tr>
            <td>
             <code>wp_posts</code>
            </td>
            <td>Stores posts, pages, attachments, revisions, and custom post types</td>
            <td>ID, post_author, post_content, post_title, post_type</td>
           </tr>
           <tr>
            <td>
             <code>wp_postmeta</code>
            </td>
            <td>Custom fields and additional metadata for posts</td>
            <td>meta_id, post_id, meta_key, meta_value</td>
           </tr>
           <tr>
            <td>
             <code>wp_users</code>
            </td>
            <td>User accounts and authentication data</td>
            <td>ID, user_login, user_pass, user_email</td>
           </tr>
           <tr>
            <td>
             <code>wp_usermeta</code>
            </td>
            <td>User preferences and additional user data</td>
            <td>umeta_id, user_id, meta_key, meta_value</td>
           </tr>
           <tr>
            <td>
             <code>wp_comments</code>
            </td>
            <td>Comments and trackbacks</td>
            <td>comment_ID, comment_post_ID, comment_author</td>
           </tr>
           <tr>
            <td>
             <code>wp_commentmeta</code>
            </td>
            <td>Metadata for comments</td>
            <td>meta_id, comment_id, meta_key, meta_value</td>
           </tr>
           <tr>
            <td>
             <code>wp_terms</code>
            </td>
            <td>Categories, tags, and custom taxonomy terms</td>
            <td>term_id, name, slug</td>
           </tr>
           <tr>
            <td>
             <code>wp_term_taxonomy</code>
            </td>
            <td>Describes the taxonomy (category, tag, etc.) for terms</td>
            <td>term_taxonomy_id, term_id, taxonomy</td>
           </tr>
           <tr>
            <td>
             <code>wp_term_relationships</code>
            </td>
            <td>Links posts to categories and tags</td>
            <td>object_id, term_taxonomy_id</td>
           </tr>
           <tr>
            <td>
             <code>wp_termmeta</code>
            </td>
            <td>Metadata for taxonomy terms</td>
            <td>meta_id, term_id, meta_key, meta_value</td>
           </tr>
           <tr>
            <td>
             <code>wp_options</code>
            </td>
            <td>Site settings and configuration</td>
            <td>option_id, option_name, option_value, autoload</td>
           </tr>
           <tr>
            <td>
             <code>wp_links</code>
            </td>
            <td>Deprecated - formerly used for blogroll</td>
            <td>link_id, link_url, link_name</td>
           </tr>
          </tbody>
         </table>
        </section>
        <section>
         <h2>Deep Dive: The wp_posts Table</h2>
         <p>The<code>wp_posts</code>table is the heart of WordPress content storage. It stores not just blog posts, but also pages, attachments, revisions, and custom post types.</p>
         <pre><code class="language-sql">-- Structure of wp_posts table
CREATE TABLE wp_posts (
    ID bigint(20) unsigned NOT NULL AUTO_INCREMENT,
    post_author bigint(20) unsigned NOT NULL DEFAULT '0',
    post_date datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
    post_date_gmt datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
    post_content longtext NOT NULL,
    post_title text NOT NULL,
    post_excerpt text NOT NULL,
    post_status varchar(20) NOT NULL DEFAULT 'publish',
    comment_status varchar(20) NOT NULL DEFAULT 'open',
    ping_status varchar(20) NOT NULL DEFAULT 'open',
    post_password varchar(255) NOT NULL DEFAULT '',
    post_name varchar(200) NOT NULL DEFAULT '',
    to_ping text NOT NULL,
    pinged text NOT NULL,
    post_modified datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
    post_modified_gmt datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
    post_content_filtered longtext NOT NULL,
    post_parent bigint(20) unsigned NOT NULL DEFAULT '0',
    guid varchar(255) NOT NULL DEFAULT '',
    menu_order int(11) NOT NULL DEFAULT '0',
    post_type varchar(20) NOT NULL DEFAULT 'post',
    post_mime_type varchar(100) NOT NULL DEFAULT '',
    comment_count bigint(20) NOT NULL DEFAULT '0',
    PRIMARY KEY (ID),
    KEY post_name (post_name(191)),
    KEY type_status_date (post_type,post_status,post_date,ID),
    KEY post_parent (post_parent),
    KEY post_author (post_author)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;</code></pre>
         <h3>Post Types and Their Storage</h3>
         <pre><code class="language-php">// Different post types stored in wp_posts
$post_types = array(
    'post'         =&gt; 'Blog posts',
    'page'         =&gt; 'Static pages',
    'attachment'   =&gt; 'Media files',
    'revision'     =&gt; 'Post revisions',
    'nav_menu_item'=&gt; 'Navigation menu items',
    'custom_css'   =&gt; 'Custom CSS',
    'customize_changeset' =&gt; 'Customizer changesets',
    // Custom post types also stored here
    'product'      =&gt; 'WooCommerce products',
    'shop_order'   =&gt; 'WooCommerce orders'
);

// Query posts by type
global $wpdb;
$custom_posts = $wpdb-&gt;get_results($wpdb-&gt;prepare(
    "SELECT * FROM {$wpdb-&gt;posts} 
     WHERE post_type = %s 
     AND post_status = 'publish' 
     ORDER BY post_date DESC 
     LIMIT 10",
    'product'
));</code></pre>
        </section>
        <section>
         <h2>Working with Meta Tables</h2>
         <p>WordPress uses meta tables to store additional data that doesn't fit into the main table structure. This provides flexibility for plugins and themes to add custom data.</p>
         <canvas height="300" id="metaTableCanvas" width="600">
         </canvas>
         <script>const metaCanvas = document.getElementById('metaTableCanvas');
                                    const metaCtx = metaCanvas.getContext('2d');
                                    
                                    // Title
                                    metaCtx.font = 'bold 16px Arial';
                                    metaCtx.fillStyle = '#333';
                                    metaCtx.fillText('Meta Table Relationships', 20, 30);
                                    
                                    // Main tables
                                    const mainTables = [
                                        {name: 'wp_posts', x: 100, y: 80, color: '#4caf50'},
                                        {name: 'wp_users', x: 300, y: 80, color: '#2196f3'},
                                        {name: 'wp_comments', x: 500, y: 80, color: '#ff9800'}
                                    ];
                                    
                                    // Meta tables
                                    const metaTables = [
                                        {name: 'wp_postmeta', x: 100, y: 180, color: '#81c784'},
                                        {name: 'wp_usermeta', x: 300, y: 180, color: '#64b5f6'},
                                        {name: 'wp_commentmeta', x: 500, y: 180, color: '#ffb74d'}
                                    ];
                                    
                                    // Draw main tables
                                    for(let table of mainTables) {
                                        metaCtx.fillStyle = table.color;
                                        metaCtx.fillRect(table.x - 40, table.y - 20, 80, 40);
                                        metaCtx.fillStyle = '#fff';
                                        metaCtx.font = '11px Arial';
                                        metaCtx.textAlign = 'center';
                                        metaCtx.fillText(table.name, table.x, table.y + 3);
                                    }
                                    
                                    // Draw meta tables
                                    for(let table of metaTables) {
                                        metaCtx.fillStyle = table.color;
                                        metaCtx.fillRect(table.x - 40, table.y - 20, 80, 40);
                                        metaCtx.fillStyle = '#fff';
                                        metaCtx.font = '11px Arial';
                                        metaCtx.textAlign = 'center';
                                        metaCtx.fillText(table.name, table.x, table.y + 3);
                                    }
                                    
                                    // Draw relationships
                                    metaCtx.strokeStyle = '#666';
                                    metaCtx.lineWidth = 2;
                                    for(let i = 0; i< 3; i++) {
                                        metaCtx.beginPath();
                                        metaCtx.moveTo(mainTables[i].x, mainTables[i].y + 20);
                                        metaCtx.lineTo(metaTables[i].x, metaTables[i].y - 20);
                                        metaCtx.stroke();
                                    }
                                    
                                    // Add labels
                                    metaCtx.fillStyle = '#666';
                                    metaCtx.font = '10px Arial';
                                    metaCtx.fillText('1 to Many', 150, 130);
                                    metaCtx.fillText('1 to Many', 350, 130);
                                    metaCtx.fillText('1 to Many', 450, 130);
                                    
                                    // Example data
                                    metaCtx.fillStyle = '#333';
                                    metaCtx.font = '12px Arial';
                                    metaCtx.textAlign = 'left';
                                    metaCtx.fillText('Example Meta Data:', 20, 250);
                                    metaCtx.font = '10px monospace';
                                    metaCtx.fillText('post_id: 123, meta_key: "_thumbnail_id", meta_value: "456"', 30, 270);</script>
         <h3>Common Meta Operations</h3>
         <pre><code class="language-php">&lt;?php
// Adding post meta
add_post_meta($post_id, 'custom_field_name', 'custom_value', true);

// Getting post meta
$value = get_post_meta($post_id, 'custom_field_name', true);

// Updating post meta
update_post_meta($post_id, 'custom_field_name', 'new_value');

// Deleting post meta
delete_post_meta($post_id, 'custom_field_name');

// Query posts by meta value
$args = array(
    'post_type' =&gt; 'product',
    'meta_query' =&gt; array(
        array(
            'key'     =&gt; 'featured_product',
            'value'   =&gt; 'yes',
            'compare' =&gt; '='
        ),
        array(
            'key'     =&gt; 'price',
            'value'   =&gt; 100,
            'compare' =&gt; '&lt;',
            'type'    =&gt; 'NUMERIC'
        )
    )
);
$query = new WP_Query($args);</code></pre>
        </section>
        <section>
         <h2>The WordPress Database API ($wpdb)</h2>
         <p>WordPress provides the<code>$wpdb</code>class for safe database interactions. This class handles escaping, prepared statements, and provides methods for common database operations.</p>
         <pre><code class="language-php">&lt;?php
global $wpdb;

// 1. SELECT queries
$results = $wpdb-&gt;get_results(
    "SELECT * FROM {$wpdb-&gt;posts} WHERE post_status = 'publish'"
);

// 2. Get single variable
$post_count = $wpdb-&gt;get_var(
    "SELECT COUNT(*) FROM {$wpdb-&gt;posts} WHERE post_type = 'post'"
);

// 3. Get single row
$post = $wpdb-&gt;get_row(
    $wpdb-&gt;prepare("SELECT * FROM {$wpdb-&gt;posts} WHERE ID = %d", $post_id)
);

// 4. Get single column
$post_titles = $wpdb-&gt;get_col(
    "SELECT post_title FROM {$wpdb-&gt;posts} WHERE post_status = 'publish'"
);

// 5. INSERT data
$wpdb-&gt;insert(
    $wpdb-&gt;prefix . 'custom_table',
    array(
        'column1' =&gt; 'value1',
        'column2' =&gt; 123,
        'column3' =&gt; current_time('mysql')
    ),
    array('%s', '%d', '%s') // Format specifiers
);

// 6. UPDATE data
$wpdb-&gt;update(
    $wpdb-&gt;posts,
    array('post_status' =&gt; 'draft'),  // Data to update
    array('ID' =&gt; $post_id),          // WHERE clause
    array('%s'),                      // Data format
    array('%d')                       // WHERE format
);

// 7. DELETE data
$wpdb-&gt;delete(
    $wpdb-&gt;postmeta,
    array('post_id' =&gt; $post_id, 'meta_key' =&gt; 'temp_data'),
    array('%d', '%s')
);

// 8. Custom queries with prepare()
$custom_query = $wpdb-&gt;prepare(
    "SELECT p.*, pm.meta_value as featured
     FROM {$wpdb-&gt;posts} p
     LEFT JOIN {$wpdb-&gt;postmeta} pm ON p.ID = pm.post_id
     WHERE p.post_type = %s
     AND pm.meta_key = %s
     AND p.post_status = 'publish'
     ORDER BY p.post_date DESC
     LIMIT %d",
    'product',
    '_featured',
    10
);
$featured_products = $wpdb-&gt;get_results($custom_query);</code></pre>
        </section>
        <!-- Best Practice Box -->
        <div class="best_practice">
         <h3>Database Best Practices</h3>
         <ul>
          <li>Always use<code>$wpdb-&gt;prepare()</code>for queries with user input to prevent SQL injection</li>
          <li>Use WordPress functions (get_posts, WP_Query) when possible instead of direct SQL</li>
          <li>Cache expensive queries using WordPress Transients API</li>
          <li>Add indexes to custom tables for frequently queried columns</li>
          <li>Regularly optimize database tables using tools like WP-Optimize</li>
          <li>Limit post revisions to reduce database bloat</li>
          <li>Clean up orphaned metadata periodically</li>
         </ul>
        </div>
        <section>
         <h2>Database Optimization Techniques</h2>
         <p>Optimizing your WordPress database is crucial for maintaining good performance as your site grows.</p>
         <h3>1. Indexing Strategies</h3>
         <pre><code class="language-sql">-- Add index for custom queries
ALTER TABLE wp_postmeta ADD INDEX meta_key_value (meta_key(191), meta_value(100));

-- Check existing indexes
SHOW INDEX FROM wp_posts;

-- Analyze table for optimization opportunities
ANALYZE TABLE wp_posts, wp_postmeta, wp_options;</code></pre>
         <h3>2. Query Optimization</h3>
         <pre><code class="language-php">&lt;?php
// Bad: Multiple queries in a loop
foreach($post_ids as $id) {
    $meta = get_post_meta($id, 'custom_field', true);
    // Process...
}

// Good: Single optimized query
global $wpdb;
$post_ids_string = implode(',', array_map('intval', $post_ids));
$results = $wpdb-&gt;get_results(
    "SELECT post_id, meta_value 
     FROM {$wpdb-&gt;postmeta} 
     WHERE post_id IN ($post_ids_string) 
     AND meta_key = 'custom_field'"
);

// Using caching for expensive queries
$cache_key = 'expensive_query_result';
$results = get_transient($cache_key);

if (false === $results) {
    $results = $wpdb-&gt;get_results($expensive_query);
    set_transient($cache_key, $results, HOUR_IN_SECONDS);
}</code></pre>
         <h3>3. Database Maintenance</h3>
         <pre><code class="language-php">&lt;?php
// Clean up post revisions
function cleanup_post_revisions($days = 30) {
    global $wpdb;
    
    $wpdb-&gt;query($wpdb-&gt;prepare(
        "DELETE FROM {$wpdb-&gt;posts} 
         WHERE post_type = 'revision' 
         AND post_date &lt; DATE_SUB(NOW(), INTERVAL %d DAY)",
        $days
    ));
}

// Remove orphaned metadata
function cleanup_orphaned_metadata() {
    global $wpdb;
    
    // Clean orphaned post meta
    $wpdb-&gt;query(
        "DELETE pm FROM {$wpdb-&gt;postmeta} pm
         LEFT JOIN {$wpdb-&gt;posts} p ON p.ID = pm.post_id
         WHERE p.ID IS NULL"
    );
    
    // Clean orphaned comment meta
    $wpdb-&gt;query(
        "DELETE cm FROM {$wpdb-&gt;commentmeta} cm
         LEFT JOIN {$wpdb-&gt;comments} c ON c.comment_ID = cm.comment_id
         WHERE c.comment_ID IS NULL"
    );
}

// Optimize tables
function optimize_database_tables() {
    global $wpdb;
    
    $tables = $wpdb-&gt;get_results("SHOW TABLES", ARRAY_N);
    foreach($tables as $table) {
        $wpdb-&gt;query("OPTIMIZE TABLE {$table[0]}");
    }
}</code></pre>
        </section>
        <!-- Real World Example -->
        <div class="real_world_example">
         <h3>Real World Example: Custom Analytics Table</h3>
         <p>Creating a custom table for tracking page views with optimized structure:</p>
         <pre><code class="language-php">&lt;?php
function create_analytics_table() {
    global $wpdb;
    
    $table_name = $wpdb-&gt;prefix . 'page_analytics';
    $charset_collate = $wpdb-&gt;get_charset_collate();
    
    $sql = "CREATE TABLE IF NOT EXISTS $table_name (
        id bigint(20) unsigned NOT NULL AUTO_INCREMENT,
        post_id bigint(20) unsigned NOT NULL,
        user_id bigint(20) unsigned DEFAULT NULL,
        ip_address varchar(45) NOT NULL,
        user_agent text,
        referrer text,
        view_date datetime DEFAULT CURRENT_TIMESTAMP,
        session_id varchar(32),
        PRIMARY KEY (id),
        KEY post_id_date (post_id, view_date),
        KEY user_id (user_id),
        KEY view_date (view_date),
        KEY session_id (session_id)
    ) $charset_collate;";
    
    require_once(ABSPATH . 'wp-admin/includes/upgrade.php');
    dbDelta($sql);
}

// Track page view
function track_page_view($post_id) {
    global $wpdb;
    
    $table_name = $wpdb-&gt;prefix . 'page_analytics';
    
    $wpdb-&gt;insert(
        $table_name,
        array(
            'post_id'    =&gt; $post_id,
            'user_id'    =&gt; get_current_user_id() ?: null,
            'ip_address' =&gt; $_SERVER['REMOTE_ADDR'],
            'user_agent' =&gt; $_SERVER['HTTP_USER_AGENT'],
            'referrer'   =&gt; $_SERVER['HTTP_REFERER'] ?? '',
            'session_id' =&gt; session_id()
        ),
        array('%d', '%d', '%s', '%s', '%s', '%s')
    );
}

// Get analytics data
function get_page_analytics($post_id, $days = 30) {
    global $wpdb;
    
    $table_name = $wpdb-&gt;prefix . 'page_analytics';
    
    return $wpdb-&gt;get_results($wpdb-&gt;prepare(
        "SELECT 
            DATE(view_date) as date,
            COUNT(*) as views,
            COUNT(DISTINCT ip_address) as unique_visitors,
            COUNT(DISTINCT session_id) as sessions
         FROM $table_name
         WHERE post_id = %d
         AND view_date &gt; DATE_SUB(NOW(), INTERVAL %d DAY)
         GROUP BY DATE(view_date)
         ORDER BY date DESC",
        $post_id,
        $days
    ));
}</code></pre>
        </div>
        <!-- Practice Exercise -->
        <section>
         <h2>Practice Exercise</h2>
         <p>Create a custom function that finds all posts with specific metadata and displays them with their authors:</p>
         <div class="alert alert-success">
          <div class="alert-icon">💻</div>
          <div class="alert-content">
           <div class="alert-title">Try It Now</div>
           <div class="alert-message">Write a function that:<ol>
             <li>Queries posts with a specific meta key "featured_level"</li>
             <li>Joins with the users table to get author information</li>
             <li>Returns posts grouped by author</li>
             <li>Includes post count per author</li>
            </ol>
           </div>
          </div>
         </div>
         <details>
          <summary>View Solution</summary>
          <pre><code class="language-php">&lt;?php
function get_featured_posts_by_author() {
    global $wpdb;
    
    $query = "
        SELECT 
            u.ID as author_id,
            u.display_name as author_name,
            COUNT(p.ID) as post_count,
            GROUP_CONCAT(p.ID ORDER BY p.post_date DESC) as post_ids
        FROM {$wpdb-&gt;posts} p
        INNER JOIN {$wpdb-&gt;postmeta} pm ON p.ID = pm.post_id
        INNER JOIN {$wpdb-&gt;users} u ON p.post_author = u.ID
        WHERE pm.meta_key = 'featured_level'
        AND pm.meta_value IN ('gold', 'silver', 'bronze')
        AND p.post_status = 'publish'
        AND p.post_type = 'post'
        GROUP BY u.ID
        ORDER BY post_count DESC
    ";
    
    $results = $wpdb-&gt;get_results($query);
    
    // Process results
    $output = array();
    foreach($results as $author) {
        $post_ids = explode(',', $author-&gt;post_ids);
        $posts = array();
        
        foreach($post_ids as $post_id) {
            $posts[] = get_post($post_id);
        }
        
        $output[] = array(
            'author' =&gt; $author,
            'posts' =&gt; $posts
        );
    }
    
    return $output;
}</code></pre>
         </details>
        </section>
        <!-- Homework -->
        <div class="homework">
         <h2>Practice Assignment</h2>
         <p>Expand your understanding of WordPress database structure by completing these tasks:</p>
         <ul>
          <li>Create a custom table for storing form submissions with proper indexes</li>
          <li>Write a function to migrate data from post meta to a custom table</li>
          <li>Implement a database cleanup routine that runs weekly via WP-Cron</li>
          <li>Create a admin page that shows database table sizes and optimization status</li>
          <li>Build a query logger to identify slow queries in your WordPress site</li>
         </ul>
        </div>
        <!-- Resources -->
        <section class="resources">
         <h2>Additional Resources</h2>
         <ul>
          <li>
           <a href="https://codex.wordpress.org/Database_Description" target="_blank">WordPress Database Description - Official Documentation</a>
          </li>
          <li>
           <a href="https://developer.wordpress.org/reference/classes/wpdb/" target="_blank">wpdb Class Reference</a>
          </li>
          <li>
           <a href="https://dev.mysql.com/doc/refman/8.0/en/optimization.html" target="_blank">MySQL Optimization Guide</a>
          </li>
          <li>
           <a href="https://wordpress.org/plugins/query-monitor/" target="_blank">Query Monitor Plugin for Debugging</a>
          </li>
          <li>
           <a href="https://kinsta.com/blog/wordpress-database/" target="_blank">Complete Guide to WordPress Database Management</a>
          </li>
         </ul>
        </section>
       </div>
       <!-- Lesson Navigation -->
       <div class="lesson-navigation">
        <a class="lesson-nav-button prev" href="/module4-session1.html">
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z">
          </path>
         </svg>
         <span>
          <small>Previous</small>
          <br/>WordPress Installation</span>
        </a>
        <button class="complete-lesson-btn">Mark as Complete</button>
        <a class="lesson-nav-button next" href="/module4-session3.html">
         <span>
          <small>Next</small>
          <br/>WordPress Loop</span>
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z">
          </path>
         </svg>
        </a>
       </div>
      </article>
     </div>
    </div>
   </main>
   <!-- Footer -->
   <footer class="site-footer" role="contentinfo">
    <div class="footer-container">
     <div class="footer-content">
      <div class="footer-section footer-about">
       <h3>PHP WordPress Development</h3>
       <p>Complete Web Development Course</p>
      </div>
      <div class="footer-section">
       <h4>Quick Links</h4>
       <ul class="footer-links">
        <li>
         <a href="/">Home</a>
        </li>
        <li>
         <a class="active" href="/module4.html">Module 4</a>
        </li>
        <li>
         <a href="/resources.html">Resources</a>
        </li>
       </ul>
      </div>
      <div class="footer-section">
       <h4>Support</h4>
       <ul class="footer-links">
        <li>
         <a href="/help.html">Help Center</a>
        </li>
        <li>
         <a href="/faq.html">FAQ</a>
        </li>
        <li>
         <a href="/contact.html">Contact</a>
        </li>
       </ul>
      </div>
     </div>
     <div class="footer-bottom">
      <div class="footer-bottom-content">
       <p class="copyright">© 2025 PHP WordPress Development Course</p>
       <nav class="footer-bottom-links">
        <a href="/privacy.html">Privacy</a>
        <span class="separator">|</span>
        <a href="/terms.html">Terms</a>
       </nav>
      </div>
     </div>
    </div>
   </footer>
  </div>
  <!-- Back to Top -->
  <button aria-label="Back to top" class="back-to-top" id="back-to-top">
   <svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24">
    <path d="M12 19V5M12 5l-7 7M12 5l7 7">
    </path>
   </svg>
  </button>
  <!-- JavaScript -->
  <script src="/assets/js/navigation.js">
  </script>
  <script src="/assets/js/site-config.js">
  </script>
  <script src="/assets/js/sidebar-toggle.js">
  </script>
  <!-- Universal Mermaid Fix (Enhanced) -->
  <!-- Universal Mermaid Fix -->
  <script src="/assets/js/mermaid-universal-fix.js">
  </script>
 </body>
</html>
