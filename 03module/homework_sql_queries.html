<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <!-- SEO Meta Tags -->
  <title>SQL Homework - Data Manipulation Queries - PHP WordPress Course</title>
  <meta content="Practice SQL queries with real-world scenarios - SELECT, INSERT, UPDATE, DELETE, JOINs, and advanced techniques" name="description"/>
  <meta content="PHP, WordPress, MySQL, SQL homework, queries, practice, exercises" name="keywords"/>
  <meta content="PHP WordPress Course" name="author"/>
  <link href="/assets/css/main.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
  <!-- Favicon -->
  <link href="/favicon.png" rel="icon" type="image/png"/>
  <link href="/favicon.png" rel="apple-touch-icon"/>
  <!-- CSS -->
  <link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
  <!-- Mermaid for diagrams -->
  <script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });</script>
 </head>
 <body>
  <!-- Skip to main content -->
  <a class="sr-only" href="#main-content">Skip to main content</a>
  <div class="page-wrapper">
   <!-- Header -->
   <header class="site-header" role="banner">
    <div class="header-container">
     <div class="site-branding">
      <a class="site-logo" href="/">
       <h1 class="site-title">PHP WordPress Development</h1>
      </a>
     </div>
     <nav aria-label="Main navigation" class="main-navigation" role="navigation">
      <button aria-expanded="false" aria-label="Toggle navigation" class="mobile-menu-btn">
       <span>
       </span>
       <span>
       </span>
       <span>
       </span>
      </button>
      <div class="nav-menu">
       <ul class="nav-list">
        <li class="nav-item">
         <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item dropdown">
         <button aria-haspopup="true" class="nav-link dropdown-toggle active">Modules</button>
         <div class="dropdown-menu">
          <a class="dropdown-item" href="/module1.html">Module 1: Web Fundamentals</a>
          <a class="dropdown-item" href="/module2.html">Module 2: PHP Fundamentals</a>
          <a class="dropdown-item active" href="/module3.html">Module 3: MySQL Database</a>
          <a class="dropdown-item" href="/module4.html">Module 4: WordPress &amp; Docker</a>
          <a class="dropdown-item" href="/module5.html">Module 5: Theme Development</a>
          <a class="dropdown-item" href="/module6.html">Module 6: Plugin Development</a>
          <a class="dropdown-item" href="/module7.html">Module 7: Advanced WordPress</a>
          <a class="dropdown-item" href="/module8.html">Module 8: Deployment</a>
          <a class="dropdown-item" href="/module9.html">Module 9: Final Project</a>
         </div>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/resources.html">Resources</a>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/about.html">About</a>
        </li>
       </ul>
      </div>
     </nav>
     <div class="search-container">
      <div class="search-input-wrapper">
       <svg class="search-icon" fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
        <path clip-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" fill-rule="evenodd">
        </path>
       </svg>
       <input aria-label="Search" class="search-input" placeholder="Search lessons..." type="search"/>
      </div>
      <div class="search-results">
      </div>
     </div>
    </div>
   </header>
   <!-- Progress Bar -->
   <div class="progress-container">
    <div class="progress-header">
     <h2 class="progress-title">Course Progress</h2>
     <span class="progress-text">Loading...</span>
    </div>
    <div class="progress-bar">
     <div class="progress-bar-fill">
      <span class="progress-bar-text">
      </span>
     </div>
    </div>
   </div>
   <!-- Breadcrumb -->
   <nav aria-label="Breadcrumb" class="breadcrumb container">
    <ol class="breadcrumb-list">
     <li class="breadcrumb-item">
      <a href="/">Home</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <a href="/module3.html">Module 3</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <span aria-current="page">SQL Homework</span>
     </li>
    </ol>
   </nav>
   <!-- Main Content -->
   <main class="main-content" id="main-content" role="main">
    <div class="container">
     <div class="content-with-sidebar">
      <!-- Sidebar -->
      <aside class="sidebar">
    <div class="sidebar-nav">
        <h3 class="sidebar-title">Module 3: MySQL Database</h3>
        <div class="sidebar-section">
            <h4 class="sidebar-section-title">Session 3: SQL Fundamentals</h4>
            <ul class="sidebar-menu">
                <li><a class="sidebar-link" href="/03module/sql_syntax_conventions.html">SQL syntax and conventions</a></li>
                <li><a class="sidebar-link" href="/03module/mysql_data_types.html">Data types in MySQL</a></li>
                <li><a class="sidebar-link" href="/03module/database_structure_ddl.html">Creating and modifying database structures (CREATE, ALTER, DROP)</a></li>
                <li><a class="sidebar-link" href="/03module/insert_update_delete.html">Basic data manipulation (INSERT, UPDATE, DELETE)</a></li>
                <li><a class="sidebar-link" href="/03module/select_queries.html">Simple queries with SELECT</a></li>
                <li><a class="sidebar-link" href="/03module/where_filtering.html">Filtering data with WHERE</a></li>
                <li><a class="sidebar-link" href="/03module/order_by_sorting.html">Sorting results with ORDER BY</a></li>
                <li class="active"><a class="sidebar-link active" href="/03module/homework_sql_queries.html">Homework: Write SQL queries to manipulate data in your database</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <h4 class="sidebar-section-title">Quick Links</h4>
            <ul class="sidebar-menu">
                <li><a class="sidebar-link" href="/module3.html">Module Overview</a></li>
                <li><a class="sidebar-link prev-session" href="/03module/data_modeling_concepts.html">‚Üê Prev: Database Design</a></li>
                <li><a class="sidebar-link next-session" href="/03module/sql_joins.html">Next: Advanced SQL ‚Üí</a></li>
                <li><a class="sidebar-link" href="/">‚Üê Course Home</a></li>
                <li><a class="sidebar-link" href="/module4.html">Next Module ‚Üí</a></li>
                <li><a class="sidebar-link" href="/resources.html">Resources</a></li>
            </ul>
        </div>
    </div>
</aside>
      <!-- Main Lesson Content -->
      <article class="lesson-content">
       <header class="lesson-header">
        <h1>Homework: SQL Query Mastery</h1>
        <div class="lesson-meta">
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
           </path>
          </svg>
          <span>Estimated Time: 3-4 hours</span>
         </div>
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 14l9-5-9-5-9 5 9 5z">
           </path>
          </svg>
          <span>Module 3: Comprehensive Assignment</span>
         </div>
        </div>
       </header>
       <!-- Assignment Overview -->
       <div class="lesson-objectives">
        <h2>Assignment Overview</h2>
        <p class="lead">Apply your SQL knowledge to solve real-world database challenges! Work with an e-commerce database to practice all DML operations.</p>
        <div class="alert alert-info">
         <div class="alert-icon">üéØ</div>
         <div class="alert-content">
          <div class="alert-title">Skills You'll Practice</div>
          <div class="alert-message">
           <ul>
            <li>Complex SELECT queries with filtering and sorting</li>
            <li>Data manipulation with INSERT, UPDATE, DELETE</li>
            <li>JOIN operations across multiple tables</li>
            <li>Aggregate functions and grouping</li>
            <li>Subqueries and advanced techniques</li>
            <li>Performance optimization</li>
           </ul>
          </div>
         </div>
        </div>
       </div>
       <!-- Assignment Body -->
       <div class="lesson-body">
        <section>
         <h2>Part A: Database Setup</h2>
         <canvas height="400" id="schemaCanvas" width="600">
         </canvas>
         <script>const ctx = document.getElementById('schemaCanvas').getContext('2d');
                                    
                                    // Title
                                    ctx.font = 'bold 16px Arial';
                                    ctx.fillStyle = '#1f2937';
                                    ctx.fillText('E-Commerce Database Schema', 190, 30);
                                    
                                    // Tables
                                    const tables = [
                                        { name: 'users', x: 50, y: 60, color: '#dbeafe' },
                                        { name: 'products', x: 220, y: 60, color: '#dcfce7' },
                                        { name: 'categories', x: 390, y: 60, color: '#fef3c7' },
                                        { name: 'orders', x: 50, y: 160, color: '#fee2e2' },
                                        { name: 'order_items', x: 220, y: 160, color: '#e9d5ff' },
                                        { name: 'reviews', x: 390, y: 160, color: '#e0f2fe' },
                                        { name: 'inventory', x: 50, y: 260, color: '#fce7f3' },
                                        { name: 'coupons', x: 220, y: 260, color: '#f3f4f6' },
                                        { name: 'cart', x: 390, y: 260, color: '#dbeafe' }
                                    ];
                                    
                                    tables.forEach(table =>{
                                        ctx.fillStyle = table.color;
                                        ctx.fillRect(table.x, table.y, 150, 80);
                                        ctx.strokeStyle = '#6b7280';
                                        ctx.strokeRect(table.x, table.y, 150, 80);
                                        
                                        ctx.fillStyle = '#1f2937';
                                        ctx.font = 'bold 12px Arial';
                                        ctx.fillText(table.name, table.x + 50, table.y + 45);
                                    });
                                    
                                    // Relationships
                                    ctx.strokeStyle = '#9ca3af';
                                    ctx.lineWidth = 1;
                                    ctx.setLineDash([5, 5]);
                                    
                                    // Draw some relationships
                                    ctx.beginPath();
                                    ctx.moveTo(125, 140);
                                    ctx.lineTo(125, 160);
                                    ctx.stroke();
                                    
                                    ctx.beginPath();
                                    ctx.moveTo(295, 140);
                                    ctx.lineTo(295, 160);
                                    ctx.stroke();
                                    
                                    ctx.beginPath();
                                    ctx.moveTo(200, 200);
                                    ctx.lineTo(220, 200);
                                    ctx.stroke();
                                    
                                    // Note
                                    ctx.setLineDash([]);
                                    ctx.fillStyle = '#6b7280';
                                    ctx.font = '11px Arial';
                                    ctx.fillText('9 interconnected tables with foreign key relationships', 150, 370);</script>
         <div class="homework">
          <h3>üìã Task A.1: Create the Database</h3>
          <p>Create a database called<code>ecommerce_hw</code>with the following schema:</p>
          <pre><code class="language-sql">-- Create and use database
CREATE DATABASE IF NOT EXISTS ecommerce_hw
    CHARACTER SET utf8mb4
    COLLATE utf8mb4_unicode_ci;

USE ecommerce_hw;

-- Users table
CREATE TABLE users (
    user_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    phone VARCHAR(20),
    registration_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login TIMESTAMP NULL,
    is_active BOOLEAN DEFAULT TRUE,
    user_type ENUM('customer', 'admin', 'vendor') DEFAULT 'customer',
    INDEX idx_email (email),
    INDEX idx_registration (registration_date)
);

-- Categories table
CREATE TABLE categories (
    category_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    category_name VARCHAR(100) UNIQUE NOT NULL,
    parent_category_id INT UNSIGNED NULL,
    description TEXT,
    is_active BOOLEAN DEFAULT TRUE,
    FOREIGN KEY (parent_category_id) REFERENCES categories(category_id)
);

-- Products table
CREATE TABLE products (
    product_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    sku VARCHAR(50) UNIQUE NOT NULL,
    product_name VARCHAR(200) NOT NULL,
    category_id INT UNSIGNED,
    description TEXT,
    price DECIMAL(10,2) NOT NULL,
    cost DECIMAL(10,2),
    weight DECIMAL(8,3),
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (category_id) REFERENCES categories(category_id),
    INDEX idx_category (category_id),
    INDEX idx_price (price),
    FULLTEXT ft_search (product_name, description)
);

-- Inventory table
CREATE TABLE inventory (
    inventory_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    product_id INT UNSIGNED UNIQUE NOT NULL,
    quantity_available INT UNSIGNED DEFAULT 0,
    quantity_reserved INT UNSIGNED DEFAULT 0,
    reorder_level INT UNSIGNED DEFAULT 10,
    last_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (product_id) REFERENCES products(product_id)
);

-- Orders table
CREATE TABLE orders (
    order_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    user_id INT UNSIGNED NOT NULL,
    order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    status ENUM('pending', 'processing', 'shipped', 'delivered', 'cancelled') DEFAULT 'pending',
    total_amount DECIMAL(10,2) NOT NULL DEFAULT 0,
    shipping_address TEXT,
    payment_method VARCHAR(50),
    notes TEXT,
    FOREIGN KEY (user_id) REFERENCES users(user_id),
    INDEX idx_user (user_id),
    INDEX idx_status (status),
    INDEX idx_date (order_date)
);

-- Order items table
CREATE TABLE order_items (
    order_item_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    order_id INT UNSIGNED NOT NULL,
    product_id INT UNSIGNED NOT NULL,
    quantity INT UNSIGNED NOT NULL,
    unit_price DECIMAL(10,2) NOT NULL,
    discount_amount DECIMAL(10,2) DEFAULT 0,
    FOREIGN KEY (order_id) REFERENCES orders(order_id) ON DELETE CASCADE,
    FOREIGN KEY (product_id) REFERENCES products(product_id),
    INDEX idx_order (order_id),
    INDEX idx_product (product_id)
);

-- Reviews table
CREATE TABLE reviews (
    review_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    product_id INT UNSIGNED NOT NULL,
    user_id INT UNSIGNED NOT NULL,
    rating INT UNSIGNED NOT NULL CHECK (rating BETWEEN 1 AND 5),
    title VARCHAR(200),
    comment TEXT,
    is_verified_purchase BOOLEAN DEFAULT FALSE,
    helpful_count INT UNSIGNED DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (product_id) REFERENCES products(product_id),
    FOREIGN KEY (user_id) REFERENCES users(user_id),
    UNIQUE KEY unique_review (product_id, user_id),
    INDEX idx_product_rating (product_id, rating)
);

-- Shopping cart table
CREATE TABLE cart (
    cart_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    user_id INT UNSIGNED NOT NULL,
    product_id INT UNSIGNED NOT NULL,
    quantity INT UNSIGNED NOT NULL DEFAULT 1,
    added_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(user_id) ON DELETE CASCADE,
    FOREIGN KEY (product_id) REFERENCES products(product_id),
    UNIQUE KEY unique_cart_item (user_id, product_id)
);

-- Coupons table
CREATE TABLE coupons (
    coupon_id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    coupon_code VARCHAR(20) UNIQUE NOT NULL,
    discount_type ENUM('percentage', 'fixed') NOT NULL,
    discount_value DECIMAL(10,2) NOT NULL,
    minimum_order DECIMAL(10,2) DEFAULT 0,
    valid_from DATE NOT NULL,
    valid_until DATE NOT NULL,
    usage_limit INT UNSIGNED,
    times_used INT UNSIGNED DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    INDEX idx_code (coupon_code),
    INDEX idx_dates (valid_from, valid_until)
);</code></pre>
          <h3>üìã Task A.2: Insert Sample Data</h3>
          <p>Populate your database with sample data (you'll need this for the queries):</p>
          <details>
           <summary>Click to see sample data insertion script</summary>
           <pre><code class="language-sql">-- Insert sample users
INSERT INTO users (username, email, first_name, last_name, phone, user_type) VALUES
('johndoe', 'john@example.com', 'John', 'Doe', '555-0101', 'customer'),
('janesmith', 'jane@example.com', 'Jane', 'Smith', '555-0102', 'customer'),
('bobwilson', 'bob@example.com', 'Bob', 'Wilson', '555-0103', 'customer'),
('alicebrown', 'alice@example.com', 'Alice', 'Brown', '555-0104', 'customer'),
('admin', 'admin@example.com', 'Admin', 'User', '555-0100', 'admin'),
('vendor1', 'vendor1@example.com', 'Vendor', 'One', '555-0201', 'vendor');

-- Insert categories
INSERT INTO categories (category_name, parent_category_id, description) VALUES
('Electronics', NULL, 'Electronic devices and accessories'),
('Computers', 1, 'Desktop and laptop computers'),
('Phones', 1, 'Mobile phones and accessories'),
('Clothing', NULL, 'Apparel and fashion'),
('Men', 4, 'Men clothing'),
('Women', 4, 'Women clothing'),
('Books', NULL, 'Books and publications'),
('Home &amp; Garden', NULL, 'Home improvement and gardening');

-- Insert products
INSERT INTO products (sku, product_name, category_id, description, price, cost) VALUES
('LAP001', 'Gaming Laptop Pro', 2, 'High-performance gaming laptop', 1499.99, 1200.00),
('LAP002', 'Business Laptop', 2, 'Professional business laptop', 899.99, 700.00),
('PHN001', 'Smartphone X', 3, 'Latest smartphone with 5G', 799.99, 600.00),
('PHN002', 'Budget Phone', 3, 'Affordable smartphone', 299.99, 200.00),
('SHT001', 'Men T-Shirt', 5, 'Cotton t-shirt', 29.99, 15.00),
('SHT002', 'Women Blouse', 6, 'Elegant blouse', 49.99, 25.00),
('BK001', 'SQL Mastery', 7, 'Complete guide to SQL', 39.99, 20.00),
('BK002', 'Web Development', 7, 'Modern web development', 44.99, 22.00),
('GDN001', 'Garden Tools Set', 8, 'Complete gardening toolkit', 89.99, 50.00),
('LAP003', 'Ultrabook', 2, 'Ultra-thin laptop', 1299.99, 1000.00);

-- Insert inventory
INSERT INTO inventory (product_id, quantity_available, quantity_reserved, reorder_level) VALUES
(1, 50, 5, 10),
(2, 75, 0, 15),
(3, 100, 10, 20),
(4, 200, 0, 30),
(5, 500, 20, 50),
(6, 300, 10, 40),
(7, 150, 0, 20),
(8, 100, 5, 15),
(9, 80, 0, 10),
(10, 30, 2, 5);

-- Continue with more sample data...</code></pre>
          </details>
         </div>
        </section>
        <section>
         <h2>Part B: SELECT Query Challenges</h2>
         <div class="alert alert-success">
          <div class="alert-icon">üìù</div>
          <div class="alert-content">
           <div class="alert-title">Task B: Write SELECT Queries</div>
           <div class="alert-message">Complete the following 15 SELECT query challenges. Each query should be optimized and properly formatted.</div>
          </div>
         </div>
         <div class="real_world_example">
          <h3>SELECT Query Tasks</h3>
          <ol class="homework-tasks">
           <li>
            <strong>Find Active Premium Customers</strong>
            <br/>List all customers who have placed more than 5 orders with a total spending over $1000.
                                            Include their name, email, order count, and total spent.</li>
           <li>
            <strong>Low Stock Alert</strong>
            <br/>Find all products where available quantity is below the reorder level.
                                            Show product name, SKU, available quantity, and reorder level.</li>
           <li>
            <strong>Category Sales Report</strong>
            <br/>Calculate total sales for each category in the last 30 days.
                                            Include category name, number of items sold, and total revenue.</li>
           <li>
            <strong>Top Rated Products</strong>
            <br/>Find the top 10 products by average rating (minimum 5 reviews).
                                            Show product name, average rating, and review count.</li>
           <li>
            <strong>Customer Purchase Pattern</strong>
            <br/>For each customer, find their most frequently purchased product category.</li>
           <li>
            <strong>Abandoned Carts</strong>
            <br/>List all cart items that have been in the cart for more than 7 days.
                                            Include user email, product name, and days in cart.</li>
           <li>
            <strong>Product Profitability</strong>
            <br/>Calculate profit margin for each product (price - cost) / price * 100.
                                            Order by profit margin descending.</li>
           <li>
            <strong>Monthly Sales Trend</strong>
            <br/>Show monthly sales totals for the current year.
                                            Include month name, order count, and total revenue.</li>
           <li>
            <strong>Cross-Sell Opportunities</strong>
            <br/>Find products frequently bought together (in the same order).</li>
           <li>
            <strong>User Activity Report</strong>
            <br/>List users who haven't logged in for more than 30 days but have items in cart.</li>
           <li>
            <strong>Review Analysis</strong>
            <br/>Find products with declining ratings (average of last 10 reviews &lt; overall average).</li>
           <li>
            <strong>Coupon Effectiveness</strong>
            <br/>Analyze which coupons are most used and their impact on order value.</li>
           <li>
            <strong>Inventory Turnover</strong>
            <br/>Calculate how many times each product's inventory has been sold completely.</li>
           <li>
            <strong>Customer Lifetime Value</strong>
            <br/>Calculate the total value each customer has brought (orders + potential cart value).</li>
           <li>
            <strong>Product Search</strong>
            <br/>Implement a search that finds products by name or description, ordered by relevance.</li>
          </ol>
         </div>
        </section>
        <section>
         <h2>Part C: Data Manipulation Tasks</h2>
         <div class="alert alert-success">
          <div class="alert-icon">üìù</div>
          <div class="alert-content">
           <div class="alert-title">Task C: INSERT, UPDATE, DELETE Operations</div>
           <div class="alert-message">Complete these data manipulation tasks using proper transactions and safety checks.</div>
          </div>
         </div>
         <div class="best_practice">
          <h3>Data Manipulation Tasks</h3>
          <ol class="homework-tasks">
           <li>
            <strong>Bulk Product Import</strong>
            <br/>Insert 10 new products with inventory in a single transaction.
                                            Ensure SKUs are unique and set appropriate inventory levels.</li>
           <li>
            <strong>Price Adjustment</strong>
            <br/>Apply a 15% discount to all products in the Electronics category.
                                            Log the original prices before updating.</li>
           <li>
            <strong>Order Processing</strong>
            <br/>Move all items from a user's cart to a new order.
                                            Update inventory quantities and clear the cart.</li>
           <li>
            <strong>User Data Update</strong>
            <br/>Update last_login for active users and mark inactive users (no login &gt; 90 days).</li>
           <li>
            <strong>Review Cleanup</strong>
            <br/>Delete spam reviews (those with specific patterns) and update helpful_count.</li>
           <li>
            <strong>Inventory Restock</strong>
            <br/>Implement an UPSERT operation to restock products based on reorder levels.</li>
           <li>
            <strong>Coupon Generation</strong>
            <br/>Generate 20 unique coupon codes with different discount values and validity periods.</li>
           <li>
            <strong>Data Archival</strong>
            <br/>Archive orders older than 2 years to archive tables, then delete from main tables.</li>
           <li>
            <strong>Cart Merge</strong>
            <br/>Merge guest cart items with user cart when user logs in (handle duplicates).</li>
           <li>
            <strong>Cascading Delete</strong>
            <br/>Safely delete a product and handle all related data (reviews, cart items, etc.).</li>
          </ol>
         </div>
        </section>
        <section>
         <h2>Part D: Advanced Query Challenges</h2>
         <div class="alert alert-success">
          <div class="alert-icon">üìù</div>
          <div class="alert-content">
           <div class="alert-title">Task D: Complex Queries with JOINs and Subqueries</div>
           <div class="alert-message">Solve these advanced scenarios using JOINs, subqueries, and aggregate functions.</div>
          </div>
         </div>
         <canvas height="300" id="complexQueryCanvas" width="600">
         </canvas>
         <script>const cCtx = document.getElementById('complexQueryCanvas').getContext('2d');
                                    
                                    // Title
                                    cCtx.font = 'bold 16px Arial';
                                    cCtx.fillStyle = '#1f2937';
                                    cCtx.fillText('Query Complexity Levels', 220, 30);
                                    
                                    // Draw complexity levels
                                    const levels = [
                                        { name: 'Basic JOINs', y: 60, width: 150, color: '#dcfce7' },
                                        { name: 'Multiple JOINs', y: 100, width: 250, color: '#dbeafe' },
                                        { name: 'Subqueries', y: 140, width: 350, color: '#fef3c7' },
                                        { name: 'Correlated Subqueries', y: 180, width: 450, color: '#fee2e2' },
                                        { name: 'Window Functions', y: 220, width: 550, color: '#e9d5ff' }
                                    ];
                                    
                                    levels.forEach(level =>{
                                        cCtx.fillStyle = level.color;
                                        cCtx.fillRect(50, level.y, level.width, 30);
                                        cCtx.strokeStyle = '#6b7280';
                                        cCtx.strokeRect(50, level.y, level.width, 30);
                                        
                                        cCtx.fillStyle = '#1f2937';
                                        cCtx.font = '12px Arial';
                                        cCtx.fillText(level.name, 60, level.y + 20);
                                    });
                                    
                                    // Arrow showing progression
                                    cCtx.strokeStyle = '#6b7280';
                                    cCtx.beginPath();
                                    cCtx.moveTo(30, 75);
                                    cCtx.lineTo(30, 235);
                                    cCtx.stroke();
                                    
                                    cCtx.fillStyle = '#6b7280';
                                    cCtx.font = '10px Arial';
                                    cCtx.save();
                                    cCtx.translate(20, 155);
                                    cCtx.rotate(-Math.PI / 2);
                                    cCtx.fillText('Increasing Complexity', 0, 0);
                                    cCtx.restore();</script>
         <div class="homework">
          <h3>Advanced Query Tasks</h3>
          <ol class="homework-tasks">
           <li>
            <strong>Customer Segmentation</strong>
            <br/>Segment customers into tiers (Gold, Silver, Bronze) based on purchase history and frequency.
                                            Use CASE statements and aggregate functions.</li>
           <li>
            <strong>Product Recommendation Engine</strong>
            <br/>For a given product, find the top 5 related products based on co-purchase patterns.
                                            Use self-joins and subqueries.</li>
           <li>
            <strong>Sales Performance Dashboard</strong>
            <br/>Create a comprehensive query showing daily, weekly, and monthly sales comparisons.
                                            Include year-over-year growth percentages.</li>
           <li>
            <strong>Inventory Forecast</strong>
            <br/>Predict when products will run out of stock based on current sales velocity.
                                            Use date functions and calculations.</li>
           <li>
            <strong>Customer Behavior Analysis</strong>
            <br/>Find customers whose purchase patterns have changed significantly.
                                            Compare first 3 months vs last 3 months of activity.</li>
          </ol>
         </div>
        </section>
        <section>
         <h2>Part E: Performance Optimization</h2>
         <div class="alert alert-warning">
          <div class="alert-icon">‚ö°</div>
          <div class="alert-content">
           <div class="alert-title">Task E: Query Optimization</div>
           <div class="alert-message">Optimize the provided slow queries and explain your optimization strategies.</div>
          </div>
         </div>
         <pre><code class="language-sql">-- Slow Query 1: Fix this performance issue
SELECT DISTINCT 
    u.username,
    COUNT(*) as order_count,
    (SELECT SUM(total_amount) FROM orders WHERE user_id = u.user_id) as total_spent
FROM users u, orders o
WHERE u.user_id = o.user_id
    AND YEAR(o.order_date) = 2024
GROUP BY u.user_id
HAVING total_spent &gt; 500
ORDER BY RAND();

-- Slow Query 2: Optimize this search
SELECT * FROM products 
WHERE UPPER(product_name) LIKE UPPER('%laptop%')
    OR description LIKE '%laptop%'
    OR sku LIKE '%laptop%'
ORDER BY (price * 0.9);

-- Slow Query 3: Improve this reporting query
SELECT 
    p.*,
    (SELECT COUNT(*) FROM order_items WHERE product_id = p.product_id) as times_ordered,
    (SELECT AVG(rating) FROM reviews WHERE product_id = p.product_id) as avg_rating,
    (SELECT quantity_available FROM inventory WHERE product_id = p.product_id) as stock
FROM products p
WHERE p.category_id IN (
    SELECT category_id FROM categories 
    WHERE category_name LIKE '%Electronics%' 
        OR parent_category_id IN (
            SELECT category_id FROM categories WHERE category_name = 'Electronics'
        )
);</code></pre>
        </section>
        <section>
         <h2>Submission Requirements</h2>
         <div class="homework">
          <h3>üì¶ What to Submit</h3>
          <div class="alert alert-info">
           <div class="alert-icon">üìã</div>
           <div class="alert-content">
            <div class="alert-title">Deliverables Checklist</div>
            <div class="alert-message">
             <ol>
              <li>‚úÖ<strong>SQL Script File</strong>(homework_solutions.sql)<ul>
                <li>All CREATE TABLE statements</li>
                <li>Sample data INSERT statements</li>
                <li>All query solutions with comments</li>
                <li>Performance optimization explanations</li>
               </ul>
              </li>
              <li>‚úÖ<strong>Query Results</strong>(results.txt or screenshots)<ul>
                <li>Output from each SELECT query</li>
                <li>Row counts for DML operations</li>
                <li>EXPLAIN output for optimized queries</li>
               </ul>
              </li>
              <li>‚úÖ<strong>Documentation</strong>(README.md)<ul>
                <li>Approach for complex queries</li>
                <li>Optimization strategies used</li>
                <li>Challenges faced and solutions</li>
                <li>Performance improvements achieved</li>
               </ul>
              </li>
              <li>‚úÖ<strong>Bonus Challenge</strong>(optional)<ul>
                <li>Create stored procedures for common operations</li>
                <li>Implement triggers for audit logging</li>
                <li>Design views for reporting</li>
               </ul>
              </li>
             </ol>
            </div>
           </div>
          </div>
          <h3>Grading Rubric</h3>
          <table class="comparison-table">
           <thead>
            <tr>
             <th>Component</th>
             <th>Points</th>
             <th>Criteria</th>
            </tr>
           </thead>
           <tbody>
            <tr>
             <td>Database Setup</td>
             <td>10</td>
             <td>Correct schema, constraints, indexes</td>
            </tr>
            <tr>
             <td>SELECT Queries</td>
             <td>30</td>
             <td>Correct results, efficient queries</td>
            </tr>
            <tr>
             <td>DML Operations</td>
             <td>20</td>
             <td>Safe operations, transactions used</td>
            </tr>
            <tr>
             <td>Advanced Queries</td>
             <td>20</td>
             <td>Complex JOINs, subqueries work</td>
            </tr>
            <tr>
             <td>Optimization</td>
             <td>15</td>
             <td>Improved performance, explanations</td>
            </tr>
            <tr>
             <td>Documentation</td>
             <td>5</td>
             <td>Clear explanations, well-commented</td>
            </tr>
            <tr>
             <td>
              <strong>Total</strong>
             </td>
             <td>
              <strong>100</strong>
             </td>
             <td>
             </td>
            </tr>
           </tbody>
          </table>
         </div>
        </section>
        <section>
         <h2>Solution Guidelines</h2>
         <details>
          <summary>üí° Click for Example Solutions (Part B, Questions 1-3)</summary>
          <pre><code class="language-sql">-- B.1: Find Active Premium Customers
SELECT 
    u.user_id,
    CONCAT(u.first_name, ' ', u.last_name) AS customer_name,
    u.email,
    COUNT(DISTINCT o.order_id) AS order_count,
    SUM(o.total_amount) AS total_spent,
    AVG(o.total_amount) AS avg_order_value
FROM users u
INNER JOIN orders o ON u.user_id = o.user_id
WHERE 
    o.status NOT IN ('cancelled', 'pending')
    AND u.is_active = TRUE
GROUP BY u.user_id
HAVING 
    order_count &gt; 5 
    AND total_spent &gt; 1000
ORDER BY total_spent DESC;

-- B.2: Low Stock Alert
SELECT 
    p.product_id,
    p.sku,
    p.product_name,
    c.category_name,
    i.quantity_available,
    i.quantity_reserved,
    i.reorder_level,
    (i.reorder_level - i.quantity_available) AS units_to_reorder
FROM products p
INNER JOIN inventory i ON p.product_id = i.product_id
LEFT JOIN categories c ON p.category_id = c.category_id
WHERE 
    i.quantity_available &lt; i.reorder_level
    AND p.is_active = TRUE
ORDER BY 
    units_to_reorder DESC,
    p.product_name;

-- B.3: Category Sales Report (Last 30 Days)
SELECT 
    c.category_name,
    COALESCE(pc.category_name, 'Top Level') AS parent_category,
    COUNT(DISTINCT o.order_id) AS order_count,
    SUM(oi.quantity) AS items_sold,
    SUM(oi.quantity * oi.unit_price) AS gross_revenue,
    SUM(oi.discount_amount) AS total_discounts,
    SUM(oi.quantity * oi.unit_price - oi.discount_amount) AS net_revenue
FROM categories c
LEFT JOIN categories pc ON c.parent_category_id = pc.category_id
INNER JOIN products p ON c.category_id = p.category_id
INNER JOIN order_items oi ON p.product_id = oi.product_id
INNER JOIN orders o ON oi.order_id = o.order_id
WHERE 
    o.order_date &gt;= DATE_SUB(NOW(), INTERVAL 30 DAY)
    AND o.status NOT IN ('cancelled', 'pending')
GROUP BY c.category_id
ORDER BY net_revenue DESC;</code></pre>
         </details>
        </section>
        <!-- Resources -->
        <section class="resources">
         <h2>Helpful Resources</h2>
         <ul>
          <li>
           <a href="https://dev.mysql.com/doc/refman/8.0/en/sql-statements.html" target="_blank">MySQL SQL Statement Reference</a>
          </li>
          <li>
           <a href="https://www.mysqltutorial.org/" target="_blank">MySQL Tutorial</a>
          </li>
          <li>
           <a href="https://use-the-index-luke.com/" target="_blank">SQL Performance Explained</a>
          </li>
          <li>
           <a href="https://sqlzoo.net/" target="_blank">SQLZOO Practice</a>
          </li>
          <li>
           <a href="https://www.hackerrank.com/domains/sql" target="_blank">HackerRank SQL Challenges</a>
          </li>
         </ul>
        </section>
       </div>
       <!-- Lesson Navigation -->
       <div class="lesson-navigation">
        <a class="lesson-nav-button prev" href="/03module/order_by_sorting.html">
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z">
          </path>
         </svg>
         <span>
          <small>Previous Lesson</small>
          <br/>ORDER BY Sorting</span>
        </a>
        <button class="complete-lesson-btn">Submit Homework</button>
        <a class="lesson-nav-button next" href="/03module/homework_advanced_sql.html">
         <span>
          <small>Next Assignment</small>
          <br/>Advanced SQL</span>
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z">
          </path>
         </svg>
        </a>
       </div>
      </article>
     </div>
    </div>
   </main>
   <!-- Footer -->
   <footer class="site-footer" role="contentinfo">
    <div class="footer-container">
     <div class="footer-content">
      <div class="footer-section footer-about">
       <h3>PHP WordPress Development</h3>
       <p>Complete Web Development Course</p>
      </div>
      <div class="footer-section">
       <h4>Quick Links</h4>
       <ul class="footer-links">
        <li>
         <a href="/">Home</a>
        </li>
        <li>
         <a class="active" href="/module3.html">Module 3</a>
        </li>
        <li>
         <a href="/resources.html">Resources</a>
        </li>
       </ul>
      </div>
      <div class="footer-section">
       <h4>Support</h4>
       <ul class="footer-links">
        <li>
         <a href="/help.html">Help Center</a>
        </li>
        <li>
         <a href="/faq.html">FAQ</a>
        </li>
        <li>
         <a href="/contact.html">Contact</a>
        </li>
       </ul>
      </div>
     </div>
     <div class="footer-bottom">
      <div class="footer-bottom-content">
       <p class="copyright">¬© 2025 PHP WordPress Development Course</p>
       <nav class="footer-bottom-links">
        <a href="/privacy.html">Privacy</a>
        <span class="separator">|</span>
        <a href="/terms.html">Terms</a>
       </nav>
      </div>
     </div>
    </div>
   </footer>
  </div>
  <!-- Back to Top -->
  <button aria-label="Back to top" class="back-to-top" id="back-to-top">
   <svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24">
    <path d="M12 19V5M12 5l-7 7M12 5l7 7">
    </path>
   </svg>
  </button>
  <!-- JavaScript -->
  <script src="/assets/js/navigation.js">
  </script>
  <script src="/assets/js/site-config.js">
  </script>
  <script src="/assets/js/sidebar-toggle.js">
  </script>
  <!--<!-- Universal Mermaid Fix -->-->
  <script src="/assets/js/mermaid-universal-fix.js">
  </script>
 </body>
</html>
