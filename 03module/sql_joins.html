<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <!-- SEO Meta Tags -->
  <title>SQL JOINs - Master Table Relationships - PHP WordPress Course</title>
  <meta content="Master SQL JOINs - INNER, LEFT, RIGHT, FULL OUTER, CROSS, and SELF joins with visual explanations" name="description"/>
  <meta content="PHP, WordPress, MySQL, SQL JOINs, INNER JOIN, LEFT JOIN, RIGHT JOIN, database relationships" name="keywords"/>
  <meta content="PHP WordPress Course" name="author"/>
  <link href="/assets/css/main.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
  <!-- Favicon -->
  <link href="/favicon.png" rel="icon" type="image/png"/>
  <link href="/favicon.png" rel="apple-touch-icon"/>
  <!-- CSS -->
  <link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
 </head>
 <body>
  <!-- Skip to main content -->
  <a class="sr-only" href="#main-content">Skip to main content</a>
  <div class="page-wrapper">
   <!-- Header -->
   <header class="site-header" role="banner">
    <div class="header-container">
     <div class="site-branding">
      <a class="site-logo" href="/">
       <h1 class="site-title">PHP WordPress Development</h1>
      </a>
     </div>
     <nav aria-label="Main navigation" class="main-navigation" role="navigation">
      <button aria-expanded="false" aria-label="Toggle navigation" class="mobile-menu-btn">
       <span>
       </span>
       <span>
       </span>
       <span>
       </span>
      </button>
      <div class="nav-menu">
       <ul class="nav-list">
        <li class="nav-item">
         <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item dropdown">
         <button aria-haspopup="true" class="nav-link dropdown-toggle active">Modules</button>
         <div class="dropdown-menu">
          <a class="dropdown-item" href="/module1.html">Module 1: Web Fundamentals</a>
          <a class="dropdown-item" href="/module2.html">Module 2: PHP Fundamentals</a>
          <a class="dropdown-item active" href="/module3.html">Module 3: MySQL Database</a>
          <a class="dropdown-item" href="/module4.html">Module 4: WordPress &amp; Docker</a>
          <a class="dropdown-item" href="/module5.html">Module 5: Theme Development</a>
          <a class="dropdown-item" href="/module6.html">Module 6: Plugin Development</a>
          <a class="dropdown-item" href="/module7.html">Module 7: Advanced WordPress</a>
          <a class="dropdown-item" href="/module8.html">Module 8: Deployment</a>
          <a class="dropdown-item" href="/module9.html">Module 9: Final Project</a>
         </div>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/resources.html">Resources</a>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/about.html">About</a>
        </li>
       </ul>
      </div>
     </nav>
     <div class="search-container">
      <div class="search-input-wrapper">
       <svg class="search-icon" fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
        <path clip-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" fill-rule="evenodd">
        </path>
       </svg>
       <input aria-label="Search" class="search-input" placeholder="Search lessons..." type="search"/>
      </div>
      <div class="search-results">
      </div>
     </div>
    </div>
   </header>
   <!-- Progress Bar -->
   <div class="progress-container">
    <div class="progress-header">
     <h2 class="progress-title">Course Progress</h2>
     <span class="progress-text">Loading...</span>
    </div>
    <div class="progress-bar">
     <div class="progress-bar-fill">
      <span class="progress-bar-text">
      </span>
     </div>
    </div>
   </div>
   <!-- Breadcrumb -->
   <nav aria-label="Breadcrumb" class="breadcrumb container">
    <ol class="breadcrumb-list">
     <li class="breadcrumb-item">
      <a href="/">Home</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <a href="/module3.html">Module 3</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <span aria-current="page">SQL JOINs</span>
     </li>
    </ol>
   </nav>
   <!-- Main Content -->
   <main class="main-content" id="main-content" role="main">
    <div class="container">
     <div class="content-with-sidebar">
      <!-- Sidebar -->
      <aside class="sidebar">
    <div class="sidebar-nav">
        <h3 class="sidebar-title">Module 3: MySQL Database</h3>
        <div class="sidebar-section">
            <h4 class="sidebar-section-title">Session 4: Advanced SQL</h4>
            <ul class="sidebar-menu">
                <li class="active"><a class="sidebar-link active" href="/03module/sql_joins.html">Joins (INNER, LEFT, RIGHT, FULL)</a></li>
                <li><a class="sidebar-link" href="/03module/aggregate_functions.html">Aggregating data (COUNT, SUM, AVG, MIN, MAX)</a></li>
                <li><a class="sidebar-link" href="/03module/group_by_having.html">Grouping data with GROUP BY</a></li>
                <li><a class="sidebar-link" href="/03module/having_deep_dive.html">Filtering groups with HAVING</a></li>
                <li><a class="sidebar-link" href="/03module/subqueries.html">Subqueries</a></li>
                <li><a class="sidebar-link" href="/03module/views.html">Views</a></li>
                <li><a class="sidebar-link" href="/03module/transactions.html">Transactions</a></li>
                <li><a class="sidebar-link" href="/03module/stored_procedures.html">Stored procedures and functions</a></li>
                <li><a class="sidebar-link" href="/03module/homework_sql_queries.html">Homework: Write complex SQL queries with joins and aggregations</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <h4 class="sidebar-section-title">Quick Links</h4>
            <ul class="sidebar-menu">
                <li><a class="sidebar-link" href="/module3.html">Module Overview</a></li>
                <li><a class="sidebar-link prev-session" href="/03module/sql_syntax_conventions.html">‚Üê Prev: SQL Fundamentals</a></li>
                <li><a class="sidebar-link next-session" href="/03module/connecting_mysql.html">Next: Session 5 ‚Üí</a></li>
                <li><a class="sidebar-link" href="/">‚Üê Course Home</a></li>
                <li><a class="sidebar-link" href="/module4.html">Next Module ‚Üí</a></li>
                <li><a class="sidebar-link" href="/resources.html">Resources</a></li>
            </ul>
        </div>
    </div>
</aside>
      <!-- Main Lesson Content -->
      <article class="lesson-content">
       <header class="lesson-header">
        <h1>Mastering SQL JOINs</h1>
        <div class="lesson-meta">
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
           </path>
          </svg>
          <span>Duration: 90 minutes</span>
         </div>
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 14l9-5-9-5-9 5 9 5z">
           </path>
          </svg>
          <span>Module 3: Session 4</span>
         </div>
        </div>
       </header>
       <!-- Learning Objectives -->
       <div class="lesson-objectives">
        <h2>Learning Objectives</h2>
        <ul>
         <li>Understand the concept of table relationships</li>
         <li>Master INNER JOIN for matching records</li>
         <li>Use LEFT/RIGHT JOIN for optional relationships</li>
         <li>Implement FULL OUTER JOIN (MySQL workaround)</li>
         <li>Apply CROSS JOIN and SELF JOIN</li>
         <li>Optimize JOIN performance with indexes</li>
         <li>Handle NULL values in JOINs</li>
         <li>Write complex multi-table queries</li>
        </ul>
       </div>
       <!-- Lesson Body -->
       <div class="lesson-body">
        <section>
         <h2>Understanding SQL JOINs</h2>
         <p class="lead">JOINs combine rows from two or more tables based on related columns. They're the heart of relational databases! üîó</p>
         <canvas height="500" id="joinOverviewCanvas" width="600">
         </canvas>
         <script>const ctx = document.getElementById('joinOverviewCanvas').getContext('2d');
                                    
                                    // Title
                                    ctx.font = 'bold 18px Arial';
                                    ctx.fillStyle = '#1f2937';
                                    ctx.fillText('SQL JOIN Types Visualized', 190, 30);
                                    
                                    // Function to draw Venn diagram
                                    function drawVenn(x, y, title, leftFill, rightFill, overlapFill) {
                                        // Title
                                        ctx.fillStyle = '#1f2937';
                                        ctx.font = 'bold 12px Arial';
                                        ctx.fillText(title, x + 35, y - 10);
                                        
                                        // Left circle
                                        ctx.beginPath();
                                        ctx.arc(x + 30, y + 30, 25, 0, Math.PI * 2);
                                        ctx.fillStyle = leftFill;
                                        ctx.fill();
                                        ctx.strokeStyle = '#374151';
                                        ctx.stroke();
                                        
                                        // Right circle
                                        ctx.beginPath();
                                        ctx.arc(x + 60, y + 30, 25, 0, Math.PI * 2);
                                        ctx.fillStyle = rightFill;
                                        ctx.fill();
                                        ctx.strokeStyle = '#374151';
                                        ctx.stroke();
                                        
                                        // Overlap (if different color)
                                        if (overlapFill) {
                                            ctx.save();
                                            ctx.beginPath();
                                            ctx.arc(x + 30, y + 30, 25, 0, Math.PI * 2);
                                            ctx.clip();
                                            ctx.beginPath();
                                            ctx.arc(x + 60, y + 30, 25, 0, Math.PI * 2);
                                            ctx.fillStyle = overlapFill;
                                            ctx.fill();
                                            ctx.restore();
                                        }
                                        
                                        // Labels
                                        ctx.fillStyle = '#fff';
                                        ctx.font = '10px Arial';
                                        ctx.fillText('A', x + 20, y + 32);
                                        ctx.fillText('B', x + 70, y + 32);
                                    }
                                    
                                    // INNER JOIN
                                    drawVenn(50, 80, 'INNER JOIN', '#e5e7eb', '#e5e7eb', '#16a34a');
                                    
                                    // LEFT JOIN
                                    drawVenn(200, 80, 'LEFT JOIN', '#3b82f6', '#e5e7eb', '#3b82f6');
                                    
                                    // RIGHT JOIN
                                    drawVenn(350, 80, 'RIGHT JOIN', '#e5e7eb', '#dc2626', '#dc2626');
                                    
                                    // FULL OUTER JOIN
                                    drawVenn(50, 180, 'FULL OUTER', '#fbbf24', '#fbbf24', '#fbbf24');
                                    
                                    // LEFT EXCLUDING
                                    drawVenn(200, 180, 'LEFT EXCL', '#3b82f6', '#e5e7eb', '#e5e7eb');
                                    ctx.fillStyle = '#fff';
                                    ctx.font = '10px Arial';
                                    ctx.fillText('Only A', 210, 212);
                                    
                                    // RIGHT EXCLUDING
                                    drawVenn(350, 180, 'RIGHT EXCL', '#e5e7eb', '#dc2626', '#e5e7eb');
                                    ctx.fillStyle = '#fff';
                                    ctx.font = '10px Arial';
                                    ctx.fillText('Only B', 410, 212);
                                    
                                    // Example tables
                                    ctx.fillStyle = '#f3f4f6';
                                    ctx.fillRect(50, 280, 500, 200);
                                    ctx.strokeStyle = '#6b7280';
                                    ctx.strokeRect(50, 280, 500, 200);
                                    
                                    ctx.fillStyle = '#1f2937';
                                    ctx.font = 'bold 14px Arial';
                                    ctx.fillText('Sample Tables for Examples', 220, 305);
                                    
                                    // Table A: customers
                                    ctx.fillStyle = '#dbeafe';
                                    ctx.fillRect(70, 320, 200, 140);
                                    ctx.strokeStyle = '#2563eb';
                                    ctx.strokeRect(70, 320, 200, 140);
                                    
                                    ctx.fillStyle = '#1e40af';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('customers', 130, 340);
                                    
                                    ctx.fillStyle = '#374151';
                                    ctx.font = '10px Courier';
                                    ctx.fillText('customer_id | name', 80, 360);
                                    ctx.fillText('-----------+--------', 80, 375);
                                    ctx.fillText('1          | Alice', 80, 390);
                                    ctx.fillText('2          | Bob', 80, 405);
                                    ctx.fillText('3          | Charlie', 80, 420);
                                    ctx.fillText('4          | David', 80, 435);
                                    
                                    // Table B: orders
                                    ctx.fillStyle = '#dcfce7';
                                    ctx.fillRect(330, 320, 200, 140);
                                    ctx.strokeStyle = '#16a34a';
                                    ctx.strokeRect(330, 320, 200, 140);
                                    
                                    ctx.fillStyle = '#166534';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('orders', 405, 340);
                                    
                                    ctx.fillStyle = '#374151';
                                    ctx.font = '10px Courier';
                                    ctx.fillText('order_id | customer_id', 340, 360);
                                    ctx.fillText('---------+------------', 340, 375);
                                    ctx.fillText('101      | 1', 340, 390);
                                    ctx.fillText('102      | 2', 340, 405);
                                    ctx.fillText('103      | 1', 340, 420);
                                    ctx.fillText('104      | 5', 340, 435);</script>
         <div class="alert alert-info">
          <div class="alert-icon">üí°</div>
          <div class="alert-content">
           <div class="alert-title">JOIN Quick Reference</div>
           <div class="alert-message">
            <ul>
             <li>
              <strong>INNER JOIN:</strong>Returns only matching rows from both tables</li>
             <li>
              <strong>LEFT JOIN:</strong>Returns all rows from left table, matching from right</li>
             <li>
              <strong>RIGHT JOIN:</strong>Returns all rows from right table, matching from left</li>
             <li>
              <strong>FULL OUTER JOIN:</strong>Returns all rows from both tables</li>
             <li>
              <strong>CROSS JOIN:</strong>Cartesian product of both tables</li>
            </ul>
           </div>
          </div>
         </div>
        </section>
        <section>
         <h2>INNER JOIN - The Foundation</h2>
         <div class="mermaid">graph LR
                                        A[Table A] --&gt;|matching<br/>records| C[Result]
                                        B[Table B] --&gt;|matching<br/>records| C
                                        
                                        style A fill:#dbeafe
                                        style B fill:#dcfce7
                                        style C fill:#fef3c7</div>
         <div class="real_world_example">
          <h3>INNER JOIN Examples</h3>
          <pre><code class="language-sql">-- ========================================
-- BASIC INNER JOIN
-- ========================================

-- Simple INNER JOIN
SELECT 
    c.customer_id,
    c.customer_name,
    o.order_id,
    o.order_date,
    o.total_amount
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id;

-- Multiple conditions in JOIN
SELECT 
    p.product_name,
    oi.quantity,
    oi.unit_price,
    o.order_date
FROM products p
INNER JOIN order_items oi 
    ON p.product_id = oi.product_id
    AND oi.unit_price &gt; 100  -- Additional condition
INNER JOIN orders o 
    ON oi.order_id = o.order_id;

-- Using USING clause (when column names match)
SELECT 
    c.customer_name,
    o.order_id,
    o.total_amount
FROM customers c
INNER JOIN orders o USING (customer_id);

-- ========================================
-- MULTIPLE TABLE JOINS
-- ========================================

-- Joining 3 tables
SELECT 
    c.customer_name,
    o.order_id,
    p.product_name,
    oi.quantity,
    oi.unit_price
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id
INNER JOIN order_items oi ON o.order_id = oi.order_id
INNER JOIN products p ON oi.product_id = p.product_id
WHERE o.order_date &gt;= '2024-01-01';

-- Complex join with aggregation
SELECT 
    c.customer_id,
    c.customer_name,
    COUNT(DISTINCT o.order_id) AS order_count,
    SUM(oi.quantity * oi.unit_price) AS total_spent,
    AVG(oi.quantity * oi.unit_price) AS avg_order_value
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id
INNER JOIN order_items oi ON o.order_id = oi.order_id
GROUP BY c.customer_id
HAVING total_spent &gt; 1000
ORDER BY total_spent DESC;

-- ========================================
-- INNER JOIN WITH SUBQUERIES
-- ========================================

-- Join with derived table
SELECT 
    c.customer_name,
    c.email,
    customer_stats.total_orders,
    customer_stats.total_spent
FROM customers c
INNER JOIN (
    SELECT 
        customer_id,
        COUNT(*) AS total_orders,
        SUM(total_amount) AS total_spent
    FROM orders
    WHERE status = 'completed'
    GROUP BY customer_id
) AS customer_stats ON c.customer_id = customer_stats.customer_id
WHERE customer_stats.total_orders &gt; 5;

-- ========================================
-- NATURAL JOIN (use with caution!)
-- ========================================

-- Natural join automatically matches columns with same names
SELECT *
FROM customers
NATURAL JOIN orders;  -- Automatically joins on customer_id

-- Equivalent to:
SELECT *
FROM customers c
INNER JOIN orders o USING (customer_id);</code></pre>
         </div>
        </section>
        <section>
         <h2>LEFT JOIN (LEFT OUTER JOIN)</h2>
         <canvas height="350" id="leftJoinCanvas" width="600">
         </canvas>
         <script>const lCtx = document.getElementById('leftJoinCanvas').getContext('2d');
                                    
                                    // Title
                                    lCtx.font = 'bold 16px Arial';
                                    lCtx.fillStyle = '#1f2937';
                                    lCtx.fillText('LEFT JOIN Behavior', 230, 30);
                                    
                                    // Tables representation
                                    // Left table (all records)
                                    lCtx.fillStyle = '#3b82f6';
                                    lCtx.fillRect(50, 60, 150, 180);
                                    lCtx.strokeStyle = '#1e40af';
                                    lCtx.lineWidth = 2;
                                    lCtx.strokeRect(50, 60, 150, 180);
                                    
                                    lCtx.fillStyle = '#fff';
                                    lCtx.font = 'bold 12px Arial';
                                    lCtx.fillText('LEFT Table', 95, 80);
                                    lCtx.fillText('(All Records)', 85, 95);
                                    
                                    lCtx.font = '11px Arial';
                                    lCtx.fillText('ID | Data', 60, 115);
                                    lCtx.fillText('1  | A', 60, 135);
                                    lCtx.fillText('2  | B', 60, 155);
                                    lCtx.fillText('3  | C', 60, 175);
                                    lCtx.fillText('4  | D', 60, 195);
                                    lCtx.fillText('5  | E', 60, 215);
                                    
                                    // Right table (matching + NULL)
                                    lCtx.fillStyle = '#e5e7eb';
                                    lCtx.fillRect(250, 60, 150, 180);
                                    lCtx.strokeStyle = '#6b7280';
                                    lCtx.strokeRect(250, 60, 150, 180);
                                    
                                    lCtx.fillStyle = '#374151';
                                    lCtx.font = 'bold 12px Arial';
                                    lCtx.fillText('RIGHT Table', 285, 80);
                                    lCtx.fillText('(Match or NULL)', 270, 95);
                                    
                                    lCtx.font = '11px Arial';
                                    lCtx.fillText('ID | Data', 260, 115);
                                    lCtx.fillText('1  | X', 260, 135);
                                    lCtx.fillText('2  | Y', 260, 155);
                                    lCtx.fillText('NULL', 260, 175);
                                    lCtx.fillText('4  | Z', 260, 195);
                                    lCtx.fillText('NULL', 260, 215);
                                    
                                    // Result
                                    lCtx.fillStyle = '#fef3c7';
                                    lCtx.fillRect(450, 60, 130, 180);
                                    lCtx.strokeStyle = '#ca8a04';
                                    lCtx.strokeRect(450, 60, 130, 180);
                                    
                                    lCtx.fillStyle = '#92400e';
                                    lCtx.font = 'bold 12px Arial';
                                    lCtx.fillText('Result', 490, 80);
                                    
                                    lCtx.font = '10px Arial';
                                    lCtx.fillText('A | X', 460, 115);
                                    lCtx.fillText('B | Y', 460, 135);
                                    lCtx.fillText('C | NULL', 460, 155);
                                    lCtx.fillText('D | Z', 460, 175);
                                    lCtx.fillText('E | NULL', 460, 195);
                                    
                                    // Arrows
                                    lCtx.strokeStyle = '#6b7280';
                                    lCtx.beginPath();
                                    lCtx.moveTo(200, 150);
                                    lCtx.lineTo(250, 150);
                                    lCtx.stroke();
                                    
                                    lCtx.beginPath();
                                    lCtx.moveTo(400, 150);
                                    lCtx.lineTo(450, 150);
                                    lCtx.stroke();
                                    
                                    // Note
                                    lCtx.fillStyle = '#059669';
                                    lCtx.font = 'bold 11px Arial';
                                    lCtx.fillText('‚úì All left table rows preserved', 50, 270);
                                    lCtx.fillText('‚úì NULL for non-matching right table', 50, 290);
                                    lCtx.fillText('‚úì Perfect for "find all X with optional Y"', 50, 310);</script>
         <div class="best_practice">
          <h3>LEFT JOIN Use Cases</h3>
          <pre><code class="language-sql">-- ========================================
-- LEFT JOIN EXAMPLES
-- ========================================

-- Find all customers with their orders (including those with no orders)
SELECT 
    c.customer_id,
    c.customer_name,
    c.email,
    COUNT(o.order_id) AS order_count,
    COALESCE(SUM(o.total_amount), 0) AS total_spent
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id;

-- Find customers who have NEVER placed an order
SELECT 
    c.customer_id,
    c.customer_name,
    c.registration_date
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
WHERE o.order_id IS NULL;  -- Key pattern for "not exists"

-- Products with optional reviews
SELECT 
    p.product_id,
    p.product_name,
    p.price,
    COUNT(r.review_id) AS review_count,
    COALESCE(AVG(r.rating), 0) AS avg_rating
FROM products p
LEFT JOIN reviews r ON p.product_id = r.product_id
GROUP BY p.product_id
ORDER BY avg_rating DESC;

-- ========================================
-- MULTIPLE LEFT JOINS
-- ========================================

-- Complete customer profile with optional data
SELECT 
    c.customer_id,
    c.customer_name,
    a.street_address,
    a.city,
    ph.phone_number,
    COUNT(DISTINCT o.order_id) AS order_count,
    COUNT(DISTINCT r.review_id) AS review_count
FROM customers c
LEFT JOIN addresses a ON c.customer_id = a.customer_id 
    AND a.is_primary = TRUE
LEFT JOIN phones ph ON c.customer_id = ph.customer_id 
    AND ph.phone_type = 'primary'
LEFT JOIN orders o ON c.customer_id = o.customer_id
LEFT JOIN reviews r ON c.customer_id = r.user_id
GROUP BY c.customer_id;

-- ========================================
-- LEFT JOIN WITH WHERE CONDITIONS
-- ========================================

-- Be careful with WHERE on LEFT JOIN!
-- Wrong: This turns LEFT JOIN into INNER JOIN
SELECT c.*, o.*
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
WHERE o.status = 'completed';  -- Filters out NULLs!

-- Correct: Put condition in ON clause
SELECT c.*, o.*
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
    AND o.status = 'completed';  -- Preserves NULLs

-- Or use WHERE with NULL check
SELECT c.*, o.*
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
WHERE o.status = 'completed' OR o.status IS NULL;

-- ========================================
-- LEFT JOIN FOR GAP ANALYSIS
-- ========================================

-- Find products not in any active order
SELECT 
    p.product_id,
    p.product_name,
    p.stock_quantity
FROM products p
LEFT JOIN (
    SELECT DISTINCT oi.product_id
    FROM order_items oi
    JOIN orders o ON oi.order_id = o.order_id
    WHERE o.status IN ('pending', 'processing')
) AS active_products ON p.product_id = active_products.product_id
WHERE active_products.product_id IS NULL
    AND p.stock_quantity &gt; 0;</code></pre>
         </div>
        </section>
        <section>
         <h2>RIGHT JOIN and FULL OUTER JOIN</h2>
         <div class="alert alert-warning">
          <div class="alert-icon">‚ö†Ô∏è</div>
          <div class="alert-content">
           <div class="alert-title">MySQL FULL OUTER JOIN</div>
           <div class="alert-message">MySQL doesn't support FULL OUTER JOIN directly. Use UNION of LEFT and RIGHT JOINs instead!</div>
          </div>
         </div>
         <pre><code class="language-sql">-- ========================================
-- RIGHT JOIN (Less Common)
-- ========================================

-- RIGHT JOIN example (rarely used, LEFT JOIN preferred)
SELECT 
    o.order_id,
    o.order_date,
    c.customer_name
FROM orders o
RIGHT JOIN customers c ON o.customer_id = c.customer_id;

-- Equivalent LEFT JOIN (more readable)
SELECT 
    o.order_id,
    o.order_date,
    c.customer_name
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id;

-- ========================================
-- FULL OUTER JOIN (MySQL Workaround)
-- ========================================

-- MySQL doesn't support FULL OUTER JOIN, use UNION
-- Find all customers and all orders, even unmatched ones

-- Method 1: UNION of LEFT and RIGHT JOIN
SELECT 
    c.customer_id,
    c.customer_name,
    o.order_id,
    o.order_date
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id

UNION

SELECT 
    c.customer_id,
    c.customer_name,
    o.order_id,
    o.order_date
FROM customers c
RIGHT JOIN orders o ON c.customer_id = o.customer_id;

-- Method 2: UNION ALL with WHERE
(
    SELECT 
        c.customer_id,
        c.customer_name,
        o.order_id,
        o.order_date
    FROM customers c
    LEFT JOIN orders o ON c.customer_id = o.customer_id
)
UNION ALL
(
    SELECT 
        c.customer_id,
        c.customer_name,
        o.order_id,
        o.order_date
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
    WHERE c.customer_id IS NULL  -- Only non-matching orders
);

-- ========================================
-- EXCLUSIVE JOINS (Anti-Joins)
-- ========================================

-- LEFT EXCLUDING JOIN (A - B)
-- Customers with no orders
SELECT c.*
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
WHERE o.order_id IS NULL;

-- RIGHT EXCLUDING JOIN (B - A)
-- Orders with no valid customer (orphaned)
SELECT o.*
FROM customers c
RIGHT JOIN orders o ON c.customer_id = o.customer_id
WHERE c.customer_id IS NULL;

-- FULL OUTER EXCLUDING (A ‚à™ B) - (A ‚à© B)
-- All non-matching records from both tables
(
    SELECT c.customer_id, 'customer_only' AS source
    FROM customers c
    LEFT JOIN orders o ON c.customer_id = o.customer_id
    WHERE o.order_id IS NULL
)
UNION ALL
(
    SELECT o.customer_id, 'order_only' AS source
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
    WHERE c.customer_id IS NULL
);</code></pre>
        </section>
        <section>
         <h2>CROSS JOIN and SELF JOIN</h2>
         <div class="real_world_example">
          <h3>Special Join Types</h3>
          <pre><code class="language-sql">-- ========================================
-- CROSS JOIN (Cartesian Product)
-- ========================================

-- Generate all possible combinations
SELECT 
    s.size,
    c.color,
    CONCAT(c.color, ' - ', s.size) AS variant
FROM sizes s
CROSS JOIN colors c
ORDER BY c.color, s.size;

-- Implicit cross join (older syntax)
SELECT 
    s.size,
    c.color
FROM sizes s, colors c;

-- Generate date range
SELECT 
    DATE_ADD('2024-01-01', INTERVAL n DAY) AS date
FROM (
    SELECT 0 AS n UNION ALL SELECT 1 UNION ALL SELECT 2 
    UNION ALL SELECT 3 UNION ALL SELECT 4 UNION ALL SELECT 5 
    UNION ALL SELECT 6
) numbers
CROSS JOIN (SELECT 0 AS m UNION ALL SELECT 7 UNION ALL SELECT 14) weeks;

-- Generate price matrix
SELECT 
    p.product_name,
    d.discount_percent,
    p.price AS original_price,
    ROUND(p.price * (1 - d.discount_percent/100), 2) AS discounted_price
FROM products p
CROSS JOIN (
    SELECT 10 AS discount_percent
    UNION ALL SELECT 20
    UNION ALL SELECT 30
    UNION ALL SELECT 50
) d
WHERE p.category_id = 1;

-- ========================================
-- SELF JOIN
-- ========================================

-- Employee hierarchy (employees and their managers)
SELECT 
    e1.employee_id,
    e1.employee_name AS employee,
    e2.employee_name AS manager
FROM employees e1
LEFT JOIN employees e2 ON e1.manager_id = e2.employee_id;

-- Find duplicate records
SELECT 
    c1.customer_id AS id1,
    c2.customer_id AS id2,
    c1.email
FROM customers c1
INNER JOIN customers c2 ON c1.email = c2.email
    AND c1.customer_id &lt; c2.customer_id;  -- Avoid duplicate pairs

-- Product comparisons within same category
SELECT 
    p1.product_name AS product_1,
    p1.price AS price_1,
    p2.product_name AS product_2,
    p2.price AS price_2,
    ABS(p1.price - p2.price) AS price_difference
FROM products p1
INNER JOIN products p2 ON p1.category_id = p2.category_id
    AND p1.product_id &lt; p2.product_id
    AND ABS(p1.price - p2.price) &lt; 10  -- Similar price range
ORDER BY price_difference;

-- Find customers in same city
SELECT 
    c1.customer_name AS customer_1,
    c2.customer_name AS customer_2,
    c1.city
FROM customers c1
INNER JOIN customers c2 ON c1.city = c2.city
    AND c1.customer_id &lt; c2.customer_id
ORDER BY c1.city;

-- Category hierarchy (parent-child relationships)
SELECT 
    c1.category_name AS category,
    c2.category_name AS parent_category,
    c3.category_name AS grandparent_category
FROM categories c1
LEFT JOIN categories c2 ON c1.parent_id = c2.category_id
LEFT JOIN categories c3 ON c2.parent_id = c3.category_id;</code></pre>
         </div>
        </section>
        <section>
         <h2>Complex JOIN Patterns</h2>
         <canvas height="300" id="complexJoinCanvas" width="600">
         </canvas>
         <script>const cjCtx = document.getElementById('complexJoinCanvas').getContext('2d');
                                    
                                    // Title
                                    cjCtx.font = 'bold 16px Arial';
                                    cjCtx.fillStyle = '#1f2937';
                                    cjCtx.fillText('Multi-Table JOIN Strategy', 200, 30);
                                    
                                    // Draw tables as nodes
                                    const tables = [
                                        { name: 'customers', x: 100, y: 100, color: '#dbeafe' },
                                        { name: 'orders', x: 300, y: 100, color: '#dcfce7' },
                                        { name: 'order_items', x: 500, y: 100, color: '#fef3c7' },
                                        { name: 'products', x: 500, y: 200, color: '#fee2e2' },
                                        { name: 'categories', x: 300, y: 200, color: '#e9d5ff' },
                                        { name: 'reviews', x: 100, y: 200, color: '#e0f2fe' }
                                    ];
                                    
                                    // Draw connections first
                                    cjCtx.strokeStyle = '#9ca3af';
                                    cjCtx.lineWidth = 2;
                                    cjCtx.setLineDash([5, 5]);
                                    
                                    // customers ->orders
                                    cjCtx.beginPath();
                                    cjCtx.moveTo(150, 100);
                                    cjCtx.lineTo(250, 100);
                                    cjCtx.stroke();
                                    
                                    // orders ->order_items
                                    cjCtx.beginPath();
                                    cjCtx.moveTo(350, 100);
                                    cjCtx.lineTo(450, 100);
                                    cjCtx.stroke();
                                    
                                    // order_items ->products
                                    cjCtx.beginPath();
                                    cjCtx.moveTo(500, 130);
                                    cjCtx.lineTo(500, 170);
                                    cjCtx.stroke();
                                    
                                    // products ->categories
                                    cjCtx.beginPath();
                                    cjCtx.moveTo(450, 200);
                                    cjCtx.lineTo(350, 200);
                                    cjCtx.stroke();
                                    
                                    // customers ->reviews
                                    cjCtx.beginPath();
                                    cjCtx.moveTo(100, 130);
                                    cjCtx.lineTo(100, 170);
                                    cjCtx.stroke();
                                    
                                    cjCtx.setLineDash([]);
                                    
                                    // Draw table nodes
                                    tables.forEach(table =>{
                                        cjCtx.fillStyle = table.color;
                                        cjCtx.fillRect(table.x - 40, table.y - 15, 80, 30);
                                        cjCtx.strokeStyle = '#6b7280';
                                        cjCtx.lineWidth = 1;
                                        cjCtx.strokeRect(table.x - 40, table.y - 15, 80, 30);
                                        
                                        cjCtx.fillStyle = '#1f2937';
                                        cjCtx.font = '11px Arial';
                                        cjCtx.textAlign = 'center';
                                        cjCtx.fillText(table.name, table.x, table.y + 3);
                                    });
                                    
                                    cjCtx.textAlign = 'left';
                                    
                                    // Legend
                                    cjCtx.fillStyle = '#f3f4f6';
                                    cjCtx.fillRect(50, 250, 500, 40);
                                    cjCtx.fillStyle = '#6b7280';
                                    cjCtx.font = '10px Arial';
                                    cjCtx.fillText('Strategy: Start with the main entity, JOIN related tables progressively', 60, 270);
                                    cjCtx.fillText('Use INNER JOIN for required relationships, LEFT JOIN for optional ones', 60, 285);</script>
         <div class="homework">
          <h3>Advanced JOIN Patterns</h3>
          <pre><code class="language-sql">-- ========================================
-- COMPLEX MULTI-TABLE QUERIES
-- ========================================

-- Complete order details with customer and product info
SELECT 
    c.customer_name,
    o.order_id,
    o.order_date,
    p.product_name,
    cat.category_name,
    oi.quantity,
    oi.unit_price,
    (oi.quantity * oi.unit_price) AS line_total
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id
INNER JOIN order_items oi ON o.order_id = oi.order_id
INNER JOIN products p ON oi.product_id = p.product_id
LEFT JOIN categories cat ON p.category_id = cat.category_id
WHERE o.order_date &gt;= DATE_SUB(NOW(), INTERVAL 30 DAY)
ORDER BY o.order_date DESC, o.order_id, oi.order_item_id;

-- Customer 360 view
SELECT 
    c.customer_id,
    c.customer_name,
    c.email,
    COALESCE(order_summary.total_orders, 0) AS total_orders,
    COALESCE(order_summary.total_spent, 0) AS total_spent,
    COALESCE(order_summary.last_order_date, 'Never') AS last_order_date,
    COALESCE(review_summary.total_reviews, 0) AS reviews_written,
    COALESCE(review_summary.avg_rating_given, 0) AS avg_rating_given,
    COALESCE(cart_items.items_in_cart, 0) AS current_cart_items
FROM customers c
LEFT JOIN (
    SELECT 
        customer_id,
        COUNT(*) AS total_orders,
        SUM(total_amount) AS total_spent,
        MAX(order_date) AS last_order_date
    FROM orders
    WHERE status NOT IN ('cancelled')
    GROUP BY customer_id
) order_summary ON c.customer_id = order_summary.customer_id
LEFT JOIN (
    SELECT 
        user_id,
        COUNT(*) AS total_reviews,
        AVG(rating) AS avg_rating_given
    FROM reviews
    GROUP BY user_id
) review_summary ON c.customer_id = review_summary.user_id
LEFT JOIN (
    SELECT 
        user_id,
        COUNT(*) AS items_in_cart
    FROM cart
    GROUP BY user_id
) cart_items ON c.customer_id = cart_items.user_id
ORDER BY total_spent DESC;

-- ========================================
-- JOIN PERFORMANCE OPTIMIZATION
-- ========================================

-- Optimize with proper index usage
EXPLAIN SELECT 
    c.customer_name,
    COUNT(o.order_id) AS order_count
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id;

-- Use straight_join to force join order
SELECT STRAIGHT_JOIN
    c.customer_name,
    o.order_id,
    oi.quantity
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id
INNER JOIN order_items oi ON o.order_id = oi.order_id
WHERE c.customer_id = 123;

-- Avoid SELECT * in joins
-- Bad:
SELECT * FROM customers c 
LEFT JOIN orders o ON c.customer_id = o.customer_id;

-- Good:
SELECT 
    c.customer_id,
    c.customer_name,
    o.order_id,
    o.order_date
FROM customers c 
LEFT JOIN orders o ON c.customer_id = o.customer_id;</code></pre>
         </div>
        </section>
        <!-- Practice Exercise -->
        <section>
         <h2>Practice Exercise</h2>
         <div class="alert alert-success">
          <div class="alert-icon">üíª</div>
          <div class="alert-content">
           <div class="alert-title">JOIN Challenges</div>
           <div class="alert-message">Write queries using appropriate JOINs for these scenarios:<ol>
             <li>List all products with their category names (handle products without category)</li>
             <li>Find customers who have never written a review</li>
             <li>Show all employees with their manager names (self-join)</li>
             <li>Create a sales report showing all dates in a month, even those with no sales</li>
             <li>Find products that have never been ordered</li>
             <li>List all possible product-coupon combinations</li>
             <li>Find customers who have ordered every product in a category</li>
             <li>Create a full comparison of this month vs last month sales</li>
            </ol>
           </div>
          </div>
         </div>
         <details>
          <summary>üí° Click for Solutions</summary>
          <pre><code class="language-sql">-- 1. Products with optional categories
SELECT 
    p.product_id,
    p.product_name,
    p.price,
    COALESCE(c.category_name, 'Uncategorized') AS category
FROM products p
LEFT JOIN categories c ON p.category_id = c.category_id
ORDER BY c.category_name, p.product_name;

-- 2. Customers who never wrote reviews
SELECT 
    c.customer_id,
    c.customer_name,
    c.email,
    c.registration_date
FROM customers c
LEFT JOIN reviews r ON c.customer_id = r.user_id
WHERE r.review_id IS NULL
ORDER BY c.registration_date;

-- 3. Employee hierarchy (self-join)
SELECT 
    e.employee_id,
    e.employee_name,
    e.title,
    COALESCE(m.employee_name, 'No Manager') AS manager_name,
    m.title AS manager_title
FROM employees e
LEFT JOIN employees m ON e.manager_id = m.employee_id
ORDER BY m.employee_id, e.employee_id;

-- 4. All dates with sales data (using date table or generation)
WITH RECURSIVE date_range AS (
    SELECT DATE('2024-01-01') AS date
    UNION ALL
    SELECT DATE_ADD(date, INTERVAL 1 DAY)
    FROM date_range
    WHERE date &lt; DATE('2024-01-31')
)
SELECT 
    dr.date,
    COUNT(o.order_id) AS orders_count,
    COALESCE(SUM(o.total_amount), 0) AS daily_sales
FROM date_range dr
LEFT JOIN orders o ON DATE(o.order_date) = dr.date
GROUP BY dr.date
ORDER BY dr.date;

-- 5. Products never ordered
SELECT 
    p.product_id,
    p.product_name,
    p.price,
    p.stock_quantity
FROM products p
LEFT JOIN order_items oi ON p.product_id = oi.product_id
WHERE oi.order_item_id IS NULL
    AND p.is_active = TRUE
ORDER BY p.product_name;

-- 6. All product-coupon combinations
SELECT 
    p.product_id,
    p.product_name,
    p.price,
    c.coupon_code,
    c.discount_type,
    c.discount_value,
    CASE 
        WHEN c.discount_type = 'percentage' 
        THEN p.price * (1 - c.discount_value/100)
        ELSE p.price - c.discount_value
    END AS price_after_coupon
FROM products p
CROSS JOIN coupons c
WHERE c.is_active = TRUE
    AND c.valid_from &lt;= CURDATE()
    AND c.valid_until &gt;= CURDATE()
ORDER BY p.product_id, c.discount_value DESC;

-- 7. Customers who ordered every product in a category
SELECT c.customer_id, c.customer_name
FROM customers c
WHERE NOT EXISTS (
    SELECT p.product_id
    FROM products p
    WHERE p.category_id = 1  -- Electronics category
    AND NOT EXISTS (
        SELECT 1
        FROM orders o
        JOIN order_items oi ON o.order_id = oi.order_id
        WHERE o.customer_id = c.customer_id
        AND oi.product_id = p.product_id
    )
);

-- 8. This month vs last month comparison
WITH this_month AS (
    SELECT 
        DATE(order_date) AS date,
        COUNT(*) AS orders,
        SUM(total_amount) AS sales
    FROM orders
    WHERE MONTH(order_date) = MONTH(CURDATE())
        AND YEAR(order_date) = YEAR(CURDATE())
    GROUP BY DATE(order_date)
),
last_month AS (
    SELECT 
        DATE_ADD(DATE(order_date), INTERVAL 1 MONTH) AS date,
        COUNT(*) AS orders,
        SUM(total_amount) AS sales
    FROM orders
    WHERE MONTH(order_date) = MONTH(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))
        AND YEAR(order_date) = YEAR(DATE_SUB(CURDATE(), INTERVAL 1 MONTH))
    GROUP BY DATE(order_date)
)
SELECT 
    COALESCE(t.date, l.date) AS date,
    COALESCE(t.orders, 0) AS this_month_orders,
    COALESCE(l.orders, 0) AS last_month_orders,
    COALESCE(t.sales, 0) AS this_month_sales,
    COALESCE(l.sales, 0) AS last_month_sales,
    COALESCE(t.sales, 0) - COALESCE(l.sales, 0) AS difference
FROM this_month t
FULL OUTER JOIN last_month l ON t.date = l.date
ORDER BY date;</code></pre>
         </details>
        </section>
        <!-- Resources -->
        <section class="resources">
         <h2>Additional Resources</h2>
         <ul>
          <li>
           <a href="https://dev.mysql.com/doc/refman/8.0/en/join.html" target="_blank">MySQL JOIN Documentation</a>
          </li>
          <li>
           <a href="https://www.mysqltutorial.org/mysql-join/" target="_blank">MySQL JOIN Tutorial</a>
          </li>
          <li>
           <a href="https://www.sqlshack.com/sql-outer-join-overview-and-examples/" target="_blank">SQL OUTER JOIN Guide</a>
          </li>
          <li>
           <a href="https://use-the-index-luke.com/sql/join" target="_blank">SQL JOIN Performance</a>
          </li>
          <li>
           <a href="https://blog.codinghorror.com/a-visual-explanation-of-sql-joins/" target="_blank">Visual SQL JOINs</a>
          </li>
         </ul>
        </section>
       </div>
       <!-- Lesson Navigation -->
       <div class="lesson-navigation">
        <a class="lesson-nav-button prev" href="/03module/homework_sql_queries.html">
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z">
          </path>
         </svg>
         <span>
          <small>Previous</small>
          <br/>SQL Homework</span>
        </a>
        <button class="complete-lesson-btn">Mark as Complete</button>
        <a class="lesson-nav-button next" href="/03module/aggregate_functions.html">
         <span>
          <small>Next</small>
          <br/>Aggregate Functions</span>
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z">
          </path>
         </svg>
        </a>
       </div>
      </article>
     </div>
    </div>
   </main>
   <!-- Footer -->
   <footer class="site-footer" role="contentinfo">
    <div class="footer-container">
     <div class="footer-content">
      <div class="footer-section footer-about">
       <h3>PHP WordPress Development</h3>
       <p>Complete Web Development Course</p>
      </div>
      <div class="footer-section">
       <h4>Quick Links</h4>
       <ul class="footer-links">
        <li>
         <a href="/">Home</a>
        </li>
        <li>
         <a class="active" href="/module3.html">Module 3</a>
        </li>
        <li>
         <a href="/resources.html">Resources</a>
        </li>
       </ul>
      </div>
      <div class="footer-section">
       <h4>Support</h4>
       <ul class="footer-links">
        <li>
         <a href="/help.html">Help Center</a>
        </li>
        <li>
         <a href="/faq.html">FAQ</a>
        </li>
        <li>
         <a href="/contact.html">Contact</a>
        </li>
       </ul>
      </div>
     </div>
     <div class="footer-bottom">
      <div class="footer-bottom-content">
       <p class="copyright">¬© 2025 PHP WordPress Development Course</p>
       <nav class="footer-bottom-links">
        <a href="/privacy.html">Privacy</a>
        <span class="separator">|</span>
        <a href="/terms.html">Terms</a>
       </nav>
      </div>
     </div>
    </div>
   </footer>
  </div>
  <!-- Back to Top -->
  <button aria-label="Back to top" class="back-to-top" id="back-to-top">
   <svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24">
    <path d="M12 19V5M12 5l-7 7M12 5l7 7">
    </path>
   </svg>
  </button>
  <!-- JavaScript -->
  <script src="/assets/js/navigation.js">
  </script>
  <script src="/assets/js/site-config.js">
  </script>
  <script src="/assets/js/sidebar-toggle.js">
  </script>
  <!-- Universal Mermaid Fix (Enhanced) -->
  <!-- Universal Mermaid Fix -->
  <script src="/assets/js/mermaid-universal-fix.js">
  </script>
 </body>
</html>
