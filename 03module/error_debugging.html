<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
    <!-- SEO Meta Tags -->
    <title>Error Handling and Debugging - PHP MySQL Development - PHP WordPress Course</title>
    <meta name="description" content="Master error handling, debugging techniques, logging strategies, and troubleshooting PHP MySQL applications">
    <meta name="keywords" content="PHP, MySQL, error handling, debugging, exceptions, logging, troubleshooting">
    <meta name="author" content="PHP WordPress Course">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Mermaid for diagrams -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <!-- Skip to main content -->
    <a href="#main-content" class="sr-only">Skip to main content</a>
    
    <div class="page-wrapper">
        <!-- Header -->
        <header class="site-header" role="banner">
            <div class="header-container">
                <div class="site-branding">
                    <a href="/" class="site-logo">
                        <h1 class="site-title">PHP WordPress Development</h1>
                    </a>
                </div>
                
                <nav class="main-navigation" role="navigation" aria-label="Main navigation">
                    <button class="mobile-menu-btn" aria-label="Toggle navigation" aria-expanded="false">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    
                    <div class="nav-menu">
                        <ul class="nav-list">
                            <li class="nav-item"><a href="/" class="nav-link">Home</a></li>
                            <li class="nav-item dropdown">
                                <button class="nav-link dropdown-toggle active" aria-haspopup="true">Modules</button>
                                <div class="dropdown-menu">
                                    <a href="/module1.html" class="dropdown-item">Module 1: Web Fundamentals</a>
                                    <a href="/module2.html" class="dropdown-item">Module 2: PHP Fundamentals</a>
                                    <a href="/module3.html" class="dropdown-item active">Module 3: MySQL Database</a>
                                    <a href="/module4.html" class="dropdown-item">Module 4: WordPress & Docker</a>
                                    <a href="/module5.html" class="dropdown-item">Module 5: Theme Development</a>
                                    <a href="/module6.html" class="dropdown-item">Module 6: Plugin Development</a>
                                    <a href="/module7.html" class="dropdown-item">Module 7: Advanced WordPress</a>
                                    <a href="/module8.html" class="dropdown-item">Module 8: Deployment</a>
                                    <a href="/module9.html" class="dropdown-item">Module 9: Final Project</a>
                                </div>
                            </li>
                            <li class="nav-item"><a href="/resources.html" class="nav-link">Resources</a></li>
                            <li class="nav-item"><a href="/about.html" class="nav-link">About</a></li>
                        </ul>
                    </div>
                </nav>
                
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                        </svg>
                        <input type="search" class="search-input" placeholder="Search lessons..." aria-label="Search">
                    </div>
                    <div class="search-results"></div>
                </div>
            </div>
        </header>
        
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-header">
                <h2 class="progress-title">Course Progress</h2>
                <span class="progress-text">Loading...</span>
            </div>
            <div class="progress-bar">
                <div class="progress-bar-fill">
                    <span class="progress-bar-text"></span>
                </div>
            </div>
        </div>
        
        <!-- Breadcrumb -->
        <nav class="breadcrumb container" aria-label="Breadcrumb">
            <ol class="breadcrumb-list">
                <li class="breadcrumb-item">
                    <a href="/">Home</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <a href="/module3.html">Module 3</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <span aria-current="page">Error Handling</span>
                </li>
            </ol>
        </nav>
        
        <!-- Main Content -->
        <main id="main-content" class="main-content" role="main">
            <div class="container">
                <div class="content-with-sidebar">
                    <!-- Sidebar -->
                    <aside class="sidebar">
                        <div class="sidebar-nav">
                            <h3 class="sidebar-title">Module 3: Session 5</h3>
                            <div class="sidebar-section">
                                <h4 class="sidebar-section-title">PHP MySQL Integration</h4>
                                <a href="/module3.html" class="sidebar-link">Module Overview</a>
                                <a href="/03module/crud_operations.html" class="sidebar-link">CRUD Operations</a>
                                <a href="/03module/result_sets.html" class="sidebar-link">Result Sets</a>
                                <a href="/03module/error_debugging.html" class="sidebar-link active">Error Handling</a>
                                <a href="/03module/final_project.html" class="sidebar-link">Final Project</a>
                            </div>
                        </div>
                    </aside>
                    
                    <!-- Main Lesson Content -->
                    <article class="lesson-content">
                        <header class="lesson-header">
                            <h1>Error Handling and Debugging</h1>
                            <div class="lesson-meta">
                                <div class="lesson-meta-item">
                                    <svg width="20" height="20" fill="currentColor">
                                        <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <span>Duration: 85 minutes</span>
                                </div>
                                <div class="lesson-meta-item">
                                    <svg width="20" height="20" fill="currentColor">
                                        <path d="M12 14l9-5-9-5-9 5 9 5z"/>
                                    </svg>
                                    <span>Module 3: Debugging</span>
                                </div>
                            </div>
                        </header>

                        <!-- Learning Objectives -->
                        <div class="lesson-objectives">
                            <h2>Learning Objectives</h2>
                            <ul>
                                <li>Implement comprehensive error handling strategies</li>
                                <li>Master exception handling in PHP</li>
                                <li>Set up effective logging systems</li>
                                <li>Use debugging tools and techniques</li>
                                <li>Handle database-specific errors</li>
                                <li>Create custom error handlers</li>
                                <li>Implement error monitoring and alerting</li>
                                <li>Debug performance issues</li>
                            </ul>
                        </div>
                        
                        <!-- Lesson Body -->
                        <div class="lesson-body">
                            <section>
                                <h2>Error Handling Strategy</h2>
                                <p class="lead">Robust error handling is crucial for maintaining stable applications and providing good user experience. Let's build a comprehensive system! üõ°Ô∏è</p>
                                
                                <canvas id="errorCanvas" width="600" height="450"></canvas>
                                <script>
                                    const ctx = document.getElementById('errorCanvas').getContext('2d');
                                    
                                    // Title
                                    ctx.font = 'bold 18px Arial';
                                    ctx.fillStyle = '#1f2937';
                                    ctx.fillText('Error Handling Architecture', 180, 30);
                                    
                                    // Error types
                                    const errorTypes = [
                                        { type: 'Syntax Errors', desc: 'Parse errors', color: '#fee2e2', border: '#dc2626', x: 50, y: 60 },
                                        { type: 'Runtime Errors', desc: 'Fatal/Warning', color: '#fef3c7', border: '#ca8a04', x: 220, y: 60 },
                                        { type: 'Logic Errors', desc: 'Bugs', color: '#dbeafe', border: '#2563eb', x: 390, y: 60 }
                                    ];
                                    
                                    errorTypes.forEach(error => {
                                        ctx.fillStyle = error.color;
                                        ctx.fillRect(error.x, error.y, 160, 80);
                                        ctx.strokeStyle = error.border;
                                        ctx.lineWidth = 2;
                                        ctx.strokeRect(error.x, error.y, 160, 80);
                                        
                                        ctx.fillStyle = error.border;
                                        ctx.font = 'bold 12px Arial';
                                        ctx.fillText(error.type, error.x + 35, error.y + 35);
                                        
                                        ctx.fillStyle = '#6b7280';
                                        ctx.font = '10px Arial';
                                        ctx.fillText(error.desc, error.x + 50, error.y + 55);
                                    });
                                    
                                    // Handling layers
                                    ctx.fillStyle = '#e9d5ff';
                                    ctx.fillRect(50, 160, 520, 60);
                                    ctx.strokeStyle = '#7c3aed';
                                    ctx.strokeRect(50, 160, 520, 60);
                                    
                                    ctx.fillStyle = '#7c3aed';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('Error Handling Layer', 250, 180);
                                    
                                    ctx.font = '10px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('try-catch | set_error_handler | set_exception_handler | register_shutdown_function', 100, 200);
                                    
                                    // Logging layer
                                    ctx.fillStyle = '#dcfce7';
                                    ctx.fillRect(50, 240, 520, 60);
                                    ctx.strokeStyle = '#16a34a';
                                    ctx.strokeRect(50, 240, 520, 60);
                                    
                                    ctx.fillStyle = '#166534';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('Logging & Monitoring', 245, 260);
                                    
                                    ctx.font = '10px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('error_log | Monolog | Sentry | New Relic | Custom Logging', 150, 280);
                                    
                                    // User feedback
                                    ctx.fillStyle = '#e0f2fe';
                                    ctx.fillRect(50, 320, 520, 60);
                                    ctx.strokeStyle = '#0891b2';
                                    ctx.strokeRect(50, 320, 520, 60);
                                    
                                    ctx.fillStyle = '#0c4a6e';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('User Feedback', 260, 340);
                                    
                                    ctx.font = '10px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('Friendly error pages | Toast notifications | Form validation | Recovery options', 120, 360);
                                    
                                    // Arrows
                                    ctx.strokeStyle = '#6b7280';
                                    ctx.setLineDash([5, 5]);
                                    for (let i = 0; i < 3; i++) {
                                        ctx.beginPath();
                                        ctx.moveTo(130 + (i * 170), 140);
                                        ctx.lineTo(130 + (i * 170), 160);
                                        ctx.stroke();
                                    }
                                    ctx.setLineDash([]);
                                </script>
                                
                                <div class="alert alert-info">
                                    <div class="alert-icon">üí°</div>
                                    <div class="alert-content">
                                        <div class="alert-title">Error Handling Best Practices</div>
                                        <div class="alert-message">
                                            <ul>
                                                <li>Never display raw error messages to end users</li>
                                                <li>Log all errors for debugging and monitoring</li>
                                                <li>Use appropriate error levels (E_ERROR, E_WARNING, etc.)</li>
                                                <li>Implement graceful degradation</li>
                                                <li>Provide helpful error messages and recovery options</li>
                                                <li>Monitor errors in production environments</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <h2>Comprehensive Error Handling System</h2>
                                
                                <div class="mermaid">
                                    graph TB
                                        ERROR[Error Occurs] --> CATCH[Error Handler]
                                        
                                        CATCH --> TYPE{Error Type}
                                        TYPE --> |Database| DB[Database Handler]
                                        TYPE --> |Validation| VAL[Validation Handler]
                                        TYPE --> |System| SYS[System Handler]
                                        
                                        DB --> LOG[Log Error]
                                        VAL --> LOG
                                        SYS --> LOG
                                        
                                        LOG --> NOTIFY{Severity}
                                        NOTIFY --> |Critical| ALERT[Send Alert]
                                        NOTIFY --> |Warning| MONITOR[Monitor]
                                        
                                        LOG --> USER[User Message]
                                        
                                        style ERROR fill:#fee2e2
                                        style CATCH fill:#dbeafe
                                        style LOG fill:#dcfce7
                                        style ALERT fill:#fef3c7
                                </div>
                                
                                <div class="real_world_example">
                                    <h3>Complete Error Handling Implementation</h3>
                                    
                                    <pre><code class="language-php">&lt;?php
// ========================================
// ERROR HANDLER CLASS
// ========================================

class ErrorHandler {
    private static $instance = null;
    private $logger;
    private $isDevelopment;
    private $errorLevels = [
        E_ERROR => 'Fatal Error',
        E_WARNING => 'Warning',
        E_PARSE => 'Parse Error',
        E_NOTICE => 'Notice',
        E_CORE_ERROR => 'Core Error',
        E_CORE_WARNING => 'Core Warning',
        E_COMPILE_ERROR => 'Compile Error',
        E_COMPILE_WARNING => 'Compile Warning',
        E_USER_ERROR => 'User Error',
        E_USER_WARNING => 'User Warning',
        E_USER_NOTICE => 'User Notice',
        E_STRICT => 'Strict Notice',
        E_RECOVERABLE_ERROR => 'Recoverable Error',
        E_DEPRECATED => 'Deprecated',
        E_USER_DEPRECATED => 'User Deprecated'
    ];
    
    private function __construct() {
        $this->isDevelopment = $_ENV['APP_ENV'] === 'development';
        $this->logger = new Logger();
        $this->registerHandlers();
    }
    
    public static function getInstance() {
        if (self::$instance === null) {
            self::$instance = new self();
        }
        return self::$instance;
    }
    
    /**
     * Register all error handlers
     */
    private function registerHandlers() {
        // Error handler
        set_error_handler([$this, 'handleError']);
        
        // Exception handler
        set_exception_handler([$this, 'handleException']);
        
        // Fatal error handler
        register_shutdown_function([$this, 'handleShutdown']);
        
        // Set error reporting level
        if ($this->isDevelopment) {
            error_reporting(E_ALL);
            ini_set('display_errors', 1);
        } else {
            error_reporting(E_ALL & ~E_NOTICE & ~E_DEPRECATED);
            ini_set('display_errors', 0);
        }
        
        ini_set('log_errors', 1);
        ini_set('error_log', __DIR__ . '/logs/php-error.log');
    }
    
    /**
     * Handle PHP errors
     */
    public function handleError($errno, $errstr, $errfile, $errline) {
        // Check if error reporting is disabled
        if (!(error_reporting() & $errno)) {
            return false;
        }
        
        $errorType = $this->errorLevels[$errno] ?? 'Unknown Error';
        
        // Create error context
        $error = [
            'type' => $errorType,
            'message' => $errstr,
            'file' => $errfile,
            'line' => $errline,
            'trace' => debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS),
            'time' => date('Y-m-d H:i:s'),
            'request' => [
                'method' => $_SERVER['REQUEST_METHOD'] ?? 'CLI',
                'uri' => $_SERVER['REQUEST_URI'] ?? 'CLI',
                'ip' => $_SERVER['REMOTE_ADDR'] ?? 'localhost'
            ]
        ];
        
        // Log error
        $this->logError($error, $errno);
        
        // Display error in development
        if ($this->isDevelopment) {
            $this->displayError($error);
        }
        
        // Don't execute PHP internal error handler
        return true;
    }
    
    /**
     * Handle uncaught exceptions
     */
    public function handleException($exception) {
        $error = [
            'type' => 'Exception',
            'class' => get_class($exception),
            'message' => $exception->getMessage(),
            'file' => $exception->getFile(),
            'line' => $exception->getLine(),
            'trace' => $exception->getTrace(),
            'time' => date('Y-m-d H:i:s'),
            'request' => [
                'method' => $_SERVER['REQUEST_METHOD'] ?? 'CLI',
                'uri' => $_SERVER['REQUEST_URI'] ?? 'CLI',
                'ip' => $_SERVER['REMOTE_ADDR'] ?? 'localhost'
            ]
        ];
        
        // Log exception
        $this->logger->critical('Uncaught Exception', $error);
        
        // Display error page
        $this->displayErrorPage($exception);
    }
    
    /**
     * Handle fatal errors
     */
    public function handleShutdown() {
        $error = error_get_last();
        
        if ($error !== null && in_array($error['type'], [E_ERROR, E_CORE_ERROR, E_COMPILE_ERROR, E_PARSE])) {
            $this->handleError($error['type'], $error['message'], $error['file'], $error['line']);
            
            // Send alert for fatal errors
            $this->sendAlert('Fatal Error', $error);
        }
    }
    
    /**
     * Log error based on severity
     */
    private function logError($error, $errno) {
        switch ($errno) {
            case E_ERROR:
            case E_CORE_ERROR:
            case E_COMPILE_ERROR:
            case E_PARSE:
                $this->logger->critical($error['message'], $error);
                $this->sendAlert('Critical Error', $error);
                break;
                
            case E_WARNING:
            case E_CORE_WARNING:
            case E_COMPILE_WARNING:
            case E_USER_WARNING:
                $this->logger->warning($error['message'], $error);
                break;
                
            case E_NOTICE:
            case E_USER_NOTICE:
                $this->logger->notice($error['message'], $error);
                break;
                
            default:
                $this->logger->info($error['message'], $error);
        }
    }
    
    /**
     * Display error in development
     */
    private function displayError($error) {
        echo "&lt;div style='border:2px solid #ff0000; padding:10px; margin:10px;'&gt;";
        echo "&lt;h3&gt;{$error['type']}: {$error['message']}&lt;/h3&gt;";
        echo "&lt;p&gt;File: {$error['file']} on line {$error['line']}&lt;/p&gt;";
        
        if (!empty($error['trace'])) {
            echo "&lt;h4&gt;Stack Trace:&lt;/h4&gt;&lt;pre&gt;";
            foreach ($error['trace'] as $i => $trace) {
                echo "#{$i} ";
                echo isset($trace['file']) ? $trace['file'] : '[internal]';
                echo isset($trace['line']) ? "({$trace['line']})" : '';
                echo isset($trace['function']) ? ": {$trace['function']}()" : '';
                echo "\n";
            }
            echo "&lt;/pre&gt;";
        }
        echo "&lt;/div&gt;";
    }
    
    /**
     * Display user-friendly error page
     */
    private function displayErrorPage($exception = null) {
        // Clear any existing output
        if (ob_get_length()) {
            ob_clean();
        }
        
        // Set appropriate HTTP status code
        http_response_code(500);
        
        // Load error template
        if ($this->isDevelopment && $exception) {
            include __DIR__ . '/templates/error-dev.php';
        } else {
            include __DIR__ . '/templates/error-500.php';
        }
        
        exit;
    }
    
    /**
     * Send alert for critical errors
     */
    private function sendAlert($subject, $error) {
        // Email alert
        if (defined('ALERT_EMAIL')) {
            $message = "Error Details:\n" . print_r($error, true);
            mail(ALERT_EMAIL, $subject, $message);
        }
        
        // Slack notification
        if (defined('SLACK_WEBHOOK')) {
            $this->sendSlackNotification($subject, $error);
        }
    }
    
    /**
     * Send Slack notification
     */
    private function sendSlackNotification($subject, $error) {
        $payload = [
            'text' => $subject,
            'attachments' => [[
                'color' => 'danger',
                'fields' => [
                    ['title' => 'Error', 'value' => $error['message'], 'short' => false],
                    ['title' => 'File', 'value' => $error['file'], 'short' => true],
                    ['title' => 'Line', 'value' => $error['line'], 'short' => true],
                    ['title' => 'Time', 'value' => $error['time'], 'short' => true],
                    ['title' => 'URL', 'value' => $error['request']['uri'] ?? 'N/A', 'short' => true]
                ]
            ]]
        ];
        
        $ch = curl_init(SLACK_WEBHOOK);
        curl_setopt($ch, CURLOPT_POST, 1);
        curl_setopt($ch, CURLOPT_POSTFIELDS, json_encode($payload));
        curl_setopt($ch, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_exec($ch);
        curl_close($ch);
    }
}

// ========================================
// DATABASE ERROR HANDLER
// ========================================

class DatabaseErrorHandler {
    
    /**
     * Handle database connection errors
     */
    public static function handleConnectionError(PDOException $e) {
        $error = [
            'type' => 'Database Connection Error',
            'message' => self::sanitizeMessage($e->getMessage()),
            'code' => $e->getCode(),
            'time' => date('Y-m-d H:i:s')
        ];
        
        // Log error
        error_log(json_encode($error));
        
        // User-friendly message
        if ($_ENV['APP_ENV'] === 'production') {
            throw new Exception('Unable to connect to the database. Please try again later.');
        } else {
            throw $e;
        }
    }
    
    /**
     * Handle query errors
     */
    public static function handleQueryError(PDOException $e, $query = null) {
        $error = [
            'type' => 'Database Query Error',
            'message' => self::sanitizeMessage($e->getMessage()),
            'code' => $e->getCode(),
            'query' => $query,
            'time' => date('Y-m-d H:i:s')
        ];
        
        // Log error
        error_log(json_encode($error));
        
        // Check for specific error types
        if (strpos($e->getMessage(), 'Duplicate entry') !== false) {
            throw new ValidationException('This record already exists.');
        } elseif (strpos($e->getMessage(), 'foreign key constraint') !== false) {
            throw new ValidationException('This record cannot be deleted as it is referenced by other data.');
        } else {
            throw new Exception('A database error occurred. Please try again.');
        }
    }
    
    /**
     * Sanitize error messages
     */
    private static function sanitizeMessage($message) {
        // Remove sensitive information
        $message = preg_replace('/password=[\S]+/', 'password=***', $message);
        $message = preg_replace('/\b\d{4,}\b/', '***', $message); // Hide long numbers
        
        return $message;
    }
}

// ========================================
// CUSTOM EXCEPTIONS
// ========================================

class ValidationException extends Exception {
    protected $errors = [];
    
    public function __construct($message = "", $errors = [], $code = 400) {
        parent::__construct($message, $code);
        $this->errors = $errors;
    }
    
    public function getErrors() {
        return $this->errors;
    }
}

class AuthenticationException extends Exception {
    public function __construct($message = "Authentication failed", $code = 401) {
        parent::__construct($message, $code);
    }
}

class AuthorizationException extends Exception {
    public function __construct($message = "Access denied", $code = 403) {
        parent::__construct($message, $code);
    }
}

class NotFoundException extends Exception {
    public function __construct($message = "Resource not found", $code = 404) {
        parent::__construct($message, $code);
    }
}

// ========================================
// LOGGER CLASS
// ========================================

class Logger {
    private $logFile;
    private $logLevels = [
        'DEBUG' => 0,
        'INFO' => 1,
        'NOTICE' => 2,
        'WARNING' => 3,
        'ERROR' => 4,
        'CRITICAL' => 5,
        'ALERT' => 6,
        'EMERGENCY' => 7
    ];
    
    public function __construct($logFile = null) {
        $this->logFile = $logFile ?: __DIR__ . '/logs/app.log';
        $this->ensureLogDirectory();
    }
    
    private function ensureLogDirectory() {
        $dir = dirname($this->logFile);
        if (!is_dir($dir)) {
            mkdir($dir, 0777, true);
        }
    }
    
    public function log($level, $message, $context = []) {
        $timestamp = date('Y-m-d H:i:s');
        $contextJson = !empty($context) ? json_encode($context) : '';
        
        $logEntry = "[{$timestamp}] {$level}: {$message} {$contextJson}" . PHP_EOL;
        
        file_put_contents($this->logFile, $logEntry, FILE_APPEND | LOCK_EX);
        
        // Also log to separate files by level
        if (in_array($level, ['ERROR', 'CRITICAL', 'ALERT', 'EMERGENCY'])) {
            $errorFile = str_replace('.log', '-error.log', $this->logFile);
            file_put_contents($errorFile, $logEntry, FILE_APPEND | LOCK_EX);
        }
    }
    
    public function debug($message, $context = []) {
        $this->log('DEBUG', $message, $context);
    }
    
    public function info($message, $context = []) {
        $this->log('INFO', $message, $context);
    }
    
    public function notice($message, $context = []) {
        $this->log('NOTICE', $message, $context);
    }
    
    public function warning($message, $context = []) {
        $this->log('WARNING', $message, $context);
    }
    
    public function error($message, $context = []) {
        $this->log('ERROR', $message, $context);
    }
    
    public function critical($message, $context = []) {
        $this->log('CRITICAL', $message, $context);
    }
    
    public function alert($message, $context = []) {
        $this->log('ALERT', $message, $context);
    }
    
    public function emergency($message, $context = []) {
        $this->log('EMERGENCY', $message, $context);
    }
}</code></pre>
                                </div>
                            </section>

                            <section>
                                <h2>Debugging Techniques</h2>
                                
                                <canvas id="debugCanvas" width="600" height="350"></canvas>
                                <script>
                                    const dCtx = document.getElementById('debugCanvas').getContext('2d');
                                    
                                    // Title
                                    dCtx.font = 'bold 16px Arial';
                                    dCtx.fillStyle = '#1f2937';
                                    dCtx.fillText('Debugging Tools & Techniques', 180, 30);
                                    
                                    // Debugging methods
                                    const methods = [
                                        { name: 'var_dump()', desc: 'Display variable info', x: 50, y: 60 },
                                        { name: 'print_r()', desc: 'Human-readable info', x: 220, y: 60 },
                                        { name: 'error_log()', desc: 'Log to file', x: 390, y: 60 },
                                        { name: 'Xdebug', desc: 'Step debugging', x: 50, y: 150 },
                                        { name: 'Debug Bar', desc: 'Toolbar info', x: 220, y: 150 },
                                        { name: 'Query Log', desc: 'SQL debugging', x: 390, y: 150 }
                                    ];
                                    
                                    methods.forEach((method, i) => {
                                        const color = i < 3 ? '#dbeafe' : '#dcfce7';
                                        const border = i < 3 ? '#2563eb' : '#16a34a';
                                        
                                        dCtx.fillStyle = color;
                                        dCtx.fillRect(method.x, method.y, 150, 70);
                                        dCtx.strokeStyle = border;
                                        dCtx.lineWidth = 2;
                                        dCtx.strokeRect(method.x, method.y, 150, 70);
                                        
                                        dCtx.fillStyle = border;
                                        dCtx.font = 'bold 11px Arial';
                                        dCtx.fillText(method.name, method.x + 35, method.y + 30);
                                        
                                        dCtx.fillStyle = '#6b7280';
                                        dCtx.font = '10px Arial';
                                        dCtx.fillText(method.desc, method.x + 30, method.y + 50);
                                    });
                                    
                                    // Performance profiling
                                    dCtx.fillStyle = '#fef3c7';
                                    dCtx.fillRect(50, 240, 500, 90);
                                    dCtx.strokeStyle = '#ca8a04';
                                    dCtx.strokeRect(50, 240, 500, 90);
                                    
                                    dCtx.fillStyle = '#92400e';
                                    dCtx.font = 'bold 12px Arial';
                                    dCtx.fillText('Performance Profiling', 230, 260);
                                    
                                    dCtx.font = '10px Arial';
                                    dCtx.fillStyle = '#374151';
                                    const tools = ['‚Ä¢ microtime() for timing', '‚Ä¢ memory_get_usage()', '‚Ä¢ Query EXPLAIN', '‚Ä¢ Blackfire.io', '‚Ä¢ New Relic'];
                                    tools.forEach((tool, i) => {
                                        const x = 70 + (i % 3) * 160;
                                        const y = 280 + Math.floor(i / 3) * 20;
                                        dCtx.fillText(tool, x, y);
                                    });
                                </script>
                                
                                <div class="best_practice">
                                    <h3>Advanced Debugging Implementation</h3>
                                    
                                    <pre><code class="language-php">&lt;?php
// ========================================
// DEBUG HELPER CLASS
// ========================================

class Debug {
    private static $startTime;
    private static $queries = [];
    private static $timers = [];
    
    /**
     * Pretty print variable
     */
    public static function dump($variable, $label = null, $exit = false) {
        echo "&lt;pre style='background:#f4f4f4; padding:10px; border:1px solid #ddd;'&gt;";
        
        if ($label) {
            echo "&lt;strong&gt;{$label}:&lt;/strong&gt;\n";
        }
        
        if (is_bool($variable)) {
            echo $variable ? 'true' : 'false';
        } elseif (is_null($variable)) {
            echo 'null';
        } else {
            print_r($variable);
        }
        
        echo "&lt;/pre&gt;";
        
        if ($exit) {
            exit;
        }
    }
    
    /**
     * Debug with backtrace
     */
    public static function trace($variable = null, $depth = 5) {
        $trace = debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS, $depth);
        
        echo "&lt;div style='background:#fff3cd; padding:10px; border:1px solid #ffc107;'&gt;";
        echo "&lt;h4&gt;Debug Trace&lt;/h4&gt;";
        
        if ($variable !== null) {
            echo "&lt;strong&gt;Value:&lt;/strong&gt; ";
            var_dump($variable);
            echo "&lt;br&gt;&lt;br&gt;";
        }
        
        echo "&lt;strong&gt;Call Stack:&lt;/strong&gt;&lt;ol&gt;";
        foreach ($trace as $item) {
            echo "&lt;li&gt;";
            echo isset($item['file']) ? $item['file'] : '[internal]';
            echo isset($item['line']) ? " ({$item['line']})" : '';
            echo isset($item['function']) ? " - {$item['function']}()" : '';
            echo "&lt;/li&gt;";
        }
        echo "&lt;/ol&gt;&lt;/div&gt;";
    }
    
    /**
     * Log to file with context
     */
    public static function log($data, $label = null) {
        $logFile = __DIR__ . '/logs/debug.log';
        $timestamp = date('Y-m-d H:i:s');
        
        $entry = "[{$timestamp}]";
        
        if ($label) {
            $entry .= " {$label}:";
        }
        
        $entry .= " " . (is_string($data) ? $data : json_encode($data)) . PHP_EOL;
        
        file_put_contents($logFile, $entry, FILE_APPEND | LOCK_EX);
    }
    
    /**
     * Start timer
     */
    public static function startTimer($name = 'default') {
        self::$timers[$name] = microtime(true);
    }
    
    /**
     * End timer and display result
     */
    public static function endTimer($name = 'default', $display = true) {
        if (!isset(self::$timers[$name])) {
            return false;
        }
        
        $elapsed = microtime(true) - self::$timers[$name];
        $milliseconds = round($elapsed * 1000, 2);
        
        if ($display) {
            echo "&lt;div style='background:#d4edda; padding:5px; border:1px solid #c3e6cb;'&gt;";
            echo "Timer '{$name}': {$milliseconds}ms";
            echo "&lt;/div&gt;";
        }
        
        unset(self::$timers[$name]);
        
        return $milliseconds;
    }
    
    /**
     * Memory usage
     */
    public static function memory($label = null) {
        $usage = memory_get_usage(true);
        $peak = memory_get_peak_usage(true);
        
        $format = function($bytes) {
            $units = ['B', 'KB', 'MB', 'GB'];
            $bytes = max($bytes, 0);
            $pow = floor(($bytes ? log($bytes) : 0) / log(1024));
            $pow = min($pow, count($units) - 1);
            
            return round($bytes / pow(1024, $pow), 2) . ' ' . $units[$pow];
        };
        
        echo "&lt;div style='background:#e2e3e5; padding:5px; border:1px solid #d6d8db;'&gt;";
        
        if ($label) {
            echo "&lt;strong&gt;{$label}&lt;/strong&gt;&lt;br&gt;";
        }
        
        echo "Memory: " . $format($usage) . " / Peak: " . $format($peak);
        echo "&lt;/div&gt;";
    }
    
    /**
     * SQL query logger
     */
    public static function logQuery($query, $params = [], $time = null) {
        self::$queries[] = [
            'query' => $query,
            'params' => $params,
            'time' => $time,
            'backtrace' => debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS, 3)
        ];
    }
    
    /**
     * Display all queries
     */
    public static function showQueries() {
        if (empty(self::$queries)) {
            return;
        }
        
        echo "&lt;div style='background:#f8f9fa; padding:10px; border:1px solid #dee2e6;'&gt;";
        echo "&lt;h4&gt;SQL Queries (" . count(self::$queries) . ")&lt;/h4&gt;";
        
        $totalTime = 0;
        
        foreach (self::$queries as $i => $query) {
            echo "&lt;div style='margin-bottom:10px; padding:5px; background:white;'&gt;";
            echo "&lt;strong&gt;Query #" . ($i + 1) . "&lt;/strong&gt;";
            
            if ($query['time']) {
                echo " ({$query['time']}ms)";
                $totalTime += $query['time'];
            }
            
            echo "&lt;pre style='margin:5px 0;'&gt;" . htmlspecialchars($query['query']) . "&lt;/pre&gt;";
            
            if (!empty($query['params'])) {
                echo "&lt;small&gt;Params: " . json_encode($query['params']) . "&lt;/small&gt;";
            }
            
            echo "&lt;/div&gt;";
        }
        
        echo "&lt;strong&gt;Total time: {$totalTime}ms&lt;/strong&gt;";
        echo "&lt;/div&gt;";
    }
    
    /**
     * Debug bar for development
     */
    public static function renderDebugBar() {
        if (($_ENV['APP_ENV'] ?? 'production') !== 'development') {
            return;
        }
        
        $executionTime = isset($_SERVER['REQUEST_TIME_FLOAT']) 
            ? round((microtime(true) - $_SERVER['REQUEST_TIME_FLOAT']) * 1000, 2)
            : 0;
        $memoryUsage = round(memory_get_peak_usage(true) / 1024 / 1024, 2);
        $queryCount = count(self::$queries);
        
        echo <<<HTML
        &lt;div id="debug-bar" style="position:fixed; bottom:0; left:0; right:0; background:#343a40; color:white; padding:10px; font-size:12px; z-index:9999;"&gt;
            &lt;span style="margin-right:20px;"&gt;‚è±Ô∏è {$executionTime}ms&lt;/span&gt;
            &lt;span style="margin-right:20px;"&gt;üíæ {$memoryUsage}MB&lt;/span&gt;
            &lt;span style="margin-right:20px;"&gt;üîç {$queryCount} queries&lt;/span&gt;
            &lt;span style="margin-right:20px;"&gt;üìÅ {$_SERVER['REQUEST_URI']}&lt;/span&gt;
            &lt;span style="margin-right:20px;"&gt;üë§ {$_SERVER['REMOTE_ADDR']}&lt;/span&gt;
            &lt;button onclick="document.getElementById('debug-bar').style.display='none'" style="float:right; background:transparent; color:white; border:none; cursor:pointer;"&gt;‚úñ&lt;/button&gt;
        &lt;/div&gt;
        HTML;
    }
}

// ========================================
// USAGE EXAMPLES
// ========================================

// Initialize error handler
ErrorHandler::getInstance();

// Debug examples
Debug::startTimer('database');

try {
    $pdo = new PDO($dsn, $username, $password);
    
    // Log query
    $query = "SELECT * FROM users WHERE status = ?";
    $stmt = $pdo->prepare($query);
    $stmt->execute(['active']);
    
    Debug::logQuery($query, ['active'], Debug::endTimer('database', false));
    
} catch (PDOException $e) {
    DatabaseErrorHandler::handleConnectionError($e);
}

// Debug output
Debug::dump($_POST, 'POST Data');
Debug::trace('Checkpoint reached');
Debug::memory('After processing');
Debug::showQueries();
Debug::renderDebugBar();</code></pre>
                                </div>
                            </section>
                            
                            <!-- Practice Exercise -->
                            <section>
                                <h2>Practice Exercise</h2>
                                
                                <div class="alert alert-success">
                                    <div class="alert-icon">üíª</div>
                                    <div class="alert-content">
                                        <div class="alert-title">Error Handling Challenges</div>
                                        <div class="alert-message">
                                            Implement these debugging features:
                                            <ol>
                                                <li>Create a comprehensive error logging system</li>
                                                <li>Build custom exception classes for your app</li>
                                                <li>Implement error monitoring dashboard</li>
                                                <li>Create debugging toolbar for development</li>
                                                <li>Build query profiler and analyzer</li>
                                                <li>Implement error recovery mechanisms</li>
                                                <li>Create user-friendly error pages</li>
                                                <li>Build automated error alerting system</li>
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            
                            <!-- Resources -->
                            <section class="resources">
                                <h2>Additional Resources</h2>
                                <ul>
                                    <li><a href="https://www.php.net/manual/en/book.errorfunc.php" target="_blank">PHP Error Handling</a></li>
                                    <li><a href="https://xdebug.org/" target="_blank">Xdebug Documentation</a></li>
                                    <li><a href="https://github.com/Seldaek/monolog" target="_blank">Monolog Logger</a></li>
                                    <li><a href="https://sentry.io/for/php/" target="_blank">Sentry Error Tracking</a></li>
                                    <li><a href="https://blackfire.io/" target="_blank">Blackfire Profiler</a></li>
                                </ul>
                            </section>
                        </div>

                        <!-- Lesson Navigation -->
                        <div class="lesson-navigation">
                            <a href="/03module/result_sets.html" class="lesson-nav-button prev">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"/>
                                </svg>
                                <span>
                                    <small>Previous</small><br>
                                    Result Sets
                                </span>
                            </a>
                            
                            <button class="complete-lesson-btn">
                                Mark as Complete
                            </button>
                            
                            <a href="/03module/final_project.html" class="lesson-nav-button next">
                                <span>
                                    <small>Next</small><br>
                                    Final Project
                                </span>
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                                </svg>
                            </a>
                        </div>
                    </article>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="site-footer" role="contentinfo">
            <div class="footer-container">
                <div class="footer-content">
                    <div class="footer-section footer-about">
                        <h3>PHP WordPress Development</h3>
                        <p>Complete Web Development Course</p>
                    </div>
                    
                    <div class="footer-section">
                        <h4>Quick Links</h4>
                        <ul class="footer-links">
                            <li><a href="/">Home</a></li>
                            <li><a href="/module3.html">Module 3</a></li>
                            <li><a href="/resources.html">Resources</a></li>
                        </ul>
                    </div>
                    
                    <div class="footer-section">
                        <h4>Support</h4>
                        <ul class="footer-links">
                            <li><a href="/help.html">Help Center</a></li>
                            <li><a href="/faq.html">FAQ</a></li>
                            <li><a href="/contact.html">Contact</a></li>
                        </ul>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <div class="footer-bottom-content">
                        <p class="copyright">&copy; 2025 PHP WordPress Development Course</p>
                        <nav class="footer-bottom-links">
                            <a href="/privacy.html">Privacy</a>
                            <span class="separator">|</span>
                            <a href="/terms.html">Terms</a>
                        </nav>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Back to Top -->
    <button id="back-to-top" class="back-to-top" aria-label="Back to top">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 19V5M12 5l-7 7M12 5l7 7"/>
        </svg>
    </button>

    <!-- JavaScript -->
    <script src="/assets/js/navigation.js"></script>
    <script src="/assets/js/site-config.js"></script>
</body>
</html>