<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    
    <!-- SEO Meta Tags -->
    <title>Handling Result Sets - PHP MySQL Data Processing - PHP WordPress Course</title>
    <meta name="description" content="Master handling MySQL result sets in PHP, pagination, filtering, sorting, and data transformation techniques">
    <meta name="keywords" content="PHP, MySQL, result sets, pagination, data processing, filtering, sorting">
    <meta name="author" content="PHP WordPress Course">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css">
    
    <!-- Mermaid for diagrams -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
    <!-- Skip to main content -->
    <a href="#main-content" class="sr-only">Skip to main content</a>
    
    <div class="page-wrapper">
        <!-- Header -->
        <header class="site-header" role="banner">
            <div class="header-container">
                <div class="site-branding">
                    <a href="/" class="site-logo">
                        <h1 class="site-title">PHP WordPress Development</h1>
                    </a>
                </div>
                
                <nav class="main-navigation" role="navigation" aria-label="Main navigation">
                    <button class="mobile-menu-btn" aria-label="Toggle navigation" aria-expanded="false">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    
                    <div class="nav-menu">
                        <ul class="nav-list">
                            <li class="nav-item"><a href="/" class="nav-link">Home</a></li>
                            <li class="nav-item dropdown">
                                <button class="nav-link dropdown-toggle active" aria-haspopup="true">Modules</button>
                                <div class="dropdown-menu">
                                    <a href="/module1.html" class="dropdown-item">Module 1: Web Fundamentals</a>
                                    <a href="/module2.html" class="dropdown-item">Module 2: PHP Fundamentals</a>
                                    <a href="/module3.html" class="dropdown-item active">Module 3: MySQL Database</a>
                                    <a href="/module4.html" class="dropdown-item">Module 4: WordPress & Docker</a>
                                    <a href="/module5.html" class="dropdown-item">Module 5: Theme Development</a>
                                    <a href="/module6.html" class="dropdown-item">Module 6: Plugin Development</a>
                                    <a href="/module7.html" class="dropdown-item">Module 7: Advanced WordPress</a>
                                    <a href="/module8.html" class="dropdown-item">Module 8: Deployment</a>
                                    <a href="/module9.html" class="dropdown-item">Module 9: Final Project</a>
                                </div>
                            </li>
                            <li class="nav-item"><a href="/resources.html" class="nav-link">Resources</a></li>
                            <li class="nav-item"><a href="/about.html" class="nav-link">About</a></li>
                        </ul>
                    </div>
                </nav>
                
                <div class="search-container">
                    <div class="search-input-wrapper">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                        </svg>
                        <input type="search" class="search-input" placeholder="Search lessons..." aria-label="Search">
                    </div>
                    <div class="search-results"></div>
                </div>
            </div>
        </header>
        
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-header">
                <h2 class="progress-title">Course Progress</h2>
                <span class="progress-text">Loading...</span>
            </div>
            <div class="progress-bar">
                <div class="progress-bar-fill">
                    <span class="progress-bar-text"></span>
                </div>
            </div>
        </div>
        
        <!-- Breadcrumb -->
        <nav class="breadcrumb container" aria-label="Breadcrumb">
            <ol class="breadcrumb-list">
                <li class="breadcrumb-item">
                    <a href="/">Home</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <a href="/module3.html">Module 3</a>
                    <span class="breadcrumb-separator">/</span>
                </li>
                <li class="breadcrumb-item">
                    <span aria-current="page">Result Sets</span>
                </li>
            </ol>
        </nav>
        
        <!-- Main Content -->
        <main id="main-content" class="main-content" role="main">
            <div class="container">
                <div class="content-with-sidebar">
                    <!-- Sidebar -->
                    <aside class="sidebar">
                        <div class="sidebar-nav">
                            <h3 class="sidebar-title">Module 3: Session 5</h3>
                            <div class="sidebar-section">
                                <h4 class="sidebar-section-title">PHP MySQL Integration</h4>
                                <a href="/module3.html" class="sidebar-link">Module Overview</a>
                                <a href="/03module/php_mysql_integration.html" class="sidebar-link">PHP MySQL Basics</a>
                                <a href="/03module/crud_operations.html" class="sidebar-link">CRUD Operations</a>
                                <a href="/03module/result_sets.html" class="sidebar-link active">Handling Result Sets</a>
                                <a href="/03module/error_debugging.html" class="sidebar-link">Error Handling</a>
                                <a href="/03module/final_project.html" class="sidebar-link">Final Project</a>
                            </div>
                        </div>
                    </aside>
                    
                    <!-- Main Lesson Content -->
                    <article class="lesson-content">
                        <header class="lesson-header">
                            <h1>Handling Result Sets</h1>
                            <div class="lesson-meta">
                                <div class="lesson-meta-item">
                                    <svg width="20" height="20" fill="currentColor">
                                        <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    <span>Duration: 90 minutes</span>
                                </div>
                                <div class="lesson-meta-item">
                                    <svg width="20" height="20" fill="currentColor">
                                        <path d="M12 14l9-5-9-5-9 5 9 5z"/>
                                    </svg>
                                    <span>Module 3: Data Processing</span>
                                </div>
                            </div>
                        </header>

                        <!-- Learning Objectives -->
                        <div class="lesson-objectives">
                            <h2>Learning Objectives</h2>
                            <ul>
                                <li>Master different fetch methods and modes</li>
                                <li>Implement efficient pagination systems</li>
                                <li>Build advanced search and filtering</li>
                                <li>Create dynamic sorting mechanisms</li>
                                <li>Handle large datasets efficiently</li>
                                <li>Transform and format data for display</li>
                                <li>Export data in various formats</li>
                                <li>Optimize memory usage with result sets</li>
                            </ul>
                        </div>
                        
                        <!-- Lesson Body -->
                        <div class="lesson-body">
                            <section>
                                <h2>Understanding Result Sets</h2>
                                <p class="lead">Result sets are the data returned from database queries. Let's master how to efficiently process and display this data! ðŸ“Š</p>
                                
                                <canvas id="resultCanvas" width="600" height="450"></canvas>
                                <script>
                                    const ctx = document.getElementById('resultCanvas').getContext('2d');
                                    
                                    // Title
                                    ctx.font = 'bold 18px Arial';
                                    ctx.fillStyle = '#1f2937';
                                    ctx.fillText('Result Set Processing Flow', 180, 30);
                                    
                                    // Database
                                    ctx.fillStyle = '#e9d5ff';
                                    ctx.fillRect(50, 60, 150, 80);
                                    ctx.strokeStyle = '#7c3aed';
                                    ctx.lineWidth = 2;
                                    ctx.strokeRect(50, 60, 150, 80);
                                    
                                    ctx.fillStyle = '#7c3aed';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('MySQL Database', 80, 85);
                                    ctx.font = '10px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('1000+ records', 95, 105);
                                    ctx.fillText('Multiple tables', 93, 120);
                                    
                                    // Query
                                    ctx.fillStyle = '#dbeafe';
                                    ctx.fillRect(250, 60, 150, 80);
                                    ctx.strokeStyle = '#2563eb';
                                    ctx.strokeRect(250, 60, 150, 80);
                                    
                                    ctx.fillStyle = '#1e40af';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('Query Execution', 285, 85);
                                    ctx.font = '10px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('SELECT * FROM...', 270, 105);
                                    ctx.fillText('WHERE, ORDER BY', 270, 120);
                                    
                                    // Result Set
                                    ctx.fillStyle = '#dcfce7';
                                    ctx.fillRect(450, 60, 120, 80);
                                    ctx.strokeStyle = '#16a34a';
                                    ctx.strokeRect(450, 60, 120, 80);
                                    
                                    ctx.fillStyle = '#166534';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('Result Set', 475, 85);
                                    ctx.font = '10px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('Raw data', 480, 105);
                                    ctx.fillText('Multiple rows', 470, 120);
                                    
                                    // Arrows
                                    ctx.strokeStyle = '#6b7280';
                                    ctx.lineWidth = 2;
                                    ctx.beginPath();
                                    ctx.moveTo(200, 100);
                                    ctx.lineTo(250, 100);
                                    ctx.stroke();
                                    
                                    ctx.beginPath();
                                    ctx.moveTo(400, 100);
                                    ctx.lineTo(450, 100);
                                    ctx.stroke();
                                    
                                    // Processing Options
                                    const options = [
                                        { text: 'Fetch Methods', x: 50, y: 180, color: '#fef3c7', border: '#ca8a04',
                                          items: ['fetch()', 'fetchAll()', 'fetchColumn()', 'fetchObject()'] },
                                        { text: 'Fetch Modes', x: 220, y: 180, color: '#fee2e2', border: '#dc2626',
                                          items: ['FETCH_ASSOC', 'FETCH_NUM', 'FETCH_OBJ', 'FETCH_CLASS'] },
                                        { text: 'Processing', x: 390, y: 180, color: '#e0f2fe', border: '#0891b2',
                                          items: ['Pagination', 'Filtering', 'Sorting', 'Transformation'] }
                                    ];
                                    
                                    options.forEach(opt => {
                                        ctx.fillStyle = opt.color;
                                        ctx.fillRect(opt.x, opt.y, 160, 120);
                                        ctx.strokeStyle = opt.border;
                                        ctx.strokeRect(opt.x, opt.y, 160, 120);
                                        
                                        ctx.fillStyle = opt.border;
                                        ctx.font = 'bold 11px Arial';
                                        ctx.fillText(opt.text, opt.x + 40, opt.y + 20);
                                        
                                        ctx.fillStyle = '#374151';
                                        ctx.font = '9px Arial';
                                        opt.items.forEach((item, i) => {
                                            ctx.fillText(`â€¢ ${item}`, opt.x + 10, opt.y + 45 + (i * 15));
                                        });
                                    });
                                    
                                    // Output formats
                                    ctx.fillStyle = '#f3f4f6';
                                    ctx.fillRect(50, 320, 520, 100);
                                    ctx.strokeStyle = '#6b7280';
                                    ctx.strokeRect(50, 320, 520, 100);
                                    
                                    ctx.fillStyle = '#1f2937';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('Output Formats', 260, 340);
                                    
                                    ctx.font = '10px Arial';
                                    const outputs = ['HTML Tables', 'JSON API', 'CSV Export', 'XML Feed', 'PDF Reports', 'Charts/Graphs'];
                                    outputs.forEach((output, i) => {
                                        const x = 70 + (i % 3) * 180;
                                        const y = 360 + Math.floor(i / 3) * 20;
                                        ctx.fillText(`âœ“ ${output}`, x, y);
                                    });
                                </script>
                                
                                <div class="alert alert-info">
                                    <div class="alert-icon">ðŸ’¡</div>
                                    <div class="alert-content">
                                        <div class="alert-title">Result Set Key Concepts</div>
                                        <div class="alert-message">
                                            <ul>
                                                <li><strong>Fetch Methods:</strong> Different ways to retrieve data from result sets</li>
                                                <li><strong>Fetch Modes:</strong> Control the format of returned data</li>
                                                <li><strong>Buffered vs Unbuffered:</strong> Memory management strategies</li>
                                                <li><strong>Cursor Position:</strong> Track current position in result set</li>
                                                <li><strong>Memory Efficiency:</strong> Handle large datasets without exhausting memory</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <h2>Fetch Methods and Modes</h2>
                                
                                <div class="mermaid">
                                    graph TB
                                        RESULT[Result Set] --> FETCH[Fetch Methods]
                                        
                                        FETCH --> SINGLE[Single Row]
                                        FETCH --> MULTI[Multiple Rows]
                                        FETCH --> COLUMN[Single Column]
                                        
                                        SINGLE --> |fetch| ASSOC[Associative Array]
                                        SINGLE --> |fetch| NUM[Numeric Array]
                                        SINGLE --> |fetch| OBJ[Object]
                                        
                                        MULTI --> |fetchAll| ALL[All Rows]
                                        COLUMN --> |fetchColumn| COL[Column Values]
                                        
                                        style RESULT fill:#e9d5ff
                                        style FETCH fill:#dbeafe
                                        style SINGLE fill:#dcfce7
                                        style MULTI fill:#fef3c7
                                </div>
                                
                                <div class="real_world_example">
                                    <h3>Working with Different Fetch Methods</h3>
                                    
                                    <pre><code class="language-php">&lt;?php
// ========================================
// FETCH METHODS COMPARISON
// ========================================

class ResultSetHandler {
    private $pdo;
    
    public function __construct(PDO $pdo) {
        $this->pdo = $pdo;
    }
    
    /**
     * Demonstrate different fetch methods
     */
    public function demonstrateFetchMethods() {
        $sql = "SELECT id, name, email, created_at FROM users LIMIT 5";
        $stmt = $this->pdo->query($sql);
        
        // ========================================
        // FETCH() - Single row at a time
        // ========================================
        echo "=== FETCH() - One row at a time ===\n";
        $stmt = $this->pdo->query($sql);
        while ($row = $stmt->fetch()) {
            echo "User: {$row['name']} ({$row['email']})\n";
        }
        
        // ========================================
        // FETCHALL() - All rows at once
        // ========================================
        echo "\n=== FETCHALL() - All rows ===\n";
        $stmt = $this->pdo->query($sql);
        $allUsers = $stmt->fetchAll();
        foreach ($allUsers as $user) {
            echo "User: {$user['name']}\n";
        }
        
        // ========================================
        // FETCHCOLUMN() - Single column value
        // ========================================
        echo "\n=== FETCHCOLUMN() - Single column ===\n";
        $sql = "SELECT COUNT(*) FROM users WHERE status = 'active'";
        $count = $this->pdo->query($sql)->fetchColumn();
        echo "Active users: $count\n";
        
        // Get specific column
        $sql = "SELECT name FROM users WHERE id = 1";
        $name = $this->pdo->query($sql)->fetchColumn();
        echo "User name: $name\n";
    }
    
    /**
     * Demonstrate different fetch modes
     */
    public function demonstrateFetchModes() {
        $sql = "SELECT id, name, email FROM users LIMIT 3";
        
        // ========================================
        // PDO::FETCH_ASSOC - Associative array
        // ========================================
        echo "=== FETCH_ASSOC ===\n";
        $stmt = $this->pdo->query($sql);
        $stmt->setFetchMode(PDO::FETCH_ASSOC);
        $row = $stmt->fetch();
        print_r($row);
        // Output: Array([id] => 1, [name] => John, [email] => john@example.com)
        
        // ========================================
        // PDO::FETCH_NUM - Numeric array
        // ========================================
        echo "\n=== FETCH_NUM ===\n";
        $stmt = $this->pdo->query($sql);
        $stmt->setFetchMode(PDO::FETCH_NUM);
        $row = $stmt->fetch();
        print_r($row);
        // Output: Array([0] => 1, [1] => John, [2] => john@example.com)
        
        // ========================================
        // PDO::FETCH_BOTH - Both numeric and associative
        // ========================================
        echo "\n=== FETCH_BOTH ===\n";
        $stmt = $this->pdo->query($sql);
        $stmt->setFetchMode(PDO::FETCH_BOTH);
        $row = $stmt->fetch();
        print_r($row);
        // Has both numeric and associative keys
        
        // ========================================
        // PDO::FETCH_OBJ - Anonymous object
        // ========================================
        echo "\n=== FETCH_OBJ ===\n";
        $stmt = $this->pdo->query($sql);
        $stmt->setFetchMode(PDO::FETCH_OBJ);
        $user = $stmt->fetch();
        echo "Name: {$user->name}, Email: {$user->email}\n";
        
        // ========================================
        // PDO::FETCH_CLASS - Into specific class
        // ========================================
        echo "\n=== FETCH_CLASS ===\n";
        
        class User {
            public $id;
            public $name;
            public $email;
            
            public function getInfo() {
                return "{$this->name} ({$this->email})";
            }
        }
        
        $stmt = $this->pdo->query($sql);
        $stmt->setFetchMode(PDO::FETCH_CLASS, 'User');
        $user = $stmt->fetch();
        echo $user->getInfo() . "\n";
        
        // ========================================
        // PDO::FETCH_KEY_PAIR - Key-value pairs
        // ========================================
        echo "\n=== FETCH_KEY_PAIR ===\n";
        $sql = "SELECT id, name FROM users LIMIT 5";
        $users = $this->pdo->query($sql)->fetchAll(PDO::FETCH_KEY_PAIR);
        print_r($users);
        // Output: Array([1] => John, [2] => Jane, ...)
        
        // ========================================
        // PDO::FETCH_GROUP - Group by first column
        // ========================================
        echo "\n=== FETCH_GROUP ===\n";
        $sql = "SELECT category_id, name FROM products";
        $stmt = $this->pdo->query($sql);
        $products = $stmt->fetchAll(PDO::FETCH_GROUP | PDO::FETCH_COLUMN);
        // Groups products by category_id
        
        // ========================================
        // PDO::FETCH_UNIQUE - Indexed by unique column
        // ========================================
        echo "\n=== FETCH_UNIQUE ===\n";
        $sql = "SELECT id, name, email FROM users";
        $users = $this->pdo->query($sql)->fetchAll(PDO::FETCH_UNIQUE);
        // Array indexed by ID
    }
    
    /**
     * Memory-efficient processing of large result sets
     */
    public function processLargeResultSet() {
        // Use unbuffered query for large datasets
        $this->pdo->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, false);
        
        $sql = "SELECT * FROM large_table";
        $stmt = $this->pdo->query($sql);
        
        $processedCount = 0;
        $batchSize = 1000;
        $batch = [];
        
        while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
            $batch[] = $row;
            
            if (count($batch) >= $batchSize) {
                $this->processBatch($batch);
                $batch = [];
                $processedCount += $batchSize;
                
                echo "Processed: $processedCount rows\n";
                
                // Free some memory
                if ($processedCount % 10000 == 0) {
                    gc_collect_cycles();
                }
            }
        }
        
        // Process remaining batch
        if (!empty($batch)) {
            $this->processBatch($batch);
        }
        
        // Re-enable buffered queries
        $this->pdo->setAttribute(PDO::MYSQL_ATTR_USE_BUFFERED_QUERY, true);
    }
    
    private function processBatch($batch) {
        // Process batch of records
        foreach ($batch as $record) {
            // Process each record
        }
    }
}</code></pre>
                                </div>
                            </section>

                            <section>
                                <h2>Pagination Implementation</h2>
                                
                                <canvas id="paginationCanvas" width="600" height="300"></canvas>
                                <script>
                                    const pCtx = document.getElementById('paginationCanvas').getContext('2d');
                                    
                                    // Title
                                    pCtx.font = 'bold 16px Arial';
                                    pCtx.fillStyle = '#1f2937';
                                    pCtx.fillText('Pagination Strategy', 240, 30);
                                    
                                    // Total records
                                    pCtx.fillStyle = '#e9d5ff';
                                    pCtx.fillRect(50, 60, 500, 40);
                                    pCtx.strokeStyle = '#7c3aed';
                                    pCtx.lineWidth = 2;
                                    pCtx.strokeRect(50, 60, 500, 40);
                                    
                                    pCtx.fillStyle = '#7c3aed';
                                    pCtx.font = '12px Arial';
                                    pCtx.fillText('Total: 1000 records', 250, 85);
                                    
                                    // Pages
                                    const pages = [
                                        { page: 1, start: 1, end: 20, x: 50 },
                                        { page: 2, start: 21, end: 40, x: 150 },
                                        { page: 3, start: 41, end: 60, x: 250 },
                                        { page: '...', start: '', end: '', x: 350 },
                                        { page: 50, start: 981, end: 1000, x: 450 }
                                    ];
                                    
                                    pages.forEach((p, i) => {
                                        // Page box
                                        const color = i === 2 ? '#dcfce7' : '#f3f4f6';
                                        const border = i === 2 ? '#16a34a' : '#6b7280';
                                        
                                        pCtx.fillStyle = color;
                                        pCtx.fillRect(p.x, 120, 80, 60);
                                        pCtx.strokeStyle = border;
                                        pCtx.strokeRect(p.x, 120, 80, 60);
                                        
                                        // Page number
                                        pCtx.fillStyle = i === 2 ? '#166534' : '#1f2937';
                                        pCtx.font = 'bold 14px Arial';
                                        pCtx.fillText(`Page ${p.page}`, p.x + 15, 145);
                                        
                                        // Records range
                                        if (p.start) {
                                            pCtx.font = '10px Arial';
                                            pCtx.fillStyle = '#6b7280';
                                            pCtx.fillText(`${p.start}-${p.end}`, p.x + 20, 165);
                                        }
                                    });
                                    
                                    // SQL query
                                    pCtx.fillStyle = '#fef3c7';
                                    pCtx.fillRect(50, 200, 500, 80);
                                    pCtx.strokeStyle = '#ca8a04';
                                    pCtx.strokeRect(50, 200, 500, 80);
                                    
                                    pCtx.fillStyle = '#92400e';
                                    pCtx.font = '11px Courier';
                                    pCtx.fillText('SELECT * FROM products', 60, 220);
                                    pCtx.fillText('ORDER BY created_at DESC', 60, 235);
                                    pCtx.fillText('LIMIT 20 OFFSET 40  -- Page 3: (3-1) * 20 = 40', 60, 250);
                                    pCtx.fillText('-- Formula: OFFSET = (page - 1) * per_page', 60, 265);
                                </script>
                                
                                <div class="best_practice">
                                    <h3>Advanced Pagination System</h3>
                                    
                                    <pre><code class="language-php">&lt;?php
// ========================================
// PAGINATION CLASS
// ========================================

class Paginator {
    private $pdo;
    private $table;
    private $perPage;
    private $currentPage;
    private $totalRecords;
    private $totalPages;
    
    public function __construct(PDO $pdo, $table, $perPage = 20) {
        $this->pdo = $pdo;
        $this->table = $table;
        $this->perPage = $perPage;
    }
    
    /**
     * Get paginated results
     */
    public function paginate($page = 1, $conditions = [], $orderBy = 'id DESC') {
        $this->currentPage = max(1, (int)$page);
        
        // Build WHERE clause
        $where = $this->buildWhereClause($conditions);
        
        // Count total records
        $countSql = "SELECT COUNT(*) FROM {$this->table} {$where}";
        $this->totalRecords = $this->pdo->query($countSql)->fetchColumn();
        $this->totalPages = ceil($this->totalRecords / $this->perPage);
        
        // Adjust current page if out of range
        if ($this->currentPage > $this->totalPages && $this->totalPages > 0) {
            $this->currentPage = $this->totalPages;
        }
        
        // Calculate offset
        $offset = ($this->currentPage - 1) * $this->perPage;
        
        // Get records for current page
        $sql = "SELECT * FROM {$this->table} 
                {$where} 
                ORDER BY {$orderBy} 
                LIMIT {$this->perPage} OFFSET {$offset}";
        
        $stmt = $this->pdo->query($sql);
        $data = $stmt->fetchAll(PDO::FETCH_ASSOC);
        
        return [
            'data' => $data,
            'pagination' => $this->getPaginationInfo()
        ];
    }
    
    /**
     * Get pagination information
     */
    public function getPaginationInfo() {
        return [
            'total' => $this->totalRecords,
            'per_page' => $this->perPage,
            'current_page' => $this->currentPage,
            'last_page' => $this->totalPages,
            'from' => ($this->currentPage - 1) * $this->perPage + 1,
            'to' => min($this->currentPage * $this->perPage, $this->totalRecords),
            'prev_page' => $this->currentPage > 1 ? $this->currentPage - 1 : null,
            'next_page' => $this->currentPage < $this->totalPages ? $this->currentPage + 1 : null,
            'links' => $this->generatePageLinks()
        ];
    }
    
    /**
     * Generate page links for UI
     */
    private function generatePageLinks($maxLinks = 7) {
        $links = [];
        
        if ($this->totalPages <= $maxLinks) {
            // Show all pages
            for ($i = 1; $i <= $this->totalPages; $i++) {
                $links[] = [
                    'page' => $i,
                    'active' => $i === $this->currentPage
                ];
            }
        } else {
            // Show limited pages with ellipsis
            $halfLinks = floor($maxLinks / 2);
            $start = max(1, $this->currentPage - $halfLinks);
            $end = min($this->totalPages, $this->currentPage + $halfLinks);
            
            // Always show first page
            if ($start > 1) {
                $links[] = ['page' => 1, 'active' => false];
                if ($start > 2) {
                    $links[] = ['page' => '...', 'active' => false];
                }
            }
            
            // Middle pages
            for ($i = $start; $i <= $end; $i++) {
                $links[] = [
                    'page' => $i,
                    'active' => $i === $this->currentPage
                ];
            }
            
            // Always show last page
            if ($end < $this->totalPages) {
                if ($end < $this->totalPages - 1) {
                    $links[] = ['page' => '...', 'active' => false];
                }
                $links[] = ['page' => $this->totalPages, 'active' => false];
            }
        }
        
        return $links;
    }
    
    /**
     * Build WHERE clause from conditions
     */
    private function buildWhereClause($conditions) {
        if (empty($conditions)) {
            return '';
        }
        
        $clauses = [];
        foreach ($conditions as $field => $value) {
            if (is_array($value)) {
                // IN clause
                $placeholders = str_repeat('?,', count($value) - 1) . '?';
                $clauses[] = "{$field} IN ({$placeholders})";
            } else {
                $clauses[] = "{$field} = ?";
            }
        }
        
        return 'WHERE ' . implode(' AND ', $clauses);
    }
    
    /**
     * Render pagination HTML
     */
    public function renderPagination($baseUrl = '') {
        $info = $this->getPaginationInfo();
        
        $html = '&lt;nav aria-label="Pagination"&gt;';
        $html .= '&lt;ul class="pagination"&gt;';
        
        // Previous button
        if ($info['prev_page']) {
            $html .= '&lt;li class="page-item"&gt;';
            $html .= '&lt;a class="page-link" href="' . $baseUrl . '?page=' . $info['prev_page'] . '"&gt;Previous&lt;/a&gt;';
            $html .= '&lt;/li&gt;';
        } else {
            $html .= '&lt;li class="page-item disabled"&gt;';
            $html .= '&lt;span class="page-link"&gt;Previous&lt;/span&gt;';
            $html .= '&lt;/li&gt;';
        }
        
        // Page numbers
        foreach ($info['links'] as $link) {
            if ($link['page'] === '...') {
                $html .= '&lt;li class="page-item disabled"&gt;';
                $html .= '&lt;span class="page-link"&gt;...&lt;/span&gt;';
                $html .= '&lt;/li&gt;';
            } else {
                $active = $link['active'] ? 'active' : '';
                $html .= '&lt;li class="page-item ' . $active . '"&gt;';
                $html .= '&lt;a class="page-link" href="' . $baseUrl . '?page=' . $link['page'] . '"&gt;';
                $html .= $link['page'] . '&lt;/a&gt;';
                $html .= '&lt;/li&gt;';
            }
        }
        
        // Next button
        if ($info['next_page']) {
            $html .= '&lt;li class="page-item"&gt;';
            $html .= '&lt;a class="page-link" href="' . $baseUrl . '?page=' . $info['next_page'] . '"&gt;Next&lt;/a&gt;';
            $html .= '&lt;/li&gt;';
        } else {
            $html .= '&lt;li class="page-item disabled"&gt;';
            $html .= '&lt;span class="page-link"&gt;Next&lt;/span&gt;';
            $html .= '&lt;/li&gt;';
        }
        
        $html .= '&lt;/ul&gt;';
        $html .= '&lt;/nav&gt;';
        
        // Info text
        $html .= '&lt;p class="pagination-info"&gt;';
        $html .= "Showing {$info['from']} to {$info['to']} of {$info['total']} entries";
        $html .= '&lt;/p&gt;';
        
        return $html;
    }
}

// Usage Example
$paginator = new Paginator($pdo, 'products', 20);
$result = $paginator->paginate($_GET['page'] ?? 1);

// Display data
foreach ($result['data'] as $product) {
    echo $product['name'] . '&lt;br&gt;';
}

// Display pagination
echo $paginator->renderPagination('/products');</code></pre>
                                </div>
                            </section>

                            <section>
                                <h2>Advanced Filtering and Searching</h2>
                                
                                <div class="homework">
                                    <h3>Dynamic Filter System</h3>
                                    
                                    <pre><code class="language-php">&lt;?php
// ========================================
// ADVANCED FILTER CLASS
// ========================================

class DataFilter {
    private $pdo;
    private $query;
    private $bindings = [];
    private $table;
    
    public function __construct(PDO $pdo, $table) {
        $this->pdo = $pdo;
        $this->table = $table;
        $this->query = "SELECT * FROM {$table}";
    }
    
    /**
     * Add search condition
     */
    public function search($fields, $searchTerm) {
        if (empty($searchTerm)) {
            return $this;
        }
        
        $conditions = [];
        foreach ($fields as $field) {
            $conditions[] = "{$field} LIKE :search_{$field}";
            $this->bindings[":search_{$field}"] = '%' . $searchTerm . '%';
        }
        
        $this->addWhere('(' . implode(' OR ', $conditions) . ')');
        
        return $this;
    }
    
    /**
     * Add exact match filter
     */
    public function where($field, $operator, $value = null) {
        if ($value === null) {
            $value = $operator;
            $operator = '=';
        }
        
        $placeholder = ':where_' . str_replace('.', '_', $field);
        $this->addWhere("{$field} {$operator} {$placeholder}");
        $this->bindings[$placeholder] = $value;
        
        return $this;
    }
    
    /**
     * Add IN condition
     */
    public function whereIn($field, array $values) {
        if (empty($values)) {
            return $this;
        }
        
        $placeholders = [];
        foreach ($values as $i => $value) {
            $placeholder = ":in_{$field}_{$i}";
            $placeholders[] = $placeholder;
            $this->bindings[$placeholder] = $value;
        }
        
        $this->addWhere("{$field} IN (" . implode(', ', $placeholders) . ")");
        
        return $this;
    }
    
    /**
     * Add date range filter
     */
    public function dateRange($field, $startDate, $endDate) {
        if ($startDate) {
            $this->where($field, '>=', $startDate);
        }
        
        if ($endDate) {
            $this->where($field, '<=', $endDate);
        }
        
        return $this;
    }
    
    /**
     * Add price/number range filter
     */
    public function numberRange($field, $min, $max) {
        if ($min !== null) {
            $this->where($field, '>=', $min);
        }
        
        if ($max !== null) {
            $this->where($field, '<=', $max);
        }
        
        return $this;
    }
    
    /**
     * Add sorting
     */
    public function orderBy($field, $direction = 'ASC') {
        // Validate direction
        $direction = strtoupper($direction) === 'DESC' ? 'DESC' : 'ASC';
        
        // Validate field (whitelist approach)
        $allowedFields = $this->getAllowedSortFields();
        if (!in_array($field, $allowedFields)) {
            $field = 'id'; // Default
        }
        
        $this->query .= " ORDER BY {$field} {$direction}";
        
        return $this;
    }
    
    /**
     * Execute query and get results
     */
    public function get($limit = null, $offset = null) {
        if ($limit !== null) {
            $this->query .= " LIMIT " . (int)$limit;
            
            if ($offset !== null) {
                $this->query .= " OFFSET " . (int)$offset;
            }
        }
        
        $stmt = $this->pdo->prepare($this->query);
        $stmt->execute($this->bindings);
        
        return $stmt->fetchAll(PDO::FETCH_ASSOC);
    }
    
    /**
     * Get count of filtered results
     */
    public function count() {
        $countQuery = str_replace('SELECT *', 'SELECT COUNT(*) as count', $this->query);
        
        $stmt = $this->pdo->prepare($countQuery);
        $stmt->execute($this->bindings);
        
        return $stmt->fetchColumn();
    }
    
    /**
     * Add WHERE clause
     */
    private function addWhere($condition) {
        if (strpos($this->query, 'WHERE') === false) {
            $this->query .= " WHERE " . $condition;
        } else {
            $this->query .= " AND " . $condition;
        }
    }
    
    /**
     * Get allowed sort fields (security)
     */
    private function getAllowedSortFields() {
        // This should be customized per table
        return ['id', 'name', 'price', 'created_at', 'updated_at'];
    }
}

// ========================================
// USAGE EXAMPLE
// ========================================

// Build complex filter from user input
$filter = new DataFilter($pdo, 'products');

$results = $filter
    ->search(['name', 'description'], $_GET['q'] ?? '')
    ->whereIn('category_id', $_GET['categories'] ?? [])
    ->numberRange('price', $_GET['min_price'] ?? null, $_GET['max_price'] ?? null)
    ->dateRange('created_at', $_GET['from_date'] ?? null, $_GET['to_date'] ?? null)
    ->where('status', 'active')
    ->orderBy($_GET['sort'] ?? 'name', $_GET['order'] ?? 'ASC')
    ->get(20, (($_GET['page'] ?? 1) - 1) * 20);

// Get total count for pagination
$totalCount = $filter->count();</code></pre>
                                </div>
                            </section>
                            
                            <!-- Practice Exercise -->
                            <section>
                                <h2>Practice Exercise</h2>
                                
                                <div class="alert alert-success">
                                    <div class="alert-icon">ðŸ’»</div>
                                    <div class="alert-content">
                                        <div class="alert-title">Result Set Challenges</div>
                                        <div class="alert-message">
                                            Implement these features:
                                            <ol>
                                                <li>Build an infinite scroll pagination system</li>
                                                <li>Create a multi-column sortable table</li>
                                                <li>Implement faceted search with filters</li>
                                                <li>Build CSV/Excel export functionality</li>
                                                <li>Create a data grid with inline editing</li>
                                                <li>Implement real-time search suggestions</li>
                                                <li>Build a report generator with charts</li>
                                                <li>Create a batch processing system</li>
                                            </ol>
                                        </div>
                                    </div>
                                </div>
                            </section>
                            
                            <!-- Resources -->
                            <section class="resources">
                                <h2>Additional Resources</h2>
                                <ul>
                                    <li><a href="https://www.php.net/manual/en/pdostatement.fetch.php" target="_blank">PDO Fetch Documentation</a></li>
                                    <li><a href="https://phpdelusions.net/pdo/fetch_modes" target="_blank">PDO Fetch Modes Guide</a></li>
                                    <li><a href="https://www.php.net/manual/en/mysqli-result.fetch-array.php" target="_blank">MySQLi Result Methods</a></li>
                                    <li><a href="https://datatables.net/" target="_blank">DataTables jQuery Plugin</a></li>
                                </ul>
                            </section>
                        </div>

                        <!-- Lesson Navigation -->
                        <div class="lesson-navigation">
                            <a href="/03module/crud_operations.html" class="lesson-nav-button prev">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"/>
                                </svg>
                                <span>
                                    <small>Previous</small><br>
                                    CRUD Operations
                                </span>
                            </a>
                            
                            <button class="complete-lesson-btn">
                                Mark as Complete
                            </button>
                            
                            <a href="/03module/error_debugging.html" class="lesson-nav-button next">
                                <span>
                                    <small>Next</small><br>
                                    Error Handling
                                </span>
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                    <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/>
                                </svg>
                            </a>
                        </div>
                    </article>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="site-footer" role="contentinfo">
            <div class="footer-container">
                <div class="footer-content">
                    <div class="footer-section footer-about">
                        <h3>PHP WordPress Development</h3>
                        <p>Complete Web Development Course</p>
                    </div>
                    
                    <div class="footer-section">
                        <h4>Quick Links</h4>
                        <ul class="footer-links">
                            <li><a href="/">Home</a></li>
                            <li><a href="/module3.html">Module 3</a></li>
                            <li><a href="/resources.html">Resources</a></li>
                        </ul>
                    </div>
                    
                    <div class="footer-section">
                        <h4>Support</h4>
                        <ul class="footer-links">
                            <li><a href="/help.html">Help Center</a></li>
                            <li><a href="/faq.html">FAQ</a></li>
                            <li><a href="/contact.html">Contact</a></li>
                        </ul>
                    </div>
                </div>
                
                <div class="footer-bottom">
                    <div class="footer-bottom-content">
                        <p class="copyright">&copy; 2025 PHP WordPress Development Course</p>
                        <nav class="footer-bottom-links">
                            <a href="/privacy.html">Privacy</a>
                            <span class="separator">|</span>
                            <a href="/terms.html">Terms</a>
                        </nav>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Back to Top -->
    <button id="back-to-top" class="back-to-top" aria-label="Back to top">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 19V5M12 5l-7 7M12 5l7 7"/>
        </svg>
    </button>

    <!-- JavaScript -->
    <script src="/assets/js/navigation.js"></script>
    <script src="/assets/js/site-config.js"></script>
</body>
</html>