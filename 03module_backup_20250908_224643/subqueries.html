<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <!-- SEO Meta Tags -->
  <title>SQL Subqueries - Master Nested Queries - PHP WordPress Course</title>
  <meta content="Master SQL subqueries - scalar, row, table subqueries, correlated queries, EXISTS, and performance optimization" name="description"/>
  <meta content="PHP, WordPress, MySQL, subqueries, nested queries, correlated subqueries, EXISTS, IN" name="keywords"/>
  <meta content="PHP WordPress Course" name="author"/>
  <link href="/assets/css/main.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
  <!-- Favicon -->
  <link href="/favicon.png" rel="icon" type="image/png"/>
  <link href="/favicon.png" rel="apple-touch-icon"/>
  <!-- CSS -->
  <link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
 </head>
 <body>
  <!-- Skip to main content -->
  <a class="sr-only" href="#main-content">Skip to main content</a>
  <div class="page-wrapper">
   <!-- Header -->
   <header class="site-header" role="banner">
    <div class="header-container">
     <div class="site-branding">
      <a class="site-logo" href="/">
       <h1 class="site-title">PHP WordPress Development</h1>
      </a>
     </div>
     <nav aria-label="Main navigation" class="main-navigation" role="navigation">
      <button aria-expanded="false" aria-label="Toggle navigation" class="mobile-menu-btn">
       <span>
       </span>
       <span>
       </span>
       <span>
       </span>
      </button>
      <div class="nav-menu">
       <ul class="nav-list">
        <li class="nav-item">
         <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item dropdown">
         <button aria-haspopup="true" class="nav-link dropdown-toggle active">Modules</button>
         <div class="dropdown-menu">
          <a class="dropdown-item" href="/module1.html">Module 1: Web Fundamentals</a>
          <a class="dropdown-item" href="/module2.html">Module 2: PHP Fundamentals</a>
          <a class="dropdown-item active" href="/module3.html">Module 3: MySQL Database</a>
          <a class="dropdown-item" href="/module4.html">Module 4: WordPress &amp; Docker</a>
          <a class="dropdown-item" href="/module5.html">Module 5: Theme Development</a>
          <a class="dropdown-item" href="/module6.html">Module 6: Plugin Development</a>
          <a class="dropdown-item" href="/module7.html">Module 7: Advanced WordPress</a>
          <a class="dropdown-item" href="/module8.html">Module 8: Deployment</a>
          <a class="dropdown-item" href="/module9.html">Module 9: Final Project</a>
         </div>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/resources.html">Resources</a>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/about.html">About</a>
        </li>
       </ul>
      </div>
     </nav>
     <div class="search-container">
      <div class="search-input-wrapper">
       <svg class="search-icon" fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
        <path clip-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" fill-rule="evenodd">
        </path>
       </svg>
       <input aria-label="Search" class="search-input" placeholder="Search lessons..." type="search"/>
      </div>
      <div class="search-results">
      </div>
     </div>
    </div>
   </header>
   <!-- Progress Bar -->
   <div class="progress-container">
    <div class="progress-header">
     <h2 class="progress-title">Course Progress</h2>
     <span class="progress-text">Loading...</span>
    </div>
    <div class="progress-bar">
     <div class="progress-bar-fill">
      <span class="progress-bar-text">
      </span>
     </div>
    </div>
   </div>
   <!-- Breadcrumb -->
   <nav aria-label="Breadcrumb" class="breadcrumb container">
    <ol class="breadcrumb-list">
     <li class="breadcrumb-item">
      <a href="/">Home</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <a href="/module3.html">Module 3</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <span aria-current="page">Subqueries</span>
     </li>
    </ol>
   </nav>
   <!-- Main Content -->
   <main class="main-content" id="main-content" role="main">
    <div class="container">
     <div class="content-with-sidebar">
      <!-- Sidebar -->
      <aside class="sidebar">
       <div class="sidebar-nav">
        <h3 class="sidebar-title">Module 3: MySQL Database</h3>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 1: Introduction to Databases</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/03module/database_concepts_terminology.html">Database concepts and terminology</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/types_of_databases.html">Types of databases (relational vs. non-relational)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/introduction_to_mysql.html">Introduction to MySQL</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/mysql_xampp_mamp.html">MySQL in XAMPP/MAMP environment</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/using_phpmyadmin.html">Using phpMyAdmin</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/creating_databases_tables.html">Creating databases and tables</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/homework_database_schema.html">Homework: Create a database schema for a simple application</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 2: Database Design</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/03module/data_modeling_concepts.html">Data modeling concepts</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/entity_relationship_diagrams.html">Entity-Relationship diagrams</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/normalization_principles.html">Normalization principles (1NF, 2NF, 3NF)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/primary_foreign_keys.html">Primary keys and foreign keys</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/indexes_importance.html">Indexes and their importance</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/database_constraints.html">Database constraints</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/homework_database_design.html">Homework: Design a normalized database for an e-commerce website</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 3: SQL Fundamentals</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/03module/sql_syntax_conventions.html">SQL syntax and conventions</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/mysql_data_types.html">Data types in MySQL</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/database_structure_ddl.html">Creating and modifying database structures (CREATE, ALTER, DROP)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/insert_update_delete.html">Basic data manipulation (INSERT, UPDATE, DELETE)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/select_queries.html">Simple queries with SELECT</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/where_filtering.html">Filtering data with WHERE</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/order_by_sorting.html">Sorting results with ORDER BY</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/homework_sql_queries.html">Homework: Write SQL queries to manipulate data in your database</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 4: Advanced SQL</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/03module/sql_joins.html">Joins (INNER, LEFT, RIGHT, FULL)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/aggregate_functions.html">Aggregating data (COUNT, SUM, AVG, MIN, MAX)</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/group_by_having.html">Grouping data with GROUP BY</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/having_deep_dive.html">Filtering groups with HAVING</a>
          </li>
          <li class="active">
           <a class="sidebar-link active" href="/03module/subqueries.html">Subqueries</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/views.html">Views</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/transactions.html">Transactions</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/stored_procedures.html">Stored procedures and functions</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/homework_sql_queries.html">Homework: Write complex SQL queries with joins and aggregations</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Session 5: PHP and MySQL Integration</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/03module/connecting_mysql.html">Connecting to MySQL with PHP</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/executing_queries.html">Executing SQL queries through PHP</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/prepared_statements.html">Prepared statements and security concerns</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/crud_operations.html">CRUD operations in PHP applications</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/result_sets.html">Handling results sets</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/error_debugging.html">Error handling and debugging</a>
          </li>
          <li>
           <a class="sidebar-link" href="/03module/php_mysql_integration.html">Final Project: Build a complete data-driven PHP application with MySQL backend</a>
          </li>
         </ul>
        </div>
        <div class="sidebar-section">
         <h4 class="sidebar-section-title">Quick Links</h4>
         <ul class="sidebar-menu">
          <li>
           <a class="sidebar-link" href="/module3.html">Module Overview</a>
          </li>
          <li>
           <a class="sidebar-link prev-session" href="/module2.html">‚Üê Prev: Module 2</a>
          </li>
          <li>
           <a class="sidebar-link next-session" href="/module4.html">Next: Module 4 ‚Üí</a>
          </li>
          <li>
           <a class="sidebar-link" href="/resources.html">Resources</a>
          </li>
         </ul>
        </div>
       </div>
      </aside>
      <!-- Main Lesson Content -->
      <article class="lesson-content">
       <header class="lesson-header">
        <h1>Mastering SQL Subqueries</h1>
        <div class="lesson-meta">
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
           </path>
          </svg>
          <span>Duration: 90 minutes</span>
         </div>
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 14l9-5-9-5-9 5 9 5z">
           </path>
          </svg>
          <span>Module 3: Advanced SQL</span>
         </div>
        </div>
       </header>
       <!-- Learning Objectives -->
       <div class="lesson-objectives">
        <h2>Learning Objectives</h2>
        <ul>
         <li>Understand subquery fundamentals and types</li>
         <li>Master scalar, row, and table subqueries</li>
         <li>Use subqueries in SELECT, WHERE, FROM, and HAVING</li>
         <li>Implement correlated vs non-correlated subqueries</li>
         <li>Apply EXISTS, IN, ANY, ALL operators</li>
         <li>Convert between subqueries and JOINs</li>
         <li>Optimize subquery performance</li>
         <li>Handle complex nested query scenarios</li>
        </ul>
       </div>
       <!-- Lesson Body -->
       <div class="lesson-body">
        <section>
         <h2>Understanding Subqueries</h2>
         <p class="lead">Subqueries are queries within queries - powerful tools for complex data retrieval and filtering! üéØ</p>
         <canvas height="500" id="subqueryCanvas" width="600">
         </canvas>
         <script>const ctx = document.getElementById('subqueryCanvas').getContext('2d');
                                    
                                    // Title
                                    ctx.font = 'bold 18px Arial';
                                    ctx.fillStyle = '#1f2937';
                                    ctx.fillText('Subquery Types and Locations', 180, 30);
                                    
                                    // Main query box
                                    ctx.strokeStyle = '#6b7280';
                                    ctx.lineWidth = 2;
                                    ctx.strokeRect(50, 60, 500, 400);
                                    ctx.fillStyle = '#f3f4f6';
                                    ctx.fillRect(50, 60, 500, 400);
                                    
                                    ctx.fillStyle = '#1f2937';
                                    ctx.font = 'bold 14px Arial';
                                    ctx.fillText('Main Query Structure', 250, 85);
                                    
                                    // SELECT subquery
                                    ctx.fillStyle = '#dbeafe';
                                    ctx.fillRect(70, 100, 460, 60);
                                    ctx.strokeStyle = '#2563eb';
                                    ctx.strokeRect(70, 100, 460, 60);
                                    ctx.fillStyle = '#1e40af';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('SELECT clause', 80, 120);
                                    ctx.font = '10px Courier';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('SELECT column1, (SELECT MAX(price) FROM products) AS max_price', 80, 140);
                                    
                                    // FROM subquery
                                    ctx.fillStyle = '#dcfce7';
                                    ctx.fillRect(70, 170, 460, 60);
                                    ctx.strokeStyle = '#16a34a';
                                    ctx.strokeRect(70, 170, 460, 60);
                                    ctx.fillStyle = '#166534';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('FROM clause (Derived Table)', 80, 190);
                                    ctx.font = '10px Courier';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('FROM (SELECT * FROM orders WHERE status = "completed") AS completed_orders', 80, 210);
                                    
                                    // WHERE subquery
                                    ctx.fillStyle = '#fef3c7';
                                    ctx.fillRect(70, 240, 460, 60);
                                    ctx.strokeStyle = '#ca8a04';
                                    ctx.strokeRect(70, 240, 460, 60);
                                    ctx.fillStyle = '#92400e';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('WHERE clause', 80, 260);
                                    ctx.font = '10px Courier';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('WHERE customer_id IN (SELECT customer_id FROM vip_customers)', 80, 280);
                                    
                                    // HAVING subquery
                                    ctx.fillStyle = '#fee2e2';
                                    ctx.fillRect(70, 310, 460, 60);
                                    ctx.strokeStyle = '#dc2626';
                                    ctx.strokeRect(70, 310, 460, 60);
                                    ctx.fillStyle = '#991b1b';
                                    ctx.font = 'bold 12px Arial';
                                    ctx.fillText('HAVING clause', 80, 330);
                                    ctx.font = '10px Courier';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('HAVING AVG(amount) >(SELECT AVG(amount) FROM all_orders)', 80, 350);
                                    
                                    // Subquery types
                                    ctx.fillStyle = '#e9d5ff';
                                    ctx.fillRect(70, 380, 140, 70);
                                    ctx.strokeStyle = '#7c3aed';
                                    ctx.strokeRect(70, 380, 140, 70);
                                    ctx.fillStyle = '#6b21a8';
                                    ctx.font = 'bold 11px Arial';
                                    ctx.fillText('Scalar', 120, 400);
                                    ctx.font = '9px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('Returns 1 value', 85, 420);
                                    ctx.fillText('1 row, 1 column', 85, 435);
                                    
                                    ctx.fillStyle = '#e0f2fe';
                                    ctx.fillRect(230, 380, 140, 70);
                                    ctx.strokeStyle = '#0891b2';
                                    ctx.strokeRect(230, 380, 140, 70);
                                    ctx.fillStyle = '#0c4a6e';
                                    ctx.font = 'bold 11px Arial';
                                    ctx.fillText('Row', 285, 400);
                                    ctx.font = '9px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('Returns 1 row', 250, 420);
                                    ctx.fillText('Multiple columns', 245, 435);
                                    
                                    ctx.fillStyle = '#fce7f3';
                                    ctx.fillRect(390, 380, 140, 70);
                                    ctx.strokeStyle = '#be185d';
                                    ctx.strokeRect(390, 380, 140, 70);
                                    ctx.fillStyle = '#9f1239';
                                    ctx.font = 'bold 11px Arial';
                                    ctx.fillText('Table', 440, 400);
                                    ctx.font = '9px Arial';
                                    ctx.fillStyle = '#374151';
                                    ctx.fillText('Returns table', 410, 420);
                                    ctx.fillText('Multiple rows/cols', 400, 435);</script>
         <div class="alert alert-info">
          <div class="alert-icon">üí°</div>
          <div class="alert-content">
           <div class="alert-title">Subquery Key Concepts</div>
           <div class="alert-message">
            <ul>
             <li>
              <strong>Scalar Subquery:</strong>Returns exactly one value (one row, one column)</li>
             <li>
              <strong>Row Subquery:</strong>Returns one row with multiple columns</li>
             <li>
              <strong>Table Subquery:</strong>Returns multiple rows and columns</li>
             <li>
              <strong>Correlated:</strong>References outer query columns</li>
             <li>
              <strong>Non-correlated:</strong>Independent of outer query</li>
             <li>Subqueries execute for each row (correlated) or once (non-correlated)</li>
            </ul>
           </div>
          </div>
         </div>
        </section>
        <section>
         <h2>Scalar Subqueries</h2>
         <div class="mermaid">graph TB
                                        SCALAR[Scalar Subquery] --&gt; SINGLE[Single Value]
                                        SINGLE --&gt; SELECT[In SELECT]
                                        SINGLE --&gt; WHERE[In WHERE]
                                        SINGLE --&gt; HAVING[In HAVING]
                                        
                                        SELECT --&gt; S1[Column calculation]
                                        WHERE --&gt; W1[Comparison operator]
                                        HAVING --&gt; H1[Aggregate comparison]
                                        
                                        style SCALAR fill:#dcfce7
                                        style SINGLE fill:#dbeafe
                                        style SELECT fill:#fef3c7</div>
         <div class="real_world_example">
          <h3>Scalar Subquery Examples</h3>
          <pre><code class="language-sql">-- ========================================
-- SCALAR SUBQUERIES IN SELECT
-- ========================================

-- Add overall average to each row
SELECT 
    product_name,
    price,
    (SELECT AVG(price) FROM products) AS avg_price,
    price - (SELECT AVG(price) FROM products) AS diff_from_avg
FROM products;

-- Get latest order for each customer
SELECT 
    c.customer_id,
    c.customer_name,
    (
        SELECT MAX(order_date)
        FROM orders o
        WHERE o.customer_id = c.customer_id
    ) AS last_order_date,
    (
        SELECT COUNT(*)
        FROM orders o
        WHERE o.customer_id = c.customer_id
    ) AS total_orders
FROM customers c;

-- Calculate percentage of total
SELECT 
    category,
    SUM(price) AS category_total,
    ROUND(
        SUM(price) * 100.0 / (SELECT SUM(price) FROM products),
        2
    ) AS percent_of_total
FROM products
GROUP BY category;

-- ========================================
-- SCALAR SUBQUERIES IN WHERE
-- ========================================

-- Find products above average price
SELECT *
FROM products
WHERE price &gt; (SELECT AVG(price) FROM products);

-- Find most recent order
SELECT *
FROM orders
WHERE order_date = (SELECT MAX(order_date) FROM orders);

-- Find customers with above-average orders
SELECT *
FROM customers
WHERE (
    SELECT AVG(amount)
    FROM orders
    WHERE customer_id = customers.customer_id
) &gt; (
    SELECT AVG(amount) FROM orders
);

-- ========================================
-- SCALAR SUBQUERIES IN HAVING
-- ========================================

-- Groups with above-average aggregates
SELECT 
    category,
    AVG(price) AS avg_price
FROM products
GROUP BY category
HAVING AVG(price) &gt; (
    SELECT AVG(price) FROM products
);

-- ========================================
-- SCALAR SUBQUERIES WITH CASE
-- ========================================

SELECT 
    product_name,
    price,
    CASE 
        WHEN price &gt; (SELECT AVG(price) * 1.5 FROM products) THEN 'Premium'
        WHEN price &gt; (SELECT AVG(price) FROM products) THEN 'Above Average'
        WHEN price &gt; (SELECT AVG(price) * 0.5 FROM products) THEN 'Below Average'
        ELSE 'Budget'
    END AS price_tier
FROM products;

-- ========================================
-- ERROR HANDLING IN SCALAR SUBQUERIES
-- ========================================

-- This will error if subquery returns multiple rows
-- SELECT * FROM products
-- WHERE price = (SELECT price FROM products);  -- Error!

-- Fix with aggregate
SELECT * FROM products
WHERE price = (SELECT MAX(price) FROM products);

-- Or use IN for multiple values
SELECT * FROM products
WHERE price IN (SELECT price FROM products WHERE category = 'Electronics');</code></pre>
         </div>
        </section>
        <section>
         <h2>Row and Table Subqueries</h2>
         <canvas height="350" id="tableSubqueryCanvas" width="600">
         </canvas>
         <script>const tCtx = document.getElementById('tableSubqueryCanvas').getContext('2d');
                                    
                                    // Title
                                    tCtx.font = 'bold 16px Arial';
                                    tCtx.fillStyle = '#1f2937';
                                    tCtx.fillText('Row vs Table Subqueries', 200, 30);
                                    
                                    // Row subquery
                                    tCtx.fillStyle = '#dbeafe';
                                    tCtx.fillRect(50, 60, 250, 120);
                                    tCtx.strokeStyle = '#2563eb';
                                    tCtx.lineWidth = 2;
                                    tCtx.strokeRect(50, 60, 250, 120);
                                    
                                    tCtx.fillStyle = '#1e40af';
                                    tCtx.font = 'bold 12px Arial';
                                    tCtx.fillText('Row Subquery', 130, 80);
                                    
                                    tCtx.fillStyle = '#374151';
                                    tCtx.font = '10px Arial';
                                    tCtx.fillText('Returns: 1 row, multiple columns', 60, 100);
                                    
                                    tCtx.font = '9px Courier';
                                    tCtx.fillText('(col1, col2) = ', 60, 120);
                                    tCtx.fillText('  (SELECT col1, col2 ', 60, 135);
                                    tCtx.fillText('   FROM table ', 60, 150);
                                    tCtx.fillText('   WHERE condition)', 60, 165);
                                    
                                    // Table subquery
                                    tCtx.fillStyle = '#dcfce7';
                                    tCtx.fillRect(320, 60, 250, 120);
                                    tCtx.strokeStyle = '#16a34a';
                                    tCtx.strokeRect(320, 60, 250, 120);
                                    
                                    tCtx.fillStyle = '#166534';
                                    tCtx.font = 'bold 12px Arial';
                                    tCtx.fillText('Table Subquery', 390, 80);
                                    
                                    tCtx.fillStyle = '#374151';
                                    tCtx.font = '10px Arial';
                                    tCtx.fillText('Returns: Multiple rows/columns', 330, 100);
                                    
                                    tCtx.font = '9px Courier';
                                    tCtx.fillText('FROM (SELECT * ', 330, 120);
                                    tCtx.fillText('      FROM table ', 330, 135);
                                    tCtx.fillText('      WHERE condition) ', 330, 150);
                                    tCtx.fillText('      AS derived_table', 330, 165);
                                    
                                    // Use cases
                                    tCtx.fillStyle = '#fef3c7';
                                    tCtx.fillRect(50, 200, 520, 130);
                                    tCtx.strokeStyle = '#ca8a04';
                                    tCtx.strokeRect(50, 200, 520, 130);
                                    
                                    tCtx.fillStyle = '#92400e';
                                    tCtx.font = 'bold 12px Arial';
                                    tCtx.fillText('Common Use Cases', 250, 220);
                                    
                                    tCtx.fillStyle = '#374151';
                                    tCtx.font = '10px Arial';
                                    
                                    // Row subquery uses
                                    tCtx.fillText('Row Subquery Uses:', 60, 240);
                                    tCtx.fillText('‚Ä¢ Multi-column comparisons', 60, 255);
                                    tCtx.fillText('‚Ä¢ Finding exact matches', 60, 270);
                                    tCtx.fillText('‚Ä¢ Row constructors', 60, 285);
                                    
                                    // Table subquery uses
                                    tCtx.fillText('Table Subquery Uses:', 330, 240);
                                    tCtx.fillText('‚Ä¢ Derived tables in FROM', 330, 255);
                                    tCtx.fillText('‚Ä¢ Complex aggregations', 330, 270);
                                    tCtx.fillText('‚Ä¢ Data transformation', 330, 285);
                                    tCtx.fillText('‚Ä¢ Temporary result sets', 330, 300);</script>
         <div class="best_practice">
          <h3>Row and Table Subquery Examples</h3>
          <pre><code class="language-sql">-- ========================================
-- ROW SUBQUERIES
-- ========================================

-- Multi-column comparison
SELECT *
FROM orders
WHERE (customer_id, order_date) = (
    SELECT customer_id, MAX(order_date)
    FROM orders
    GROUP BY customer_id
    LIMIT 1
);

-- Find matching row combinations
SELECT *
FROM products p1
WHERE (category, price) IN (
    SELECT category, MAX(price)
    FROM products
    GROUP BY category
);

-- Row constructor comparison
SELECT *
FROM employees
WHERE (department, salary) = (
    SELECT department, MAX(salary)
    FROM employees
    WHERE department = 'Sales'
);

-- ========================================
-- TABLE SUBQUERIES (Derived Tables)
-- ========================================

-- Subquery in FROM clause
SELECT 
    category,
    avg_price,
    product_count
FROM (
    SELECT 
        category,
        AVG(price) AS avg_price,
        COUNT(*) AS product_count
    FROM products
    GROUP BY category
) AS category_stats
WHERE avg_price &gt; 100;

-- Multiple derived tables
SELECT 
    c.customer_name,
    os.total_orders,
    os.total_spent,
    rs.review_count
FROM customers c
JOIN (
    SELECT 
        customer_id,
        COUNT(*) AS total_orders,
        SUM(amount) AS total_spent
    FROM orders
    WHERE status = 'completed'
    GROUP BY customer_id
) AS os ON c.customer_id = os.customer_id
LEFT JOIN (
    SELECT 
        user_id AS customer_id,
        COUNT(*) AS review_count
    FROM reviews
    GROUP BY user_id
) AS rs ON c.customer_id = rs.customer_id;

-- ========================================
-- LATERAL DERIVED TABLES (MySQL 8.0.14+)
-- ========================================

-- LATERAL allows derived table to reference preceding tables
SELECT 
    c.customer_name,
    recent_orders.*
FROM customers c
CROSS JOIN LATERAL (
    SELECT 
        COUNT(*) AS order_count,
        SUM(amount) AS total_amount,
        MAX(order_date) AS last_order
    FROM orders o
    WHERE o.customer_id = c.customer_id
        AND o.order_date &gt;= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
) AS recent_orders;

-- ========================================
-- COMPLEX TABLE SUBQUERIES
-- ========================================

-- Ranking within groups using derived table
SELECT *
FROM (
    SELECT 
        product_id,
        product_name,
        category,
        price,
        ROW_NUMBER() OVER (PARTITION BY category ORDER BY price DESC) AS price_rank
    FROM products
) AS ranked_products
WHERE price_rank &lt;= 3;

-- Pivoting data with derived tables
SELECT 
    customer_id,
    MAX(CASE WHEN month = 1 THEN revenue END) AS jan_revenue,
    MAX(CASE WHEN month = 2 THEN revenue END) AS feb_revenue,
    MAX(CASE WHEN month = 3 THEN revenue END) AS mar_revenue
FROM (
    SELECT 
        customer_id,
        MONTH(order_date) AS month,
        SUM(amount) AS revenue
    FROM orders
    WHERE YEAR(order_date) = 2024
    GROUP BY customer_id, MONTH(order_date)
) AS monthly_revenue
GROUP BY customer_id;</code></pre>
         </div>
        </section>
        <section>
         <h2>Correlated vs Non-Correlated Subqueries</h2>
         <canvas height="400" id="correlatedCanvas" width="600">
         </canvas>
         <script>const cCtx = document.getElementById('correlatedCanvas').getContext('2d');
                                    
                                    // Title
                                    cCtx.font = 'bold 16px Arial';
                                    cCtx.fillStyle = '#1f2937';
                                    cCtx.fillText('Correlated vs Non-Correlated Execution', 150, 30);
                                    
                                    // Non-correlated
                                    cCtx.fillStyle = '#dcfce7';
                                    cCtx.fillRect(50, 60, 250, 150);
                                    cCtx.strokeStyle = '#16a34a';
                                    cCtx.lineWidth = 2;
                                    cCtx.strokeRect(50, 60, 250, 150);
                                    
                                    cCtx.fillStyle = '#166534';
                                    cCtx.font = 'bold 12px Arial';
                                    cCtx.fillText('Non-Correlated', 130, 80);
                                    
                                    cCtx.fillStyle = '#374151';
                                    cCtx.font = '10px Arial';
                                    cCtx.fillText('‚úì Executes once', 60, 100);
                                    cCtx.fillText('‚úì Independent of outer query', 60, 115);
                                    cCtx.fillText('‚úì Can run standalone', 60, 130);
                                    cCtx.fillText('‚úì Usually faster', 60, 145);
                                    cCtx.fillText('‚úì Cached result', 60, 160);
                                    
                                    cCtx.font = '9px Courier';
                                    cCtx.fillStyle = '#059669';
                                    cCtx.fillText('WHERE price >(SELECT AVG(price)', 60, 180);
                                    cCtx.fillText('               FROM products)', 60, 195);
                                    
                                    // Correlated
                                    cCtx.fillStyle = '#fee2e2';
                                    cCtx.fillRect(320, 60, 250, 150);
                                    cCtx.strokeStyle = '#dc2626';
                                    cCtx.strokeRect(320, 60, 250, 150);
                                    
                                    cCtx.fillStyle = '#991b1b';
                                    cCtx.font = 'bold 12px Arial';
                                    cCtx.fillText('Correlated', 410, 80);
                                    
                                    cCtx.fillStyle = '#374151';
                                    cCtx.font = '10px Arial';
                                    cCtx.fillText('√ó Executes per outer row', 330, 100);
                                    cCtx.fillText('√ó References outer query', 330, 115);
                                    cCtx.fillText('√ó Cannot run standalone', 330, 130);
                                    cCtx.fillText('√ó Often slower', 330, 145);
                                    cCtx.fillText('√ó Re-executes each time', 330, 160);
                                    
                                    cCtx.font = '9px Courier';
                                    cCtx.fillStyle = '#dc2626';
                                    cCtx.fillText('WHERE price >(SELECT AVG(price)', 330, 180);
                                    cCtx.fillText('  FROM products p2', 330, 195);
                                    cCtx.fillText('  WHERE p2.category = p1.category)', 330, 210);
                                    
                                    // Execution flow
                                    cCtx.fillStyle = '#fef3c7';
                                    cCtx.fillRect(50, 230, 520, 150);
                                    cCtx.strokeStyle = '#ca8a04';
                                    cCtx.strokeRect(50, 230, 520, 150);
                                    
                                    cCtx.fillStyle = '#92400e';
                                    cCtx.font = 'bold 12px Arial';
                                    cCtx.fillText('Execution Patterns', 250, 250);
                                    
                                    // Draw execution flow
                                    cCtx.strokeStyle = '#6b7280';
                                    cCtx.lineWidth = 1;
                                    
                                    // Non-correlated flow
                                    cCtx.fillStyle = '#059669';
                                    cCtx.font = '10px Arial';
                                    cCtx.fillText('Non-Correlated:', 60, 270);
                                    cCtx.fillText('1. Execute subquery once', 60, 285);
                                    cCtx.fillText('2. Cache result', 60, 300);
                                    cCtx.fillText('3. Use for all outer rows', 60, 315);
                                    
                                    // Correlated flow
                                    cCtx.fillStyle = '#dc2626';
                                    cCtx.fillText('Correlated:', 330, 270);
                                    cCtx.fillText('For each outer row:', 330, 285);
                                    cCtx.fillText('  1. Pass values to subquery', 330, 300);
                                    cCtx.fillText('  2. Execute subquery', 330, 315);
                                    cCtx.fillText('  3. Return result', 330, 330);
                                    cCtx.fillText('  4. Repeat for next row', 330, 345);</script>
         <div class="homework">
          <h3>Correlated Subquery Examples</h3>
          <pre><code class="language-sql">-- ========================================
-- CORRELATED SUBQUERIES
-- ========================================

-- Find products priced above their category average
SELECT 
    p1.product_name,
    p1.category,
    p1.price,
    (
        SELECT AVG(price)
        FROM products p2
        WHERE p2.category = p1.category
    ) AS category_avg
FROM products p1
WHERE p1.price &gt; (
    SELECT AVG(price)
    FROM products p2
    WHERE p2.category = p1.category
);

-- Find customers' most expensive order
SELECT 
    c.customer_name,
    (
        SELECT MAX(o.amount)
        FROM orders o
        WHERE o.customer_id = c.customer_id
    ) AS max_order,
    (
        SELECT o.order_date
        FROM orders o
        WHERE o.customer_id = c.customer_id
            AND o.amount = (
                SELECT MAX(o2.amount)
                FROM orders o2
                WHERE o2.customer_id = c.customer_id
            )
        LIMIT 1
    ) AS max_order_date
FROM customers c;

-- ========================================
-- EXISTS WITH CORRELATED SUBQUERY
-- ========================================

-- Find customers who have ordered in last 30 days
SELECT c.*
FROM customers c
WHERE EXISTS (
    SELECT 1
    FROM orders o
    WHERE o.customer_id = c.customer_id
        AND o.order_date &gt;= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
);

-- Find products never ordered
SELECT p.*
FROM products p
WHERE NOT EXISTS (
    SELECT 1
    FROM order_items oi
    WHERE oi.product_id = p.product_id
);

-- ========================================
-- IN vs EXISTS Performance
-- ========================================

-- Using IN (non-correlated)
SELECT *
FROM customers
WHERE customer_id IN (
    SELECT DISTINCT customer_id
    FROM orders
    WHERE amount &gt; 1000
);

-- Using EXISTS (correlated) - often faster for large datasets
SELECT *
FROM customers c
WHERE EXISTS (
    SELECT 1
    FROM orders o
    WHERE o.customer_id = c.customer_id
        AND o.amount &gt; 1000
);

-- ========================================
-- ANY, ALL, SOME Operators
-- ========================================

-- Products cheaper than all products in 'Electronics'
SELECT *
FROM products
WHERE price &lt; ALL (
    SELECT price
    FROM products
    WHERE category = 'Electronics'
);

-- Products more expensive than any product in 'Books'
SELECT *
FROM products
WHERE price &gt; ANY (
    SELECT price
    FROM products
    WHERE category = 'Books'
);

-- Customers who spent more than any single order average
SELECT 
    c.customer_id,
    c.customer_name,
    SUM(o.amount) AS total_spent
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id
HAVING SUM(o.amount) &gt; ANY (
    SELECT AVG(amount)
    FROM orders
    GROUP BY customer_id
);</code></pre>
         </div>
        </section>
        <section>
         <h2>Subquery vs JOIN Conversion</h2>
         <div class="alert alert-warning">
          <div class="alert-icon">‚ö†Ô∏è</div>
          <div class="alert-content">
           <div class="alert-title">Performance Consideration</div>
           <div class="alert-message">Many subqueries can be rewritten as JOINs for better performance. However, some patterns are clearer with subqueries.</div>
          </div>
         </div>
         <div class="real_world_example">
          <h3>Converting Between Subqueries and JOINs</h3>
          <pre><code class="language-sql">-- ========================================
-- SUBQUERY TO JOIN CONVERSIONS
-- ========================================

-- Example 1: IN Subquery to JOIN
-- Subquery version
SELECT *
FROM customers
WHERE customer_id IN (
    SELECT customer_id
    FROM orders
    WHERE amount &gt; 1000
);

-- JOIN version (often faster)
SELECT DISTINCT c.*
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id
WHERE o.amount &gt; 1000;

-- ========================================

-- Example 2: NOT IN to LEFT JOIN
-- Subquery version
SELECT *
FROM products
WHERE product_id NOT IN (
    SELECT product_id
    FROM order_items
);

-- JOIN version (handles NULLs better)
SELECT p.*
FROM products p
LEFT JOIN order_items oi ON p.product_id = oi.product_id
WHERE oi.product_id IS NULL;

-- ========================================

-- Example 3: Correlated subquery to JOIN
-- Subquery version
SELECT 
    c.customer_name,
    (SELECT COUNT(*) FROM orders o WHERE o.customer_id = c.customer_id) AS order_count
FROM customers c;

-- JOIN version
SELECT 
    c.customer_name,
    COUNT(o.order_id) AS order_count
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id;

-- ========================================

-- Example 4: EXISTS to JOIN
-- Subquery version
SELECT c.*
FROM customers c
WHERE EXISTS (
    SELECT 1
    FROM orders o
    WHERE o.customer_id = c.customer_id
        AND o.status = 'pending'
);

-- JOIN version
SELECT DISTINCT c.*
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id
WHERE o.status = 'pending';

-- ========================================
-- WHEN TO USE SUBQUERIES vs JOINS
-- ========================================

-- Use SUBQUERY when:
-- 1. Need a single aggregate value
SELECT 
    product_name,
    price,
    price - (SELECT AVG(price) FROM products) AS diff_from_avg
FROM products;

-- 2. Checking existence without needing data
SELECT *
FROM customers c
WHERE NOT EXISTS (
    SELECT 1 FROM orders o 
    WHERE o.customer_id = c.customer_id
);

-- 3. Complex filtering conditions
SELECT *
FROM orders
WHERE amount &gt; (
    SELECT AVG(amount) * 1.5
    FROM orders
    WHERE order_date &gt;= DATE_SUB(CURDATE(), INTERVAL 30 DAY)
);

-- Use JOIN when:
-- 1. Need multiple columns from related table
SELECT 
    c.customer_name,
    o.order_id,
    o.amount
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id;

-- 2. Performance is critical with large datasets
-- 3. Need to aggregate across relationships</code></pre>
         </div>
        </section>
        <section>
         <h2>Advanced Subquery Patterns</h2>
         <div class="best_practice">
          <h3>Complex Subquery Patterns</h3>
          <pre><code class="language-sql">-- ========================================
-- NESTED SUBQUERIES
-- ========================================

-- Multiple levels of nesting
SELECT *
FROM products
WHERE category IN (
    SELECT category
    FROM categories
    WHERE parent_category_id IN (
        SELECT category_id
        FROM categories
        WHERE category_name = 'Electronics'
    )
);

-- ========================================
-- SUBQUERIES WITH WINDOW FUNCTIONS
-- ========================================

-- Top N per group using subquery
SELECT *
FROM (
    SELECT 
        *,
        RANK() OVER (PARTITION BY category ORDER BY price DESC) AS price_rank
    FROM products
) AS ranked
WHERE price_rank &lt;= 3;

-- ========================================
-- RECURSIVE SUBQUERIES (CTEs)
-- ========================================

WITH RECURSIVE category_tree AS (
    -- Base case: root categories
    SELECT 
        category_id,
        category_name,
        parent_category_id,
        0 AS level,
        category_name AS path
    FROM categories
    WHERE parent_category_id IS NULL
    
    UNION ALL
    
    -- Recursive case
    SELECT 
        c.category_id,
        c.category_name,
        c.parent_category_id,
        ct.level + 1,
        CONCAT(ct.path, ' &gt; ', c.category_name)
    FROM categories c
    INNER JOIN category_tree ct ON c.parent_category_id = ct.category_id
)
SELECT * FROM category_tree;

-- ========================================
-- SUBQUERY OPTIMIZATION TECHNIQUES
-- ========================================

-- 1. Push conditions into subquery
-- Bad: Filters after subquery
SELECT *
FROM (
    SELECT * FROM orders
) AS o
WHERE status = 'completed';

-- Good: Filters in subquery
SELECT *
FROM (
    SELECT * FROM orders WHERE status = 'completed'
) AS o;

-- 2. Use EXISTS instead of IN for large lists
-- Less efficient with large results
SELECT *
FROM customers
WHERE customer_id IN (
    SELECT customer_id FROM orders WHERE amount &gt; 1000
);

-- More efficient
SELECT *
FROM customers c
WHERE EXISTS (
    SELECT 1 FROM orders o 
    WHERE o.customer_id = c.customer_id AND o.amount &gt; 1000
);

-- 3. Materialize frequently used subqueries
CREATE TEMPORARY TABLE high_value_customers AS
SELECT customer_id
FROM orders
GROUP BY customer_id
HAVING SUM(amount) &gt; 10000;

SELECT c.*
FROM customers c
INNER JOIN high_value_customers hvc ON c.customer_id = hvc.customer_id;

-- ========================================
-- SUBQUERY ERROR HANDLING
-- ========================================

-- Handle potential NULL issues
-- Problem: NULL in NOT IN
SELECT *
FROM products
WHERE category NOT IN (
    SELECT category FROM discontinued_categories
    -- If any category is NULL, entire query returns no rows!
);

-- Solution: Filter NULLs
SELECT *
FROM products
WHERE category NOT IN (
    SELECT category 
    FROM discontinued_categories 
    WHERE category IS NOT NULL
);

-- Or use NOT EXISTS (NULL-safe)
SELECT p.*
FROM products p
WHERE NOT EXISTS (
    SELECT 1 
    FROM discontinued_categories dc 
    WHERE dc.category = p.category
);</code></pre>
         </div>
        </section>
        <!-- Practice Exercise -->
        <section>
         <h2>Practice Exercise</h2>
         <div class="alert alert-success">
          <div class="alert-icon">üíª</div>
          <div class="alert-content">
           <div class="alert-title">Subquery Challenges</div>
           <div class="alert-message">Solve these complex subquery scenarios:<ol>
             <li>Find products that are the most expensive in their category</li>
             <li>List customers whose average order exceeds the overall average by 50%</li>
             <li>Find all manager-subordinate relationships (recursive)</li>
             <li>Identify customers who ordered every product in a category</li>
             <li>Calculate running totals using subqueries (not window functions)</li>
             <li>Find the second highest salary in each department</li>
             <li>Detect duplicate orders (same customer, date, amount)</li>
             <li>Build a percentile ranking system using subqueries</li>
            </ol>
           </div>
          </div>
         </div>
         <details>
          <summary>üí° Click for Solutions</summary>
          <pre><code class="language-sql">-- 1. Most expensive products in their category
SELECT p1.*
FROM products p1
WHERE p1.price = (
    SELECT MAX(p2.price)
    FROM products p2
    WHERE p2.category = p1.category
);

-- Alternative with row subquery
SELECT *
FROM products
WHERE (category, price) IN (
    SELECT category, MAX(price)
    FROM products
    GROUP BY category
);

-- 2. Customers with 50% above average orders
SELECT 
    c.*,
    (
        SELECT AVG(amount)
        FROM orders
        WHERE customer_id = c.customer_id
    ) AS customer_avg
FROM customers c
WHERE (
    SELECT AVG(amount)
    FROM orders
    WHERE customer_id = c.customer_id
) &gt; (
    SELECT AVG(amount) * 1.5
    FROM orders
);

-- 3. Manager-subordinate relationships (recursive)
WITH RECURSIVE org_chart AS (
    SELECT 
        employee_id,
        employee_name,
        manager_id,
        0 AS level,
        employee_name AS reporting_chain
    FROM employees
    WHERE manager_id IS NULL
    
    UNION ALL
    
    SELECT 
        e.employee_id,
        e.employee_name,
        e.manager_id,
        oc.level + 1,
        CONCAT(oc.reporting_chain, ' &gt; ', e.employee_name)
    FROM employees e
    INNER JOIN org_chart oc ON e.manager_id = oc.employee_id
)
SELECT * FROM org_chart;

-- 4. Customers who ordered every product in a category
SELECT c.*
FROM customers c
WHERE NOT EXISTS (
    SELECT p.product_id
    FROM products p
    WHERE p.category = 'Electronics'
    AND NOT EXISTS (
        SELECT 1
        FROM orders o
        JOIN order_items oi ON o.order_id = oi.order_id
        WHERE o.customer_id = c.customer_id
        AND oi.product_id = p.product_id
    )
);

-- 5. Running totals using subqueries
SELECT 
    order_date,
    amount,
    (
        SELECT SUM(amount)
        FROM orders o2
        WHERE o2.order_date &lt;= o1.order_date
            AND o2.customer_id = o1.customer_id
    ) AS running_total
FROM orders o1
WHERE customer_id = 123
ORDER BY order_date;

-- 6. Second highest salary in each department
SELECT 
    department,
    (
        SELECT DISTINCT salary
        FROM employees e2
        WHERE e2.department = e1.department
        ORDER BY salary DESC
        LIMIT 1 OFFSET 1
    ) AS second_highest_salary
FROM employees e1
GROUP BY department;

-- Alternative approach
SELECT department, MAX(salary) AS second_highest
FROM employees e1
WHERE salary &lt; (
    SELECT MAX(salary)
    FROM employees e2
    WHERE e2.department = e1.department
)
GROUP BY department;

-- 7. Detect duplicate orders
SELECT o1.*
FROM orders o1
WHERE EXISTS (
    SELECT 1
    FROM orders o2
    WHERE o2.customer_id = o1.customer_id
        AND DATE(o2.order_date) = DATE(o1.order_date)
        AND o2.amount = o1.amount
        AND o2.order_id != o1.order_id
);

-- 8. Percentile ranking using subqueries
SELECT 
    product_id,
    product_name,
    price,
    (
        SELECT COUNT(*)
        FROM products p2
        WHERE p2.price &lt;= p1.price
    ) * 100.0 / (SELECT COUNT(*) FROM products) AS percentile_rank
FROM products p1
ORDER BY price;

-- More precise percentile calculation
SELECT 
    product_name,
    price,
    ROUND(
        (
            SELECT COUNT(DISTINCT price)
            FROM products p2
            WHERE p2.price &lt; p1.price
        ) * 100.0 / (
            SELECT COUNT(DISTINCT price)
            FROM products
        ),
        2
    ) AS percentile
FROM products p1
ORDER BY price;</code></pre>
         </details>
        </section>
        <!-- Resources -->
        <section class="resources">
         <h2>Additional Resources</h2>
         <ul>
          <li>
           <a href="https://dev.mysql.com/doc/refman/8.0/en/subqueries.html" target="_blank">MySQL Subquery Documentation</a>
          </li>
          <li>
           <a href="https://dev.mysql.com/doc/refman/8.0/en/correlated-subqueries.html" target="_blank">Correlated Subqueries</a>
          </li>
          <li>
           <a href="https://www.mysqltutorial.org/mysql-subquery/" target="_blank">MySQL Subquery Tutorial</a>
          </li>
          <li>
           <a href="https://use-the-index-luke.com/sql/where-clause/subqueries" target="_blank">Subquery Performance</a>
          </li>
          <li>
           <a href="https://modern-sql.com/feature/with" target="_blank">Common Table Expressions (CTEs)</a>
          </li>
         </ul>
        </section>
       </div>
       <!-- Lesson Navigation -->
       <div class="lesson-navigation">
        <a class="lesson-nav-button prev" href="/03module/group_by_having.html">
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z">
          </path>
         </svg>
         <span>
          <small>Previous</small>
          <br/>GROUP BY &amp; HAVING</span>
        </a>
        <button class="complete-lesson-btn">Mark as Complete</button>
        <a class="lesson-nav-button next" href="/03module/window_functions.html">
         <span>
          <small>Next</small>
          <br/>Window Functions</span>
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z">
          </path>
         </svg>
        </a>
       </div>
      </article>
     </div>
    </div>
   </main>
   <!-- Footer -->
   <footer class="site-footer" role="contentinfo">
    <div class="footer-container">
     <div class="footer-content">
      <div class="footer-section footer-about">
       <h3>PHP WordPress Development</h3>
       <p>Complete Web Development Course</p>
      </div>
      <div class="footer-section">
       <h4>Quick Links</h4>
       <ul class="footer-links">
        <li>
         <a href="/">Home</a>
        </li>
        <li>
         <a class="active" href="/module3.html">Module 3</a>
        </li>
        <li>
         <a href="/resources.html">Resources</a>
        </li>
       </ul>
      </div>
      <div class="footer-section">
       <h4>Support</h4>
       <ul class="footer-links">
        <li>
         <a href="/help.html">Help Center</a>
        </li>
        <li>
         <a href="/faq.html">FAQ</a>
        </li>
        <li>
         <a href="/contact.html">Contact</a>
        </li>
       </ul>
      </div>
     </div>
     <div class="footer-bottom">
      <div class="footer-bottom-content">
       <p class="copyright">¬© 2025 PHP WordPress Development Course</p>
       <nav class="footer-bottom-links">
        <a href="/privacy.html">Privacy</a>
        <span class="separator">|</span>
        <a href="/terms.html">Terms</a>
       </nav>
      </div>
     </div>
    </div>
   </footer>
  </div>
  <!-- Back to Top -->
  <button aria-label="Back to top" class="back-to-top" id="back-to-top">
   <svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24">
    <path d="M12 19V5M12 5l-7 7M12 5l7 7">
    </path>
   </svg>
  </button>
  <!-- JavaScript -->
  <script src="/assets/js/navigation.js">
  </script>
  <script src="/assets/js/site-config.js">
  </script>
  <script src="/assets/js/sidebar-toggle.js">
  </script>
  <!-- Universal Mermaid Fix (Enhanced) -->
  <!-- Universal Mermaid Fix -->
  <script src="/assets/js/mermaid-universal-fix.js">
  </script>
 </body>
</html>
