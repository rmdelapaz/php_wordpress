<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta content="ie=edge" http-equiv="X-UA-Compatible"/>
  <!-- SEO Meta Tags -->
  <title>The WordPress Loop - PHP WordPress Course</title>
  <meta content="Master the WordPress Loop - the core mechanism for displaying posts, pages, and custom content in WordPress themes" name="description"/>
  <meta content="PHP, WordPress, Loop, have_posts, the_post, WP_Query, template tags" name="keywords"/>
  <meta content="PHP WordPress Course" name="author"/>
  <link href="/assets/css/main.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-enhanced.css" rel="stylesheet"/>
  <link href="/assets/css/sidebar-toggle.css" rel="stylesheet"/>
  <!-- Favicon -->
  <link href="/favicon.png" rel="icon" type="image/png"/>
  <link href="/favicon.png" rel="apple-touch-icon"/>
  <!-- CSS -->
 </head>
 <body>
  <!-- Skip to main content -->
  <a class="sr-only" href="#main-content">Skip to main content</a>
  <div class="page-wrapper">
   <!-- Header -->
   <header class="site-header" role="banner">
    <div class="header-container">
     <div class="site-branding">
      <a class="site-logo" href="/">
       <h1 class="site-title">PHP WordPress Development</h1>
      </a>
     </div>
     <nav aria-label="Main navigation" class="main-navigation" role="navigation">
      <button aria-expanded="false" aria-label="Toggle navigation" class="mobile-menu-btn">
       <span>
       </span>
       <span>
       </span>
       <span>
       </span>
      </button>
      <div class="nav-menu">
       <ul class="nav-list">
        <li class="nav-item">
         <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item dropdown">
         <button aria-haspopup="true" class="nav-link dropdown-toggle active">Modules</button>
         <div class="dropdown-menu">
          <a class="dropdown-item" href="/module1.html">Module 1: Web Fundamentals</a>
          <a class="dropdown-item" href="/module2.html">Module 2: PHP Fundamentals</a>
          <a class="dropdown-item" href="/module3.html">Module 3: MySQL Database</a>
          <a class="dropdown-item active" href="/module4.html">Module 4: WordPress &amp; Docker</a>
          <a class="dropdown-item" href="/module5.html">Module 5: Theme Development</a>
          <a class="dropdown-item" href="/module6.html">Module 6: Plugin Development</a>
          <a class="dropdown-item" href="/module7.html">Module 7: Advanced WordPress</a>
          <a class="dropdown-item" href="/module8.html">Module 8: Deployment</a>
          <a class="dropdown-item" href="/module9.html">Module 9: Final Project</a>
         </div>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/resources.html">Resources</a>
        </li>
        <li class="nav-item">
         <a class="nav-link" href="/about.html">About</a>
        </li>
       </ul>
      </div>
     </nav>
     <div class="search-container">
      <div class="search-input-wrapper">
       <svg class="search-icon" fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
        <path clip-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" fill-rule="evenodd">
        </path>
       </svg>
       <input aria-label="Search" class="search-input" placeholder="Search lessons..." type="search"/>
      </div>
      <div class="search-results">
      </div>
     </div>
    </div>
   </header>
   <!-- Progress Bar -->
   <div class="progress-container">
    <div class="progress-header">
     <h2 class="progress-title">Course Progress</h2>
     <span class="progress-text">Loading...</span>
    </div>
    <div class="progress-bar">
     <div class="progress-bar-fill">
      <span class="progress-bar-text">
      </span>
     </div>
    </div>
   </div>
   <!-- Breadcrumb -->
   <nav aria-label="Breadcrumb" class="breadcrumb container">
    <ol class="breadcrumb-list">
     <li class="breadcrumb-item">
      <a href="/">Home</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <a href="/module4.html">Module 4</a>
      <span class="breadcrumb-separator">/</span>
     </li>
     <li class="breadcrumb-item">
      <span aria-current="page">The WordPress Loop</span>
     </li>
    </ol>
   </nav>
   <!-- Main Content -->
   <main class="main-content" id="main-content" role="main">
    <div class="container">
     <div class="content-with-sidebar">
      <!-- Sidebar -->
      <aside class="sidebar">
    <div class="sidebar-nav">
        <h3 class="sidebar-title">Module 4: WordPress & Docker</h3>
        <div class="sidebar-section">
            <h4 class="sidebar-section-title">Session 2: WordPress Core Architecture</h4>
            <ul class="sidebar-menu">
                <li><a class="sidebar-link" href="/04module/file_structure_overview.html">WordPress file structure</a></li>
                <li><a class="sidebar-link" href="/04module/wp_config.html">Understanding wp-config.php</a></li>
                <li><a class="sidebar-link" href="/04module/wordpress_database_structure_lesson.html">WordPress database structure</a></li>
                <li class="active"><a class="sidebar-link active" href="/04module/wordpress_loop.html">The WordPress Loop</a></li>
                <li><a class="sidebar-link" href="/04module/wordpress_template_hierarchy.html">Template hierarchy</a></li>
                <li><a class="sidebar-link" href="/04module/wordpress_hooks_system.html">WordPress hooks system (actions and filters)</a></li>
                <li><a class="sidebar-link" href="/04module/homework_file_structure_template_hierarchy.html">Homework: Create a diagram of WordPress file structure and template hierarchy</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <h4 class="sidebar-section-title">Quick Links</h4>
            <ul class="sidebar-menu">
                <li><a class="sidebar-link" href="/module4.html">Module Overview</a></li>
                <li><a class="sidebar-link prev-session" href="/04module/history_evolution.html">‚Üê Prev: Session 1</a></li>
                <li><a class="sidebar-link next-session" href="/04module/wordpress_dashboard_overview.html">Next: Session 3 ‚Üí</a></li>
                <li><a class="sidebar-link" href="/">‚Üê Course Home</a></li>
                <li><a class="sidebar-link" href="/module5.html">Next Module ‚Üí</a></li>
                <li><a class="sidebar-link" href="/resources.html">Resources</a></li>
            </ul>
        </div>
    </div>
</aside>
      <!-- Main Lesson Content -->
      <article class="lesson-content">
       <header class="lesson-header">
        <h1>The WordPress Loop</h1>
        <div class="lesson-meta">
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z">
           </path>
          </svg>
          <span>Duration: 50 minutes</span>
         </div>
         <div class="lesson-meta-item">
          <svg fill="currentColor" height="20" width="20">
           <path d="M12 14l9-5-9-5-9 5 9 5z">
           </path>
          </svg>
          <span>Module 4: Session 3</span>
         </div>
        </div>
       </header>
       <!-- Learning Objectives -->
       <div class="lesson-objectives">
        <h2>Learning Objectives</h2>
        <ul>
         <li>Understand how the WordPress Loop works and why it's central to theme development</li>
         <li>Master the basic Loop structure and template tags</li>
         <li>Learn to create custom loops using WP_Query</li>
         <li>Implement multiple loops and nested loops effectively</li>
         <li>Optimize Loop performance and handle edge cases</li>
        </ul>
       </div>
       <!-- Lesson Body -->
       <div class="lesson-body">
        <section>
         <h2>Introduction to The WordPress Loop</h2>
         <p class="lead">The WordPress Loop is the PHP code that displays posts. It's called "The Loop" because it loops through each post in the database and displays it according to your theme's design. Understanding The Loop is fundamental to WordPress theme development - it's the engine that powers content display.</p>
         <div class="alert alert-info">
          <div class="alert-icon">üí°</div>
          <div class="alert-content">
           <div class="alert-title">Key Concept</div>
           <div class="alert-message">The Loop is WordPress's way of processing and displaying posts from the database. It uses two main functions:<code>have_posts()</code>to check if there are posts to display, and<code>the_post()</code>to set up the post data for use with template tags.</div>
          </div>
         </div>
        </section>
        <section>
         <h2>How The Loop Works</h2>
         <p>The Loop follows a simple but powerful pattern that retrieves posts from the database and makes them available to your theme templates.</p>
         <!-- Loop Flow Diagram -->
         <div class="mermaid">flowchart TD
                                        A[WordPress Query] --&gt; B{have_posts?}
                                        B --&gt;|Yes| C[the_post]
                                        C --&gt; D[Display Post Content]
                                        D --&gt; E[Template Tags]
                                        E --&gt; B
                                        B --&gt;|No| F[End Loop]
                                        F --&gt; G[Display 'No Posts' Message]
                                        
                                        style A fill:#4caf50,color:#fff
                                        style B fill:#ff9800,color:#fff
                                        style C fill:#2196f3,color:#fff
                                        style D fill:#e91e63,color:#fff
                                        style E fill:#9c27b0,color:#fff
                                        style F fill:#f44336,color:#fff
                                        style G fill:#795548,color:#fff</div>
         <h3>The Basic Loop Structure</h3>
         <pre><code class="language-php">&lt;?php
// The most basic WordPress Loop
if ( have_posts() ) :
    while ( have_posts() ) : the_post();
        // Display post content
        the_title();
        the_content();
    endwhile;
else :
    echo '&lt;p&gt;No posts found.&lt;/p&gt;';
endif;
?&gt;</code></pre>
        </section>
        <section>
         <h2>Understanding Loop Components</h2>
         <canvas height="400" id="loopComponentsCanvas" width="700">
         </canvas>
         <script>const loopCanvas = document.getElementById('loopComponentsCanvas');
                                    const loopCtx = loopCanvas.getContext('2d');
                                    
                                    // Title
                                    loopCtx.font = 'bold 18px Arial';
                                    loopCtx.fillStyle = '#333';
                                    loopCtx.fillText('WordPress Loop Components', 200, 30);
                                    
                                    // Components
                                    const components = [
                                        {name: 'have_posts()', desc: 'Checks if posts exist', x: 100, y: 80, color: '#4caf50'},
                                        {name: 'the_post()', desc: 'Sets up post data', x: 300, y: 80, color: '#2196f3'},
                                        {name: 'Template Tags', desc: 'Display post data', x: 500, y: 80, color: '#ff9800'}
                                    ];
                                    
                                    // Draw components
                                    components.forEach(comp =>{
                                        // Box
                                        loopCtx.fillStyle = comp.color;
                                        loopCtx.fillRect(comp.x - 60, comp.y - 25, 120, 50);
                                        
                                        // Text
                                        loopCtx.fillStyle = '#fff';
                                        loopCtx.font = 'bold 12px Arial';
                                        loopCtx.textAlign = 'center';
                                        loopCtx.fillText(comp.name, comp.x, comp.y);
                                        loopCtx.font = '10px Arial';
                                        loopCtx.fillText(comp.desc, comp.x, comp.y + 15);
                                    });
                                    
                                    // Draw arrows
                                    loopCtx.strokeStyle = '#666';
                                    loopCtx.lineWidth = 2;
                                    loopCtx.setLineDash([5, 5]);
                                    
                                    // Arrow 1
                                    loopCtx.beginPath();
                                    loopCtx.moveTo(160, 80);
                                    loopCtx.lineTo(240, 80);
                                    loopCtx.stroke();
                                    
                                    // Arrow 2
                                    loopCtx.beginPath();
                                    loopCtx.moveTo(360, 80);
                                    loopCtx.lineTo(440, 80);
                                    loopCtx.stroke();
                                    
                                    loopCtx.setLineDash([]);
                                    loopCtx.textAlign = 'left';
                                    
                                    // Example code sections
                                    loopCtx.fillStyle = '#333';
                                    loopCtx.font = 'bold 14px Arial';
                                    loopCtx.fillText('What happens in each step:', 50, 160);
                                    
                                    // Step details
                                    const steps = [
                                        '1. have_posts() queries the database for posts',
                                        '2. the_post() loads current post into global $post object',
                                        '3. Template tags extract and format post data',
                                        '4. Loop continues until no more posts'
                                    ];
                                    
                                    loopCtx.font = '12px Arial';
                                    steps.forEach((step, i) =>{
                                        loopCtx.fillText(step, 60, 185 + (i * 20));
                                    });
                                    
                                    // Global variables box
                                    loopCtx.fillStyle = '#f5f5f5';
                                    loopCtx.fillRect(50, 280, 600, 100);
                                    loopCtx.fillStyle = '#333';
                                    loopCtx.font = 'bold 12px Arial';
                                    loopCtx.fillText('Global Variables Set by the_post():', 60, 300);
                                    
                                    loopCtx.font = '11px monospace';
                                    const globals = [
                                        '$post - The current post object',
                                        '$authordata - Author information',
                                        '$currentday, $currentmonth - Date information',
                                        '$page, $pages, $multipage - Pagination data'
                                    ];
                                    
                                    globals.forEach((global, i) =>{
                                        loopCtx.fillText(global, 70, 320 + (i * 15));
                                    });</script>
         <h3>Essential Template Tags</h3>
         <pre><code class="language-php">&lt;?php
// Common template tags used within The Loop

// Post Information
the_title();              // Displays the post title
the_title_attribute();    // Title for use in attributes
the_ID();                 // Post ID
the_permalink();          // Post URL
the_post_thumbnail();     // Featured image

// Content
the_content();            // Full post content
the_excerpt();            // Post excerpt
the_content_part();       // Content sections (Block Editor)

// Meta Information
the_author();             // Author display name
the_author_posts_link();  // Link to author archive
the_date();              // Publication date
the_time();              // Publication time
the_category();          // Categories
the_tags();              // Tags

// Comments
comments_number();        // Number of comments
comments_link();         // Link to comments

// Custom Fields
the_field('field_name');  // ACF field (if using ACF)
get_post_meta(get_the_ID(), 'key', true); // Custom meta
?&gt;</code></pre>
        </section>
        <section>
         <h2>Complete Loop Examples</h2>
         <h3>1. Standard Blog Loop</h3>
         <pre><code class="language-php">&lt;?php
// A complete blog post loop with all elements
if ( have_posts() ) : 
    while ( have_posts() ) : the_post(); ?&gt;
    
        &lt;article id="post-&lt;?php the_ID(); ?&gt;" &lt;?php post_class(); ?&gt;&gt;
            &lt;header class="entry-header"&gt;
                &lt;h2 class="entry-title"&gt;
                    &lt;a href="&lt;?php the_permalink(); ?&gt;" rel="bookmark"&gt;
                        &lt;?php the_title(); ?&gt;
                    &lt;/a&gt;
                &lt;/h2&gt;
                
                &lt;div class="entry-meta"&gt;
                    Posted on &lt;?php echo get_the_date(); ?&gt;
                    by &lt;?php the_author_posts_link(); ?&gt;
                    in &lt;?php the_category(', '); ?&gt;
                &lt;/div&gt;
            &lt;/header&gt;

            &lt;?php if ( has_post_thumbnail() ) : ?&gt;
                &lt;div class="post-thumbnail"&gt;
                    &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                        &lt;?php the_post_thumbnail('large'); ?&gt;
                    &lt;/a&gt;
                &lt;/div&gt;
            &lt;?php endif; ?&gt;

            &lt;div class="entry-content"&gt;
                &lt;?php 
                if ( is_singular() ) :
                    the_content();
                    
                    wp_link_pages( array(
                        'before' =&gt; '&lt;div class="page-links"&gt;Pages:',
                        'after'  =&gt; '&lt;/div&gt;',
                    ) );
                else :
                    the_excerpt();
                    ?&gt;
                    &lt;a href="&lt;?php the_permalink(); ?&gt;" class="read-more"&gt;
                        Continue reading ‚Üí
                    &lt;/a&gt;
                &lt;?php endif; ?&gt;
            &lt;/div&gt;

            &lt;footer class="entry-footer"&gt;
                &lt;?php if ( has_tag() ) : ?&gt;
                    &lt;span class="tags-links"&gt;
                        Tagged: &lt;?php the_tags('', ', '); ?&gt;
                    &lt;/span&gt;
                &lt;?php endif; ?&gt;
                
                &lt;span class="comments-link"&gt;
                    &lt;?php comments_popup_link(
                        'Leave a comment',
                        '1 Comment',
                        '% Comments'
                    ); ?&gt;
                &lt;/span&gt;
            &lt;/footer&gt;
        &lt;/article&gt;

    &lt;?php endwhile;
    
    // Pagination
    the_posts_pagination( array(
        'prev_text' =&gt; '‚Üê Previous',
        'next_text' =&gt; 'Next ‚Üí',
        'mid_size'  =&gt; 2,
    ) );

else : ?&gt;
    
    &lt;article class="no-results"&gt;
        &lt;header class="page-header"&gt;
            &lt;h1&gt;Nothing Found&lt;/h1&gt;
        &lt;/header&gt;
        
        &lt;div class="page-content"&gt;
            &lt;p&gt;Sorry, but nothing matched your search criteria. 
            Please try again with different keywords.&lt;/p&gt;
            
            &lt;?php get_search_form(); ?&gt;
        &lt;/div&gt;
    &lt;/article&gt;

&lt;?php endif; ?&gt;</code></pre>
         <h3>2. Custom Post Type Loop</h3>
         <pre><code class="language-php">&lt;?php
// Loop for custom post type 'portfolio'
$portfolio_query = new WP_Query( array(
    'post_type'      =&gt; 'portfolio',
    'posts_per_page' =&gt; 12,
    'orderby'        =&gt; 'menu_order',
    'order'          =&gt; 'ASC',
    'meta_query'     =&gt; array(
        array(
            'key'     =&gt; 'featured_project',
            'value'   =&gt; 'yes',
            'compare' =&gt; '='
        )
    )
) );

if ( $portfolio_query-&gt;have_posts() ) : ?&gt;
    
    &lt;div class="portfolio-grid"&gt;
        &lt;?php while ( $portfolio_query-&gt;have_posts() ) : 
            $portfolio_query-&gt;the_post(); ?&gt;
            
            &lt;div class="portfolio-item"&gt;
                &lt;div class="portfolio-thumbnail"&gt;
                    &lt;?php if ( has_post_thumbnail() ) : ?&gt;
                        &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                            &lt;?php the_post_thumbnail('portfolio-thumb'); ?&gt;
                        &lt;/a&gt;
                    &lt;?php endif; ?&gt;
                    
                    &lt;div class="portfolio-overlay"&gt;
                        &lt;h3&gt;&lt;?php the_title(); ?&gt;&lt;/h3&gt;
                        &lt;p&gt;&lt;?php echo get_post_meta(get_the_ID(), 'project_type', true); ?&gt;&lt;/p&gt;
                        &lt;a href="&lt;?php the_permalink(); ?&gt;" class="view-project"&gt;
                            View Project
                        &lt;/a&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
        &lt;?php endwhile; ?&gt;
    &lt;/div&gt;
    
    &lt;?php 
    // Reset post data
    wp_reset_postdata();
    
else : ?&gt;
    &lt;p&gt;No portfolio items found.&lt;/p&gt;
&lt;?php endif; ?&gt;</code></pre>
        </section>
        <section>
         <h2>Custom Queries with WP_Query</h2>
         <p>WP_Query is the class that powers The Loop. Understanding how to create custom queries gives you complete control over which posts are displayed and how they're ordered.</p>
         <div class="mermaid">graph TD
                                        A[WP_Query Parameters] --&gt; B[Post Type]
                                        A --&gt; C[Post Status]
                                        A --&gt; D[Pagination]
                                        A --&gt; E[Ordering]
                                        A --&gt; F[Meta Query]
                                        A --&gt; G[Tax Query]
                                        
                                        B --&gt; B1[post]
                                        B --&gt; B2[page]
                                        B --&gt; B3[custom]
                                        
                                        C --&gt; C1[publish]
                                        C --&gt; C2[draft]
                                        C --&gt; C3[private]
                                        
                                        D --&gt; D1[posts_per_page]
                                        D --&gt; D2[paged]
                                        D --&gt; D3[offset]
                                        
                                        E --&gt; E1[orderby]
                                        E --&gt; E2[order]
                                        E --&gt; E3[meta_key]
                                        
                                        style A fill:#4caf50,color:#fff
                                        style F fill:#ff9800,color:#fff
                                        style G fill:#e91e63,color:#fff</div>
         <h3>Common WP_Query Parameters</h3>
         <pre><code class="language-php">&lt;?php
// Comprehensive WP_Query example
$args = array(
    // Post &amp; Page Parameters
    'post_type'      =&gt; array('post', 'page', 'custom_type'),
    'post_status'    =&gt; 'publish',
    'posts_per_page' =&gt; 10,  // -1 for all posts
    
    // Order &amp; Orderby Parameters
    'orderby'        =&gt; 'date', // title, menu_order, rand, comment_count
    'order'          =&gt; 'DESC',  // ASC or DESC
    
    // Pagination Parameters
    'paged'          =&gt; get_query_var('paged') ? get_query_var('paged') : 1,
    'offset'         =&gt; 0,
    
    // Author Parameters
    'author'         =&gt; 1,
    'author_name'    =&gt; 'john',
    
    // Category Parameters
    'cat'            =&gt; 5,
    'category_name'  =&gt; 'news',
    'category__in'   =&gt; array(2, 6),
    'category__not_in' =&gt; array(3, 7),
    
    // Tag Parameters
    'tag'            =&gt; 'cooking',
    'tag_id'         =&gt; 5,
    'tag__in'        =&gt; array(2, 6),
    
    // Custom Taxonomy Parameters
    'tax_query' =&gt; array(
        'relation' =&gt; 'AND',
        array(
            'taxonomy' =&gt; 'product_cat',
            'field'    =&gt; 'slug',
            'terms'    =&gt; array('electronics', 'computers'),
            'operator' =&gt; 'IN',
        ),
        array(
            'taxonomy' =&gt; 'product_tag',
            'field'    =&gt; 'id',
            'terms'    =&gt; array(25, 30),
            'operator' =&gt; 'NOT IN',
        )
    ),
    
    // Custom Field Parameters
    'meta_key'       =&gt; 'price',
    'meta_value'     =&gt; '100',
    'meta_compare'   =&gt; '&gt;',
    'meta_query' =&gt; array(
        'relation' =&gt; 'AND',
        array(
            'key'     =&gt; 'color',
            'value'   =&gt; 'blue',
            'compare' =&gt; '='
        ),
        array(
            'key'     =&gt; 'price',
            'value'   =&gt; array(20, 100),
            'type'    =&gt; 'numeric',
            'compare' =&gt; 'BETWEEN'
        )
    ),
    
    // Search Parameters
    's' =&gt; 'search term',
    
    // Date Parameters
    'year'      =&gt; 2024,
    'monthnum'  =&gt; 12,
    'day'       =&gt; 25,
);

$custom_query = new WP_Query($args);
?&gt;</code></pre>
        </section>
        <section>
         <h2>Multiple and Nested Loops</h2>
         <p>Sometimes you need to display multiple sets of posts on the same page. This requires careful handling to avoid conflicts.</p>
         <h3>Multiple Loops Example</h3>
         <pre><code class="language-php">&lt;?php
// First Loop: Featured Posts
$featured_args = array(
    'posts_per_page' =&gt; 3,
    'meta_key'       =&gt; 'featured',
    'meta_value'     =&gt; 'yes'
);
$featured_query = new WP_Query($featured_args);

if ($featured_query-&gt;have_posts()) : ?&gt;
    &lt;section class="featured-posts"&gt;
        &lt;h2&gt;Featured Posts&lt;/h2&gt;
        &lt;?php while ($featured_query-&gt;have_posts()) : 
            $featured_query-&gt;the_post(); ?&gt;
            &lt;article&gt;
                &lt;h3&gt;&lt;?php the_title(); ?&gt;&lt;/h3&gt;
                &lt;?php the_excerpt(); ?&gt;
            &lt;/article&gt;
        &lt;?php endwhile; ?&gt;
    &lt;/section&gt;
    &lt;?php wp_reset_postdata(); ?&gt;
&lt;?php endif; ?&gt;

&lt;?php
// Second Loop: Recent Posts (excluding featured)
$featured_ids = wp_list_pluck($featured_query-&gt;posts, 'ID');
$recent_args = array(
    'posts_per_page' =&gt; 10,
    'post__not_in'   =&gt; $featured_ids
);
$recent_query = new WP_Query($recent_args);

if ($recent_query-&gt;have_posts()) : ?&gt;
    &lt;section class="recent-posts"&gt;
        &lt;h2&gt;Recent Posts&lt;/h2&gt;
        &lt;?php while ($recent_query-&gt;have_posts()) : 
            $recent_query-&gt;the_post(); ?&gt;
            &lt;article&gt;
                &lt;h3&gt;&lt;?php the_title(); ?&gt;&lt;/h3&gt;
                &lt;?php the_excerpt(); ?&gt;
            &lt;/article&gt;
        &lt;?php endwhile; ?&gt;
    &lt;/section&gt;
    &lt;?php wp_reset_postdata(); ?&gt;
&lt;?php endif; ?&gt;</code></pre>
         <h3>Nested Loop Example</h3>
         <pre><code class="language-php">&lt;?php
// Parent Loop: Categories
$categories = get_categories(array(
    'orderby' =&gt; 'name',
    'order'   =&gt; 'ASC'
));

foreach ($categories as $category) : ?&gt;
    &lt;section class="category-section"&gt;
        &lt;h2&gt;&lt;?php echo $category-&gt;name; ?&gt;&lt;/h2&gt;
        
        &lt;?php
        // Child Loop: Posts in this category
        $cat_posts = new WP_Query(array(
            'cat'            =&gt; $category-&gt;term_id,
            'posts_per_page' =&gt; 5
        ));
        
        if ($cat_posts-&gt;have_posts()) : ?&gt;
            &lt;div class="category-posts"&gt;
                &lt;?php while ($cat_posts-&gt;have_posts()) : 
                    $cat_posts-&gt;the_post(); ?&gt;
                    &lt;article&gt;
                        &lt;h3&gt;
                            &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                                &lt;?php the_title(); ?&gt;
                            &lt;/a&gt;
                        &lt;/h3&gt;
                        &lt;time&gt;&lt;?php echo get_the_date(); ?&gt;&lt;/time&gt;
                    &lt;/article&gt;
                &lt;?php endwhile; ?&gt;
            &lt;/div&gt;
            &lt;?php wp_reset_postdata(); ?&gt;
        &lt;?php endif; ?&gt;
    &lt;/section&gt;
&lt;?php endforeach; ?&gt;</code></pre>
        </section>
        <!-- Best Practice Box -->
        <div class="best_practice">
         <h3>Loop Best Practices</h3>
         <ul>
          <li>Always use<code>wp_reset_postdata()</code>after custom queries to restore the global $post object</li>
          <li>Use<code>WP_Query</code>for complex queries instead of query_posts() which can break pagination</li>
          <li>Cache expensive queries using the Transients API for better performance</li>
          <li>Use proper conditional tags to display appropriate content for different contexts</li>
          <li>Implement pagination for large result sets to improve page load times</li>
          <li>Use<code>get_posts()</code>for simple queries that return an array of posts</li>
          <li>Always escape output with appropriate functions like<code>esc_html()</code>,<code>esc_url()</code>
          </li>
          <li>Consider using<code>pre_get_posts</code>action to modify main queries instead of creating new ones</li>
         </ul>
        </div>
        <section>
         <h2>Advanced Loop Techniques</h2>
         <h3>1. AJAX Load More Posts</h3>
         <pre><code class="language-php">&lt;?php
// functions.php
function load_more_posts() {
    $paged = $_POST['page'];
    $args = array(
        'post_type'      =&gt; 'post',
        'posts_per_page' =&gt; 6,
        'paged'          =&gt; $paged
    );
    
    $query = new WP_Query($args);
    
    if ($query-&gt;have_posts()) :
        while ($query-&gt;have_posts()) : $query-&gt;the_post();
            get_template_part('template-parts/content', get_post_format());
        endwhile;
    endif;
    
    wp_die();
}
add_action('wp_ajax_load_more', 'load_more_posts');
add_action('wp_ajax_nopriv_load_more', 'load_more_posts');

// JavaScript for load more
?&gt;
&lt;script&gt;
jQuery(document).ready(function($) {
    var page = 2;
    
    $('#load-more').click(function() {
        var data = {
            'action': 'load_more',
            'page': page
        };
        
        $.post(ajax_url, data, function(response) {
            $('.posts-container').append(response);
            page++;
        });
    });
});
&lt;/script&gt;</code></pre>
         <h3>2. Related Posts Query</h3>
         <pre><code class="language-php">&lt;?php
// Get related posts based on categories
function get_related_posts($post_id, $number_of_posts = 4) {
    $categories = wp_get_post_categories($post_id);
    
    $args = array(
        'category__in'   =&gt; $categories,
        'post__not_in'   =&gt; array($post_id),
        'posts_per_page' =&gt; $number_of_posts,
        'orderby'        =&gt; 'rand'
    );
    
    return new WP_Query($args);
}

// Usage in single.php
$related = get_related_posts(get_the_ID());

if ($related-&gt;have_posts()) : ?&gt;
    &lt;section class="related-posts"&gt;
        &lt;h3&gt;Related Articles&lt;/h3&gt;
        &lt;div class="related-grid"&gt;
            &lt;?php while ($related-&gt;have_posts()) : $related-&gt;the_post(); ?&gt;
                &lt;article&gt;
                    &lt;?php if (has_post_thumbnail()) : ?&gt;
                        &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                            &lt;?php the_post_thumbnail('medium'); ?&gt;
                        &lt;/a&gt;
                    &lt;?php endif; ?&gt;
                    &lt;h4&gt;
                        &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                            &lt;?php the_title(); ?&gt;
                        &lt;/a&gt;
                    &lt;/h4&gt;
                &lt;/article&gt;
            &lt;?php endwhile; ?&gt;
        &lt;/div&gt;
    &lt;/section&gt;
    &lt;?php wp_reset_postdata(); ?&gt;
&lt;?php endif; ?&gt;</code></pre>
         <h3>3. Modifying the Main Query</h3>
         <pre><code class="language-php">&lt;?php
// functions.php - Modify main query without creating new queries
function modify_main_query($query) {
    if (!is_admin() &amp;&amp; $query-&gt;is_main_query()) {
        
        // Change posts per page on archive pages
        if (is_archive()) {
            $query-&gt;set('posts_per_page', 20);
        }
        
        // Exclude category from blog page
        if (is_home()) {
            $query-&gt;set('cat', '-5'); // Exclude category ID 5
        }
        
        // Custom post type archive
        if (is_post_type_archive('portfolio')) {
            $query-&gt;set('orderby', 'menu_order');
            $query-&gt;set('order', 'ASC');
        }
        
        // Search results
        if (is_search()) {
            $query-&gt;set('post_type', array('post', 'page', 'product'));
        }
    }
}
add_action('pre_get_posts', 'modify_main_query');</code></pre>
        </section>
        <!-- Real World Example -->
        <div class="real_world_example">
         <h3>Real World Example: Magazine Homepage</h3>
         <p>Creating a complex magazine-style homepage with multiple content sections:</p>
         <pre><code class="language-php">&lt;?php
// Magazine Homepage Template
get_header(); ?&gt;

&lt;div class="magazine-layout"&gt;
    
    &lt;!-- Hero Section: Latest Featured Post --&gt;
    &lt;?php
    $hero = new WP_Query(array(
        'posts_per_page' =&gt; 1,
        'meta_key'       =&gt; 'hero_feature',
        'meta_value'     =&gt; 'yes'
    ));
    
    if ($hero-&gt;have_posts()) : while ($hero-&gt;have_posts()) : $hero-&gt;the_post(); ?&gt;
        &lt;section class="hero-section" style="background-image: url(&lt;?php echo get_the_post_thumbnail_url(null, 'full'); ?&gt;)"&gt;
            &lt;div class="hero-content"&gt;
                &lt;div class="category-badge"&gt;
                    &lt;?php the_category(' '); ?&gt;
                &lt;/div&gt;
                &lt;h1&gt;&lt;?php the_title(); ?&gt;&lt;/h1&gt;
                &lt;div class="hero-meta"&gt;
                    By &lt;?php the_author(); ?&gt; on &lt;?php echo get_the_date(); ?&gt;
                &lt;/div&gt;
                &lt;div class="hero-excerpt"&gt;
                    &lt;?php the_excerpt(); ?&gt;
                &lt;/div&gt;
                &lt;a href="&lt;?php the_permalink(); ?&gt;" class="btn-primary"&gt;Read More&lt;/a&gt;
            &lt;/div&gt;
        &lt;/section&gt;
    &lt;?php endwhile; wp_reset_postdata(); endif; ?&gt;
    
    &lt;!-- Trending Section --&gt;
    &lt;section class="trending-section"&gt;
        &lt;h2&gt;Trending Now&lt;/h2&gt;
        &lt;div class="trending-grid"&gt;
            &lt;?php
            $trending = new WP_Query(array(
                'posts_per_page' =&gt; 4,
                'meta_key'       =&gt; 'views_count',
                'orderby'        =&gt; 'meta_value_num',
                'order'          =&gt; 'DESC'
            ));
            
            if ($trending-&gt;have_posts()) : 
                while ($trending-&gt;have_posts()) : $trending-&gt;the_post(); ?&gt;
                    &lt;article class="trending-item"&gt;
                        &lt;span class="trending-number"&gt;&lt;?php echo $trending-&gt;current_post + 1; ?&gt;&lt;/span&gt;
                        &lt;h3&gt;
                            &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                                &lt;?php the_title(); ?&gt;
                            &lt;/a&gt;
                        &lt;/h3&gt;
                        &lt;span class="trending-views"&gt;
                            &lt;?php echo get_post_meta(get_the_ID(), 'views_count', true); ?&gt; views
                        &lt;/span&gt;
                    &lt;/article&gt;
                &lt;?php endwhile; 
                wp_reset_postdata();
            endif; ?&gt;
        &lt;/div&gt;
    &lt;/section&gt;
    
    &lt;!-- Category Sections --&gt;
    &lt;?php
    $featured_categories = array('technology', 'lifestyle', 'business');
    
    foreach ($featured_categories as $cat_slug) :
        $category = get_category_by_slug($cat_slug);
        if (!$category) continue;
        ?&gt;
        
        &lt;section class="category-showcase"&gt;
            &lt;header class="section-header"&gt;
                &lt;h2&gt;&lt;?php echo $category-&gt;name; ?&gt;&lt;/h2&gt;
                &lt;a href="&lt;?php echo get_category_link($category); ?&gt;" class="view-all"&gt;
                    View All ‚Üí
                &lt;/a&gt;
            &lt;/header&gt;
            
            &lt;div class="posts-grid"&gt;
                &lt;?php
                $cat_posts = new WP_Query(array(
                    'cat'            =&gt; $category-&gt;term_id,
                    'posts_per_page' =&gt; 3
                ));
                
                if ($cat_posts-&gt;have_posts()) :
                    while ($cat_posts-&gt;have_posts()) : $cat_posts-&gt;the_post(); ?&gt;
                        &lt;article class="grid-post"&gt;
                            &lt;?php if (has_post_thumbnail()) : ?&gt;
                                &lt;div class="post-thumbnail"&gt;
                                    &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                                        &lt;?php the_post_thumbnail('medium_large'); ?&gt;
                                    &lt;/a&gt;
                                &lt;/div&gt;
                            &lt;?php endif; ?&gt;
                            
                            &lt;div class="post-content"&gt;
                                &lt;h3&gt;
                                    &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                                        &lt;?php the_title(); ?&gt;
                                    &lt;/a&gt;
                                &lt;/h3&gt;
                                &lt;div class="post-meta"&gt;
                                    &lt;time&gt;&lt;?php echo get_the_date(); ?&gt;&lt;/time&gt;
                                    ‚Ä¢ &lt;?php echo get_comments_number(); ?&gt; comments
                                &lt;/div&gt;
                                &lt;div class="post-excerpt"&gt;
                                    &lt;?php echo wp_trim_words(get_the_excerpt(), 20); ?&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/article&gt;
                    &lt;?php endwhile;
                    wp_reset_postdata();
                endif; ?&gt;
            &lt;/div&gt;
        &lt;/section&gt;
        
    &lt;?php endforeach; ?&gt;
    
&lt;/div&gt;

&lt;?php get_footer(); ?&gt;</code></pre>
        </div>
        <!-- Practice Exercise -->
        <section>
         <h2>Practice Exercise</h2>
         <p>Create a custom loop that displays posts from multiple categories in separate sections:</p>
         <div class="alert alert-success">
          <div class="alert-icon">üíª</div>
          <div class="alert-content">
           <div class="alert-title">Try It Now</div>
           <div class="alert-message">Build a page template that:<ol>
             <li>Displays the 3 most recent posts from category "News"</li>
             <li>Shows 5 posts from "Events" category ordered by event date (custom field)</li>
             <li>Lists all posts tagged with "featured" excluding the above</li>
             <li>Implements proper pagination for each section</li>
            </ol>
           </div>
          </div>
         </div>
         <details>
          <summary>View Solution</summary>
          <pre><code class="language-php">&lt;?php
// Template Name: Multi-Category Display
get_header(); ?&gt;

&lt;div class="multi-category-page"&gt;
    
    &lt;!-- News Section --&gt;
    &lt;section class="news-section"&gt;
        &lt;h2&gt;Latest News&lt;/h2&gt;
        &lt;?php
        $news_query = new WP_Query(array(
            'category_name'  =&gt; 'news',
            'posts_per_page' =&gt; 3
        ));
        
        if ($news_query-&gt;have_posts()) : ?&gt;
            &lt;div class="news-grid"&gt;
                &lt;?php while ($news_query-&gt;have_posts()) : $news_query-&gt;the_post(); ?&gt;
                    &lt;article&gt;
                        &lt;h3&gt;&lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;&lt;?php the_title(); ?&gt;&lt;/a&gt;&lt;/h3&gt;
                        &lt;time&gt;&lt;?php echo get_the_date(); ?&gt;&lt;/time&gt;
                        &lt;?php the_excerpt(); ?&gt;
                    &lt;/article&gt;
                &lt;?php endwhile; ?&gt;
            &lt;/div&gt;
            &lt;?php wp_reset_postdata(); ?&gt;
        &lt;?php endif; ?&gt;
    &lt;/section&gt;
    
    &lt;!-- Events Section --&gt;
    &lt;section class="events-section"&gt;
        &lt;h2&gt;Upcoming Events&lt;/h2&gt;
        &lt;?php
        $events_query = new WP_Query(array(
            'category_name'  =&gt; 'events',
            'posts_per_page' =&gt; 5,
            'meta_key'       =&gt; 'event_date',
            'orderby'        =&gt; 'meta_value',
            'order'          =&gt; 'ASC',
            'meta_query'     =&gt; array(
                array(
                    'key'     =&gt; 'event_date',
                    'value'   =&gt; date('Y-m-d'),
                    'compare' =&gt; '&gt;=',
                    'type'    =&gt; 'DATE'
                )
            )
        ));
        
        if ($events_query-&gt;have_posts()) : ?&gt;
            &lt;div class="events-list"&gt;
                &lt;?php while ($events_query-&gt;have_posts()) : $events_query-&gt;the_post(); ?&gt;
                    &lt;article class="event-item"&gt;
                        &lt;div class="event-date"&gt;
                            &lt;?php echo get_post_meta(get_the_ID(), 'event_date', true); ?&gt;
                        &lt;/div&gt;
                        &lt;div class="event-details"&gt;
                            &lt;h3&gt;&lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;&lt;?php the_title(); ?&gt;&lt;/a&gt;&lt;/h3&gt;
                            &lt;p&gt;&lt;?php echo get_post_meta(get_the_ID(), 'event_location', true); ?&gt;&lt;/p&gt;
                        &lt;/div&gt;
                    &lt;/article&gt;
                &lt;?php endwhile; ?&gt;
            &lt;/div&gt;
            &lt;?php wp_reset_postdata(); ?&gt;
        &lt;?php endif; ?&gt;
    &lt;/section&gt;
    
    &lt;!-- Featured Posts Section --&gt;
    &lt;section class="featured-section"&gt;
        &lt;h2&gt;Featured Content&lt;/h2&gt;
        &lt;?php
        // Get IDs to exclude
        $exclude_ids = array();
        if ($news_query-&gt;have_posts()) {
            $exclude_ids = array_merge($exclude_ids, wp_list_pluck($news_query-&gt;posts, 'ID'));
        }
        if ($events_query-&gt;have_posts()) {
            $exclude_ids = array_merge($exclude_ids, wp_list_pluck($events_query-&gt;posts, 'ID'));
        }
        
        $featured_query = new WP_Query(array(
            'tag'            =&gt; 'featured',
            'posts_per_page' =&gt; 10,
            'post__not_in'   =&gt; $exclude_ids,
            'paged'          =&gt; get_query_var('paged') ? get_query_var('paged') : 1
        ));
        
        if ($featured_query-&gt;have_posts()) : ?&gt;
            &lt;div class="featured-grid"&gt;
                &lt;?php while ($featured_query-&gt;have_posts()) : $featured_query-&gt;the_post(); ?&gt;
                    &lt;article&gt;
                        &lt;?php if (has_post_thumbnail()) : ?&gt;
                            &lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;
                                &lt;?php the_post_thumbnail('thumbnail'); ?&gt;
                            &lt;/a&gt;
                        &lt;?php endif; ?&gt;
                        &lt;h3&gt;&lt;a href="&lt;?php the_permalink(); ?&gt;"&gt;&lt;?php the_title(); ?&gt;&lt;/a&gt;&lt;/h3&gt;
                    &lt;/article&gt;
                &lt;?php endwhile; ?&gt;
            &lt;/div&gt;
            
            &lt;!-- Pagination --&gt;
            &lt;?php
            echo paginate_links(array(
                'total' =&gt; $featured_query-&gt;max_num_pages,
                'current' =&gt; max(1, get_query_var('paged'))
            ));
            wp_reset_postdata();
            ?&gt;
        &lt;?php endif; ?&gt;
    &lt;/section&gt;
    
&lt;/div&gt;

&lt;?php get_footer(); ?&gt;</code></pre>
         </details>
        </section>
        <!-- Homework -->
        <div class="homework">
         <h2>Practice Assignment</h2>
         <p>Strengthen your understanding of The WordPress Loop by completing these exercises:</p>
         <ul>
          <li>Create a custom homepage template with at least 3 different loops</li>
          <li>Build an archive page that groups posts by month with nested loops</li>
          <li>Implement AJAX pagination for a custom post type archive</li>
          <li>Create a "load more" button that appends posts without page refresh</li>
          <li>Build a filtering system that modifies the loop based on user selection</li>
          <li>Develop a related posts section that uses tags and categories</li>
         </ul>
        </div>
        <!-- Resources -->
        <section class="resources">
         <h2>Additional Resources</h2>
         <ul>
          <li>
           <a href="https://developer.wordpress.org/themes/basics/the-loop/" target="_blank">The Loop - WordPress Developer Resources</a>
          </li>
          <li>
           <a href="https://developer.wordpress.org/reference/classes/wp_query/" target="_blank">WP_Query Class Reference</a>
          </li>
          <li>
           <a href="https://codex.wordpress.org/The_Loop_in_Action" target="_blank">The Loop in Action - WordPress Codex</a>
          </li>
          <li>
           <a href="https://www.billerickson.net/code/wp_query-arguments/" target="_blank">WP_Query Arguments - Complete Reference</a>
          </li>
          <li>
           <a href="https://developer.wordpress.org/reference/hooks/pre_get_posts/" target="_blank">pre_get_posts Action Hook</a>
          </li>
         </ul>
        </section>
       </div>
       <!-- Lesson Navigation -->
       <div class="lesson-navigation">
        <a class="lesson-nav-button prev" href="/module4-session2-database-structure.html">
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z">
          </path>
         </svg>
         <span>
          <small>Previous</small>
          <br/>Database Structure</span>
        </a>
        <button class="complete-lesson-btn">Mark as Complete</button>
        <a class="lesson-nav-button next" href="/module4-session4.html">
         <span>
          <small>Next</small>
          <br/>Theme Basics</span>
         <svg fill="currentColor" height="20" viewbox="0 0 20 20" width="20">
          <path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z">
          </path>
         </svg>
        </a>
       </div>
      </article>
     </div>
    </div>
   </main>
   <!-- Footer -->
   <footer class="site-footer" role="contentinfo">
    <div class="footer-container">
     <div class="footer-content">
      <div class="footer-section footer-about">
       <h3>PHP WordPress Development</h3>
       <p>Complete Web Development Course</p>
      </div>
      <div class="footer-section">
       <h4>Quick Links</h4>
       <ul class="footer-links">
        <li>
         <a href="/">Home</a>
        </li>
        <li>
         <a class="active" href="/module4.html">Module 4</a>
        </li>
        <li>
         <a href="/resources.html">Resources</a>
        </li>
       </ul>
      </div>
      <div class="footer-section">
       <h4>Support</h4>
       <ul class="footer-links">
        <li>
         <a href="/help.html">Help Center</a>
        </li>
        <li>
         <a href="/faq.html">FAQ</a>
        </li>
        <li>
         <a href="/contact.html">Contact</a>
        </li>
       </ul>
      </div>
     </div>
     <div class="footer-bottom">
      <div class="footer-bottom-content">
       <p class="copyright">¬© 2025 PHP WordPress Development Course</p>
       <nav class="footer-bottom-links">
        <a href="/privacy.html">Privacy</a>
        <span class="separator">|</span>
        <a href="/terms.html">Terms</a>
       </nav>
      </div>
     </div>
    </div>
   </footer>
  </div>
  <!-- Back to Top -->
  <button aria-label="Back to top" class="back-to-top" id="back-to-top">
   <svg fill="none" height="24" stroke="currentColor" stroke-width="2" viewbox="0 0 24 24" width="24">
    <path d="M12 19V5M12 5l-7 7M12 5l7 7">
    </path>
   </svg>
  </button>
  <!-- JavaScript -->
  <script src="/assets/js/navigation.js">
  </script>
  <script src="/assets/js/site-config.js">
  </script>
  <script src="/assets/js/sidebar-toggle.js">
  </script>
  <!-- Universal Mermaid Fix (Enhanced) -->
  <!-- Universal Mermaid Fix -->
  <script src="/assets/js/mermaid-universal-fix.js">
  </script>
 </body>
</html>
